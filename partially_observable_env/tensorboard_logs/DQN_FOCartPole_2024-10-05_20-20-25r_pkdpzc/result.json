{"evaluation": {"sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 29.0, "episode_reward_mean": 45.6, "episode_len_mean": 45.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 53.0, 32.0, 49.0, 29.0, 38.0, 52.0, 72.0, 31.0, 57.0], "episode_lengths": [43, 53, 32, 49, 29, 38, 52, 72, 31, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2910676209822945, "mean_inference_ms": 1.3081716454547383, "mean_action_processing_ms": 0.10503704840015518, "mean_env_wait_ms": 0.04666030642543385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028228759765625, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.05549192428588867}}, "episode_reward_max": 72.0, "episode_reward_min": 29.0, "episode_reward_mean": 45.6, "episode_len_mean": 45.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 53.0, 32.0, 49.0, 29.0, 38.0, 52.0, 72.0, 31.0, 57.0], "episode_lengths": [43, 53, 32, 49, 29, 38, 52, 72, 31, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2910676209822945, "mean_inference_ms": 1.3081716454547383, "mean_action_processing_ms": 0.10503704840015518, "mean_env_wait_ms": 0.04666030642543385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028228759765625, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.05549192428588867}, "num_agent_steps_sampled_this_iter": 456, "num_env_steps_sampled_this_iter": 456, "timesteps_this_iter": 456, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 26.62857142857143, "episode_len_mean": 26.62857142857143, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 33.0, 33.0, 12.0, 22.0, 51.0, 18.0, 13.0, 31.0, 19.0, 28.0, 40.0, 43.0, 16.0, 22.0, 62.0, 16.0, 23.0, 24.0, 14.0, 29.0, 18.0, 19.0, 38.0, 28.0, 34.0, 23.0, 23.0, 28.0, 14.0, 45.0, 45.0, 18.0, 29.0, 12.0], "episode_lengths": [9, 33, 33, 12, 22, 51, 18, 13, 31, 19, 28, 40, 43, 16, 22, 62, 16, 23, 24, 14, 29, 18, 19, 38, 28, 34, 23, 23, 28, 14, 45, 45, 18, 29, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.239714384619611, "mean_inference_ms": 2.994020509611723, "mean_action_processing_ms": 0.163647917663159, "mean_env_wait_ms": 0.08714545070449242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006618499755859375, "StateBufferConnector_ms": 0.005022457667759487, "ViewRequirementAgentConnector_ms": 0.10143484388078962}}, "episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 26.62857142857143, "episode_len_mean": 26.62857142857143, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, 33.0, 33.0, 12.0, 22.0, 51.0, 18.0, 13.0, 31.0, 19.0, 28.0, 40.0, 43.0, 16.0, 22.0, 62.0, 16.0, 23.0, 24.0, 14.0, 29.0, 18.0, 19.0, 38.0, 28.0, 34.0, 23.0, 23.0, 28.0, 14.0, 45.0, 45.0, 18.0, 29.0, 12.0], "episode_lengths": [9, 33, 33, 12, 22, 51, 18, 13, 31, 19, 28, 40, 43, 16, 22, 62, 16, 23, 24, 14, 29, 18, 19, 38, 28, 34, 23, 23, 28, 14, 45, 45, 18, 29, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.239714384619611, "mean_inference_ms": 2.994020509611723, "mean_action_processing_ms": 0.163647917663159, "mean_env_wait_ms": 0.08714545070449242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006618499755859375, "StateBufferConnector_ms": 0.005022457667759487, "ViewRequirementAgentConnector_ms": 0.10143484388078962}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 947.109549419435, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 6.711, "sample_time_ms": 6.072}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 35, "training_iteration": 1, "trial_id": "default", "date": "2024-10-05_20-20-33", "timestamp": 1728152433, "time_this_iter_s": 1.5087735652923584, "time_total_s": 1.5087735652923584, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.5087735652923584, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.0, "ram_util_percent": 89.8}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 16.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 62.0, 9.0, 13.0, 10.0, 10.0, 9.0, 13.0, 12.0, 10.0], "episode_lengths": [12, 62, 9, 13, 10, 10, 9, 13, 12, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.310201614428633, "mean_inference_ms": 1.227357517035244, "mean_action_processing_ms": 0.10499634300938812, "mean_env_wait_ms": 0.046869436392007156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029015541076660156, "StateBufferConnector_ms": 0.0033164024353027344, "ViewRequirementAgentConnector_ms": 0.056519508361816406}}, "episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 16.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 62.0, 9.0, 13.0, 10.0, 10.0, 9.0, 13.0, 12.0, 10.0], "episode_lengths": [12, 62, 9, 13, 10, 10, 9, 13, 12, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.310201614428633, "mean_inference_ms": 1.227357517035244, "mean_action_processing_ms": 0.10499634300938812, "mean_env_wait_ms": 0.046869436392007156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029015541076660156, "StateBufferConnector_ms": 0.0033164024353027344, "ViewRequirementAgentConnector_ms": 0.056519508361816406}, "num_agent_steps_sampled_this_iter": 160, "num_env_steps_sampled_this_iter": 160, "timesteps_this_iter": 160, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 2.5315606594085693, "min_q": 1.507922887802124, "max_q": 4.136944770812988, "mean_td_error": 0.2400198131799698}, "td_error": [0.45478153228759766, -0.6497480869293213, -0.1156160831451416, -0.22924518585205078, 0.07169008255004883, 1.3642151355743408, 0.5808405876159668, -0.07012343406677246, 0.133040189743042, 0.08613729476928711, -0.2734508514404297, 0.11917853355407715, 0.2028489112854004, 0.6143429279327393, 0.12976837158203125, -0.5431995391845703, 1.8432347774505615, 1.90336012840271, 0.36460041999816895, -0.03855538368225098, -1.138831377029419, 0.2120351791381836, 1.4863226413726807, -0.21896576881408691, -0.5428718328475952, 0.6954059600830078, 0.6335670948028564, -0.4319477081298828, -0.5979571342468262, 0.13541388511657715, 1.6574316024780273, -0.15706872940063477], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 124}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "last_target_update_ts": 1512, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 23.240963855421686, "episode_len_mean": 23.240963855421686, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 33.0, 33.0, 12.0, 22.0, 51.0, 18.0, 13.0, 31.0, 19.0, 28.0, 40.0, 43.0, 16.0, 22.0, 62.0, 16.0, 23.0, 24.0, 14.0, 29.0, 18.0, 19.0, 38.0, 28.0, 34.0, 23.0, 23.0, 28.0, 14.0, 45.0, 45.0, 18.0, 29.0, 12.0, 27.0, 46.0, 14.0, 13.0, 40.0, 10.0, 12.0, 10.0, 19.0, 12.0, 18.0, 12.0, 18.0, 22.0, 12.0, 13.0, 21.0, 26.0, 45.0, 23.0, 21.0, 15.0, 10.0, 31.0, 12.0, 10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0], "episode_lengths": [9, 33, 33, 12, 22, 51, 18, 13, 31, 19, 28, 40, 43, 16, 22, 62, 16, 23, 24, 14, 29, 18, 19, 38, 28, 34, 23, 23, 28, 14, 45, 45, 18, 29, 12, 27, 46, 14, 13, 40, 10, 12, 10, 19, 12, 18, 12, 18, 22, 12, 13, 21, 26, 45, 23, 21, 15, 10, 31, 12, 10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2690300678354323, "mean_inference_ms": 2.5751670137495197, "mean_action_processing_ms": 0.16109525995388163, "mean_env_wait_ms": 0.08711248150795027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007466235792780497, "StateBufferConnector_ms": 0.005909046494817159, "ViewRequirementAgentConnector_ms": 0.11080919978130295}}, "episode_reward_max": 62.0, "episode_reward_min": 9.0, "episode_reward_mean": 23.240963855421686, "episode_len_mean": 23.240963855421686, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, 33.0, 33.0, 12.0, 22.0, 51.0, 18.0, 13.0, 31.0, 19.0, 28.0, 40.0, 43.0, 16.0, 22.0, 62.0, 16.0, 23.0, 24.0, 14.0, 29.0, 18.0, 19.0, 38.0, 28.0, 34.0, 23.0, 23.0, 28.0, 14.0, 45.0, 45.0, 18.0, 29.0, 12.0, 27.0, 46.0, 14.0, 13.0, 40.0, 10.0, 12.0, 10.0, 19.0, 12.0, 18.0, 12.0, 18.0, 22.0, 12.0, 13.0, 21.0, 26.0, 45.0, 23.0, 21.0, 15.0, 10.0, 31.0, 12.0, 10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0], "episode_lengths": [9, 33, 33, 12, 22, 51, 18, 13, 31, 19, 28, 40, 43, 16, 22, 62, 16, 23, 24, 14, 29, 18, 19, 38, 28, 34, 23, 23, 28, 14, 45, 45, 18, 29, 12, 27, 46, 14, 13, 40, 10, 12, 10, 19, 12, 18, 12, 18, 22, 12, 13, 21, 26, 45, 23, 21, 15, 10, 31, 12, 10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2690300678354323, "mean_inference_ms": 2.5751670137495197, "mean_action_processing_ms": 0.16109525995388163, "mean_env_wait_ms": 0.08711248150795027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007466235792780497, "StateBufferConnector_ms": 0.005909046494817159, "ViewRequirementAgentConnector_ms": 0.11080919978130295}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.391193761857, "num_env_steps_trained_throughput_per_sec": 1157.564775047428, "timesteps_total": 2000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 21.696, "sample_time_ms": 8.229, "learn_time_ms": 2.454, "learn_throughput": 13039.709, "synch_weights_time_ms": 3.761}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "last_target_update_ts": 1512, "num_target_updates": 2}, "done": false, "episodes_total": 83, "training_iteration": 2, "trial_id": "default", "date": "2024-10-05_20-20-37", "timestamp": 1728152437, "time_this_iter_s": 3.5491740703582764, "time_total_s": 5.057947635650635, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 5.057947635650635, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.58, "ram_util_percent": 90.42}}
{"evaluation": {"sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": 8.0, "episode_reward_mean": 9.3, "episode_len_mean": 9.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 8.0, 9.0, 9.0, 10.0, 9.0, 8.0, 9.0, 9.0, 10.0], "episode_lengths": [12, 8, 9, 9, 10, 9, 8, 9, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3311554146878546, "mean_inference_ms": 1.2088274822554774, "mean_action_processing_ms": 0.10751012983268864, "mean_env_wait_ms": 0.04818386205747806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.004343986511230469, "ViewRequirementAgentConnector_ms": 0.06931781768798828}}, "episode_reward_max": 12.0, "episode_reward_min": 8.0, "episode_reward_mean": 9.3, "episode_len_mean": 9.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 8.0, 9.0, 9.0, 10.0, 9.0, 8.0, 9.0, 9.0, 10.0], "episode_lengths": [12, 8, 9, 9, 10, 9, 8, 9, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3311554146878546, "mean_inference_ms": 1.2088274822554774, "mean_action_processing_ms": 0.10751012983268864, "mean_env_wait_ms": 0.04818386205747806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.004343986511230469, "ViewRequirementAgentConnector_ms": 0.06931781768798828}, "num_agent_steps_sampled_this_iter": 93, "num_env_steps_sampled_this_iter": 93, "timesteps_this_iter": 93, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 4.796780586242676, "min_q": 2.4856550693511963, "max_q": 6.343319416046143, "mean_td_error": -0.07658562064170837}, "td_error": [1.4856550693511963, -0.9988079071044922, -0.07475805282592773, 2.1357107162475586, -0.040346622467041016, -0.0033559799194335938, -0.5200700759887695, 0.4477996826171875, 0.03298330307006836, -0.1120901107788086, -1.0530312061309814, -0.45183563232421875, 0.20780515670776367, 0.013453006744384766, -0.18765735626220703, -0.39093685150146484, -0.711937427520752, -0.5200700759887695, -0.04182243347167969, 0.13932180404663086, -0.18431854248046875, 0.08822011947631836, -0.6025052070617676, -0.3326706886291504, -0.20704889297485352, -0.024272441864013672, -0.5018186569213867, 0.15090322494506836, -0.1357555389404297, -0.04533529281616211, 0.2060713768005371, -0.21821832656860352], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 250, "diff_num_grad_updates_vs_sampler_policy": 249}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "last_target_update_ts": 2520, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 20.68, "episode_len_mean": 20.68, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 45.0, 45.0, 18.0, 29.0, 12.0, 27.0, 46.0, 14.0, 13.0, 40.0, 10.0, 12.0, 10.0, 19.0, 12.0, 18.0, 12.0, 18.0, 22.0, 12.0, 13.0, 21.0, 26.0, 45.0, 23.0, 21.0, 15.0, 10.0, 31.0, 12.0, 10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0], "episode_lengths": [14, 45, 45, 18, 29, 12, 27, 46, 14, 13, 40, 10, 12, 10, 19, 12, 18, 12, 18, 22, 12, 13, 21, 26, 45, 23, 21, 15, 10, 31, 12, 10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323679461508328, "mean_inference_ms": 2.23104154245553, "mean_action_processing_ms": 0.16256455115609236, "mean_env_wait_ms": 0.08864253554035077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031845092773438, "StateBufferConnector_ms": 0.006501436233520508, "ViewRequirementAgentConnector_ms": 0.12190055847167969}}, "episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 20.68, "episode_len_mean": 20.68, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.0, 45.0, 45.0, 18.0, 29.0, 12.0, 27.0, 46.0, 14.0, 13.0, 40.0, 10.0, 12.0, 10.0, 19.0, 12.0, 18.0, 12.0, 18.0, 22.0, 12.0, 13.0, 21.0, 26.0, 45.0, 23.0, 21.0, 15.0, 10.0, 31.0, 12.0, 10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0], "episode_lengths": [14, 45, 45, 18, 29, 12, 27, 46, 14, 13, 40, 10, 12, 10, 19, 12, 18, 12, 18, 22, 12, 13, 21, 26, 45, 23, 21, 15, 10, 31, 12, 10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323679461508328, "mean_inference_ms": 2.23104154245553, "mean_action_processing_ms": 0.16256455115609236, "mean_env_wait_ms": 0.08864253554035077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031845092773438, "StateBufferConnector_ms": 0.006501436233520508, "ViewRequirementAgentConnector_ms": 0.12190055847167969}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.16734328587364, "num_env_steps_trained_throughput_per_sec": 1272.6693731434946, "timesteps_total": 3000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 25.94, "sample_time_ms": 9.592, "learn_time_ms": 2.886, "learn_throughput": 11089.167, "synch_weights_time_ms": 4.404}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "last_target_update_ts": 2520, "num_target_updates": 4}, "done": false, "episodes_total": 129, "training_iteration": 3, "trial_id": "default", "date": "2024-10-05_20-20-40", "timestamp": 1728152440, "time_this_iter_s": 3.2313849925994873, "time_total_s": 8.289332628250122, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 8.289332628250122, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.825, "ram_util_percent": 90.625}}
{"evaluation": {"sampler_results": {"episode_reward_max": 187.0, "episode_reward_min": 120.0, "episode_reward_mean": 147.8, "episode_len_mean": 147.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 129.0, 140.0, 167.0, 165.0, 177.0, 149.0, 187.0, 120.0, 124.0], "episode_lengths": [120, 129, 140, 167, 165, 177, 149, 187, 120, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3071045938678684, "mean_inference_ms": 1.0245260893509438, "mean_action_processing_ms": 0.11089325792896779, "mean_env_wait_ms": 0.04803429424289256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.058541297912597656}}, "episode_reward_max": 187.0, "episode_reward_min": 120.0, "episode_reward_mean": 147.8, "episode_len_mean": 147.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 129.0, 140.0, 167.0, 165.0, 177.0, 149.0, 187.0, 120.0, 124.0], "episode_lengths": [120, 129, 140, 167, 165, 177, 149, 187, 120, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3071045938678684, "mean_inference_ms": 1.0245260893509438, "mean_action_processing_ms": 0.11089325792896779, "mean_env_wait_ms": 0.04803429424289256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.058541297912597656}, "num_agent_steps_sampled_this_iter": 1478, "num_env_steps_sampled_this_iter": 1478, "timesteps_this_iter": 1478, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 6.060136795043945, "min_q": 3.3583457469940186, "max_q": 8.607377052307129, "mean_td_error": 0.2994925379753113}, "td_error": [-0.9061031341552734, -0.2985568046569824, 0.0074748992919921875, 5.411501407623291, -0.37275123596191406, -0.12574052810668945, -1.2284834384918213, -0.32851314544677734, -0.4680304527282715, 2.3583457469940186, -0.019227981567382812, -1.2808432579040527, -0.38536548614501953, 0.019880294799804688, -1.248979091644287, 3.5588412284851074, -0.28147220611572266, -0.14558935165405273, -1.0015778541564941, -0.8169574737548828, 3.0064964294433594, -0.1295337677001953, -0.2914614677429199, 0.25607967376708984, 0.5160427093505859, -0.7137761116027832, -0.19527816772460938, 5.200108051300049, -0.2286667823791504, -0.2000112533569336, -0.07206439971923828, -0.012026309967041016], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 375, "diff_num_grad_updates_vs_sampler_policy": 374}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "last_target_update_ts": 3528, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 23.51, "episode_len_mean": 23.51, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0], "episode_lengths": [10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3612231810163158, "mean_inference_ms": 2.0853644700657954, "mean_action_processing_ms": 0.16437071452704013, "mean_env_wait_ms": 0.08986941877517583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008420228958129883, "StateBufferConnector_ms": 0.0066089630126953125, "ViewRequirementAgentConnector_ms": 0.1276552677154541}}, "episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 23.51, "episode_len_mean": 23.51, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 11.0, 17.0, 12.0, 18.0, 31.0, 28.0, 15.0, 13.0, 45.0, 21.0, 18.0, 46.0, 16.0, 38.0, 47.0, 12.0, 11.0, 20.0, 14.0, 14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0], "episode_lengths": [10, 11, 17, 12, 18, 31, 28, 15, 13, 45, 21, 18, 46, 16, 38, 47, 12, 11, 20, 14, 14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3612231810163158, "mean_inference_ms": 2.0853644700657954, "mean_action_processing_ms": 0.16437071452704013, "mean_env_wait_ms": 0.08986941877517583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008420228958129883, "StateBufferConnector_ms": 0.0066089630126953125, "ViewRequirementAgentConnector_ms": 0.1276552677154541}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.7087456332059, "num_env_steps_trained_throughput_per_sec": 1218.8349825328237, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 25.887, "sample_time_ms": 9.482, "learn_time_ms": 2.944, "learn_throughput": 10870.649, "synch_weights_time_ms": 4.413}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "last_target_update_ts": 3528, "num_target_updates": 6}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-10-05_20-20-44", "timestamp": 1728152444, "time_this_iter_s": 4.3792030811309814, "time_total_s": 12.668535709381104, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 12.668535709381104, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.24285714285715, "ram_util_percent": 90.64285714285715}}
{"evaluation": {"sampler_results": {"episode_reward_max": 111.0, "episode_reward_min": 60.0, "episode_reward_mean": 77.9, "episode_len_mean": 77.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.0, 75.0, 63.0, 60.0, 61.0, 65.0, 95.0, 97.0, 80.0, 72.0], "episode_lengths": [111, 75, 63, 60, 61, 65, 95, 97, 80, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30546923142570825, "mean_inference_ms": 0.9940093763472972, "mean_action_processing_ms": 0.11020426012294653, "mean_env_wait_ms": 0.04783175856611353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.05748748779296875}}, "episode_reward_max": 111.0, "episode_reward_min": 60.0, "episode_reward_mean": 77.9, "episode_len_mean": 77.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.0, 75.0, 63.0, 60.0, 61.0, 65.0, 95.0, 97.0, 80.0, 72.0], "episode_lengths": [111, 75, 63, 60, 61, 65, 95, 97, 80, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30546923142570825, "mean_inference_ms": 0.9940093763472972, "mean_action_processing_ms": 0.11020426012294653, "mean_env_wait_ms": 0.04783175856611353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.05748748779296875}, "num_agent_steps_sampled_this_iter": 779, "num_env_steps_sampled_this_iter": 779, "timesteps_this_iter": 779, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 8.84262466430664, "min_q": 3.938358783721924, "max_q": 10.62398624420166, "mean_td_error": 0.33454716205596924}, "td_error": [-0.0871734619140625, 0.12824058532714844, -1.1789088249206543, 0.12468242645263672, -0.005677223205566406, 0.5216045379638672, 0.3010730743408203, -0.021108627319335938, -0.6240053176879883, 0.06862735748291016, -0.35748291015625, 0.0061397552490234375, 0.09470081329345703, 5.575581073760986, 0.04449939727783203, -0.18827533721923828, 2.938358783721924, -0.3203611373901367, 0.07402610778808594, -0.3657341003417969, 0.11089515686035156, -0.2924633026123047, -0.0031347274780273438, -0.5094738006591797, -0.09396743774414062, -0.20507049560546875, 0.18409442901611328, -0.0634164810180664, 5.531006813049316, -0.40508174896240234, -0.37370777130126953, 0.09702205657958984], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 500, "diff_num_grad_updates_vs_sampler_policy": 499}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "last_target_update_ts": 4536, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 110.0, "episode_reward_min": 9.0, "episode_reward_mean": 28.35, "episode_len_mean": 28.35, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0], "episode_lengths": [14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.388988635318846, "mean_inference_ms": 2.02087027303406, "mean_action_processing_ms": 0.16762388419028276, "mean_env_wait_ms": 0.09135749641161234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008364439010620117, "StateBufferConnector_ms": 0.00654292106628418, "ViewRequirementAgentConnector_ms": 0.13146138191223145}}, "episode_reward_max": 110.0, "episode_reward_min": 9.0, "episode_reward_mean": 28.35, "episode_len_mean": 28.35, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.0, 18.0, 20.0, 11.0, 16.0, 32.0, 27.0, 20.0, 9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0], "episode_lengths": [14, 18, 20, 11, 16, 32, 27, 20, 9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.388988635318846, "mean_inference_ms": 2.02087027303406, "mean_action_processing_ms": 0.16762388419028276, "mean_env_wait_ms": 0.09135749641161234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008364439010620117, "StateBufferConnector_ms": 0.00654292106628418, "ViewRequirementAgentConnector_ms": 0.13146138191223145}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4750343910011, "num_env_steps_trained_throughput_per_sec": 1237.9001375640044, "timesteps_total": 5000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 26.182, "sample_time_ms": 9.816, "learn_time_ms": 2.84, "learn_throughput": 11267.344, "synch_weights_time_ms": 4.436}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "last_target_update_ts": 4536, "num_target_updates": 8}, "done": false, "episodes_total": 180, "training_iteration": 5, "trial_id": "default", "date": "2024-10-05_20-20-48", "timestamp": 1728152448, "time_this_iter_s": 3.7963829040527344, "time_total_s": 16.464918613433838, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.464918613433838, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.260000000000005, "ram_util_percent": 90.52000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 161.0, "episode_reward_min": 87.0, "episode_reward_mean": 114.9, "episode_len_mean": 114.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 87.0, 106.0, 94.0, 102.0, 135.0, 134.0, 91.0, 92.0, 161.0], "episode_lengths": [147, 87, 106, 94, 102, 135, 134, 91, 92, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30520023443760014, "mean_inference_ms": 0.9796087332034494, "mean_action_processing_ms": 0.10987462481202563, "mean_env_wait_ms": 0.047836208615207945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003211498260498047, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.0593876838684082}}, "episode_reward_max": 161.0, "episode_reward_min": 87.0, "episode_reward_mean": 114.9, "episode_len_mean": 114.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 87.0, 106.0, 94.0, 102.0, 135.0, 134.0, 91.0, 92.0, 161.0], "episode_lengths": [147, 87, 106, 94, 102, 135, 134, 91, 92, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30520023443760014, "mean_inference_ms": 0.9796087332034494, "mean_action_processing_ms": 0.10987462481202563, "mean_env_wait_ms": 0.047836208615207945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003211498260498047, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.0593876838684082}, "num_agent_steps_sampled_this_iter": 1149, "num_env_steps_sampled_this_iter": 1149, "timesteps_this_iter": 1149, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 10.065868377685547, "min_q": 4.377442836761475, "max_q": 12.160847663879395, "mean_td_error": 0.8805320858955383}, "td_error": [4.333370208740234, -0.4396090507507324, 0.5458993911743164, -0.012389183044433594, -0.1012125015258789, -0.07334041595458984, -0.12177276611328125, -0.25301170349121094, 0.18721389770507812, 0.11542892456054688, 7.3955888748168945, 3.3774428367614746, 0.32596302032470703, -0.6133384704589844, -0.7908611297607422, 5.021470069885254, -0.02601337432861328, 0.43106985092163086, 0.2994060516357422, 0.15515804290771484, 8.524541854858398, -0.14721012115478516, 0.03692436218261719, -0.21325016021728516, -0.0956878662109375, -0.1454486846923828, 0.08069801330566406, -0.002696990966796875, 0.12784671783447266, 0.33130645751953125, -0.13504695892333984, 0.05858802795410156], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 625, "diff_num_grad_updates_vs_sampler_policy": 624}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "last_target_update_ts": 5544, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 166.0, "episode_reward_min": 9.0, "episode_reward_mean": 35.17, "episode_len_mean": 35.17, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0], "episode_lengths": [9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3953756895382552, "mean_inference_ms": 1.993619120999091, "mean_action_processing_ms": 0.1682009226543393, "mean_env_wait_ms": 0.09168016731405063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008390426635742188, "StateBufferConnector_ms": 0.006468534469604492, "ViewRequirementAgentConnector_ms": 0.13219738006591797}}, "episode_reward_max": 166.0, "episode_reward_min": 9.0, "episode_reward_mean": 35.17, "episode_len_mean": 35.17, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, 11.0, 13.0, 11.0, 20.0, 33.0, 13.0, 10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0], "episode_lengths": [9, 11, 13, 11, 20, 33, 13, 10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3953756895382552, "mean_inference_ms": 1.993619120999091, "mean_action_processing_ms": 0.1682009226543393, "mean_env_wait_ms": 0.09168016731405063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008390426635742188, "StateBufferConnector_ms": 0.006468534469604492, "ViewRequirementAgentConnector_ms": 0.13219738006591797}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.8230118434817, "num_env_steps_trained_throughput_per_sec": 1239.2920473739268, "timesteps_total": 6000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 26.292, "sample_time_ms": 9.776, "learn_time_ms": 2.86, "learn_throughput": 11187.608, "synch_weights_time_ms": 4.362}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "last_target_update_ts": 5544, "num_target_updates": 10}, "done": false, "episodes_total": 188, "training_iteration": 6, "trial_id": "default", "date": "2024-10-05_20-20-52", "timestamp": 1728152452, "time_this_iter_s": 4.037533521652222, "time_total_s": 20.50245213508606, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.50245213508606, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.233333333333334, "ram_util_percent": 90.5}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 132.0, "episode_reward_mean": 230.6, "episode_len_mean": 230.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 273.0, 287.0, 188.0, 300.0, 239.0, 221.0, 226.0, 208.0, 232.0], "episode_lengths": [132, 273, 287, 188, 300, 239, 221, 226, 208, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3598318919876582, "mean_inference_ms": 1.1471070854911978, "mean_action_processing_ms": 0.13278620275437023, "mean_env_wait_ms": 0.05757488636229733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039005279541015625, "StateBufferConnector_ms": 0.0034809112548828125, "ViewRequirementAgentConnector_ms": 0.09284734725952148}}, "episode_reward_max": 300.0, "episode_reward_min": 132.0, "episode_reward_mean": 230.6, "episode_len_mean": 230.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 273.0, 287.0, 188.0, 300.0, 239.0, 221.0, 226.0, 208.0, 232.0], "episode_lengths": [132, 273, 287, 188, 300, 239, 221, 226, 208, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3598318919876582, "mean_inference_ms": 1.1471070854911978, "mean_action_processing_ms": 0.13278620275437023, "mean_env_wait_ms": 0.05757488636229733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039005279541015625, "StateBufferConnector_ms": 0.0034809112548828125, "ViewRequirementAgentConnector_ms": 0.09284734725952148}, "num_agent_steps_sampled_this_iter": 2306, "num_env_steps_sampled_this_iter": 2306, "timesteps_this_iter": 2306, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.74161148071289, "min_q": 4.75442361831665, "max_q": 14.270248413085938, "mean_td_error": 0.9692584276199341}, "td_error": [0.1101980209350586, 10.566046714782715, 0.31804943084716797, -0.07227611541748047, -0.643651008605957, 0.7431182861328125, -0.2301015853881836, 0.9930620193481445, -0.000232696533203125, 3.7544236183166504, 0.04386615753173828, -0.027640342712402344, 0.4051809310913086, -0.35135650634765625, 0.28468990325927734, -0.17377471923828125, -0.18334293365478516, 0.3883199691772461, -0.49829769134521484, 0.5714044570922852, -0.8586587905883789, 0.6978607177734375, -0.4348011016845703, -0.2935028076171875, 0.2727470397949219, -0.30867481231689453, -0.0901956558227539, 10.258454322814941, 5.83089017868042, -0.03494834899902344, 0.07035636901855469, -0.0909433364868164], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 750, "diff_num_grad_updates_vs_sampler_policy": 749}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "last_target_update_ts": 6552, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 43.35, "episode_len_mean": 43.35, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0], "episode_lengths": [10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4058431821041228, "mean_inference_ms": 1.978704138742985, "mean_action_processing_ms": 0.1690861242747672, "mean_env_wait_ms": 0.09212149636451775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008678674697875977, "StateBufferConnector_ms": 0.006545305252075195, "ViewRequirementAgentConnector_ms": 0.13660717010498047}}, "episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 43.35, "episode_len_mean": 43.35, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 14.0, 15.0, 23.0, 14.0, 16.0, 15.0, 45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0], "episode_lengths": [10, 14, 15, 23, 14, 16, 15, 45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4058431821041228, "mean_inference_ms": 1.978704138742985, "mean_action_processing_ms": 0.1690861242747672, "mean_env_wait_ms": 0.09212149636451775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008678674697875977, "StateBufferConnector_ms": 0.006545305252075195, "ViewRequirementAgentConnector_ms": 0.13660717010498047}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.41284482831276, "num_env_steps_trained_throughput_per_sec": 841.651379313251, "timesteps_total": 7000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 45.834, "sample_time_ms": 16.971, "learn_time_ms": 4.736, "learn_throughput": 6756.493, "synch_weights_time_ms": 7.57}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "last_target_update_ts": 6552, "num_target_updates": 12}, "done": false, "episodes_total": 195, "training_iteration": 7, "trial_id": "default", "date": "2024-10-05_20-20-59", "timestamp": 1728152459, "time_this_iter_s": 7.371283292770386, "time_total_s": 27.873735427856445, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.873735427856445, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.85000000000001, "ram_util_percent": 90.5}}
{"evaluation": {"sampler_results": {"episode_reward_max": 217.0, "episode_reward_min": 121.0, "episode_reward_mean": 160.0, "episode_len_mean": 160.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 137.0, 178.0, 174.0, 182.0, 131.0, 134.0, 134.0, 192.0, 121.0], "episode_lengths": [217, 137, 178, 174, 182, 131, 134, 134, 192, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38367672858103063, "mean_inference_ms": 1.2036888591096748, "mean_action_processing_ms": 0.13993445585640668, "mean_env_wait_ms": 0.060817188792178914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004353523254394531, "StateBufferConnector_ms": 0.0035691261291503906, "ViewRequirementAgentConnector_ms": 0.09269475936889648}}, "episode_reward_max": 217.0, "episode_reward_min": 121.0, "episode_reward_mean": 160.0, "episode_len_mean": 160.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 137.0, 178.0, 174.0, 182.0, 131.0, 134.0, 134.0, 192.0, 121.0], "episode_lengths": [217, 137, 178, 174, 182, 131, 134, 134, 192, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38367672858103063, "mean_inference_ms": 1.2036888591096748, "mean_action_processing_ms": 0.13993445585640668, "mean_env_wait_ms": 0.060817188792178914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004353523254394531, "StateBufferConnector_ms": 0.0035691261291503906, "ViewRequirementAgentConnector_ms": 0.09269475936889648}, "num_agent_steps_sampled_this_iter": 1600, "num_env_steps_sampled_this_iter": 1600, "timesteps_this_iter": 1600, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.266304016113281, "min_q": 2.7386152744293213, "max_q": 16.517221450805664, "mean_td_error": 0.256758451461792}, "td_error": [-1.125539779663086, -0.20405960083007812, 0.2007770538330078, -0.5467586517333984, 0.7799773216247559, -0.3165740966796875, -0.2013702392578125, -0.14277267456054688, 0.4561338424682617, -0.2295522689819336, 1.0084924697875977, -0.5595560073852539, 5.411190032958984, 2.663142681121826, -0.5688676834106445, 0.5214948654174805, -0.01884937286376953, 0.17206859588623047, -0.6596145629882812, 0.1539449691772461, -0.1792888641357422, 0.3305702209472656, 0.02969837188720703, 0.3163928985595703, -0.44628334045410156, 0.36334705352783203, 0.09453582763671875, -0.42746829986572266, 0.1913461685180664, 1.7386152744293213, -0.4185361862182617, -0.1703662872314453], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 875, "diff_num_grad_updates_vs_sampler_policy": 874}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "last_target_update_ts": 7560, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 52.15, "episode_len_mean": 52.15, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0], "episode_lengths": [45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4276771826548857, "mean_inference_ms": 1.9790483230891454, "mean_action_processing_ms": 0.17117985185678214, "mean_env_wait_ms": 0.09303854649184234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008969783782958984, "StateBufferConnector_ms": 0.006714344024658203, "ViewRequirementAgentConnector_ms": 0.14342403411865234}}, "episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 52.15, "episode_len_mean": 52.15, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.0, 18.0, 10.0, 25.0, 31.0, 12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0], "episode_lengths": [45, 18, 10, 25, 31, 12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4276771826548857, "mean_inference_ms": 1.9790483230891454, "mean_action_processing_ms": 0.17117985185678214, "mean_env_wait_ms": 0.09303854649184234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008969783782958984, "StateBufferConnector_ms": 0.006714344024658203, "ViewRequirementAgentConnector_ms": 0.14342403411865234}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.81830099255225, "num_env_steps_trained_throughput_per_sec": 755.273203970209, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 44.566, "sample_time_ms": 16.102, "learn_time_ms": 4.705, "learn_throughput": 6800.655, "synch_weights_time_ms": 7.176}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "last_target_update_ts": 7560, "num_target_updates": 14}, "done": false, "episodes_total": 202, "training_iteration": 8, "trial_id": "default", "date": "2024-10-05_20-21-06", "timestamp": 1728152466, "time_this_iter_s": 6.884216070175171, "time_total_s": 34.757951498031616, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.757951498031616, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.86, "ram_util_percent": 90.62}}
{"evaluation": {"sampler_results": {"episode_reward_max": 196.0, "episode_reward_min": 110.0, "episode_reward_mean": 138.7, "episode_len_mean": 138.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.0, 136.0, 125.0, 136.0, 150.0, 144.0, 110.0, 114.0, 145.0, 196.0], "episode_lengths": [131, 136, 125, 136, 150, 144, 110, 114, 145, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396563611114939, "mean_inference_ms": 1.2428912176439115, "mean_action_processing_ms": 0.1452270936041995, "mean_env_wait_ms": 0.06317801101928813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004141330718994141, "StateBufferConnector_ms": 0.0035643577575683594, "ViewRequirementAgentConnector_ms": 0.09178400039672852}}, "episode_reward_max": 196.0, "episode_reward_min": 110.0, "episode_reward_mean": 138.7, "episode_len_mean": 138.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.0, 136.0, 125.0, 136.0, 150.0, 144.0, 110.0, 114.0, 145.0, 196.0], "episode_lengths": [131, 136, 125, 136, 150, 144, 110, 114, 145, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396563611114939, "mean_inference_ms": 1.2428912176439115, "mean_action_processing_ms": 0.1452270936041995, "mean_env_wait_ms": 0.06317801101928813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004141330718994141, "StateBufferConnector_ms": 0.0035643577575683594, "ViewRequirementAgentConnector_ms": 0.09178400039672852}, "num_agent_steps_sampled_this_iter": 1387, "num_env_steps_sampled_this_iter": 1387, "timesteps_this_iter": 1387, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.766456604003906, "min_q": 9.386735916137695, "max_q": 18.50505256652832, "mean_td_error": 0.9054003357887268}, "td_error": [0.3635406494140625, -1.1602401733398438, 0.18068504333496094, -1.2205657958984375, -0.6498298645019531, -0.18524742126464844, 9.033963203430176, 0.0044841766357421875, -0.9144725799560547, -1.1417932510375977, -0.17113876342773438, -0.23259544372558594, 0.13625526428222656, -0.18067169189453125, -0.9648838043212891, 0.07756614685058594, 0.1879119873046875, 17.477201461791992, -0.05968284606933594, 0.28457069396972656, 0.05625152587890625, -0.1766653060913086, 8.386735916137695, 0.3326740264892578, 0.39281463623046875, -0.04250907897949219, 0.029666900634765625, -1.01220703125, -0.3563671112060547, 0.5139350891113281, -0.0062465667724609375, -0.010328292846679688], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1000, "diff_num_grad_updates_vs_sampler_policy": 999}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "last_target_update_ts": 8568, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 58.44, "episode_len_mean": 58.44, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0], "episode_lengths": [12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4484213672072368, "mean_inference_ms": 1.9846913655211236, "mean_action_processing_ms": 0.17329694403342838, "mean_env_wait_ms": 0.09394528511821858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009182453155517578, "StateBufferConnector_ms": 0.00675654411315918, "ViewRequirementAgentConnector_ms": 0.14670395851135254}}, "episode_reward_max": 208.0, "episode_reward_min": 9.0, "episode_reward_mean": 58.44, "episode_len_mean": 58.44, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 12.0, 17.0, 15.0, 37.0, 17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0], "episode_lengths": [12, 12, 17, 15, 37, 17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4484213672072368, "mean_inference_ms": 1.9846913655211236, "mean_action_processing_ms": 0.17329694403342838, "mean_env_wait_ms": 0.09394528511821858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009182453155517578, "StateBufferConnector_ms": 0.00675654411315918, "ViewRequirementAgentConnector_ms": 0.14670395851135254}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.76292980083522, "num_env_steps_trained_throughput_per_sec": 767.0517192033409, "timesteps_total": 9000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 42.728, "sample_time_ms": 15.22, "learn_time_ms": 4.672, "learn_throughput": 6849.241, "synch_weights_time_ms": 6.836}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "last_target_update_ts": 8568, "num_target_updates": 16}, "done": false, "episodes_total": 207, "training_iteration": 9, "trial_id": "default", "date": "2024-10-05_20-21-13", "timestamp": 1728152473, "time_this_iter_s": 6.81928014755249, "time_total_s": 41.577231645584106, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 41.577231645584106, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.959999999999994, "ram_util_percent": 90.35}}
{"evaluation": {"sampler_results": {"episode_reward_max": 164.0, "episode_reward_min": 113.0, "episode_reward_mean": 137.3, "episode_len_mean": 137.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 130.0, 121.0, 128.0, 156.0, 113.0, 164.0, 156.0, 139.0, 121.0], "episode_lengths": [145, 130, 121, 128, 156, 113, 164, 156, 139, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4060769452263992, "mean_inference_ms": 1.266696127897903, "mean_action_processing_ms": 0.1485097222720543, "mean_env_wait_ms": 0.06459376120938472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004839897155761719, "StateBufferConnector_ms": 0.0035500526428222656, "ViewRequirementAgentConnector_ms": 0.09320497512817383}}, "episode_reward_max": 164.0, "episode_reward_min": 113.0, "episode_reward_mean": 137.3, "episode_len_mean": 137.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 130.0, 121.0, 128.0, 156.0, 113.0, 164.0, 156.0, 139.0, 121.0], "episode_lengths": [145, 130, 121, 128, 156, 113, 164, 156, 139, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4060769452263992, "mean_inference_ms": 1.266696127897903, "mean_action_processing_ms": 0.1485097222720543, "mean_env_wait_ms": 0.06459376120938472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004839897155761719, "StateBufferConnector_ms": 0.0035500526428222656, "ViewRequirementAgentConnector_ms": 0.09320497512817383}, "num_agent_steps_sampled_this_iter": 1373, "num_env_steps_sampled_this_iter": 1373, "timesteps_this_iter": 1373, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.945098876953125, "min_q": 12.38208293914795, "max_q": 20.205795288085938, "mean_td_error": 0.5374505519866943}, "td_error": [-1.5226593017578125, -1.8226232528686523, 0.0658111572265625, 14.770771980285645, -1.651686668395996, 0.03411865234375, -1.0524272918701172, 0.352813720703125, -0.09962844848632812, 0.11514663696289062, 0.49501514434814453, -0.2252330780029297, 0.5576534271240234, -0.07636260986328125, -0.24640464782714844, -0.11810111999511719, 0.1404285430908203, -0.15180397033691406, -0.11478996276855469, -1.0899715423583984, -0.3849601745605469, -0.2550849914550781, 0.083404541015625, -0.4251136779785156, 0.1875324249267578, 0.25084686279296875, -0.3274192810058594, 0.10105705261230469, 0.05345344543457031, -0.1691913604736328, 11.38208293914795, -1.6582584381103516], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1125, "diff_num_grad_updates_vs_sampler_policy": 1124}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "last_target_update_ts": 9576, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 9.0, "episode_reward_mean": 67.56, "episode_len_mean": 67.56, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0], "episode_lengths": [17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4721266471365388, "mean_inference_ms": 1.9919658881724536, "mean_action_processing_ms": 0.1759834145873057, "mean_env_wait_ms": 0.09507589704976818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009308099746704102, "StateBufferConnector_ms": 0.006819248199462891, "ViewRequirementAgentConnector_ms": 0.1505293846130371}}, "episode_reward_max": 300.0, "episode_reward_min": 9.0, "episode_reward_mean": 67.56, "episode_len_mean": 67.56, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.0, 11.0, 9.0, 12.0, 17.0, 15.0, 19.0, 10.0, 31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0], "episode_lengths": [17, 11, 9, 12, 17, 15, 19, 10, 31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4721266471365388, "mean_inference_ms": 1.9919658881724536, "mean_action_processing_ms": 0.1759834145873057, "mean_env_wait_ms": 0.09507589704976818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009308099746704102, "StateBufferConnector_ms": 0.006819248199462891, "ViewRequirementAgentConnector_ms": 0.1505293846130371}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.9741260197639, "num_env_steps_trained_throughput_per_sec": 763.8965040790556, "timesteps_total": 10000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 41.164, "sample_time_ms": 14.905, "learn_time_ms": 4.389, "learn_throughput": 7290.678, "synch_weights_time_ms": 6.792}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "last_target_update_ts": 9576, "num_target_updates": 18}, "done": false, "episodes_total": 212, "training_iteration": 10, "trial_id": "default", "date": "2024-10-05_20-21-20", "timestamp": 1728152480, "time_this_iter_s": 6.65997314453125, "time_total_s": 48.237204790115356, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.237204790115356, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.544444444444444, "ram_util_percent": 90.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 177.0, "episode_reward_min": 115.0, "episode_reward_mean": 138.9, "episode_len_mean": 138.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 177.0, 135.0, 135.0, 123.0, 152.0, 115.0, 116.0, 159.0, 120.0], "episode_lengths": [157, 177, 135, 135, 123, 152, 115, 116, 159, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41098725305844663, "mean_inference_ms": 1.2872838474491926, "mean_action_processing_ms": 0.1513684785337241, "mean_env_wait_ms": 0.06578043523476453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004808902740478516, "StateBufferConnector_ms": 0.003407001495361328, "ViewRequirementAgentConnector_ms": 0.09160041809082031}}, "episode_reward_max": 177.0, "episode_reward_min": 115.0, "episode_reward_mean": 138.9, "episode_len_mean": 138.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 177.0, 135.0, 135.0, 123.0, 152.0, 115.0, 116.0, 159.0, 120.0], "episode_lengths": [157, 177, 135, 135, 123, 152, 115, 116, 159, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41098725305844663, "mean_inference_ms": 1.2872838474491926, "mean_action_processing_ms": 0.1513684785337241, "mean_env_wait_ms": 0.06578043523476453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004808902740478516, "StateBufferConnector_ms": 0.003407001495361328, "ViewRequirementAgentConnector_ms": 0.09160041809082031}, "num_agent_steps_sampled_this_iter": 1389, "num_env_steps_sampled_this_iter": 1389, "timesteps_this_iter": 1389, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 18.642261505126953, "min_q": 8.83320426940918, "max_q": 21.964664459228516, "mean_td_error": 1.5093357563018799}, "td_error": [0.014652252197265625, 13.060944557189941, 0.12123680114746094, -0.11745643615722656, -0.7951736450195312, 10.785179138183594, 0.15942001342773438, 8.017022132873535, -1.7636594772338867, -0.10042381286621094, -0.15517044067382812, -0.10407066345214844, 0.09924697875976562, -0.14891624450683594, -0.1279277801513672, -0.1853466033935547, 0.16230010986328125, -0.34989356994628906, 0.14914321899414062, -0.08261680603027344, -1.2330093383789062, -0.0879364013671875, 0.03757286071777344, 13.071043968200684, 10.157293319702148, -0.5097770690917969, -0.6133651733398438, -0.1443500518798828, 0.12640953063964844, -0.17158889770507812, -0.17387008666992188, -0.7981700897216797], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1250, "diff_num_grad_updates_vs_sampler_policy": 1249}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "last_target_update_ts": 10584, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 78.99, "episode_len_mean": 78.99, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0], "episode_lengths": [31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5135964105571826, "mean_inference_ms": 2.005674748178956, "mean_action_processing_ms": 0.18081594057142936, "mean_env_wait_ms": 0.09710564334874457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00943613052368164, "StateBufferConnector_ms": 0.006919145584106445, "ViewRequirementAgentConnector_ms": 0.15614652633666992}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 78.99, "episode_len_mean": 78.99, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.0, 11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0], "episode_lengths": [31, 11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5135964105571826, "mean_inference_ms": 2.005674748178956, "mean_action_processing_ms": 0.18081594057142936, "mean_env_wait_ms": 0.09710564334874457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00943613052368164, "StateBufferConnector_ms": 0.006919145584106445, "ViewRequirementAgentConnector_ms": 0.15614652633666992}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.28384949030735, "num_env_steps_trained_throughput_per_sec": 785.1353979612294, "timesteps_total": 11000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 41.618, "sample_time_ms": 15.439, "learn_time_ms": 4.297, "learn_throughput": 7447.066, "synch_weights_time_ms": 6.62}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "last_target_update_ts": 10584, "num_target_updates": 20}, "done": false, "episodes_total": 220, "training_iteration": 11, "trial_id": "default", "date": "2024-10-05_20-21-27", "timestamp": 1728152487, "time_this_iter_s": 6.826365232467651, "time_total_s": 55.06357002258301, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 55.06357002258301, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.06, "ram_util_percent": 90.35999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 113.0, "episode_reward_mean": 151.0, "episode_len_mean": 151.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 126.0, 120.0, 127.0, 165.0, 122.0, 154.0, 145.0, 113.0, 138.0], "episode_lengths": [300, 126, 120, 127, 165, 122, 154, 145, 113, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187793079556811, "mean_inference_ms": 1.3003994469611981, "mean_action_processing_ms": 0.1531513304406617, "mean_env_wait_ms": 0.0666055604075215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212856292724609, "StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.09067773818969727}}, "episode_reward_max": 300.0, "episode_reward_min": 113.0, "episode_reward_mean": 151.0, "episode_len_mean": 151.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 126.0, 120.0, 127.0, 165.0, 122.0, 154.0, 145.0, 113.0, 138.0], "episode_lengths": [300, 126, 120, 127, 165, 122, 154, 145, 113, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187793079556811, "mean_inference_ms": 1.3003994469611981, "mean_action_processing_ms": 0.1531513304406617, "mean_env_wait_ms": 0.0666055604075215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212856292724609, "StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.09067773818969727}, "num_agent_steps_sampled_this_iter": 1510, "num_env_steps_sampled_this_iter": 1510, "timesteps_this_iter": 1510, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 21.047603607177734, "min_q": 10.668399810791016, "max_q": 23.697101593017578, "mean_td_error": 0.45788803696632385}, "td_error": [-0.6854057312011719, 0.35550689697265625, 0.15215682983398438, -0.8863601684570312, -1.2375125885009766, -0.6969356536865234, -0.3303108215332031, -0.23343276977539062, -0.10370063781738281, -0.06040382385253906, -0.29618263244628906, 0.4732093811035156, -0.41698646545410156, -0.14449119567871094, 0.16637420654296875, 9.668399810791016, -0.3754997253417969, 0.20269393920898438, 12.227046012878418, 0.025751113891601562, -0.4198741912841797, 0.21689796447753906, -0.2686328887939453, 0.0883026123046875, -0.11517333984375, -0.9238166809082031, -0.03345680236816406, -0.4530620574951172, -0.23340988159179688, -0.7067909240722656, -0.4230003356933594, 0.12051773071289062], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1375, "diff_num_grad_updates_vs_sampler_policy": 1374}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "last_target_update_ts": 11592, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 80.36, "episode_len_mean": 80.36, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0], "episode_lengths": [11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5200584383028535, "mean_inference_ms": 2.008785389406258, "mean_action_processing_ms": 0.18158620567931774, "mean_env_wait_ms": 0.09742476087751595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009451150894165039, "StateBufferConnector_ms": 0.006936073303222656, "ViewRequirementAgentConnector_ms": 0.1570591926574707}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 80.36, "episode_len_mean": 80.36, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.0, 20.0, 26.0, 12.0, 74.0, 14.0, 37.0, 28.0, 16.0, 57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0], "episode_lengths": [11, 20, 26, 12, 74, 14, 37, 28, 16, 57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5200584383028535, "mean_inference_ms": 2.008785389406258, "mean_action_processing_ms": 0.18158620567931774, "mean_env_wait_ms": 0.09742476087751595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009451150894165039, "StateBufferConnector_ms": 0.006936073303222656, "ViewRequirementAgentConnector_ms": 0.1570591926574707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.50159745531542, "num_env_steps_trained_throughput_per_sec": 786.0063898212617, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 41.716, "sample_time_ms": 14.887, "learn_time_ms": 4.563, "learn_throughput": 7012.494, "synch_weights_time_ms": 6.719}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "last_target_update_ts": 11592, "num_target_updates": 22}, "done": false, "episodes_total": 221, "training_iteration": 12, "trial_id": "default", "date": "2024-10-05_20-21-33", "timestamp": 1728152493, "time_this_iter_s": 6.496024131774902, "time_total_s": 61.55959415435791, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 61.55959415435791, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.733333333333334, "ram_util_percent": 90.37777777777778}}
{"evaluation": {"sampler_results": {"episode_reward_max": 132.0, "episode_reward_min": 106.0, "episode_reward_mean": 117.8, "episode_len_mean": 117.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.0, 127.0, 120.0, 117.0, 110.0, 132.0, 106.0, 111.0, 113.0, 125.0], "episode_lengths": [117, 127, 120, 117, 110, 132, 106, 111, 113, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.424858384373911, "mean_inference_ms": 1.3192797097950937, "mean_action_processing_ms": 0.15561368922528665, "mean_env_wait_ms": 0.06777077741109121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041961669921875, "StateBufferConnector_ms": 0.003693103790283203, "ViewRequirementAgentConnector_ms": 0.09465217590332031}}, "episode_reward_max": 132.0, "episode_reward_min": 106.0, "episode_reward_mean": 117.8, "episode_len_mean": 117.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.0, 127.0, 120.0, 117.0, 110.0, 132.0, 106.0, 111.0, 113.0, 125.0], "episode_lengths": [117, 127, 120, 117, 110, 132, 106, 111, 113, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.424858384373911, "mean_inference_ms": 1.3192797097950937, "mean_action_processing_ms": 0.15561368922528665, "mean_env_wait_ms": 0.06777077741109121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041961669921875, "StateBufferConnector_ms": 0.003693103790283203, "ViewRequirementAgentConnector_ms": 0.09465217590332031}, "num_agent_steps_sampled_this_iter": 1178, "num_env_steps_sampled_this_iter": 1178, "timesteps_this_iter": 1178, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 21.44355010986328, "min_q": 4.606827259063721, "max_q": 24.999608993530273, "mean_td_error": 0.2825565040111542}, "td_error": [-0.256072998046875, 0.42462730407714844, 0.17439842224121094, -0.05736541748046875, -2.2270450592041016, 1.474287986755371, -0.6210842132568359, 0.17576980590820312, -0.8528976440429688, -0.3792877197265625, -0.15456771850585938, -0.10634231567382812, 10.90339469909668, 0.49665069580078125, 0.06712722778320312, 0.17112159729003906, 0.27872467041015625, 0.09109306335449219, 0.06987571716308594, -0.5487270355224609, -0.015306472778320312, 0.19559097290039062, -0.4358940124511719, -1.1624317169189453, -0.07871437072753906, -0.410614013671875, 1.3290214538574219, -0.06238555908203125, 0.2159404754638672, 0.13251876831054688, 0.12139320373535156, 0.08900833129882812], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1500, "diff_num_grad_updates_vs_sampler_policy": 1499}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "last_target_update_ts": 12600, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 96.81, "episode_len_mean": 96.81, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0], "episode_lengths": [57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5730071671517534, "mean_inference_ms": 2.0244253024943077, "mean_action_processing_ms": 0.18816244207344154, "mean_env_wait_ms": 0.1002413780918098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00969386100769043, "StateBufferConnector_ms": 0.007063865661621094, "ViewRequirementAgentConnector_ms": 0.16327857971191406}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 96.81, "episode_len_mean": 96.81, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.0, 35.0, 19.0, 40.0, 22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0], "episode_lengths": [57, 35, 19, 40, 22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5730071671517534, "mean_inference_ms": 2.0244253024943077, "mean_action_processing_ms": 0.18816244207344154, "mean_env_wait_ms": 0.1002413780918098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00969386100769043, "StateBufferConnector_ms": 0.007063865661621094, "ViewRequirementAgentConnector_ms": 0.16327857971191406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.44046310347773, "num_env_steps_trained_throughput_per_sec": 781.7618524139109, "timesteps_total": 13000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 43.195, "sample_time_ms": 15.795, "learn_time_ms": 4.548, "learn_throughput": 7035.652, "synch_weights_time_ms": 6.872}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "last_target_update_ts": 12600, "num_target_updates": 24}, "done": false, "episodes_total": 230, "training_iteration": 13, "trial_id": "default", "date": "2024-10-05_20-21-40", "timestamp": 1728152500, "time_this_iter_s": 6.513444185256958, "time_total_s": 68.07303833961487, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 68.07303833961487, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.46666666666667, "ram_util_percent": 90.43333333333334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 219.0, "episode_reward_min": 113.0, "episode_reward_mean": 150.5, "episode_len_mean": 150.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 219.0, 143.0, 153.0, 152.0, 155.0, 160.0, 113.0, 131.0, 137.0], "episode_lengths": [142, 219, 143, 153, 152, 155, 160, 113, 131, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412128772973025, "mean_inference_ms": 1.2808189992646284, "mean_action_processing_ms": 0.15094727168643013, "mean_env_wait_ms": 0.06575642023140085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0021648406982421875, "ViewRequirementAgentConnector_ms": 0.05592823028564453}}, "episode_reward_max": 219.0, "episode_reward_min": 113.0, "episode_reward_mean": 150.5, "episode_len_mean": 150.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 219.0, 143.0, 153.0, 152.0, 155.0, 160.0, 113.0, 131.0, 137.0], "episode_lengths": [142, 219, 143, 153, 152, 155, 160, 113, 131, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412128772973025, "mean_inference_ms": 1.2808189992646284, "mean_action_processing_ms": 0.15094727168643013, "mean_env_wait_ms": 0.06575642023140085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0021648406982421875, "ViewRequirementAgentConnector_ms": 0.05592823028564453}, "num_agent_steps_sampled_this_iter": 1505, "num_env_steps_sampled_this_iter": 1505, "timesteps_this_iter": 1505, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.107013702392578, "min_q": 12.033408164978027, "max_q": 27.5003604888916, "mean_td_error": 0.5217054486274719}, "td_error": [-0.5132083892822266, -0.15386199951171875, -0.28937530517578125, -0.22542572021484375, -0.1385822296142578, -0.6346187591552734, -0.2120952606201172, -0.4872322082519531, 0.19307899475097656, -0.275054931640625, -0.3506431579589844, 11.033408164978027, 0.13448524475097656, -0.11863517761230469, 0.04477500915527344, -0.16193580627441406, -0.0434722900390625, -3.3104982376098633, 0.290435791015625, -0.1267528533935547, 17.916019439697266, -0.3983020782470703, -1.5047664642333984, -1.3945484161376953, -0.22974395751953125, -0.3660545349121094, 0.05995750427246094, -0.48136138916015625, -1.221261978149414, -0.37603759765625, 0.2105884552001953, -0.17470550537109375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1625, "diff_num_grad_updates_vs_sampler_policy": 1624}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "last_target_update_ts": 13608, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 99.98, "episode_len_mean": 99.98, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0], "episode_lengths": [22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5915669728211088, "mean_inference_ms": 2.0291570534727703, "mean_action_processing_ms": 0.19008075825550133, "mean_env_wait_ms": 0.1010865229896244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00971674919128418, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.16391682624816895}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 99.98, "episode_len_mean": 99.98, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.0, 15.0, 13.0, 21.0, 28.0, 38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0], "episode_lengths": [22, 15, 13, 21, 28, 38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5915669728211088, "mean_inference_ms": 2.0291570534727703, "mean_action_processing_ms": 0.19008075825550133, "mean_env_wait_ms": 0.1010865229896244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00971674919128418, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.16391682624816895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.63658728291037, "num_env_steps_trained_throughput_per_sec": 810.5463491316415, "timesteps_total": 14000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 28.494, "sample_time_ms": 10.78, "learn_time_ms": 3.054, "learn_throughput": 10478.229, "synch_weights_time_ms": 4.715}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "last_target_update_ts": 13608, "num_target_updates": 26}, "done": false, "episodes_total": 234, "training_iteration": 14, "trial_id": "default", "date": "2024-10-05_20-21-46", "timestamp": 1728152506, "time_this_iter_s": 5.954103946685791, "time_total_s": 74.02714228630066, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 74.02714228630066, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 35.32222222222222, "ram_util_percent": 90.6888888888889}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956190354803898, "mean_inference_ms": 1.2281318288354104, "mean_action_processing_ms": 0.14495483152099506, "mean_env_wait_ms": 0.0630770857023755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524852752685547, "StateBufferConnector_ms": 0.0023245811462402344, "ViewRequirementAgentConnector_ms": 0.0585484504699707}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956190354803898, "mean_inference_ms": 1.2281318288354104, "mean_action_processing_ms": 0.14495483152099506, "mean_env_wait_ms": 0.0630770857023755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524852752685547, "StateBufferConnector_ms": 0.0023245811462402344, "ViewRequirementAgentConnector_ms": 0.0585484504699707}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.91888427734375, "min_q": 5.852667331695557, "max_q": 28.56878089904785, "mean_td_error": -0.2658715844154358}, "td_error": [-0.7044658660888672, 0.6875476837158203, -0.73297119140625, -0.05774688720703125, -0.14088821411132812, -0.3686389923095703, 0.1280689239501953, -0.4600028991699219, -0.17856407165527344, 0.35152435302734375, -0.5666542053222656, -0.5193653106689453, -0.7980766296386719, 0.11746597290039062, 2.100259304046631, 0.015153884887695312, -1.222848892211914, -0.5795078277587891, -0.7134037017822266, -0.023302078247070312, -0.5778217315673828, -0.7199821472167969, -0.1713428497314453, -0.8508434295654297, -0.6375293731689453, 0.11081314086914062, -1.4709129333496094, 0.18325042724609375, 0.1309375762939453, -0.6178016662597656, -0.23606300354003906, 0.015821456909179688], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1750, "diff_num_grad_updates_vs_sampler_policy": 1749}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "last_target_update_ts": 14616, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 109.73, "episode_len_mean": 109.73, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0], "episode_lengths": [38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.616530867235024, "mean_inference_ms": 2.038122658618772, "mean_action_processing_ms": 0.19282288376976353, "mean_env_wait_ms": 0.10226602748633405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009682655334472656, "StateBufferConnector_ms": 0.006894350051879883, "ViewRequirementAgentConnector_ms": 0.16343379020690918}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 109.73, "episode_len_mean": 109.73, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.0, 34.0, 23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0], "episode_lengths": [38, 34, 23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.616530867235024, "mean_inference_ms": 2.038122658618772, "mean_action_processing_ms": 0.19282288376976353, "mean_env_wait_ms": 0.10226602748633405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009682655334472656, "StateBufferConnector_ms": 0.006894350051879883, "ViewRequirementAgentConnector_ms": 0.16343379020690918}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.59925501701736, "num_env_steps_trained_throughput_per_sec": 1262.3970200680694, "timesteps_total": 15000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 25.229, "sample_time_ms": 9.313, "learn_time_ms": 2.793, "learn_throughput": 11457.499, "synch_weights_time_ms": 4.317}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "last_target_update_ts": 14616, "num_target_updates": 28}, "done": false, "episodes_total": 239, "training_iteration": 15, "trial_id": "default", "date": "2024-10-05_20-21-51", "timestamp": 1728152511, "time_this_iter_s": 5.3018598556518555, "time_total_s": 79.32900214195251, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 79.32900214195251, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.2, "ram_util_percent": 90.75}}
{"evaluation": {"sampler_results": {"episode_reward_max": 214.0, "episode_reward_min": 183.0, "episode_reward_mean": 199.9, "episode_len_mean": 199.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0, 198.0, 206.0, 192.0, 183.0, 196.0, 196.0, 202.0, 214.0, 206.0], "episode_lengths": [206, 198, 206, 192, 183, 196, 196, 202, 214, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38507458067939665, "mean_inference_ms": 1.1960935672957027, "mean_action_processing_ms": 0.14114698874736262, "mean_env_wait_ms": 0.061419686514460406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003001689910888672, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.06226062774658203}}, "episode_reward_max": 214.0, "episode_reward_min": 183.0, "episode_reward_mean": 199.9, "episode_len_mean": 199.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0, 198.0, 206.0, 192.0, 183.0, 196.0, 196.0, 202.0, 214.0, 206.0], "episode_lengths": [206, 198, 206, 192, 183, 196, 196, 202, 214, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38507458067939665, "mean_inference_ms": 1.1960935672957027, "mean_action_processing_ms": 0.14114698874736262, "mean_env_wait_ms": 0.061419686514460406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003001689910888672, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.06226062774658203}, "num_agent_steps_sampled_this_iter": 1999, "num_env_steps_sampled_this_iter": 1999, "timesteps_this_iter": 1999, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.306285858154297, "min_q": 9.289981842041016, "max_q": 29.778091430664062, "mean_td_error": 1.0832836627960205}, "td_error": [-0.11059379577636719, -0.11384773254394531, -0.4928760528564453, -0.36135101318359375, 0.28070640563964844, -0.3238182067871094, 8.289981842041016, 0.5190525054931641, -0.06260108947753906, -0.37268829345703125, -0.21633338928222656, 14.358997344970703, -0.19251441955566406, -0.42049217224121094, 0.29164886474609375, -0.18079376220703125, -1.0024356842041016, 0.1385669708251953, 0.25226593017578125, 0.4479351043701172, -3.049501419067383, -0.4872627258300781, -0.2063884735107422, 20.173845291137695, -0.3626384735107422, -1.6378707885742188, -0.2799968719482422, -0.12084197998046875, 0.1729907989501953, -0.31955718994140625, 0.08810043334960938, -0.03461265563964844], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1875, "diff_num_grad_updates_vs_sampler_policy": 1874}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "last_target_update_ts": 15624, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 115.01, "episode_len_mean": 115.01, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0], "episode_lengths": [23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6266128326441993, "mean_inference_ms": 2.042748944123223, "mean_action_processing_ms": 0.193963762136726, "mean_env_wait_ms": 0.10274465622102866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009667396545410156, "StateBufferConnector_ms": 0.0068666934967041016, "ViewRequirementAgentConnector_ms": 0.16312956809997559}}, "episode_reward_max": 300.0, "episode_reward_min": 11.0, "episode_reward_mean": 115.01, "episode_len_mean": 115.01, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.0, 24.0, 32.0, 12.0, 17.0, 23.0, 11.0, 20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0], "episode_lengths": [23, 24, 32, 12, 17, 23, 11, 20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6266128326441993, "mean_inference_ms": 2.042748944123223, "mean_action_processing_ms": 0.193963762136726, "mean_env_wait_ms": 0.10274465622102866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009667396545410156, "StateBufferConnector_ms": 0.0068666934967041016, "ViewRequirementAgentConnector_ms": 0.16312956809997559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.8322716279234, "num_env_steps_trained_throughput_per_sec": 1251.3290865116935, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 25.487, "sample_time_ms": 9.494, "learn_time_ms": 2.781, "learn_throughput": 11508.487, "synch_weights_time_ms": 4.253}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "last_target_update_ts": 15624, "num_target_updates": 30}, "done": false, "episodes_total": 241, "training_iteration": 16, "trial_id": "default", "date": "2024-10-05_20-21-56", "timestamp": 1728152516, "time_this_iter_s": 4.520338296890259, "time_total_s": 83.84934043884277, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 83.84934043884277, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.38333333333333, "ram_util_percent": 91.05000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 287.0, "episode_reward_min": 205.0, "episode_reward_mean": 229.7, "episode_len_mean": 229.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.0, 248.0, 205.0, 217.0, 222.0, 222.0, 232.0, 223.0, 213.0, 287.0], "episode_lengths": [228, 248, 205, 217, 222, 222, 232, 223, 213, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37452854626711346, "mean_inference_ms": 1.1655087525171548, "mean_action_processing_ms": 0.1374790334480873, "mean_env_wait_ms": 0.05982141811706261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0021004676818847656, "ViewRequirementAgentConnector_ms": 0.05584716796875}}, "episode_reward_max": 287.0, "episode_reward_min": 205.0, "episode_reward_mean": 229.7, "episode_len_mean": 229.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.0, 248.0, 205.0, 217.0, 222.0, 222.0, 232.0, 223.0, 213.0, 287.0], "episode_lengths": [228, 248, 205, 217, 222, 222, 232, 223, 213, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37452854626711346, "mean_inference_ms": 1.1655087525171548, "mean_action_processing_ms": 0.1374790334480873, "mean_env_wait_ms": 0.05982141811706261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0021004676818847656, "ViewRequirementAgentConnector_ms": 0.05584716796875}, "num_agent_steps_sampled_this_iter": 2297, "num_env_steps_sampled_this_iter": 2297, "timesteps_this_iter": 2297, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.200387954711914, "min_q": 12.003072738647461, "max_q": 32.1152458190918, "mean_td_error": 1.1767480373382568}, "td_error": [0.07785224914550781, 15.406328201293945, -0.000392913818359375, 0.5008449554443359, -0.14880943298339844, 0.5490779876708984, 0.5433368682861328, 0.6996726989746094, 0.4848365783691406, 0.12665367126464844, 0.27446746826171875, 0.5008354187011719, 0.5891990661621094, 0.30814170837402344, 0.2451801300048828, 0.6393203735351562, 0.01383209228515625, 11.003072738647461, 0.2897205352783203, 0.3417549133300781, 0.5079269409179688, 0.45249366760253906, 1.0147361755371094, 0.5057392120361328, 0.08629608154296875, 0.2052764892578125, 0.13913917541503906, 0.20172882080078125, 0.13295745849609375, 0.3661212921142578, 0.9339485168457031, 0.6646461486816406], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2000, "diff_num_grad_updates_vs_sampler_policy": 1999}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "last_target_update_ts": 16632, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 12.0, "episode_reward_mean": 132.42, "episode_len_mean": 132.42, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0], "episode_lengths": [20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6598545763849168, "mean_inference_ms": 2.0567939622715223, "mean_action_processing_ms": 0.19758465117453852, "mean_env_wait_ms": 0.10425859792957949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009546756744384766, "StateBufferConnector_ms": 0.006852388381958008, "ViewRequirementAgentConnector_ms": 0.16295242309570312}}, "episode_reward_max": 300.0, "episode_reward_min": 12.0, "episode_reward_mean": 132.42, "episode_len_mean": 132.42, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.0, 17.0, 12.0, 39.0, 70.0, 68.0, 17.0, 64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0], "episode_lengths": [20, 17, 12, 39, 70, 68, 17, 64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6598545763849168, "mean_inference_ms": 2.0567939622715223, "mean_action_processing_ms": 0.19758465117453852, "mean_env_wait_ms": 0.10425859792957949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009546756744384766, "StateBufferConnector_ms": 0.006852388381958008, "ViewRequirementAgentConnector_ms": 0.16295242309570312}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.19812658899576, "num_env_steps_trained_throughput_per_sec": 1256.792506355983, "timesteps_total": 17000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 25.828, "sample_time_ms": 9.503, "learn_time_ms": 2.919, "learn_throughput": 10962.366, "synch_weights_time_ms": 4.284}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "last_target_update_ts": 16632, "num_target_updates": 32}, "done": false, "episodes_total": 248, "training_iteration": 17, "trial_id": "default", "date": "2024-10-05_20-22-00", "timestamp": 1728152520, "time_this_iter_s": 4.784559011459351, "time_total_s": 88.63389945030212, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 88.63389945030212, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.457142857142856, "ram_util_percent": 90.91428571428571}}
{"evaluation": {"sampler_results": {"episode_reward_max": 259.0, "episode_reward_min": 77.0, "episode_reward_mean": 99.6, "episode_len_mean": 99.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 259.0, 79.0, 79.0, 84.0, 77.0, 79.0, 82.0, 83.0, 84.0], "episode_lengths": [90, 259, 79, 79, 84, 77, 79, 82, 83, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37170048814245515, "mean_inference_ms": 1.156329645581487, "mean_action_processing_ms": 0.13628783152309293, "mean_env_wait_ms": 0.05931540524157889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002968311309814453, "StateBufferConnector_ms": 0.0021719932556152344, "ViewRequirementAgentConnector_ms": 0.05622386932373047}}, "episode_reward_max": 259.0, "episode_reward_min": 77.0, "episode_reward_mean": 99.6, "episode_len_mean": 99.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 259.0, 79.0, 79.0, 84.0, 77.0, 79.0, 82.0, 83.0, 84.0], "episode_lengths": [90, 259, 79, 79, 84, 77, 79, 82, 83, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37170048814245515, "mean_inference_ms": 1.156329645581487, "mean_action_processing_ms": 0.13628783152309293, "mean_env_wait_ms": 0.05931540524157889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002968311309814453, "StateBufferConnector_ms": 0.0021719932556152344, "ViewRequirementAgentConnector_ms": 0.05622386932373047}, "num_agent_steps_sampled_this_iter": 996, "num_env_steps_sampled_this_iter": 996, "timesteps_this_iter": 996, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.116432189941406, "min_q": 6.974435806274414, "max_q": 33.24449157714844, "mean_td_error": -0.20498552918434143}, "td_error": [-0.48049068450927734, 5.974435806274414, -0.4724559783935547, -2.4333667755126953, -0.5324573516845703, -0.9517097473144531, -0.9026222229003906, -0.059436798095703125, -0.13218307495117188, -1.4802799224853516, 0.012014389038085938, -1.9065513610839844, 0.5122451782226562, -0.6623439788818359, -0.7461948394775391, -0.29079437255859375, -0.23887062072753906, 1.3640384674072266, -0.2527923583984375, -0.03676414489746094, -0.1314849853515625, -1.068227767944336, 0.06908226013183594, -0.7229881286621094, 1.5340805053710938, -0.18532180786132812, -0.3992347717285156, -1.0270271301269531, -0.5678215026855469, 0.07959175109863281, -0.06619453430175781, -0.3574104309082031], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2125, "diff_num_grad_updates_vs_sampler_policy": 2124}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "last_target_update_ts": 17640, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 139.73, "episode_len_mean": 139.73, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0], "episode_lengths": [64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6921300440833076, "mean_inference_ms": 2.0683620449215545, "mean_action_processing_ms": 0.20140056746149138, "mean_env_wait_ms": 0.10585178716224863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009554147720336914, "StateBufferConnector_ms": 0.006821632385253906, "ViewRequirementAgentConnector_ms": 0.16292667388916016}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 139.73, "episode_len_mean": 139.73, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 53.0, 36.0, 26.0, 46.0, 79.0, 65.0, 53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0], "episode_lengths": [64, 53, 36, 26, 46, 79, 65, 53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6921300440833076, "mean_inference_ms": 2.0683620449215545, "mean_action_processing_ms": 0.20140056746149138, "mean_env_wait_ms": 0.10585178716224863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009554147720336914, "StateBufferConnector_ms": 0.006821632385253906, "ViewRequirementAgentConnector_ms": 0.16292667388916016}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.4864577430267, "num_env_steps_trained_throughput_per_sec": 1257.9458309721067, "timesteps_total": 18000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 25.165, "sample_time_ms": 9.218, "learn_time_ms": 2.793, "learn_throughput": 11455.348, "synch_weights_time_ms": 4.278}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "last_target_update_ts": 17640, "num_target_updates": 34}, "done": false, "episodes_total": 255, "training_iteration": 18, "trial_id": "default", "date": "2024-10-05_20-22-04", "timestamp": 1728152524, "time_this_iter_s": 3.8437654972076416, "time_total_s": 92.47766494750977, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 92.47766494750977, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.14, "ram_util_percent": 91.0}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 106.0, "episode_reward_mean": 244.3, "episode_len_mean": 244.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 242.0, 300.0, 242.0, 288.0, 290.0, 189.0, 261.0, 274.0, 251.0], "episode_lengths": [106, 242, 300, 242, 288, 290, 189, 261, 274, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3626710079041847, "mean_inference_ms": 1.1312536224105758, "mean_action_processing_ms": 0.13321571263419058, "mean_env_wait_ms": 0.05797141721798582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026988983154296875, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05738496780395508}}, "episode_reward_max": 300.0, "episode_reward_min": 106.0, "episode_reward_mean": 244.3, "episode_len_mean": 244.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 242.0, 300.0, 242.0, 288.0, 290.0, 189.0, 261.0, 274.0, 251.0], "episode_lengths": [106, 242, 300, 242, 288, 290, 189, 261, 274, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3626710079041847, "mean_inference_ms": 1.1312536224105758, "mean_action_processing_ms": 0.13321571263419058, "mean_env_wait_ms": 0.05797141721798582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026988983154296875, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05738496780395508}, "num_agent_steps_sampled_this_iter": 2443, "num_env_steps_sampled_this_iter": 2443, "timesteps_this_iter": 2443, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.377452850341797, "min_q": -2.9287476539611816, "max_q": 35.061683654785156, "mean_td_error": -0.09938481450080872}, "td_error": [-0.4600677490234375, 0.18578338623046875, -0.0063018798828125, -0.041912078857421875, 4.700387477874756, 0.1573486328125, 0.3193550109863281, 0.052967071533203125, -0.5016422271728516, 0.21389007568359375, -0.7431678771972656, 0.03034210205078125, 0.6860904693603516, 0.45786285400390625, 1.9434361457824707, 0.02680206298828125, -0.9317684173583984, 0.21866989135742188, 0.39385986328125, -4.827864170074463, -0.17404937744140625, 0.0888519287109375, 0.01016998291015625, -0.1794281005859375, -1.3431472778320312, 0.47756195068359375, 0.38837432861328125, -0.09693527221679688, -0.09402084350585938, -3.9287476539611816, -0.44150543212890625, 0.23849105834960938], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2250, "diff_num_grad_updates_vs_sampler_policy": 2249}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "last_target_update_ts": 18648, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 145.2, "episode_len_mean": 145.2, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0], "episode_lengths": [53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.721462891602812, "mean_inference_ms": 2.075396376181293, "mean_action_processing_ms": 0.20505576043461182, "mean_env_wait_ms": 0.10741539836659647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009522199630737305, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.16243815422058105}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 145.2, "episode_len_mean": 145.2, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 110.0, 88.0, 56.0, 48.0, 76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0], "episode_lengths": [53, 110, 88, 56, 48, 76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.721462891602812, "mean_inference_ms": 2.075396376181293, "mean_action_processing_ms": 0.20505576043461182, "mean_env_wait_ms": 0.10741539836659647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009522199630737305, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.16243815422058105}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3944952720807, "num_env_steps_trained_throughput_per_sec": 1237.5779810883228, "timesteps_total": 19000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 28.633, "sample_time_ms": 11.951, "learn_time_ms": 2.864, "learn_throughput": 11174.66, "synch_weights_time_ms": 4.433}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "last_target_update_ts": 18648, "num_target_updates": 36}, "done": false, "episodes_total": 262, "training_iteration": 19, "trial_id": "default", "date": "2024-10-05_20-22-09", "timestamp": 1728152529, "time_this_iter_s": 4.943324565887451, "time_total_s": 97.42098951339722, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 97.42098951339722, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.67142857142857, "ram_util_percent": 90.95714285714284}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 122.0, "episode_reward_mean": 144.3, "episode_len_mean": 144.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 135.0, 123.0, 128.0, 124.0, 132.0, 122.0, 131.0, 122.0, 126.0], "episode_lengths": [300, 135, 123, 128, 124, 132, 122, 131, 122, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3688919498354207, "mean_inference_ms": 1.1480516885368501, "mean_action_processing_ms": 0.13528669076434546, "mean_env_wait_ms": 0.05885099522422852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005428791046142578, "StateBufferConnector_ms": 0.0037097930908203125, "ViewRequirementAgentConnector_ms": 0.09234189987182617}}, "episode_reward_max": 300.0, "episode_reward_min": 122.0, "episode_reward_mean": 144.3, "episode_len_mean": 144.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 135.0, 123.0, 128.0, 124.0, 132.0, 122.0, 131.0, 122.0, 126.0], "episode_lengths": [300, 135, 123, 128, 124, 132, 122, 131, 122, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3688919498354207, "mean_inference_ms": 1.1480516885368501, "mean_action_processing_ms": 0.13528669076434546, "mean_env_wait_ms": 0.05885099522422852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005428791046142578, "StateBufferConnector_ms": 0.0037097930908203125, "ViewRequirementAgentConnector_ms": 0.09234189987182617}, "num_agent_steps_sampled_this_iter": 1443, "num_env_steps_sampled_this_iter": 1443, "timesteps_this_iter": 1443, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.918792724609375, "min_q": -8.995071411132812, "max_q": 36.25130844116211, "mean_td_error": 0.07346072793006897}, "td_error": [-0.11271286010742188, 0.2218017578125, 0.013757705688476562, -0.8094444274902344, 0.2724189758300781, 0.2658424377441406, -0.12053298950195312, -0.5729103088378906, 20.850229263305664, -0.23317337036132812, 0.4359550476074219, -1.8790626525878906, 0.4936065673828125, -0.062427520751953125, 0.27225494384765625, 0.28693199157714844, -0.13723373413085938, 0.591069221496582, -9.995071411132812, 0.4831390380859375, 0.443267822265625, -6.339139938354492, 0.7209053039550781, 0.5610160827636719, -0.060230255126953125, -0.5615577697753906, 0.056591033935546875, -0.17252349853515625, -0.16320419311523438, -1.2321338653564453, -1.2530403137207031, 0.08635520935058594], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2375, "diff_num_grad_updates_vs_sampler_policy": 2374}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "last_target_update_ts": 19656, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 150.09, "episode_len_mean": 150.09, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0], "episode_lengths": [76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.743297876413379, "mean_inference_ms": 2.0861195197111098, "mean_action_processing_ms": 0.20749954416384958, "mean_env_wait_ms": 0.10843052926389493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009716272354125977, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.16466450691223145}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 150.09, "episode_len_mean": 150.09, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0], "episode_lengths": [76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.743297876413379, "mean_inference_ms": 2.0861195197111098, "mean_action_processing_ms": 0.20749954416384958, "mean_env_wait_ms": 0.10843052926389493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009716272354125977, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.16466450691223145}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.20685820894306, "num_env_steps_trained_throughput_per_sec": 1012.8274328357722, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 43.424, "sample_time_ms": 15.582, "learn_time_ms": 4.596, "learn_throughput": 6963.09, "synch_weights_time_ms": 7.129}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "last_target_update_ts": 19656, "num_target_updates": 38}, "done": false, "episodes_total": 267, "training_iteration": 20, "trial_id": "default", "date": "2024-10-05_20-22-15", "timestamp": 1728152535, "time_this_iter_s": 5.442740201950073, "time_total_s": 102.86372971534729, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 102.86372971534729, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.1375, "ram_util_percent": 90.8}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 130.0, "episode_reward_mean": 283.0, "episode_len_mean": 283.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [130, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549525433305175, "mean_inference_ms": 1.1709572356424212, "mean_action_processing_ms": 0.1382211749785382, "mean_env_wait_ms": 0.06008386687411279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038695335388183594, "StateBufferConnector_ms": 0.00335693359375, "ViewRequirementAgentConnector_ms": 0.08874893188476562}}, "episode_reward_max": 300.0, "episode_reward_min": 130.0, "episode_reward_mean": 283.0, "episode_len_mean": 283.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [130, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549525433305175, "mean_inference_ms": 1.1709572356424212, "mean_action_processing_ms": 0.1382211749785382, "mean_env_wait_ms": 0.06008386687411279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038695335388183594, "StateBufferConnector_ms": 0.00335693359375, "ViewRequirementAgentConnector_ms": 0.08874893188476562}, "num_agent_steps_sampled_this_iter": 2830, "num_env_steps_sampled_this_iter": 2830, "timesteps_this_iter": 2830, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 32.70676040649414, "min_q": 3.222609043121338, "max_q": 37.796043395996094, "mean_td_error": 0.9127335548400879}, "td_error": [-0.6664199829101562, 23.25885581970215, 2.257692337036133, 0.047458648681640625, 0.6260223388671875, -0.6776847839355469, -0.21060562133789062, 0.09912490844726562, -0.36782073974609375, -0.12908172607421875, -0.27242279052734375, 0.8089523315429688, 0.232391357421875, 7.390691757202148, -0.710052490234375, 0.09999847412109375, -1.01171875, -0.13065719604492188, -0.4354095458984375, 1.5286498069763184, -0.35353851318359375, 0.7000198364257812, -0.3428001403808594, -0.22686004638671875, -0.2413482666015625, -0.4585762023925781, -0.36496734619140625, -1.8979148864746094, 0.02225494384765625, 0.42372894287109375, 0.09449005126953125, 0.115020751953125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2500, "diff_num_grad_updates_vs_sampler_policy": 2499}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "last_target_update_ts": 20664, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 150.09, "episode_len_mean": 150.09, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0], "episode_lengths": [76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.743297876413379, "mean_inference_ms": 2.0861195197111098, "mean_action_processing_ms": 0.20749954416384958, "mean_env_wait_ms": 0.10843052926389493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009716272354125977, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.16466450691223145}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 150.09, "episode_len_mean": 150.09, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 23.0, 24.0, 34.0, 23.0, 27.0, 23.0, 18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0], "episode_lengths": [76, 23, 24, 34, 23, 27, 23, 18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.743297876413379, "mean_inference_ms": 2.0861195197111098, "mean_action_processing_ms": 0.20749954416384958, "mean_env_wait_ms": 0.10843052926389493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009716272354125977, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.16466450691223145}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.80632017380907, "num_env_steps_trained_throughput_per_sec": 759.2252806952363, "timesteps_total": 21000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 43.168, "sample_time_ms": 15.442, "learn_time_ms": 4.691, "learn_throughput": 6821.358, "synch_weights_time_ms": 6.968}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "last_target_update_ts": 20664, "num_target_updates": 40}, "done": false, "episodes_total": 267, "training_iteration": 21, "trial_id": "default", "date": "2024-10-05_20-22-23", "timestamp": 1728152543, "time_this_iter_s": 8.399184226989746, "time_total_s": 111.26291394233704, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 111.26291394233704, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.899999999999995, "ram_util_percent": 90.875}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 150.0, "episode_reward_mean": 182.4, "episode_len_mean": 182.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 150.0, 179.0, 151.0, 171.0, 162.0, 177.0, 179.0, 182.0, 173.0], "episode_lengths": [300, 150, 179, 151, 171, 162, 177, 179, 182, 173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3805621713848447, "mean_inference_ms": 1.1832379634519576, "mean_action_processing_ms": 0.13972548818387304, "mean_env_wait_ms": 0.06075081948700043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047588348388671875, "StateBufferConnector_ms": 0.0035381317138671875, "ViewRequirementAgentConnector_ms": 0.09037256240844727}}, "episode_reward_max": 300.0, "episode_reward_min": 150.0, "episode_reward_mean": 182.4, "episode_len_mean": 182.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 150.0, 179.0, 151.0, 171.0, 162.0, 177.0, 179.0, 182.0, 173.0], "episode_lengths": [300, 150, 179, 151, 171, 162, 177, 179, 182, 173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3805621713848447, "mean_inference_ms": 1.1832379634519576, "mean_action_processing_ms": 0.13972548818387304, "mean_env_wait_ms": 0.06075081948700043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047588348388671875, "StateBufferConnector_ms": 0.0035381317138671875, "ViewRequirementAgentConnector_ms": 0.09037256240844727}, "num_agent_steps_sampled_this_iter": 1824, "num_env_steps_sampled_this_iter": 1824, "timesteps_this_iter": 1824, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 33.251007080078125, "min_q": 1.8324419260025024, "max_q": 40.021034240722656, "mean_td_error": 1.7956171035766602}, "td_error": [0.6981163024902344, -0.2168426513671875, 0.42896270751953125, 0.6507339477539062, -2.6183505058288574, -0.08823013305664062, 0.29619598388671875, 1.1347312927246094, -0.6153984069824219, -0.44446563720703125, -0.0233917236328125, -0.30741119384765625, 0.027532577514648438, 18.760961532592773, 19.38460350036621, 0.39595794677734375, -0.7159461975097656, -0.7315940856933594, 21.87766456604004, 0.07494354248046875, -0.3612632751464844, 0.22064208984375, -1.5845375061035156, -1.1339035034179688, -0.3795623779296875, -0.95263671875, 4.268065452575684, -0.05873870849609375, -1.0453567504882812, 1.286834716796875, -0.7648086547851562, -0.003757476806640625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2625, "diff_num_grad_updates_vs_sampler_policy": 2624}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "last_target_update_ts": 21672, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 166.08, "episode_len_mean": 166.08, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0], "episode_lengths": [18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7770773797198602, "mean_inference_ms": 2.1039804697992146, "mean_action_processing_ms": 0.2113385171248418, "mean_env_wait_ms": 0.11002605283921703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009798765182495117, "StateBufferConnector_ms": 0.006943941116333008, "ViewRequirementAgentConnector_ms": 0.16870474815368652}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 166.08, "episode_len_mean": 166.08, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.0, 18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0], "episode_lengths": [18, 18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7770773797198602, "mean_inference_ms": 2.1039804697992146, "mean_action_processing_ms": 0.2113385171248418, "mean_env_wait_ms": 0.11002605283921703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009798765182495117, "StateBufferConnector_ms": 0.006943941116333008, "ViewRequirementAgentConnector_ms": 0.16870474815368652}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.65064004423448, "num_env_steps_trained_throughput_per_sec": 774.6025601769379, "timesteps_total": 22000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 44.472, "sample_time_ms": 16.179, "learn_time_ms": 4.642, "learn_throughput": 6892.858, "synch_weights_time_ms": 6.925}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "last_target_update_ts": 21672, "num_target_updates": 42}, "done": false, "episodes_total": 274, "training_iteration": 22, "trial_id": "default", "date": "2024-10-05_20-22-30", "timestamp": 1728152550, "time_this_iter_s": 6.933456182479858, "time_total_s": 118.1963701248169, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 118.1963701248169, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.18, "ram_util_percent": 90.88}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 150.0, "episode_reward_mean": 204.5, "episode_len_mean": 204.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 214.0, 165.0, 300.0, 150.0, 159.0, 208.0, 184.0, 190.0, 300.0], "episode_lengths": [175, 214, 165, 300, 150, 159, 208, 184, 190, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843577838845177, "mean_inference_ms": 1.1958558343115722, "mean_action_processing_ms": 0.1413341608035056, "mean_env_wait_ms": 0.061438321026957544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00423431396484375, "StateBufferConnector_ms": 0.0034308433532714844, "ViewRequirementAgentConnector_ms": 0.08848905563354492}}, "episode_reward_max": 300.0, "episode_reward_min": 150.0, "episode_reward_mean": 204.5, "episode_len_mean": 204.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 214.0, 165.0, 300.0, 150.0, 159.0, 208.0, 184.0, 190.0, 300.0], "episode_lengths": [175, 214, 165, 300, 150, 159, 208, 184, 190, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843577838845177, "mean_inference_ms": 1.1958558343115722, "mean_action_processing_ms": 0.1413341608035056, "mean_env_wait_ms": 0.061438321026957544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00423431396484375, "StateBufferConnector_ms": 0.0034308433532714844, "ViewRequirementAgentConnector_ms": 0.08848905563354492}, "num_agent_steps_sampled_this_iter": 2045, "num_env_steps_sampled_this_iter": 2045, "timesteps_this_iter": 2045, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 31.51727294921875, "min_q": 0.41115808486938477, "max_q": 40.69454574584961, "mean_td_error": 1.808685302734375}, "td_error": [-1.0525169372558594, 0.019947052001953125, 0.14909744262695312, 0.24267959594726562, -2.6450042724609375, 0.7320156097412109, 0.3415985107421875, 10.335065841674805, -0.018383026123046875, 16.408260345458984, 0.8791580200195312, 0.24957275390625, 14.223316192626953, 0.240966796875, 0.5101585388183594, -0.7325325012207031, -2.443849563598633, 0.2776508331298828, -1.7171669006347656, 0.3192253112792969, 0.23118972778320312, 0.3293021321296692, 16.524009704589844, 0.3065299987792969, -0.8480186462402344, 0.08231353759765625, -0.4387626647949219, 0.2470855712890625, 0.39937591552734375, -0.5316696166992188, 1.244903564453125, 4.012409210205078], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2750, "diff_num_grad_updates_vs_sampler_policy": 2749}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "last_target_update_ts": 22680, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 168.85, "episode_len_mean": 168.85, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0], "episode_lengths": [18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.782144980444054, "mean_inference_ms": 2.106800064200367, "mean_action_processing_ms": 0.2119778987186981, "mean_env_wait_ms": 0.11029281283668169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009813785552978516, "StateBufferConnector_ms": 0.0069599151611328125, "ViewRequirementAgentConnector_ms": 0.16919612884521484}}, "episode_reward_max": 300.0, "episode_reward_min": 16.0, "episode_reward_mean": 168.85, "episode_len_mean": 168.85, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.0, 53.0, 61.0, 32.0, 16.0, 80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0], "episode_lengths": [18, 53, 61, 32, 16, 80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.782144980444054, "mean_inference_ms": 2.106800064200367, "mean_action_processing_ms": 0.2119778987186981, "mean_env_wait_ms": 0.11029281283668169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009813785552978516, "StateBufferConnector_ms": 0.0069599151611328125, "ViewRequirementAgentConnector_ms": 0.16919612884521484}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.44049953095816, "num_env_steps_trained_throughput_per_sec": 781.7619981238327, "timesteps_total": 23000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 41.628, "sample_time_ms": 14.729, "learn_time_ms": 4.559, "learn_throughput": 7019.535, "synch_weights_time_ms": 6.871}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "last_target_update_ts": 22680, "num_target_updates": 44}, "done": false, "episodes_total": 275, "training_iteration": 23, "trial_id": "default", "date": "2024-10-05_20-22-37", "timestamp": 1728152557, "time_this_iter_s": 7.302439212799072, "time_total_s": 125.49880933761597, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 125.49880933761597, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.010000000000005, "ram_util_percent": 90.79999999999998}}
{"evaluation": {"sampler_results": {"episode_reward_max": 152.0, "episode_reward_min": 92.0, "episode_reward_mean": 103.0, "episode_len_mean": 103.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 152.0, 97.0, 100.0, 94.0, 98.0, 92.0, 97.0, 101.0, 101.0], "episode_lengths": [98, 152, 97, 100, 94, 98, 92, 97, 101, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38742810137827416, "mean_inference_ms": 1.2035812644775554, "mean_action_processing_ms": 0.14227669778282065, "mean_env_wait_ms": 0.061873807171648684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637241363525391, "StateBufferConnector_ms": 0.004596710205078125, "ViewRequirementAgentConnector_ms": 0.09545326232910156}}, "episode_reward_max": 152.0, "episode_reward_min": 92.0, "episode_reward_mean": 103.0, "episode_len_mean": 103.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 152.0, 97.0, 100.0, 94.0, 98.0, 92.0, 97.0, 101.0, 101.0], "episode_lengths": [98, 152, 97, 100, 94, 98, 92, 97, 101, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38742810137827416, "mean_inference_ms": 1.2035812644775554, "mean_action_processing_ms": 0.14227669778282065, "mean_env_wait_ms": 0.061873807171648684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637241363525391, "StateBufferConnector_ms": 0.004596710205078125, "ViewRequirementAgentConnector_ms": 0.09545326232910156}, "num_agent_steps_sampled_this_iter": 1030, "num_env_steps_sampled_this_iter": 1030, "timesteps_this_iter": 1030, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 37.29044723510742, "min_q": -5.089735984802246, "max_q": 42.38145446777344, "mean_td_error": 0.5978572368621826}, "td_error": [0.3062934875488281, -0.3957061767578125, -0.22632598876953125, -0.2722511291503906, -0.3058280944824219, 0.5796623229980469, -0.3918266296386719, -0.4811897277832031, -0.2130126953125, -0.4811897277832031, 0.40712738037109375, 0.0271759033203125, 1.4428558349609375, -1.5582084655761719, -0.09358787536621094, -1.6515045166015625, -0.20805740356445312, -0.09833908081054688, 25.870052337646484, -0.1934967041015625, -6.089735984802246, -0.4930839538574219, 0.2086944580078125, -0.2558746337890625, -0.5003395080566406, 0.006988525390625, 0.21559906005859375, -0.18607330322265625, -1.3956108093261719, 0.3881111145019531, 5.346231460571289, -0.176116943359375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2875, "diff_num_grad_updates_vs_sampler_policy": 2874}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "last_target_update_ts": 23688, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 63.0, "episode_reward_mean": 181.55, "episode_len_mean": 181.55, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0], "episode_lengths": [80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076841728027633, "mean_inference_ms": 2.1185753728530052, "mean_action_processing_ms": 0.21509622895325575, "mean_env_wait_ms": 0.11162313176101847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003805160522461, "StateBufferConnector_ms": 0.007105588912963867, "ViewRequirementAgentConnector_ms": 0.17299842834472656}}, "episode_reward_max": 300.0, "episode_reward_min": 63.0, "episode_reward_mean": 181.55, "episode_len_mean": 181.55, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 64.0, 67.0, 119.0, 119.0, 91.0, 134.0, 166.0, 208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0], "episode_lengths": [80, 64, 67, 119, 119, 91, 134, 166, 208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076841728027633, "mean_inference_ms": 2.1185753728530052, "mean_action_processing_ms": 0.21509622895325575, "mean_env_wait_ms": 0.11162313176101847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003805160522461, "StateBufferConnector_ms": 0.007105588912963867, "ViewRequirementAgentConnector_ms": 0.17299842834472656}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.02731277188911, "num_env_steps_trained_throughput_per_sec": 780.1092510875565, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 42.85, "sample_time_ms": 15.422, "learn_time_ms": 4.517, "learn_throughput": 7084.225, "synch_weights_time_ms": 6.893}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "last_target_update_ts": 23688, "num_target_updates": 46}, "done": false, "episodes_total": 280, "training_iteration": 24, "trial_id": "default", "date": "2024-10-05_20-22-44", "timestamp": 1728152564, "time_this_iter_s": 6.248623847961426, "time_total_s": 131.7474331855774, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 131.7474331855774, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 36.011111111111106, "ram_util_percent": 90.74444444444445}}
{"evaluation": {"sampler_results": {"episode_reward_max": 111.0, "episode_reward_min": 97.0, "episode_reward_mean": 105.4, "episode_len_mean": 105.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0, 104.0, 107.0, 108.0, 97.0, 102.0, 111.0, 102.0, 110.0, 111.0], "episode_lengths": [102, 104, 107, 108, 97, 102, 111, 102, 110, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39053000294219664, "mean_inference_ms": 1.2121400818825792, "mean_action_processing_ms": 0.14330393399062238, "mean_env_wait_ms": 0.062367071654828785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004751682281494141, "StateBufferConnector_ms": 0.0036978721618652344, "ViewRequirementAgentConnector_ms": 0.09808540344238281}}, "episode_reward_max": 111.0, "episode_reward_min": 97.0, "episode_reward_mean": 105.4, "episode_len_mean": 105.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0, 104.0, 107.0, 108.0, 97.0, 102.0, 111.0, 102.0, 110.0, 111.0], "episode_lengths": [102, 104, 107, 108, 97, 102, 111, 102, 110, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39053000294219664, "mean_inference_ms": 1.2121400818825792, "mean_action_processing_ms": 0.14330393399062238, "mean_env_wait_ms": 0.062367071654828785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004751682281494141, "StateBufferConnector_ms": 0.0036978721618652344, "ViewRequirementAgentConnector_ms": 0.09808540344238281}, "num_agent_steps_sampled_this_iter": 1054, "num_env_steps_sampled_this_iter": 1054, "timesteps_this_iter": 1054, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 35.9505615234375, "min_q": 12.643393516540527, "max_q": 43.61953353881836, "mean_td_error": 1.792685866355896}, "td_error": [-0.3036003112792969, 21.779542922973633, -0.2840766906738281, -0.14935684204101562, -0.5246810913085938, 0.21786880493164062, -0.32808685302734375, -0.8385906219482422, 0.2416229248046875, 20.025571823120117, 0.17055892944335938, -1.0614662170410156, -0.009616851806640625, -1.2530555725097656, -0.20210647583007812, -1.0873641967773438, 0.545074462890625, -0.8982009887695312, 28.77196502685547, -0.42043304443359375, -0.7068462371826172, -1.1439838409423828, -1.0254058837890625, -1.2010498046875, -0.12293338775634766, -0.754638671875, -0.5395011901855469, -1.0900745391845703, 0.277862548828125, 0.047573089599609375, -0.15613174438476562, -0.6104888916015625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3000, "diff_num_grad_updates_vs_sampler_policy": 2999}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "last_target_update_ts": 24696, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 63.0, "episode_reward_mean": 189.26, "episode_len_mean": 189.26, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0], "episode_lengths": [208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8487501561915893, "mean_inference_ms": 2.1426382245900992, "mean_action_processing_ms": 0.21982339876549234, "mean_env_wait_ms": 0.11362745596514813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010238170623779297, "StateBufferConnector_ms": 0.007322549819946289, "ViewRequirementAgentConnector_ms": 0.1788191795349121}}, "episode_reward_max": 300.0, "episode_reward_min": 63.0, "episode_reward_mean": 189.26, "episode_len_mean": 189.26, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [208.0, 147.0, 63.0, 182.0, 119.0, 71.0, 138.0, 91.0, 139.0, 172.0, 190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0], "episode_lengths": [208, 147, 63, 182, 119, 71, 138, 91, 139, 172, 190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8487501561915893, "mean_inference_ms": 2.1426382245900992, "mean_action_processing_ms": 0.21982339876549234, "mean_env_wait_ms": 0.11362745596514813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010238170623779297, "StateBufferConnector_ms": 0.007322549819946289, "ViewRequirementAgentConnector_ms": 0.1788191795349121}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.93073495769525, "num_env_steps_trained_throughput_per_sec": 767.722939830781, "timesteps_total": 25000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 41.707, "sample_time_ms": 15.355, "learn_time_ms": 4.368, "learn_throughput": 7325.775, "synch_weights_time_ms": 6.685}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "last_target_update_ts": 24696, "num_target_updates": 48}, "done": false, "episodes_total": 288, "training_iteration": 25, "trial_id": "default", "date": "2024-10-05_20-22-50", "timestamp": 1728152570, "time_this_iter_s": 6.42204475402832, "time_total_s": 138.1694779396057, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 138.1694779396057, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 37.32222222222222, "ram_util_percent": 90.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": 194.0, "episode_reward_min": 143.0, "episode_reward_mean": 162.4, "episode_len_mean": 162.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.0, 154.0, 147.0, 179.0, 143.0, 167.0, 174.0, 194.0, 172.0, 143.0], "episode_lengths": [151, 154, 147, 179, 143, 167, 174, 194, 172, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39337629560521065, "mean_inference_ms": 1.2212654121989175, "mean_action_processing_ms": 0.14445182603412943, "mean_env_wait_ms": 0.0628824476683969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038671493530273438, "StateBufferConnector_ms": 0.003464221954345703, "ViewRequirementAgentConnector_ms": 0.09090423583984375}}, "episode_reward_max": 194.0, "episode_reward_min": 143.0, "episode_reward_mean": 162.4, "episode_len_mean": 162.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.0, 154.0, 147.0, 179.0, 143.0, 167.0, 174.0, 194.0, 172.0, 143.0], "episode_lengths": [151, 154, 147, 179, 143, 167, 174, 194, 172, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39337629560521065, "mean_inference_ms": 1.2212654121989175, "mean_action_processing_ms": 0.14445182603412943, "mean_env_wait_ms": 0.0628824476683969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038671493530273438, "StateBufferConnector_ms": 0.003464221954345703, "ViewRequirementAgentConnector_ms": 0.09090423583984375}, "num_agent_steps_sampled_this_iter": 1624, "num_env_steps_sampled_this_iter": 1624, "timesteps_this_iter": 1624, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 40.83087921142578, "min_q": 12.636837005615234, "max_q": 45.75230407714844, "mean_td_error": 1.589644432067871}, "td_error": [0.21934890747070312, 0.9090194702148438, 11.636837005615234, -0.33983612060546875, 1.2169189453125, 0.2646293640136719, 0.4216651916503906, 0.9458541870117188, 0.9109153747558594, 0.4395484924316406, 0.7080039978027344, 28.63582992553711, 0.4055671691894531, 0.6146469116210938, 0.21077728271484375, 0.12079620361328125, 0.3075981140136719, 0.5620460510253906, -0.9199562072753906, -0.06706619262695312, 0.1844940185546875, -1.1608543395996094, 0.44104766845703125, 0.22198486328125, 0.5430030822753906, -0.31410980224609375, 1.5450439453125, -0.24124526977539062, 0.3919029235839844, 0.3209266662597656, 0.9162750244140625, 0.8170089721679688], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3125, "diff_num_grad_updates_vs_sampler_policy": 3124}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "last_target_update_ts": 25704, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 186.84, "episode_len_mean": 186.84, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0], "episode_lengths": [190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8869142461306303, "mean_inference_ms": 2.1637957513623935, "mean_action_processing_ms": 0.22415952227734656, "mean_env_wait_ms": 0.11546441864608109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010088443756103516, "StateBufferConnector_ms": 0.00729823112487793, "ViewRequirementAgentConnector_ms": 0.1781454086303711}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 186.84, "episode_len_mean": 186.84, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [190.0, 153.0, 104.0, 138.0, 114.0, 174.0, 179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0], "episode_lengths": [190, 153, 104, 138, 114, 174, 179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8869142461306303, "mean_inference_ms": 2.1637957513623935, "mean_action_processing_ms": 0.22415952227734656, "mean_env_wait_ms": 0.11546441864608109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010088443756103516, "StateBufferConnector_ms": 0.00729823112487793, "ViewRequirementAgentConnector_ms": 0.1781454086303711}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.51120266686416, "num_env_steps_trained_throughput_per_sec": 778.0448106674567, "timesteps_total": 26000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 42.004, "sample_time_ms": 14.805, "learn_time_ms": 4.555, "learn_throughput": 7025.414, "synch_weights_time_ms": 7.018}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "last_target_update_ts": 25704, "num_target_updates": 50}, "done": false, "episodes_total": 298, "training_iteration": 26, "trial_id": "default", "date": "2024-10-05_20-22-57", "timestamp": 1728152577, "time_this_iter_s": 6.921950101852417, "time_total_s": 145.09142804145813, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 145.09142804145813, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 34.620000000000005, "ram_util_percent": 90.76}}
{"evaluation": {"sampler_results": {"episode_reward_max": 188.0, "episode_reward_min": 120.0, "episode_reward_mean": 163.0, "episode_len_mean": 163.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 120.0, 149.0, 178.0, 188.0, 183.0, 157.0, 175.0, 156.0, 187.0], "episode_lengths": [137, 120, 149, 178, 188, 183, 157, 175, 156, 187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38895519818466834, "mean_inference_ms": 1.2158901901857937, "mean_action_processing_ms": 0.14282790834294073, "mean_env_wait_ms": 0.06216809389267301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026488304138183594, "StateBufferConnector_ms": 0.0021147727966308594, "ViewRequirementAgentConnector_ms": 0.055999755859375}}, "episode_reward_max": 188.0, "episode_reward_min": 120.0, "episode_reward_mean": 163.0, "episode_len_mean": 163.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 120.0, 149.0, 178.0, 188.0, 183.0, 157.0, 175.0, 156.0, 187.0], "episode_lengths": [137, 120, 149, 178, 188, 183, 157, 175, 156, 187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38895519818466834, "mean_inference_ms": 1.2158901901857937, "mean_action_processing_ms": 0.14282790834294073, "mean_env_wait_ms": 0.06216809389267301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026488304138183594, "StateBufferConnector_ms": 0.0021147727966308594, "ViewRequirementAgentConnector_ms": 0.055999755859375}, "num_agent_steps_sampled_this_iter": 1630, "num_env_steps_sampled_this_iter": 1630, "timesteps_this_iter": 1630, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 39.68425750732422, "min_q": 3.552727699279785, "max_q": 46.955081939697266, "mean_td_error": 1.3291277885437012}, "td_error": [0.01172637939453125, 0.8134117126464844, 0.2877197265625, 0.24047088623046875, -0.4764060974121094, 0.25559234619140625, 0.21846389770507812, -0.08305740356445312, 0.3732872009277344, 0.467132568359375, 0.12974166870117188, -0.7097053527832031, 1.224578857421875, 29.26331329345703, -0.0232391357421875, 5.308209419250488, 0.183349609375, -0.0999298095703125, 1.1625747680664062, 0.3332347869873047, 0.40883636474609375, 0.20403289794921875, 0.149627685546875, 0.4576225280761719, 0.040069580078125, 0.20458602905273438, 3.875944137573242, 0.035369873046875, -1.6624107360839844, 0.18602371215820312, -0.17560958862304688, -0.07247161865234375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3250, "diff_num_grad_updates_vs_sampler_policy": 3249}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "last_target_update_ts": 26712, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 185.97, "episode_len_mean": 185.97, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0], "episode_lengths": [179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.90265575406136, "mean_inference_ms": 2.1709595086948585, "mean_action_processing_ms": 0.2260031601843244, "mean_env_wait_ms": 0.11623740153985526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010033607482910156, "StateBufferConnector_ms": 0.007223367691040039, "ViewRequirementAgentConnector_ms": 0.17587018013000488}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 185.97, "episode_len_mean": 185.97, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [179.0, 127.0, 164.0, 300.0, 161.0, 127.0, 135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0], "episode_lengths": [179, 127, 164, 300, 161, 127, 135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.90265575406136, "mean_inference_ms": 2.1709595086948585, "mean_action_processing_ms": 0.2260031601843244, "mean_env_wait_ms": 0.11623740153985526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010033607482910156, "StateBufferConnector_ms": 0.007223367691040039, "ViewRequirementAgentConnector_ms": 0.17587018013000488}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.69702227238884, "num_env_steps_trained_throughput_per_sec": 890.7880890895553, "timesteps_total": 27000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 25.269, "sample_time_ms": 9.619, "learn_time_ms": 2.729, "learn_throughput": 11727.296, "synch_weights_time_ms": 4.141}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "last_target_update_ts": 26712, "num_target_updates": 52}, "done": false, "episodes_total": 304, "training_iteration": 27, "trial_id": "default", "date": "2024-10-05_20-23-03", "timestamp": 1728152583, "time_this_iter_s": 5.718708038330078, "time_total_s": 150.8101360797882, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 150.8101360797882, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.74444444444445, "ram_util_percent": 90.84444444444445}}
{"evaluation": {"sampler_results": {"episode_reward_max": 160.0, "episode_reward_min": 116.0, "episode_reward_mean": 132.7, "episode_len_mean": 132.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 160.0, 133.0, 130.0, 116.0, 141.0, 119.0, 134.0, 123.0, 137.0], "episode_lengths": [134, 160, 133, 130, 116, 141, 119, 134, 123, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38568327466387065, "mean_inference_ms": 1.2059612072122208, "mean_action_processing_ms": 0.14158578958141388, "mean_env_wait_ms": 0.061632209523361126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0021576881408691406, "ViewRequirementAgentConnector_ms": 0.056509971618652344}}, "episode_reward_max": 160.0, "episode_reward_min": 116.0, "episode_reward_mean": 132.7, "episode_len_mean": 132.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 160.0, 133.0, 130.0, 116.0, 141.0, 119.0, 134.0, 123.0, 137.0], "episode_lengths": [134, 160, 133, 130, 116, 141, 119, 134, 123, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38568327466387065, "mean_inference_ms": 1.2059612072122208, "mean_action_processing_ms": 0.14158578958141388, "mean_env_wait_ms": 0.061632209523361126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0021576881408691406, "ViewRequirementAgentConnector_ms": 0.056509971618652344}, "num_agent_steps_sampled_this_iter": 1327, "num_env_steps_sampled_this_iter": 1327, "timesteps_this_iter": 1327, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 45.342247009277344, "min_q": 32.985198974609375, "max_q": 48.62930679321289, "mean_td_error": 0.2564164400100708}, "td_error": [1.1569633483886719, 1.1450958251953125, -0.017772674560546875, 0.18968582153320312, -0.3849945068359375, 0.5252227783203125, 0.588714599609375, 0.23572540283203125, -0.33725738525390625, 0.4252166748046875, 0.6086158752441406, -0.6330032348632812, 0.22387313842773438, 0.01811981201171875, 0.7905845642089844, 0.4097938537597656, -0.003505706787109375, 0.08327484130859375, 0.27648162841796875, -0.151153564453125, -0.04598236083984375, 0.641357421875, 0.4006309509277344, 0.3608436584472656, 0.6819381713867188, 0.6254043579101562, 0.457733154296875, 0.4236907958984375, 0.043018341064453125, 0.5323333740234375, -0.5701904296875, -0.4951324462890625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3375, "diff_num_grad_updates_vs_sampler_policy": 3374}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "last_target_update_ts": 27720, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 184.64, "episode_len_mean": 184.64, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0], "episode_lengths": [135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9136979902062143, "mean_inference_ms": 2.1759359846047817, "mean_action_processing_ms": 0.22731839093441455, "mean_env_wait_ms": 0.11676981732177417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009761571884155273, "StateBufferConnector_ms": 0.007065773010253906, "ViewRequirementAgentConnector_ms": 0.1719377040863037}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 184.64, "episode_len_mean": 184.64, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [135.0, 282.0, 185.0, 154.0, 132.0, 146.0, 188.0, 142.0, 175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0], "episode_lengths": [135, 282, 185, 154, 132, 146, 188, 142, 175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9136979902062143, "mean_inference_ms": 2.1759359846047817, "mean_action_processing_ms": 0.22731839093441455, "mean_env_wait_ms": 0.11676981732177417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009761571884155273, "StateBufferConnector_ms": 0.007065773010253906, "ViewRequirementAgentConnector_ms": 0.1719377040863037}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.62736680174316, "num_env_steps_trained_throughput_per_sec": 1270.5094672069727, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 25.246, "sample_time_ms": 9.545, "learn_time_ms": 2.667, "learn_throughput": 11997.866, "synch_weights_time_ms": 4.134}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "last_target_update_ts": 27720, "num_target_updates": 54}, "done": false, "episodes_total": 310, "training_iteration": 28, "trial_id": "default", "date": "2024-10-05_20-23-07", "timestamp": 1728152587, "time_this_iter_s": 4.050188064575195, "time_total_s": 154.8603241443634, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 154.8603241443634, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.6, "ram_util_percent": 90.8}}
{"evaluation": {"sampler_results": {"episode_reward_max": 128.0, "episode_reward_min": 115.0, "episode_reward_mean": 122.1, "episode_len_mean": 122.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.0, 128.0, 125.0, 122.0, 121.0, 120.0, 115.0, 120.0, 122.0, 122.0], "episode_lengths": [126, 128, 125, 122, 121, 120, 115, 120, 122, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833542659981002, "mean_inference_ms": 1.198513502093729, "mean_action_processing_ms": 0.14065806132878958, "mean_env_wait_ms": 0.06123712212759451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.06417512893676758}}, "episode_reward_max": 128.0, "episode_reward_min": 115.0, "episode_reward_mean": 122.1, "episode_len_mean": 122.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.0, 128.0, 125.0, 122.0, 121.0, 120.0, 115.0, 120.0, 122.0, 122.0], "episode_lengths": [126, 128, 125, 122, 121, 120, 115, 120, 122, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833542659981002, "mean_inference_ms": 1.198513502093729, "mean_action_processing_ms": 0.14065806132878958, "mean_env_wait_ms": 0.06123712212759451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.06417512893676758}, "num_agent_steps_sampled_this_iter": 1221, "num_env_steps_sampled_this_iter": 1221, "timesteps_this_iter": 1221, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 42.59253692626953, "min_q": -6.421015739440918, "max_q": 49.226402282714844, "mean_td_error": 2.851841926574707}, "td_error": [-0.4427299499511719, -0.3780364990234375, 0.19749069213867188, 0.2380218505859375, -0.09104156494140625, -0.5814170837402344, -0.4214019775390625, -0.045063018798828125, 22.609375, -0.13114166259765625, -0.5097160339355469, -0.13956451416015625, 30.269245147705078, 0.4119834899902344, -0.6714210510253906, -0.3800697326660156, -0.5442657470703125, -0.3456764221191406, -0.8931350708007812, -0.6623344421386719, -7.421015739440918, 23.284774780273438, -0.5425643920898438, 28.92801856994629, 0.45221710205078125, -0.3054962158203125, -0.4007568359375, 0.0383453369140625, 0.6395683288574219, -0.2514801025390625, -0.7753448486328125, 0.1235809326171875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3500, "diff_num_grad_updates_vs_sampler_policy": 3499}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "last_target_update_ts": 28728, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 183.6, "episode_len_mean": 183.6, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0], "episode_lengths": [175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9197864707517511, "mean_inference_ms": 2.1750634496611156, "mean_action_processing_ms": 0.22793111393678353, "mean_env_wait_ms": 0.11701335174968573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009546279907226562, "StateBufferConnector_ms": 0.00683140754699707, "ViewRequirementAgentConnector_ms": 0.1662888526916504}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 183.6, "episode_len_mean": 183.6, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [175.0, 131.0, 168.0, 128.0, 227.0, 273.0, 300.0, 216.0, 197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0], "episode_lengths": [175, 131, 168, 128, 227, 273, 300, 216, 197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9197864707517511, "mean_inference_ms": 2.1750634496611156, "mean_action_processing_ms": 0.22793111393678353, "mean_env_wait_ms": 0.11701335174968573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009546279907226562, "StateBufferConnector_ms": 0.00683140754699707, "ViewRequirementAgentConnector_ms": 0.1662888526916504}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.56381272837586, "num_env_steps_trained_throughput_per_sec": 1226.2552509135035, "timesteps_total": 29000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 26.501, "sample_time_ms": 9.645, "learn_time_ms": 2.839, "learn_throughput": 11271.413, "synch_weights_time_ms": 4.336}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "last_target_update_ts": 28728, "num_target_updates": 56}, "done": false, "episodes_total": 318, "training_iteration": 29, "trial_id": "default", "date": "2024-10-05_20-23-11", "timestamp": 1728152591, "time_this_iter_s": 4.126024484634399, "time_total_s": 158.9863486289978, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 158.9863486289978, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.81666666666667, "ram_util_percent": 90.73333333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 125.0, "episode_reward_mean": 152.2, "episode_len_mean": 152.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 151.0, 141.0, 137.0, 133.0, 127.0, 300.0, 125.0, 133.0, 141.0], "episode_lengths": [134, 151, 141, 137, 133, 127, 300, 125, 133, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379731960042636, "mean_inference_ms": 1.1883808083653142, "mean_action_processing_ms": 0.13939620918153237, "mean_env_wait_ms": 0.06069373334420462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.056281089782714844}}, "episode_reward_max": 300.0, "episode_reward_min": 125.0, "episode_reward_mean": 152.2, "episode_len_mean": 152.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 151.0, 141.0, 137.0, 133.0, 127.0, 300.0, 125.0, 133.0, 141.0], "episode_lengths": [134, 151, 141, 137, 133, 127, 300, 125, 133, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379731960042636, "mean_inference_ms": 1.1883808083653142, "mean_action_processing_ms": 0.13939620918153237, "mean_env_wait_ms": 0.06069373334420462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.056281089782714844}, "num_agent_steps_sampled_this_iter": 1522, "num_env_steps_sampled_this_iter": 1522, "timesteps_this_iter": 1522, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 42.54190444946289, "min_q": -4.303079605102539, "max_q": 50.279273986816406, "mean_td_error": 0.20400160551071167}, "td_error": [0.20879745483398438, 0.4879341125488281, 0.9806327819824219, 1.7378120422363281, 0.2377777099609375, 0.640380859375, -1.5458335876464844, -0.5968132019042969, 1.2853889465332031, 0.7392807006835938, 1.8928489685058594, 1.2259445190429688, 0.23469924926757812, -4.202678680419922, 0.47039031982421875, -0.6443557739257812, 0.2140960693359375, 0.8157310485839844, 0.38329315185546875, 0.26904296875, 1.0116615295410156, 0.6907577514648438, 0.3174018859863281, 0.3546333312988281, 1.4284896850585938, -5.303079605102539, -0.9521217346191406, 0.5509300231933594, 0.6598663330078125, 0.156280517578125, 1.3213005065917969, 1.4575614929199219], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3625, "diff_num_grad_updates_vs_sampler_policy": 3624}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "last_target_update_ts": 29736, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 176.29, "episode_len_mean": 176.29, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0], "episode_lengths": [197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9188820846267003, "mean_inference_ms": 2.1682367008870664, "mean_action_processing_ms": 0.22778614294347896, "mean_env_wait_ms": 0.11693186446312598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009392261505126953, "StateBufferConnector_ms": 0.006653308868408203, "ViewRequirementAgentConnector_ms": 0.1608278751373291}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 176.29, "episode_len_mean": 176.29, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [197.0, 92.0, 248.0, 202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0], "episode_lengths": [197, 92, 248, 202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9188820846267003, "mean_inference_ms": 2.1682367008870664, "mean_action_processing_ms": 0.22778614294347896, "mean_env_wait_ms": 0.11693186446312598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009392261505126953, "StateBufferConnector_ms": 0.006653308868408203, "ViewRequirementAgentConnector_ms": 0.1608278751373291}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.09533442637536, "num_env_steps_trained_throughput_per_sec": 1252.3813377055014, "timesteps_total": 30000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 25.301, "sample_time_ms": 9.306, "learn_time_ms": 2.846, "learn_throughput": 11244.406, "synch_weights_time_ms": 4.147}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "last_target_update_ts": 29736, "num_target_updates": 58}, "done": false, "episodes_total": 326, "training_iteration": 30, "trial_id": "default", "date": "2024-10-05_20-23-15", "timestamp": 1728152595, "time_this_iter_s": 4.313910961151123, "time_total_s": 163.30025959014893, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 163.30025959014893, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.06666666666666, "ram_util_percent": 90.26666666666667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 170.0, "episode_reward_min": 126.0, "episode_reward_mean": 141.9, "episode_len_mean": 141.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 126.0, 170.0, 141.0, 133.0, 128.0, 160.0, 138.0, 152.0, 130.0], "episode_lengths": [141, 126, 170, 141, 133, 128, 160, 138, 152, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37686098601854556, "mean_inference_ms": 1.1793779542687166, "mean_action_processing_ms": 0.1383139148309976, "mean_env_wait_ms": 0.06022324991653918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002727508544921875, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.05708932876586914}}, "episode_reward_max": 170.0, "episode_reward_min": 126.0, "episode_reward_mean": 141.9, "episode_len_mean": 141.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 126.0, 170.0, 141.0, 133.0, 128.0, 160.0, 138.0, 152.0, 130.0], "episode_lengths": [141, 126, 170, 141, 133, 128, 160, 138, 152, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37686098601854556, "mean_inference_ms": 1.1793779542687166, "mean_action_processing_ms": 0.1383139148309976, "mean_env_wait_ms": 0.06022324991653918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002727508544921875, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.05708932876586914}, "num_agent_steps_sampled_this_iter": 1419, "num_env_steps_sampled_this_iter": 1419, "timesteps_this_iter": 1419, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 40.81059265136719, "min_q": -3.422518730163574, "max_q": 51.25921630859375, "mean_td_error": 0.9317973852157593}, "td_error": [0.09146499633789062, 0.1995849609375, 0.0717926025390625, -0.24264144897460938, 0.11999702453613281, -0.2950325012207031, -0.17341995239257812, 1.0388755798339844, 0.10169601440429688, -0.024394989013671875, 2.7574493885040283, 0.4732704162597656, -4.422518730163574, -0.5434532165527344, -0.17545509338378906, -0.3107261657714844, -0.5662307739257812, -1.3193702697753906, 0.10156631469726562, -0.12096786499023438, -0.24423599243164062, -0.6789627075195312, 0.086822509765625, 0.2070159912109375, -0.2862739562988281, 22.923690795898438, -0.39165496826171875, -0.5118026733398438, 0.4690589904785156, -0.5737953186035156, 0.371978759765625, 11.684188842773438], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3750, "diff_num_grad_updates_vs_sampler_policy": 3749}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "last_target_update_ts": 30744, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 175.34, "episode_len_mean": 175.34, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0], "episode_lengths": [202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.918007367667297, "mean_inference_ms": 2.1657634339877685, "mean_action_processing_ms": 0.2277072286218292, "mean_env_wait_ms": 0.11688973215349006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009285688400268555, "StateBufferConnector_ms": 0.0065686702728271484, "ViewRequirementAgentConnector_ms": 0.15844392776489258}}, "episode_reward_max": 300.0, "episode_reward_min": 90.0, "episode_reward_mean": 175.34, "episode_len_mean": 175.34, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.0, 100.0, 90.0, 100.0, 178.0, 265.0, 287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0], "episode_lengths": [202, 100, 90, 100, 178, 265, 287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.918007367667297, "mean_inference_ms": 2.1657634339877685, "mean_action_processing_ms": 0.2277072286218292, "mean_env_wait_ms": 0.11688973215349006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009285688400268555, "StateBufferConnector_ms": 0.0065686702728271484, "ViewRequirementAgentConnector_ms": 0.15844392776489258}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.89783217477805, "num_env_steps_trained_throughput_per_sec": 1243.5913286991122, "timesteps_total": 31000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 25.76, "sample_time_ms": 9.361, "learn_time_ms": 2.868, "learn_throughput": 11158.774, "synch_weights_time_ms": 4.435}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "last_target_update_ts": 30744, "num_target_updates": 60}, "done": false, "episodes_total": 329, "training_iteration": 31, "trial_id": "default", "date": "2024-10-05_20-23-19", "timestamp": 1728152599, "time_this_iter_s": 4.158040285110474, "time_total_s": 167.4582998752594, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 167.4582998752594, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.41666666666667, "ram_util_percent": 90.39999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 125.0, "episode_reward_min": 95.0, "episode_reward_mean": 105.7, "episode_len_mean": 105.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.0, 108.0, 106.0, 110.0, 95.0, 105.0, 97.0, 98.0, 109.0, 104.0], "episode_lengths": [125, 108, 106, 110, 95, 105, 97, 98, 109, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750749224677408, "mean_inference_ms": 1.1737580400797767, "mean_action_processing_ms": 0.137617907052565, "mean_env_wait_ms": 0.059935887196682004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028252601623535156, "StateBufferConnector_ms": 0.0022268295288085938, "ViewRequirementAgentConnector_ms": 0.057218074798583984}}, "episode_reward_max": 125.0, "episode_reward_min": 95.0, "episode_reward_mean": 105.7, "episode_len_mean": 105.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.0, 108.0, 106.0, 110.0, 95.0, 105.0, 97.0, 98.0, 109.0, 104.0], "episode_lengths": [125, 108, 106, 110, 95, 105, 97, 98, 109, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750749224677408, "mean_inference_ms": 1.1737580400797767, "mean_action_processing_ms": 0.137617907052565, "mean_env_wait_ms": 0.059935887196682004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028252601623535156, "StateBufferConnector_ms": 0.0022268295288085938, "ViewRequirementAgentConnector_ms": 0.057218074798583984}, "num_agent_steps_sampled_this_iter": 1057, "num_env_steps_sampled_this_iter": 1057, "timesteps_this_iter": 1057, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 41.83856964111328, "min_q": -8.428592681884766, "max_q": 52.56599426269531, "mean_td_error": 1.2272589206695557}, "td_error": [-0.08150482177734375, -0.2659721374511719, -1.5135459899902344, -9.428592681884766, -0.07811355590820312, 0.193450927734375, -0.8061656951904297, -0.17425155639648438, -1.9966621398925781, -0.6629638671875, 0.28954315185546875, -1.4387741088867188, 5.051052093505859, -1.4289493560791016, 0.428619384765625, -0.2566566467285156, 2.61083984375, 38.27754592895508, -1.5399188995361328, 0.38240814208984375, -0.07145309448242188, -0.24687576293945312, 11.699987411499023, 0.5445938110351562, -1.063385009765625, 0.013996124267578125, -0.2064666748046875, 0.9994888305664062, -1.0110702514648438, 0.8129005432128906, 0.45766448974609375, -0.21847915649414062], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3875, "diff_num_grad_updates_vs_sampler_policy": 3874}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "last_target_update_ts": 31752, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 178.44, "episode_len_mean": 178.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0], "episode_lengths": [287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9155396756423062, "mean_inference_ms": 2.160027585689856, "mean_action_processing_ms": 0.22744283415307998, "mean_env_wait_ms": 0.11674236757254874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009169578552246094, "StateBufferConnector_ms": 0.006444692611694336, "ViewRequirementAgentConnector_ms": 0.15592098236083984}}, "episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 178.44, "episode_len_mean": 178.44, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [287.0, 169.0, 176.0, 177.0, 300.0, 300.0, 262.0, 300.0, 222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0], "episode_lengths": [287, 169, 176, 177, 300, 300, 262, 300, 222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9155396756423062, "mean_inference_ms": 2.160027585689856, "mean_action_processing_ms": 0.22744283415307998, "mean_env_wait_ms": 0.11674236757254874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009169578552246094, "StateBufferConnector_ms": 0.006444692611694336, "ViewRequirementAgentConnector_ms": 0.15592098236083984}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7448919425881, "num_env_steps_trained_throughput_per_sec": 1246.9795677703523, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 25.481, "sample_time_ms": 9.234, "learn_time_ms": 2.846, "learn_throughput": 11245.819, "synch_weights_time_ms": 4.339}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "last_target_update_ts": 31752, "num_target_updates": 62}, "done": false, "episodes_total": 335, "training_iteration": 32, "trial_id": "default", "date": "2024-10-05_20-23-23", "timestamp": 1728152603, "time_this_iter_s": 3.9442460536956787, "time_total_s": 171.40254592895508, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 171.40254592895508, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.93333333333333, "ram_util_percent": 90.35000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 136.0, "episode_reward_min": 106.0, "episode_reward_mean": 120.3, "episode_len_mean": 120.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 136.0, 128.0, 121.0, 117.0, 118.0, 128.0, 117.0, 118.0, 114.0], "episode_lengths": [106, 136, 128, 121, 117, 118, 128, 117, 118, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781926726475505, "mean_inference_ms": 1.1832247939396598, "mean_action_processing_ms": 0.13877590287228098, "mean_env_wait_ms": 0.06044255686531143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004315376281738281, "StateBufferConnector_ms": 0.0037980079650878906, "ViewRequirementAgentConnector_ms": 0.09835004806518555}}, "episode_reward_max": 136.0, "episode_reward_min": 106.0, "episode_reward_mean": 120.3, "episode_len_mean": 120.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 136.0, 128.0, 121.0, 117.0, 118.0, 128.0, 117.0, 118.0, 114.0], "episode_lengths": [106, 136, 128, 121, 117, 118, 128, 117, 118, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781926726475505, "mean_inference_ms": 1.1832247939396598, "mean_action_processing_ms": 0.13877590287228098, "mean_env_wait_ms": 0.06044255686531143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004315376281738281, "StateBufferConnector_ms": 0.0037980079650878906, "ViewRequirementAgentConnector_ms": 0.09835004806518555}, "num_agent_steps_sampled_this_iter": 1203, "num_env_steps_sampled_this_iter": 1203, "timesteps_this_iter": 1203, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 48.337669372558594, "min_q": 30.9617862701416, "max_q": 54.51972579956055, "mean_td_error": 0.3378452658653259}, "td_error": [0.18166732788085938, 1.4695968627929688, 0.16016769409179688, 0.5467796325683594, 1.9701728820800781, 0.8860130310058594, 0.7213897705078125, 0.16975021362304688, -0.5611953735351562, 0.2516212463378906, -0.01062774658203125, -0.08184051513671875, -0.322601318359375, 0.6624069213867188, 0.3266105651855469, 0.15512847900390625, -1.1548881530761719, -0.5792045593261719, -0.052043914794921875, 0.3487129211425781, 0.17494964599609375, 0.1493988037109375, -0.409759521484375, -0.08418655395507812, 0.8673934936523438, 1.439779281616211, 1.6467056274414062, 0.30683135986328125, -0.2858695983886719, -0.6524467468261719, 1.5201911926269531, 1.050445556640625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4000, "diff_num_grad_updates_vs_sampler_policy": 3999}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "last_target_update_ts": 32760, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 171.24, "episode_len_mean": 171.24, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0], "episode_lengths": [222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9131604007135812, "mean_inference_ms": 2.1539458892990395, "mean_action_processing_ms": 0.2269993149823609, "mean_env_wait_ms": 0.11653516143162962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009151935577392578, "StateBufferConnector_ms": 0.0064852237701416016, "ViewRequirementAgentConnector_ms": 0.15672969818115234}}, "episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 171.24, "episode_len_mean": 171.24, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [222.0, 199.0, 300.0, 300.0, 300.0, 300.0, 99.0, 97.0, 113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0], "episode_lengths": [222, 199, 300, 300, 300, 300, 99, 97, 113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9131604007135812, "mean_inference_ms": 2.1539458892990395, "mean_action_processing_ms": 0.2269993149823609, "mean_env_wait_ms": 0.11653516143162962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009151935577392578, "StateBufferConnector_ms": 0.0064852237701416016, "ViewRequirementAgentConnector_ms": 0.15672969818115234}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.5274907042272, "num_env_steps_trained_throughput_per_sec": 978.1099628169088, "timesteps_total": 33000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 43.876, "sample_time_ms": 15.939, "learn_time_ms": 4.863, "learn_throughput": 6580.01, "synch_weights_time_ms": 7.056}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "last_target_update_ts": 32760, "num_target_updates": 64}, "done": false, "episodes_total": 343, "training_iteration": 33, "trial_id": "default", "date": "2024-10-05_20-23-29", "timestamp": 1728152609, "time_this_iter_s": 5.516348123550415, "time_total_s": 176.9188940525055, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 176.9188940525055, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 33.7125, "ram_util_percent": 90.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 115.0, "episode_reward_mean": 220.9, "episode_len_mean": 220.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 183.0, 229.0, 174.0, 300.0, 184.0, 235.0, 198.0, 291.0, 300.0], "episode_lengths": [115, 183, 229, 174, 300, 184, 235, 198, 291, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814694909058173, "mean_inference_ms": 1.1926027246016047, "mean_action_processing_ms": 0.13999341716546915, "mean_env_wait_ms": 0.06098012570143736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190372467041016, "StateBufferConnector_ms": 0.0035047531127929688, "ViewRequirementAgentConnector_ms": 0.09283781051635742}}, "episode_reward_max": 300.0, "episode_reward_min": 115.0, "episode_reward_mean": 220.9, "episode_len_mean": 220.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 183.0, 229.0, 174.0, 300.0, 184.0, 235.0, 198.0, 291.0, 300.0], "episode_lengths": [115, 183, 229, 174, 300, 184, 235, 198, 291, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814694909058173, "mean_inference_ms": 1.1926027246016047, "mean_action_processing_ms": 0.13999341716546915, "mean_env_wait_ms": 0.06098012570143736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190372467041016, "StateBufferConnector_ms": 0.0035047531127929688, "ViewRequirementAgentConnector_ms": 0.09283781051635742}, "num_agent_steps_sampled_this_iter": 2209, "num_env_steps_sampled_this_iter": 2209, "timesteps_this_iter": 2209, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 46.775657653808594, "min_q": 10.599858283996582, "max_q": 55.8958740234375, "mean_td_error": 0.9230941534042358}, "td_error": [0.7257957458496094, 0.4015922546386719, 0.3510322570800781, 0.4600105285644531, 0.5752487182617188, 0.229461669921875, 0.5297737121582031, 0.4907188415527344, 0.38755035400390625, 0.14070892333984375, 0.5797691345214844, 1.8066673278808594, -0.041988372802734375, 0.7449226379394531, 0.48633575439453125, 0.6763076782226562, 0.2402496337890625, -0.08087921142578125, 1.0721778869628906, 0.3450965881347656, 0.09664535522460938, 0.6981010437011719, 0.7036895751953125, 0.6303863525390625, 2.3059234619140625, 10.112930297851562, 0.15035629272460938, 1.0051231384277344, 0.4779510498046875, 0.891754150390625, 1.0909843444824219, 1.2546157836914062], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4125, "diff_num_grad_updates_vs_sampler_policy": 4124}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "last_target_update_ts": 33768, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 163.33, "episode_len_mean": 163.33, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0], "episode_lengths": [113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9168905750369583, "mean_inference_ms": 2.1547088059288932, "mean_action_processing_ms": 0.22741349840257086, "mean_env_wait_ms": 0.11668802874895814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009485244750976562, "StateBufferConnector_ms": 0.006659030914306641, "ViewRequirementAgentConnector_ms": 0.16305208206176758}}, "episode_reward_max": 300.0, "episode_reward_min": 93.0, "episode_reward_mean": 163.33, "episode_len_mean": 163.33, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [113.0, 93.0, 173.0, 99.0, 160.0, 116.0, 121.0, 118.0, 126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0], "episode_lengths": [113, 93, 173, 99, 160, 116, 121, 118, 126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9168905750369583, "mean_inference_ms": 2.1547088059288932, "mean_action_processing_ms": 0.22741349840257086, "mean_env_wait_ms": 0.11668802874895814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009485244750976562, "StateBufferConnector_ms": 0.006659030914306641, "ViewRequirementAgentConnector_ms": 0.16305208206176758}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.63448229153, "num_env_steps_trained_throughput_per_sec": 758.53792916612, "timesteps_total": 34000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 42.922, "sample_time_ms": 15.444, "learn_time_ms": 4.613, "learn_throughput": 6937.141, "synch_weights_time_ms": 7.002}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "last_target_update_ts": 33768, "num_target_updates": 66}, "done": false, "episodes_total": 351, "training_iteration": 34, "trial_id": "default", "date": "2024-10-05_20-23-36", "timestamp": 1728152616, "time_this_iter_s": 7.576205492019653, "time_total_s": 184.49509954452515, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 184.49509954452515, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.054545454545455, "ram_util_percent": 90.23636363636365}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 114.0, "episode_reward_mean": 172.1, "episode_len_mean": 172.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, 128.0, 228.0, 114.0, 121.0, 122.0, 300.0, 293.0, 136.0, 136.0], "episode_lengths": [143, 128, 228, 114, 121, 122, 300, 293, 136, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38387171225889033, "mean_inference_ms": 1.2003122271586801, "mean_action_processing_ms": 0.14100810983078477, "mean_env_wait_ms": 0.06141636557896981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912448883056641, "StateBufferConnector_ms": 0.003993511199951172, "ViewRequirementAgentConnector_ms": 0.09008407592773438}}, "episode_reward_max": 300.0, "episode_reward_min": 114.0, "episode_reward_mean": 172.1, "episode_len_mean": 172.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, 128.0, 228.0, 114.0, 121.0, 122.0, 300.0, 293.0, 136.0, 136.0], "episode_lengths": [143, 128, 228, 114, 121, 122, 300, 293, 136, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38387171225889033, "mean_inference_ms": 1.2003122271586801, "mean_action_processing_ms": 0.14100810983078477, "mean_env_wait_ms": 0.06141636557896981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912448883056641, "StateBufferConnector_ms": 0.003993511199951172, "ViewRequirementAgentConnector_ms": 0.09008407592773438}, "num_agent_steps_sampled_this_iter": 1721, "num_env_steps_sampled_this_iter": 1721, "timesteps_this_iter": 1721, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 48.833534240722656, "min_q": 13.821043014526367, "max_q": 56.5877571105957, "mean_td_error": 1.0681819915771484}, "td_error": [-0.1111907958984375, 0.4263877868652344, 0.17448806762695312, 0.046142578125, 23.021217346191406, -0.060642242431640625, 0.4311027526855469, 0.16245651245117188, 12.821043014526367, -0.21196365356445312, -6.383241653442383, 0.138946533203125, 0.1065826416015625, 0.4579887390136719, 0.4276008605957031, 0.2741813659667969, 0.7874107360839844, 0.052639007568359375, -0.1906280517578125, 0.22987747192382812, 0.1137237548828125, 0.0745849609375, 1.0925865173339844, 0.00759124755859375, 0.12751007080078125, 0.045719146728515625, -0.079498291015625, -0.12669754028320312, -0.7902812957763672, 0.5718612670898438, 0.00994873046875, 0.5343742370605469], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4250, "diff_num_grad_updates_vs_sampler_policy": 4249}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "last_target_update_ts": 34776, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 163.05, "episode_len_mean": 163.05, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0], "episode_lengths": [126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9238951124793935, "mean_inference_ms": 2.1590406575860754, "mean_action_processing_ms": 0.22827085340008169, "mean_env_wait_ms": 0.11703481831255527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009897232055664062, "StateBufferConnector_ms": 0.0068416595458984375, "ViewRequirementAgentConnector_ms": 0.16828393936157227}}, "episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 163.05, "episode_len_mean": 163.05, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [126.0, 123.0, 152.0, 131.0, 254.0, 145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0], "episode_lengths": [126, 123, 152, 131, 254, 145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9238951124793935, "mean_inference_ms": 2.1590406575860754, "mean_action_processing_ms": 0.22827085340008169, "mean_env_wait_ms": 0.11703481831255527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009897232055664062, "StateBufferConnector_ms": 0.0068416595458984375, "ViewRequirementAgentConnector_ms": 0.16828393936157227}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.89724786210166, "num_env_steps_trained_throughput_per_sec": 759.5889914484067, "timesteps_total": 35000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 42.944, "sample_time_ms": 15.073, "learn_time_ms": 4.575, "learn_throughput": 6995.061, "synch_weights_time_ms": 7.163}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "last_target_update_ts": 34776, "num_target_updates": 68}, "done": false, "episodes_total": 359, "training_iteration": 35, "trial_id": "default", "date": "2024-10-05_20-23-44", "timestamp": 1728152624, "time_this_iter_s": 7.179219484329224, "time_total_s": 191.67431902885437, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 191.67431902885437, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.33, "ram_util_percent": 90.26999999999998}}
{"evaluation": {"sampler_results": {"episode_reward_max": 190.0, "episode_reward_min": 143.0, "episode_reward_mean": 165.8, "episode_len_mean": 165.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 165.0, 184.0, 152.0, 163.0, 178.0, 155.0, 143.0, 158.0, 170.0], "episode_lengths": [190, 165, 184, 152, 163, 178, 155, 143, 158, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640785457523175, "mean_inference_ms": 1.2075312271677776, "mean_action_processing_ms": 0.14189594700096747, "mean_env_wait_ms": 0.06182114088933645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004677772521972656, "StateBufferConnector_ms": 0.0035429000854492188, "ViewRequirementAgentConnector_ms": 0.09223461151123047}}, "episode_reward_max": 190.0, "episode_reward_min": 143.0, "episode_reward_mean": 165.8, "episode_len_mean": 165.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 165.0, 184.0, 152.0, 163.0, 178.0, 155.0, 143.0, 158.0, 170.0], "episode_lengths": [190, 165, 184, 152, 163, 178, 155, 143, 158, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640785457523175, "mean_inference_ms": 1.2075312271677776, "mean_action_processing_ms": 0.14189594700096747, "mean_env_wait_ms": 0.06182114088933645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004677772521972656, "StateBufferConnector_ms": 0.0035429000854492188, "ViewRequirementAgentConnector_ms": 0.09223461151123047}, "num_agent_steps_sampled_this_iter": 1658, "num_env_steps_sampled_this_iter": 1658, "timesteps_this_iter": 1658, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 45.731781005859375, "min_q": -4.127776145935059, "max_q": 57.08409881591797, "mean_td_error": 0.8992600440979004}, "td_error": [0.903228759765625, 0.33138275146484375, 0.22590255737304688, 0.36420440673828125, 0.2574043273925781, -0.8105392456054688, 0.45922088623046875, 0.4650154113769531, 10.694253921508789, -5.127776145935059, 0.10808563232421875, -0.07432937622070312, -0.385009765625, 0.4399871826171875, 0.28924560546875, 0.917022705078125, 0.3010215759277344, 0.8326950073242188, 0.6327400207519531, 0.22275161743164062, 0.6849288940429688, -0.08435821533203125, 0.6017303466796875, -0.31716156005859375, 0.16048431396484375, -0.07013702392578125, 0.268157958984375, 19.623268127441406, 0.5341567993164062, 0.1348724365234375, 0.810546875, -4.616675853729248], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4375, "diff_num_grad_updates_vs_sampler_policy": 4374}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "last_target_update_ts": 35784, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 164.83, "episode_len_mean": 164.83, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0], "episode_lengths": [145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9297334692202062, "mean_inference_ms": 2.1633299470949363, "mean_action_processing_ms": 0.22915794118391983, "mean_env_wait_ms": 0.11739339236149268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010071754455566406, "StateBufferConnector_ms": 0.007047414779663086, "ViewRequirementAgentConnector_ms": 0.17226791381835938}}, "episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 164.83, "episode_len_mean": 164.83, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 148.0, 166.0, 300.0, 300.0, 164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0], "episode_lengths": [145, 148, 166, 300, 300, 164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9297334692202062, "mean_inference_ms": 2.1633299470949363, "mean_action_processing_ms": 0.22915794118391983, "mean_env_wait_ms": 0.11739339236149268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010071754455566406, "StateBufferConnector_ms": 0.007047414779663086, "ViewRequirementAgentConnector_ms": 0.17226791381835938}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.9524455555505, "num_env_steps_trained_throughput_per_sec": 779.809782222202, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 41.837, "sample_time_ms": 14.931, "learn_time_ms": 4.44, "learn_throughput": 7207.521, "synch_weights_time_ms": 6.716}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "last_target_update_ts": 35784, "num_target_updates": 70}, "done": false, "episodes_total": 364, "training_iteration": 36, "trial_id": "default", "date": "2024-10-05_20-23-51", "timestamp": 1728152631, "time_this_iter_s": 6.894601821899414, "time_total_s": 198.56892085075378, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 198.56892085075378, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.18, "ram_util_percent": 90.03}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885084381017835, "mean_inference_ms": 1.214557684052741, "mean_action_processing_ms": 0.14280360012947407, "mean_env_wait_ms": 0.06218825740764675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005013942718505859, "StateBufferConnector_ms": 0.003383159637451172, "ViewRequirementAgentConnector_ms": 0.08395195007324219}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885084381017835, "mean_inference_ms": 1.214557684052741, "mean_action_processing_ms": 0.14280360012947407, "mean_env_wait_ms": 0.06218825740764675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005013942718505859, "StateBufferConnector_ms": 0.003383159637451172, "ViewRequirementAgentConnector_ms": 0.08395195007324219}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 48.24951171875, "min_q": 12.495458602905273, "max_q": 57.3867301940918, "mean_td_error": 0.3406826853752136}, "td_error": [-0.06252670288085938, -0.7789382934570312, -0.12770843505859375, -1.3349952697753906, -0.8875770568847656, 7.640899658203125, -0.5684738159179688, -1.3886833190917969, -0.45722198486328125, -0.3186073303222656, -0.24855422973632812, -0.0548248291015625, -0.5215568542480469, -0.9045257568359375, 21.352235794067383, -0.4095039367675781, -0.7972679138183594, 0.037181854248046875, -1.0259819030761719, -0.6090431213378906, -0.523681640625, 0.04224395751953125, -0.0430450439453125, -0.9037933349609375, -1.3707313537597656, -1.4205818176269531, -1.09661865234375, -0.7803993225097656, -0.7375755310058594, -0.25272369384765625, -1.4547920227050781, 0.9092178344726562], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4500, "diff_num_grad_updates_vs_sampler_policy": 4499}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "last_target_update_ts": 36792, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 163.4, "episode_len_mean": 163.4, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0], "episode_lengths": [164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9324900846107058, "mean_inference_ms": 2.1638854686021776, "mean_action_processing_ms": 0.2293360285451037, "mean_env_wait_ms": 0.11747748076774074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009964942932128906, "StateBufferConnector_ms": 0.007041454315185547, "ViewRequirementAgentConnector_ms": 0.17194271087646484}}, "episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 163.4, "episode_len_mean": 163.4, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [164.0, 300.0, 165.0, 300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0], "episode_lengths": [164, 300, 165, 300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9324900846107058, "mean_inference_ms": 2.1638854686021776, "mean_action_processing_ms": 0.2293360285451037, "mean_env_wait_ms": 0.11747748076774074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009964942932128906, "StateBufferConnector_ms": 0.007041454315185547, "ViewRequirementAgentConnector_ms": 0.17194271087646484}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.02594384044102, "num_env_steps_trained_throughput_per_sec": 784.1037753617641, "timesteps_total": 37000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 42.559, "sample_time_ms": 15.174, "learn_time_ms": 4.573, "learn_throughput": 6998.343, "synch_weights_time_ms": 6.834}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "last_target_update_ts": 36792, "num_target_updates": 72}, "done": false, "episodes_total": 369, "training_iteration": 37, "trial_id": "default", "date": "2024-10-05_20-23-59", "timestamp": 1728152639, "time_this_iter_s": 8.125997066497803, "time_total_s": 206.6949179172516, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 206.6949179172516, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.309090909090905, "ram_util_percent": 89.89999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 173.0, "episode_reward_min": 107.0, "episode_reward_mean": 118.2, "episode_len_mean": 118.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.0, 118.0, 107.0, 108.0, 109.0, 116.0, 114.0, 120.0, 110.0, 107.0], "episode_lengths": [173, 118, 107, 108, 109, 116, 114, 120, 110, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39034730137959317, "mean_inference_ms": 1.2195946422671802, "mean_action_processing_ms": 0.14340197051895895, "mean_env_wait_ms": 0.06245032716297018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043392181396484375, "StateBufferConnector_ms": 0.0035834312438964844, "ViewRequirementAgentConnector_ms": 0.09196758270263672}}, "episode_reward_max": 173.0, "episode_reward_min": 107.0, "episode_reward_mean": 118.2, "episode_len_mean": 118.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.0, 118.0, 107.0, 108.0, 109.0, 116.0, 114.0, 120.0, 110.0, 107.0], "episode_lengths": [173, 118, 107, 108, 109, 116, 114, 120, 110, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39034730137959317, "mean_inference_ms": 1.2195946422671802, "mean_action_processing_ms": 0.14340197051895895, "mean_env_wait_ms": 0.06245032716297018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043392181396484375, "StateBufferConnector_ms": 0.0035834312438964844, "ViewRequirementAgentConnector_ms": 0.09196758270263672}, "num_agent_steps_sampled_this_iter": 1182, "num_env_steps_sampled_this_iter": 1182, "timesteps_this_iter": 1182, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 41.436767578125, "min_q": -9.819689750671387, "max_q": 59.81954574584961, "mean_td_error": 1.2451281547546387}, "td_error": [0.24276351928710938, -0.1280517578125, -0.2461700439453125, -1.9177360534667969, -1.3293952941894531, -0.07317733764648438, -0.4713287353515625, 0.6998634338378906, 0.0660400390625, 15.056790351867676, -0.09700775146484375, -7.848758697509766, -0.13508987426757812, 0.10512542724609375, 3.36871337890625, 0.15793991088867188, 0.2942543029785156, -1.5117721557617188, 0.19769668579101562, 17.3256778717041, 0.10436248779296875, 17.91138458251953, -0.19447708129882812, -1.945688247680664, -0.0433197021484375, 0.3492755889892578, 0.181610107421875, -0.2287750244140625, -0.8182411193847656, 0.48336029052734375, 0.2488574981689453, 0.039371490478515625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4625, "diff_num_grad_updates_vs_sampler_policy": 4624}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "last_target_update_ts": 37800, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 162.27, "episode_len_mean": 162.27, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0], "episode_lengths": [300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.934007657613352, "mean_inference_ms": 2.164790551932397, "mean_action_processing_ms": 0.229348551540028, "mean_env_wait_ms": 0.11747404155701581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01007843017578125, "StateBufferConnector_ms": 0.0070531368255615234, "ViewRequirementAgentConnector_ms": 0.17286014556884766}}, "episode_reward_max": 300.0, "episode_reward_min": 99.0, "episode_reward_mean": 162.27, "episode_len_mean": 162.27, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 295.0, 300.0, 250.0, 300.0, 300.0, 300.0, 300.0, 300.0, 128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0], "episode_lengths": [300, 300, 295, 300, 250, 300, 300, 300, 300, 300, 128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.934007657613352, "mean_inference_ms": 2.164790551932397, "mean_action_processing_ms": 0.229348551540028, "mean_env_wait_ms": 0.11747404155701581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01007843017578125, "StateBufferConnector_ms": 0.0070531368255615234, "ViewRequirementAgentConnector_ms": 0.17286014556884766}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.2667748785319, "num_env_steps_trained_throughput_per_sec": 785.0670995141276, "timesteps_total": 38000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 41.764, "sample_time_ms": 15.15, "learn_time_ms": 4.464, "learn_throughput": 7168.142, "synch_weights_time_ms": 6.872}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "last_target_update_ts": 37800, "num_target_updates": 74}, "done": false, "episodes_total": 372, "training_iteration": 38, "trial_id": "default", "date": "2024-10-05_20-24-05", "timestamp": 1728152645, "time_this_iter_s": 6.369030237197876, "time_total_s": 213.06394815444946, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 213.06394815444946, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.63333333333334, "ram_util_percent": 90.03333333333335}}
{"evaluation": {"sampler_results": {"episode_reward_max": 117.0, "episode_reward_min": 97.0, "episode_reward_mean": 104.8, "episode_len_mean": 104.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 100.0, 111.0, 99.0, 105.0, 109.0, 117.0, 100.0, 97.0, 112.0], "episode_lengths": [98, 100, 111, 99, 105, 109, 117, 100, 97, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3920977245305407, "mean_inference_ms": 1.2241777757825765, "mean_action_processing_ms": 0.14396672541715674, "mean_env_wait_ms": 0.06271663464997944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004863739013671875, "StateBufferConnector_ms": 0.003945827484130859, "ViewRequirementAgentConnector_ms": 0.09343147277832031}}, "episode_reward_max": 117.0, "episode_reward_min": 97.0, "episode_reward_mean": 104.8, "episode_len_mean": 104.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 100.0, 111.0, 99.0, 105.0, 109.0, 117.0, 100.0, 97.0, 112.0], "episode_lengths": [98, 100, 111, 99, 105, 109, 117, 100, 97, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3920977245305407, "mean_inference_ms": 1.2241777757825765, "mean_action_processing_ms": 0.14396672541715674, "mean_env_wait_ms": 0.06271663464997944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004863739013671875, "StateBufferConnector_ms": 0.003945827484130859, "ViewRequirementAgentConnector_ms": 0.09343147277832031}, "num_agent_steps_sampled_this_iter": 1048, "num_env_steps_sampled_this_iter": 1048, "timesteps_this_iter": 1048, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 51.12096405029297, "min_q": 12.253498077392578, "max_q": 61.58401107788086, "mean_td_error": 1.095141887664795}, "td_error": [0.5344619750976562, 0.3685111999511719, -0.2757720947265625, 0.5700759887695312, -1.1450881958007812, -0.5344467163085938, 0.4228782653808594, -0.180755615234375, 0.18083953857421875, 0.30150604248046875, -6.641700744628906, -0.5222282409667969, -1.587249755859375, 0.12576675415039062, 0.026309967041015625, 0.7498054504394531, 0.018581390380859375, 31.163238525390625, -1.7939987182617188, -0.5948448181152344, 9.432388305664062, 0.5321121215820312, 0.19977569580078125, -0.4996070861816406, -0.22539520263671875, 3.3401269912719727, 0.6552047729492188, 0.09132003784179688, 0.6226844787597656, 0.09732437133789062, -0.6214828491210938, 0.23419952392578125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4750, "diff_num_grad_updates_vs_sampler_policy": 4749}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "last_target_update_ts": 38808, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 151.19, "episode_len_mean": 151.19, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0], "episode_lengths": [128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9391717523468346, "mean_inference_ms": 2.167662013772417, "mean_action_processing_ms": 0.23011672149512288, "mean_env_wait_ms": 0.11779086480257642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010181427001953125, "StateBufferConnector_ms": 0.007099628448486328, "ViewRequirementAgentConnector_ms": 0.17383146286010742}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 151.19, "episode_len_mean": 151.19, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [128.0, 300.0, 153.0, 132.0, 142.0, 156.0, 107.0, 124.0, 109.0, 107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0], "episode_lengths": [128, 300, 153, 132, 142, 156, 107, 124, 109, 107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9391717523468346, "mean_inference_ms": 2.167662013772417, "mean_action_processing_ms": 0.23011672149512288, "mean_env_wait_ms": 0.11779086480257642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010181427001953125, "StateBufferConnector_ms": 0.007099628448486328, "ViewRequirementAgentConnector_ms": 0.17383146286010742}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.1612072722825, "num_env_steps_trained_throughput_per_sec": 772.64482908913, "timesteps_total": 39000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 44.75, "sample_time_ms": 16.307, "learn_time_ms": 4.623, "learn_throughput": 6921.187, "synch_weights_time_ms": 7.019}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "last_target_update_ts": 38808, "num_target_updates": 76}, "done": false, "episodes_total": 382, "training_iteration": 39, "trial_id": "default", "date": "2024-10-05_20-24-11", "timestamp": 1728152651, "time_this_iter_s": 6.3545918464660645, "time_total_s": 219.41854000091553, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 219.41854000091553, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 36.599999999999994, "ram_util_percent": 90.10000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 180.0, "episode_reward_min": 120.0, "episode_reward_mean": 165.8, "episode_len_mean": 165.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 161.0, 167.0, 178.0, 177.0, 172.0, 172.0, 177.0, 154.0, 180.0], "episode_lengths": [120, 161, 167, 178, 177, 172, 172, 177, 154, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38913022802011593, "mean_inference_ms": 1.215232118965663, "mean_action_processing_ms": 0.14290829675075695, "mean_env_wait_ms": 0.06225282838750067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003025531768798828, "StateBufferConnector_ms": 0.002200603485107422, "ViewRequirementAgentConnector_ms": 0.057599544525146484}}, "episode_reward_max": 180.0, "episode_reward_min": 120.0, "episode_reward_mean": 165.8, "episode_len_mean": 165.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 161.0, 167.0, 178.0, 177.0, 172.0, 172.0, 177.0, 154.0, 180.0], "episode_lengths": [120, 161, 167, 178, 177, 172, 172, 177, 154, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38913022802011593, "mean_inference_ms": 1.215232118965663, "mean_action_processing_ms": 0.14290829675075695, "mean_env_wait_ms": 0.06225282838750067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003025531768798828, "StateBufferConnector_ms": 0.002200603485107422, "ViewRequirementAgentConnector_ms": 0.057599544525146484}, "num_agent_steps_sampled_this_iter": 1658, "num_env_steps_sampled_this_iter": 1658, "timesteps_this_iter": 1658, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 48.765533447265625, "min_q": 19.406545639038086, "max_q": 62.00851821899414, "mean_td_error": 1.178091287612915}, "td_error": [0.21233367919921875, 18.406545639038086, -1.3839073181152344, -0.33817291259765625, -0.3827400207519531, -2.709657669067383, 26.633346557617188, 0.2168121337890625, -0.2105865478515625, -0.275177001953125, 0.8068351745605469, -0.4152183532714844, 3.951923370361328, -1.1830577850341797, -0.44443511962890625, -2.1801986694335938, 0.2314300537109375, 0.13210296630859375, -0.5128211975097656, -0.4400672912597656, -0.20006179809570312, 0.054264068603515625, 0.05521392822265625, 0.3965721130371094, -0.1920928955078125, -0.16448211669921875, -0.3822669982910156, -0.21567153930664062, -0.33683013916015625, -0.5048370361328125, -0.9519004821777344, 0.025726318359375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4875, "diff_num_grad_updates_vs_sampler_policy": 4874}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "last_target_update_ts": 39816, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 147.63, "episode_len_mean": 147.63, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0], "episode_lengths": [107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9413974982553805, "mean_inference_ms": 2.1679095669189485, "mean_action_processing_ms": 0.23039120146587272, "mean_env_wait_ms": 0.11789624651735338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010366201400756836, "StateBufferConnector_ms": 0.00705718994140625, "ViewRequirementAgentConnector_ms": 0.17312049865722656}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 147.63, "episode_len_mean": 147.63, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [107.0, 111.0, 106.0, 111.0, 109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0], "episode_lengths": [107, 111, 106, 111, 109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9413974982553805, "mean_inference_ms": 2.1679095669189485, "mean_action_processing_ms": 0.23039120146587272, "mean_env_wait_ms": 0.11789624651735338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010366201400756836, "StateBufferConnector_ms": 0.00705718994140625, "ViewRequirementAgentConnector_ms": 0.17312049865722656}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.69268726289144, "num_env_steps_trained_throughput_per_sec": 790.7707490515658, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 35.427, "sample_time_ms": 13.575, "learn_time_ms": 3.571, "learn_throughput": 8961.47, "synch_weights_time_ms": 5.439}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "last_target_update_ts": 39816, "num_target_updates": 78}, "done": false, "episodes_total": 391, "training_iteration": 40, "trial_id": "default", "date": "2024-10-05_20-24-18", "timestamp": 1728152658, "time_this_iter_s": 6.24878716468811, "time_total_s": 225.66732716560364, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 225.66732716560364, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.94444444444444, "ram_util_percent": 90.21111111111111}}
{"evaluation": {"sampler_results": {"episode_reward_max": 195.0, "episode_reward_min": 170.0, "episode_reward_mean": 180.8, "episode_len_mean": 180.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.0, 195.0, 180.0, 178.0, 186.0, 171.0, 177.0, 186.0, 178.0, 170.0], "episode_lengths": [187, 195, 180, 178, 186, 171, 177, 186, 178, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859997860328504, "mean_inference_ms": 1.2056629363667137, "mean_action_processing_ms": 0.1417334458234112, "mean_env_wait_ms": 0.0617519861841684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.05450248718261719}}, "episode_reward_max": 195.0, "episode_reward_min": 170.0, "episode_reward_mean": 180.8, "episode_len_mean": 180.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.0, 195.0, 180.0, 178.0, 186.0, 171.0, 177.0, 186.0, 178.0, 170.0], "episode_lengths": [187, 195, 180, 178, 186, 171, 177, 186, 178, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859997860328504, "mean_inference_ms": 1.2056629363667137, "mean_action_processing_ms": 0.1417334458234112, "mean_env_wait_ms": 0.0617519861841684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.05450248718261719}, "num_agent_steps_sampled_this_iter": 1808, "num_env_steps_sampled_this_iter": 1808, "timesteps_this_iter": 1808, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 55.016876220703125, "min_q": 18.368005752563477, "max_q": 63.426876068115234, "mean_td_error": 0.5240132808685303}, "td_error": [0.6524505615234375, 0.07007980346679688, 0.5690116882324219, -4.110260009765625, 0.6021881103515625, 0.21172332763671875, 0.041900634765625, -2.153827667236328, 0.7655143737792969, 0.05561065673828125, 0.060543060302734375, -0.05834197998046875, -0.09883499145507812, 0.9316215515136719, 0.7377471923828125, 1.0623245239257812, 0.389068603515625, -0.24509811401367188, 15.26320743560791, 0.9304656982421875, 0.09946060180664062, -1.0773200988769531, 2.5698318481445312, 0.30789947509765625, -0.4981689453125, 0.20045089721679688, -0.5846061706542969, -0.6941337585449219, 0.6166343688964844, 0.02629852294921875, -0.0082550048828125, 0.13323974609375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5000, "diff_num_grad_updates_vs_sampler_policy": 4999}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "last_target_update_ts": 40824, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 149.74, "episode_len_mean": 149.74, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0], "episode_lengths": [109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9406807398580181, "mean_inference_ms": 2.1661712253032834, "mean_action_processing_ms": 0.2301607436906794, "mean_env_wait_ms": 0.11779986037472766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01024627685546875, "StateBufferConnector_ms": 0.006939888000488281, "ViewRequirementAgentConnector_ms": 0.16974806785583496}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 149.74, "episode_len_mean": 149.74, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.0, 104.0, 100.0, 126.0, 129.0, 113.0, 146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0], "episode_lengths": [109, 104, 100, 126, 129, 113, 146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9406807398580181, "mean_inference_ms": 2.1661712253032834, "mean_action_processing_ms": 0.2301607436906794, "mean_env_wait_ms": 0.11779986037472766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01024627685546875, "StateBufferConnector_ms": 0.006939888000488281, "ViewRequirementAgentConnector_ms": 0.16974806785583496}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7722475653636, "num_env_steps_trained_throughput_per_sec": 1259.0889902614545, "timesteps_total": 41000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 25.479, "sample_time_ms": 9.082, "learn_time_ms": 2.811, "learn_throughput": 11382.004, "synch_weights_time_ms": 4.324}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "last_target_update_ts": 40824, "num_target_updates": 80}, "done": false, "episodes_total": 395, "training_iteration": 41, "trial_id": "default", "date": "2024-10-05_20-24-22", "timestamp": 1728152662, "time_this_iter_s": 4.3715291023254395, "time_total_s": 230.03885626792908, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 230.03885626792908, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.32857142857143, "ram_util_percent": 90.29999999999998}}
{"evaluation": {"sampler_results": {"episode_reward_max": 235.0, "episode_reward_min": 176.0, "episode_reward_mean": 213.9, "episode_len_mean": 213.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 217.0, 235.0, 226.0, 217.0, 217.0, 210.0, 217.0, 211.0, 213.0], "episode_lengths": [176, 217, 235, 226, 217, 217, 210, 217, 211, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38244166388464185, "mean_inference_ms": 1.1951729275398963, "mean_action_processing_ms": 0.14044346216592823, "mean_env_wait_ms": 0.061204535522912475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029206275939941406, "StateBufferConnector_ms": 0.0021791458129882812, "ViewRequirementAgentConnector_ms": 0.05440473556518555}}, "episode_reward_max": 235.0, "episode_reward_min": 176.0, "episode_reward_mean": 213.9, "episode_len_mean": 213.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 217.0, 235.0, 226.0, 217.0, 217.0, 210.0, 217.0, 211.0, 213.0], "episode_lengths": [176, 217, 235, 226, 217, 217, 210, 217, 211, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38244166388464185, "mean_inference_ms": 1.1951729275398963, "mean_action_processing_ms": 0.14044346216592823, "mean_env_wait_ms": 0.061204535522912475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029206275939941406, "StateBufferConnector_ms": 0.0021791458129882812, "ViewRequirementAgentConnector_ms": 0.05440473556518555}, "num_agent_steps_sampled_this_iter": 2139, "num_env_steps_sampled_this_iter": 2139, "timesteps_this_iter": 2139, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 52.89155578613281, "min_q": 23.577125549316406, "max_q": 64.41460418701172, "mean_td_error": 1.8248374462127686}, "td_error": [0.037128448486328125, 0.5430755615234375, 0.005306243896484375, 0.42221832275390625, 0.05886077880859375, 0.16572952270507812, 1.1597957611083984, -0.19072341918945312, 27.390485763549805, -0.15027618408203125, -0.3073005676269531, -0.5191879272460938, -0.013896942138671875, -0.115570068359375, -0.7363357543945312, 27.390485763549805, 0.21722412109375, 0.8298416137695312, -0.551483154296875, 2.633859634399414, 0.3732032775878906, -0.17079544067382812, 0.18107986450195312, -0.5185623168945312, -0.08141708374023438, -0.06438446044921875, 0.42577362060546875, -0.3986320495605469, 0.07785797119140625, 0.35953330993652344, -0.5828704833984375, 0.5247764587402344], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5125, "diff_num_grad_updates_vs_sampler_policy": 5124}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "last_target_update_ts": 41832, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 152.77, "episode_len_mean": 152.77, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0], "episode_lengths": [146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9415525560566913, "mean_inference_ms": 2.16635061640744, "mean_action_processing_ms": 0.2302504104032482, "mean_env_wait_ms": 0.11781425318019029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01000523567199707, "StateBufferConnector_ms": 0.006762504577636719, "ViewRequirementAgentConnector_ms": 0.1658799648284912}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 152.77, "episode_len_mean": 152.77, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [146.0, 131.0, 141.0, 140.0, 153.0, 153.0, 186.0, 142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0], "episode_lengths": [146, 131, 141, 140, 153, 153, 186, 142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9415525560566913, "mean_inference_ms": 2.16635061640744, "mean_action_processing_ms": 0.2302504104032482, "mean_env_wait_ms": 0.11781425318019029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01000523567199707, "StateBufferConnector_ms": 0.006762504577636719, "ViewRequirementAgentConnector_ms": 0.1658799648284912}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.6810424115635, "num_env_steps_trained_throughput_per_sec": 1258.724169646254, "timesteps_total": 42000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 25.233, "sample_time_ms": 9.293, "learn_time_ms": 2.764, "learn_throughput": 11578.978, "synch_weights_time_ms": 4.169}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "last_target_update_ts": 41832, "num_target_updates": 82}, "done": false, "episodes_total": 401, "training_iteration": 42, "trial_id": "default", "date": "2024-10-05_20-24-27", "timestamp": 1728152667, "time_this_iter_s": 4.636886119842529, "time_total_s": 234.6757423877716, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 234.6757423877716, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.78333333333333, "ram_util_percent": 90.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777394075995817, "mean_inference_ms": 1.1814885336010863, "mean_action_processing_ms": 0.13877498264469532, "mean_env_wait_ms": 0.060478562910567114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003440380096435547, "StateBufferConnector_ms": 0.002167224884033203, "ViewRequirementAgentConnector_ms": 0.05793571472167969}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777394075995817, "mean_inference_ms": 1.1814885336010863, "mean_action_processing_ms": 0.13877498264469532, "mean_env_wait_ms": 0.060478562910567114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003440380096435547, "StateBufferConnector_ms": 0.002167224884033203, "ViewRequirementAgentConnector_ms": 0.05793571472167969}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 54.721492767333984, "min_q": 6.556591033935547, "max_q": 65.0015869140625, "mean_td_error": 2.4399056434631348}, "td_error": [-0.052825927734375, -0.7095756530761719, -0.3363380432128906, -0.616455078125, 0.9040069580078125, 18.97016143798828, -0.04302215576171875, 0.28583526611328125, -0.9038925170898438, -3.066761016845703, -0.13552093505859375, -0.17957305908203125, -0.0022125244140625, 0.10152053833007812, 0.0476226806640625, -0.9221878051757812, 5.111177921295166, -1.1851081848144531, 0.2926177978515625, 5.759307861328125, 1.479095458984375, -0.3708534240722656, -0.46019744873046875, -0.4747810363769531, -0.8163795471191406, -0.72564697265625, -0.5006141662597656, -0.8855628967285156, 3.7643203735351562, 0.3880653381347656, 53.555850982666016, -0.19509124755859375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5250, "diff_num_grad_updates_vs_sampler_policy": 5249}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "last_target_update_ts": 42840, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 154.21, "episode_len_mean": 154.21, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0], "episode_lengths": [142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9395429393484802, "mean_inference_ms": 2.162556553907692, "mean_action_processing_ms": 0.22994595546137223, "mean_env_wait_ms": 0.11769973856205908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010045051574707031, "StateBufferConnector_ms": 0.0067288875579833984, "ViewRequirementAgentConnector_ms": 0.1650676727294922}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 154.21, "episode_len_mean": 154.21, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0], "episode_lengths": [142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9395429393484802, "mean_inference_ms": 2.162556553907692, "mean_action_processing_ms": 0.22994595546137223, "mean_env_wait_ms": 0.11769973856205908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010045051574707031, "StateBufferConnector_ms": 0.0067288875579833984, "ViewRequirementAgentConnector_ms": 0.1650676727294922}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.52858956175027, "num_env_steps_trained_throughput_per_sec": 1250.114358247001, "timesteps_total": 43000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 25.578, "sample_time_ms": 9.314, "learn_time_ms": 2.873, "learn_throughput": 11137.199, "synch_weights_time_ms": 4.197}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "last_target_update_ts": 42840, "num_target_updates": 84}, "done": false, "episodes_total": 408, "training_iteration": 43, "trial_id": "default", "date": "2024-10-05_20-24-32", "timestamp": 1728152672, "time_this_iter_s": 5.18374490737915, "time_total_s": 239.85948729515076, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 239.85948729515076, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.925, "ram_util_percent": 90.375}}
{"evaluation": {"sampler_results": {"episode_reward_max": 255.0, "episode_reward_min": 129.0, "episode_reward_mean": 145.4, "episode_len_mean": 145.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.0, 135.0, 139.0, 132.0, 129.0, 133.0, 133.0, 134.0, 129.0, 135.0], "episode_lengths": [255, 135, 139, 132, 129, 133, 133, 134, 129, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761970898678254, "mean_inference_ms": 1.1763469967224096, "mean_action_processing_ms": 0.13813470901910357, "mean_env_wait_ms": 0.0602088658697015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003032684326171875, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.05729198455810547}}, "episode_reward_max": 255.0, "episode_reward_min": 129.0, "episode_reward_mean": 145.4, "episode_len_mean": 145.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.0, 135.0, 139.0, 132.0, 129.0, 133.0, 133.0, 134.0, 129.0, 135.0], "episode_lengths": [255, 135, 139, 132, 129, 133, 133, 134, 129, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761970898678254, "mean_inference_ms": 1.1763469967224096, "mean_action_processing_ms": 0.13813470901910357, "mean_env_wait_ms": 0.0602088658697015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003032684326171875, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.05729198455810547}, "num_agent_steps_sampled_this_iter": 1454, "num_env_steps_sampled_this_iter": 1454, "timesteps_this_iter": 1454, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 52.356590270996094, "min_q": -11.311655044555664, "max_q": 65.67886352539062, "mean_td_error": -0.38181591033935547}, "td_error": [-5.500282287597656, -0.559417724609375, 0.033649444580078125, -0.8751029968261719, -0.44150543212890625, -0.7125625610351562, -0.14588546752929688, -0.1281890869140625, -0.07820892333984375, -0.45407867431640625, -0.226654052734375, -0.8710594177246094, 0.0406341552734375, -0.02732086181640625, -0.11762237548828125, -0.1687469482421875, -0.45317649841308594, 15.173913955688477, -0.743377685546875, -0.34688568115234375, -0.743377685546875, -0.9650516510009766, -1.0620651245117188, -0.2147369384765625, 2.462860107421875, -0.30394744873046875, -12.311655044555664, -0.17238616943359375, -0.5828018188476562, -0.9774627685546875, -0.16381072998046875, -0.5817947387695312], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5375, "diff_num_grad_updates_vs_sampler_policy": 5374}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "last_target_update_ts": 43848, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 154.21, "episode_len_mean": 154.21, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0], "episode_lengths": [142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9395429393484802, "mean_inference_ms": 2.162556553907692, "mean_action_processing_ms": 0.22994595546137223, "mean_env_wait_ms": 0.11769973856205908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010045051574707031, "StateBufferConnector_ms": 0.0067288875579833984, "ViewRequirementAgentConnector_ms": 0.1650676727294922}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 154.21, "episode_len_mean": 154.21, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [142.0, 151.0, 180.0, 175.0, 136.0, 131.0, 137.0, 216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0], "episode_lengths": [142, 151, 180, 175, 136, 131, 137, 216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9395429393484802, "mean_inference_ms": 2.162556553907692, "mean_action_processing_ms": 0.22994595546137223, "mean_env_wait_ms": 0.11769973856205908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010045051574707031, "StateBufferConnector_ms": 0.0067288875579833984, "ViewRequirementAgentConnector_ms": 0.1650676727294922}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.05680301856245, "num_env_steps_trained_throughput_per_sec": 1248.2272120742498, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 25.532, "sample_time_ms": 9.514, "learn_time_ms": 2.772, "learn_throughput": 11545.909, "synch_weights_time_ms": 4.254}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "last_target_update_ts": 43848, "num_target_updates": 86}, "done": false, "episodes_total": 408, "training_iteration": 44, "trial_id": "default", "date": "2024-10-05_20-24-36", "timestamp": 1728152676, "time_this_iter_s": 4.124172925949097, "time_total_s": 243.98366022109985, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 243.98366022109985, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 36.760000000000005, "ram_util_percent": 90.47999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 167.0, "episode_reward_min": 151.0, "episode_reward_mean": 156.1, "episode_len_mean": 156.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.0, 153.0, 151.0, 156.0, 159.0, 158.0, 157.0, 151.0, 157.0, 167.0], "episode_lengths": [152, 153, 151, 156, 159, 158, 157, 151, 157, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37414168524587843, "mean_inference_ms": 1.1700006757124932, "mean_action_processing_ms": 0.13738497533751598, "mean_env_wait_ms": 0.05988368351481669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027036666870117188, "StateBufferConnector_ms": 0.0024008750915527344, "ViewRequirementAgentConnector_ms": 0.05652904510498047}}, "episode_reward_max": 167.0, "episode_reward_min": 151.0, "episode_reward_mean": 156.1, "episode_len_mean": 156.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.0, 153.0, 151.0, 156.0, 159.0, 158.0, 157.0, 151.0, 157.0, 167.0], "episode_lengths": [152, 153, 151, 156, 159, 158, 157, 151, 157, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37414168524587843, "mean_inference_ms": 1.1700006757124932, "mean_action_processing_ms": 0.13738497533751598, "mean_env_wait_ms": 0.05988368351481669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027036666870117188, "StateBufferConnector_ms": 0.0024008750915527344, "ViewRequirementAgentConnector_ms": 0.05652904510498047}, "num_agent_steps_sampled_this_iter": 1561, "num_env_steps_sampled_this_iter": 1561, "timesteps_this_iter": 1561, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 51.24128723144531, "min_q": -5.0885725021362305, "max_q": 66.60102081298828, "mean_td_error": -0.9751801490783691}, "td_error": [-2.6017379760742188, -5.211845397949219, -12.014717102050781, -1.0096359252929688, -0.5776214599609375, -0.4011421203613281, -0.3374519348144531, -0.1457061767578125, -1.013946533203125, -1.3274917602539062, -0.5208511352539062, -0.8016815185546875, -6.609615325927734, -2.2014198303222656, -0.228057861328125, -3.422870635986328, -0.5639801025390625, -9.337963104248047, 5.619263648986816, -0.700714111328125, -0.7761611938476562, -0.20833587646484375, -0.8938827514648438, -1.04425048828125, 18.104843139648438, -1.0585365295410156, -1.1102523803710938, -0.12549591064453125, 0.00228118896484375, -0.3131103515625, -0.6980972290039062, 0.3244209289550781], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5500, "diff_num_grad_updates_vs_sampler_policy": 5499}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "last_target_update_ts": 44856, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 164.17, "episode_len_mean": 164.17, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0], "episode_lengths": [216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9368739271299642, "mean_inference_ms": 2.158211794922474, "mean_action_processing_ms": 0.22948790573274105, "mean_env_wait_ms": 0.11751712395469849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010154008865356445, "StateBufferConnector_ms": 0.00675201416015625, "ViewRequirementAgentConnector_ms": 0.16472411155700684}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 164.17, "episode_len_mean": 164.17, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [216.0, 158.0, 127.0, 110.0, 109.0, 118.0, 113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0], "episode_lengths": [216, 158, 127, 110, 109, 118, 113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9368739271299642, "mean_inference_ms": 2.158211794922474, "mean_action_processing_ms": 0.22948790573274105, "mean_env_wait_ms": 0.11751712395469849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010154008865356445, "StateBufferConnector_ms": 0.00675201416015625, "ViewRequirementAgentConnector_ms": 0.16472411155700684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.16814660790686, "num_env_steps_trained_throughput_per_sec": 1236.6725864316275, "timesteps_total": 45000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 25.187, "sample_time_ms": 9.059, "learn_time_ms": 2.891, "learn_throughput": 11068.59, "synch_weights_time_ms": 4.257}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "last_target_update_ts": 44856, "num_target_updates": 88}, "done": false, "episodes_total": 415, "training_iteration": 45, "trial_id": "default", "date": "2024-10-05_20-24-40", "timestamp": 1728152680, "time_this_iter_s": 4.284190893173218, "time_total_s": 248.26785111427307, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 248.26785111427307, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.714285714285715, "ram_util_percent": 90.45714285714284}}
{"evaluation": {"sampler_results": {"episode_reward_max": 145.0, "episode_reward_min": 126.0, "episode_reward_mean": 135.5, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 143.0, 126.0, 136.0, 130.0, 138.0, 129.0, 137.0, 138.0, 133.0], "episode_lengths": [145, 143, 126, 136, 130, 138, 129, 137, 138, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37632438212149016, "mean_inference_ms": 1.176734162836254, "mean_action_processing_ms": 0.13827001360479624, "mean_env_wait_ms": 0.06023813207391269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009174346923828, "StateBufferConnector_ms": 0.004220008850097656, "ViewRequirementAgentConnector_ms": 0.0955510139465332}}, "episode_reward_max": 145.0, "episode_reward_min": 126.0, "episode_reward_mean": 135.5, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 143.0, 126.0, 136.0, 130.0, 138.0, 129.0, 137.0, 138.0, 133.0], "episode_lengths": [145, 143, 126, 136, 130, 138, 129, 137, 138, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37632438212149016, "mean_inference_ms": 1.176734162836254, "mean_action_processing_ms": 0.13827001360479624, "mean_env_wait_ms": 0.06023813207391269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009174346923828, "StateBufferConnector_ms": 0.004220008850097656, "ViewRequirementAgentConnector_ms": 0.0955510139465332}, "num_agent_steps_sampled_this_iter": 1355, "num_env_steps_sampled_this_iter": 1355, "timesteps_this_iter": 1355, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 53.0900993347168, "min_q": 1.2880215644836426, "max_q": 67.32962036132812, "mean_td_error": -0.14339303970336914}, "td_error": [-0.6007232666015625, -0.56341552734375, -0.51531982421875, -0.3023681640625, 1.9512481689453125, 0.102508544921875, -0.51409912109375, -0.7770462036132812, -0.7562484741210938, -1.9596595764160156, -0.1024169921875, -0.13665390014648438, 0.7386856079101562, -0.2640533447265625, -6.0095062255859375, -0.9648361206054688, -0.6416091918945312, -0.583831787109375, 0.2880215644836426, -0.8190650939941406, -0.408966064453125, 0.0709075927734375, -0.7118759155273438, -0.508331298828125, -0.6255149841308594, -0.6003227233886719, -0.9876937866210938, -1.9098052978515625, -0.3746910095214844, -0.16565704345703125, 4.449174404144287, 9.614587783813477], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5625, "diff_num_grad_updates_vs_sampler_policy": 5624}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "last_target_update_ts": 45864, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 165.74, "episode_len_mean": 165.74, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0], "episode_lengths": [113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9384142942364357, "mean_inference_ms": 2.1587352122453454, "mean_action_processing_ms": 0.22985705968698678, "mean_env_wait_ms": 0.11767313678676755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010243892669677734, "StateBufferConnector_ms": 0.006937503814697266, "ViewRequirementAgentConnector_ms": 0.16883397102355957}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 165.74, "episode_len_mean": 165.74, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [113.0, 99.0, 104.0, 124.0, 110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0], "episode_lengths": [113, 99, 104, 124, 110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9384142942364357, "mean_inference_ms": 2.1587352122453454, "mean_action_processing_ms": 0.22985705968698678, "mean_env_wait_ms": 0.11767313678676755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010243892669677734, "StateBufferConnector_ms": 0.006937503814697266, "ViewRequirementAgentConnector_ms": 0.16883397102355957}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.14421075490628, "num_env_steps_trained_throughput_per_sec": 832.5768430196251, "timesteps_total": 46000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 43.763, "sample_time_ms": 16.019, "learn_time_ms": 4.563, "learn_throughput": 7012.677, "synch_weights_time_ms": 6.986}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "last_target_update_ts": 45864, "num_target_updates": 90}, "done": false, "episodes_total": 421, "training_iteration": 46, "trial_id": "default", "date": "2024-10-05_20-24-47", "timestamp": 1728152687, "time_this_iter_s": 6.391652822494507, "time_total_s": 254.65950393676758, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 254.65950393676758, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.81111111111111, "ram_util_percent": 90.46666666666667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 141.0, "episode_reward_min": 125.0, "episode_reward_mean": 131.7, "episode_len_mean": 131.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 130.0, 134.0, 131.0, 125.0, 127.0, 133.0, 127.0, 138.0, 131.0], "episode_lengths": [141, 130, 134, 131, 125, 127, 133, 127, 138, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823348653082756, "mean_inference_ms": 1.1822336574525356, "mean_action_processing_ms": 0.13895663950178358, "mean_env_wait_ms": 0.06053058150547001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.003902912139892578, "ViewRequirementAgentConnector_ms": 0.09305238723754883}}, "episode_reward_max": 141.0, "episode_reward_min": 125.0, "episode_reward_mean": 131.7, "episode_len_mean": 131.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 130.0, 134.0, 131.0, 125.0, 127.0, 133.0, 127.0, 138.0, 131.0], "episode_lengths": [141, 130, 134, 131, 125, 127, 133, 127, 138, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823348653082756, "mean_inference_ms": 1.1822336574525356, "mean_action_processing_ms": 0.13895663950178358, "mean_env_wait_ms": 0.06053058150547001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.003902912139892578, "ViewRequirementAgentConnector_ms": 0.09305238723754883}, "num_agent_steps_sampled_this_iter": 1317, "num_env_steps_sampled_this_iter": 1317, "timesteps_this_iter": 1317, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 62.591346740722656, "min_q": 36.90843200683594, "max_q": 69.18083953857422, "mean_td_error": -0.09190809726715088}, "td_error": [0.0947265625, 0.5247039794921875, -0.23394012451171875, 0.49460601806640625, -0.28955078125, 0.5727767944335938, 0.26172637939453125, -0.05942535400390625, 0.41269683837890625, 0.1157989501953125, 0.05147552490234375, 0.032379150390625, 0.124969482421875, 0.0697479248046875, 0.22272491455078125, -1.7503738403320312, -0.078521728515625, 0.127471923828125, -0.0118408203125, -1.1595230102539062, 0.28287506103515625, 0.057666778564453125, -1.1837615966796875, -0.011962890625, -0.6004981994628906, 0.26506805419921875, 0.30123138427734375, 0.32221221923828125, 0.22034454345703125, 0.13593673706054688, -2.3971481323242188, 0.14434814453125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5750, "diff_num_grad_updates_vs_sampler_policy": 5749}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "last_target_update_ts": 46872, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 167.06, "episode_len_mean": 167.06, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0], "episode_lengths": [110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.938629728395318, "mean_inference_ms": 2.1582221168874587, "mean_action_processing_ms": 0.2297724348875478, "mean_env_wait_ms": 0.11764220380152722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010365962982177734, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.17191195487976074}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 167.06, "episode_len_mean": 167.06, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.0, 146.0, 173.0, 123.0, 210.0, 226.0, 118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0], "episode_lengths": [110, 146, 173, 123, 210, 226, 118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.938629728395318, "mean_inference_ms": 2.1582221168874587, "mean_action_processing_ms": 0.2297724348875478, "mean_env_wait_ms": 0.11764220380152722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010365962982177734, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.17191195487976074}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.66315557926828, "num_env_steps_trained_throughput_per_sec": 762.6526223170731, "timesteps_total": 47000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 44.362, "sample_time_ms": 16.157, "learn_time_ms": 4.744, "learn_throughput": 6745.965, "synch_weights_time_ms": 7.38}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "last_target_update_ts": 46872, "num_target_updates": 92}, "done": false, "episodes_total": 425, "training_iteration": 47, "trial_id": "default", "date": "2024-10-05_20-24-54", "timestamp": 1728152694, "time_this_iter_s": 6.706267595291138, "time_total_s": 261.3657715320587, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 261.3657715320587, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.53333333333333, "ram_util_percent": 90.5}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38044098345538446, "mean_inference_ms": 1.1889449717922402, "mean_action_processing_ms": 0.13990086575941788, "mean_env_wait_ms": 0.060920706598749964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005211830139160156, "StateBufferConnector_ms": 0.0054168701171875, "ViewRequirementAgentConnector_ms": 0.08503913879394531}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38044098345538446, "mean_inference_ms": 1.1889449717922402, "mean_action_processing_ms": 0.13990086575941788, "mean_env_wait_ms": 0.060920706598749964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005211830139160156, "StateBufferConnector_ms": 0.0054168701171875, "ViewRequirementAgentConnector_ms": 0.08503913879394531}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 57.47337341308594, "min_q": 18.060672760009766, "max_q": 69.8954849243164, "mean_td_error": 0.42203956842422485}, "td_error": [-0.37319183349609375, -1.5961685180664062, -0.5053520202636719, -0.30926513671875, -0.23791122436523438, -0.7020645141601562, -0.07714462280273438, -0.5093154907226562, 0.7628860473632812, 0.45265960693359375, 24.793476104736328, -0.6171455383300781, -1.6470184326171875, 0.396026611328125, -0.122039794921875, 0.27796173095703125, -0.92291259765625, -0.5623550415039062, -0.2593345642089844, -0.15729522705078125, -0.45644378662109375, 0.12558364868164062, -1.7697563171386719, -0.2823486328125, -0.23677825927734375, 0.5114974975585938, -1.0281105041503906, -0.23971176147460938, -0.5740966796875, -0.3676910400390625, 0.4128303527832031, -0.6742038726806641], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5875, "diff_num_grad_updates_vs_sampler_policy": 5874}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "last_target_update_ts": 47880, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 169.2, "episode_len_mean": 169.2, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0], "episode_lengths": [118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9413998551536897, "mean_inference_ms": 2.1601300656895335, "mean_action_processing_ms": 0.23006793424763217, "mean_env_wait_ms": 0.11777249218095663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01052713394165039, "StateBufferConnector_ms": 0.007171630859375, "ViewRequirementAgentConnector_ms": 0.17558574676513672}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 169.2, "episode_len_mean": 169.2, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [118.0, 300.0, 148.0, 243.0, 139.0, 141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0], "episode_lengths": [118, 300, 148, 243, 139, 141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9413998551536897, "mean_inference_ms": 2.1601300656895335, "mean_action_processing_ms": 0.23006793424763217, "mean_env_wait_ms": 0.11777249218095663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01052713394165039, "StateBufferConnector_ms": 0.007171630859375, "ViewRequirementAgentConnector_ms": 0.17558574676513672}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.627344127425, "num_env_steps_trained_throughput_per_sec": 738.5093765097, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 41.231, "sample_time_ms": 14.744, "learn_time_ms": 4.49, "learn_throughput": 7126.655, "synch_weights_time_ms": 6.606}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "last_target_update_ts": 47880, "num_target_updates": 94}, "done": false, "episodes_total": 431, "training_iteration": 48, "trial_id": "default", "date": "2024-10-05_20-25-02", "timestamp": 1728152702, "time_this_iter_s": 8.478812217712402, "time_total_s": 269.8445837497711, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 269.8445837497711, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.15833333333333, "ram_util_percent": 90.60000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 189.0, "episode_reward_min": 159.0, "episode_reward_mean": 171.5, "episode_len_mean": 171.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 168.0, 166.0, 187.0, 162.0, 189.0, 165.0, 184.0, 175.0, 160.0], "episode_lengths": [159, 168, 166, 187, 162, 189, 165, 184, 175, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38258302774777253, "mean_inference_ms": 1.1951792345670158, "mean_action_processing_ms": 0.14072385493316908, "mean_env_wait_ms": 0.061264382361243354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038170814514160156, "StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.09209156036376953}}, "episode_reward_max": 189.0, "episode_reward_min": 159.0, "episode_reward_mean": 171.5, "episode_len_mean": 171.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 168.0, 166.0, 187.0, 162.0, 189.0, 165.0, 184.0, 175.0, 160.0], "episode_lengths": [159, 168, 166, 187, 162, 189, 165, 184, 175, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38258302774777253, "mean_inference_ms": 1.1951792345670158, "mean_action_processing_ms": 0.14072385493316908, "mean_env_wait_ms": 0.061264382361243354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038170814514160156, "StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.09209156036376953}, "num_agent_steps_sampled_this_iter": 1715, "num_env_steps_sampled_this_iter": 1715, "timesteps_this_iter": 1715, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 57.036354064941406, "min_q": 15.845348358154297, "max_q": 70.47818756103516, "mean_td_error": 1.5207555294036865}, "td_error": [1.2409896850585938, 19.57954978942871, 0.2533721923828125, 0.01335906982421875, 0.24195098876953125, 0.29688262939453125, -5.374475479125977, -0.1240386962890625, 0.8005638122558594, 0.4004364013671875, 17.265226364135742, 0.41588592529296875, -0.1673736572265625, 0.01782989501953125, -4.217000961303711, 0.04788970947265625, 0.6393814086914062, 0.6249008178710938, 0.248443603515625, 0.19005966186523438, 0.31031036376953125, 0.4085235595703125, 0.5989761352539062, 0.487457275390625, 14.845348358154297, -0.8505630493164062, 0.5667152404785156, -0.6558799743652344, 0.31188201904296875, 0.08744049072265625, 0.257171630859375, -0.09703826904296875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6000, "diff_num_grad_updates_vs_sampler_policy": 5999}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "last_target_update_ts": 48888, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 168.73, "episode_len_mean": 168.73, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0], "episode_lengths": [141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9448065837770852, "mean_inference_ms": 2.1626082715440207, "mean_action_processing_ms": 0.23060814048564526, "mean_env_wait_ms": 0.11801449496132774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010701417922973633, "StateBufferConnector_ms": 0.007288932800292969, "ViewRequirementAgentConnector_ms": 0.17886018753051758}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 168.73, "episode_len_mean": 168.73, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [141.0, 132.0, 300.0, 139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0], "episode_lengths": [141, 132, 300, 139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9448065837770852, "mean_inference_ms": 2.1626082715440207, "mean_action_processing_ms": 0.23060814048564526, "mean_env_wait_ms": 0.11801449496132774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010701417922973633, "StateBufferConnector_ms": 0.007288932800292969, "ViewRequirementAgentConnector_ms": 0.17886018753051758}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.2114744138001, "num_env_steps_trained_throughput_per_sec": 752.8458976552004, "timesteps_total": 49000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 48.491, "sample_time_ms": 17.074, "learn_time_ms": 5.17, "learn_throughput": 6189.342, "synch_weights_time_ms": 7.859}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "last_target_update_ts": 48888, "num_target_updates": 96}, "done": false, "episodes_total": 436, "training_iteration": 49, "trial_id": "default", "date": "2024-10-05_20-25-09", "timestamp": 1728152709, "time_this_iter_s": 7.246254920959473, "time_total_s": 277.0908386707306, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 277.0908386707306, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.85454545454546, "ram_util_percent": 90.81818181818181}}
{"evaluation": {"sampler_results": {"episode_reward_max": 137.0, "episode_reward_min": 120.0, "episode_reward_mean": 130.4, "episode_len_mean": 130.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 125.0, 120.0, 127.0, 131.0, 134.0, 127.0, 132.0, 136.0, 135.0], "episode_lengths": [137, 125, 120, 127, 131, 134, 127, 132, 136, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384000369737869, "mean_inference_ms": 1.1993625347726327, "mean_action_processing_ms": 0.14125246714674294, "mean_env_wait_ms": 0.06149125353029593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004119873046875, "StateBufferConnector_ms": 0.005180835723876953, "ViewRequirementAgentConnector_ms": 0.09556055068969727}}, "episode_reward_max": 137.0, "episode_reward_min": 120.0, "episode_reward_mean": 130.4, "episode_len_mean": 130.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 125.0, 120.0, 127.0, 131.0, 134.0, 127.0, 132.0, 136.0, 135.0], "episode_lengths": [137, 125, 120, 127, 131, 134, 127, 132, 136, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384000369737869, "mean_inference_ms": 1.1993625347726327, "mean_action_processing_ms": 0.14125246714674294, "mean_env_wait_ms": 0.06149125353029593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004119873046875, "StateBufferConnector_ms": 0.005180835723876953, "ViewRequirementAgentConnector_ms": 0.09556055068969727}, "num_agent_steps_sampled_this_iter": 1304, "num_env_steps_sampled_this_iter": 1304, "timesteps_this_iter": 1304, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 59.280975341796875, "min_q": 17.913454055786133, "max_q": 71.99974822998047, "mean_td_error": 3.4093236923217773}, "td_error": [0.2778587341308594, 19.051563262939453, 0.20587921142578125, 1.114288330078125, 0.2732086181640625, 53.37602996826172, 0.14288330078125, 0.7370147705078125, -0.02646636962890625, 0.525665283203125, 0.09770965576171875, 0.7209091186523438, 0.35930633544921875, 0.22992706298828125, 0.417816162109375, -0.4086494445800781, 0.16796875, 0.10010528564453125, -0.4184532165527344, -4.480384826660156, 18.474834442138672, -0.13706207275390625, 0.147674560546875, 0.1304931640625, -0.534088134765625, 0.3401641845703125, 0.1322784423828125, 0.345947265625, 0.9695510864257812, 16.913454055786133, -0.42296600341796875, 0.273895263671875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6125, "diff_num_grad_updates_vs_sampler_policy": 6124}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "last_target_update_ts": 49896, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 170.29, "episode_len_mean": 170.29, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0], "episode_lengths": [139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9470494440410793, "mean_inference_ms": 2.164567498149482, "mean_action_processing_ms": 0.23071650299279414, "mean_env_wait_ms": 0.11805634626662079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010795831680297852, "StateBufferConnector_ms": 0.0073699951171875, "ViewRequirementAgentConnector_ms": 0.18130040168762207}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 170.29, "episode_len_mean": 170.29, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [139.0, 130.0, 137.0, 133.0, 136.0, 123.0, 137.0, 137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0], "episode_lengths": [139, 130, 137, 133, 136, 123, 137, 137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9470494440410793, "mean_inference_ms": 2.164567498149482, "mean_action_processing_ms": 0.23071650299279414, "mean_env_wait_ms": 0.11805634626662079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010795831680297852, "StateBufferConnector_ms": 0.0073699951171875, "ViewRequirementAgentConnector_ms": 0.18130040168762207}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.65996631944282, "num_env_steps_trained_throughput_per_sec": 782.6398652777713, "timesteps_total": 50000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 41.453, "sample_time_ms": 14.907, "learn_time_ms": 4.41, "learn_throughput": 7256.307, "synch_weights_time_ms": 6.778}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "last_target_update_ts": 49896, "num_target_updates": 98}, "done": false, "episodes_total": 439, "training_iteration": 50, "trial_id": "default", "date": "2024-10-05_20-25-16", "timestamp": 1728152716, "time_this_iter_s": 6.53082013130188, "time_total_s": 283.62165880203247, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 283.62165880203247, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 91.02222222222223}}
{"evaluation": {"sampler_results": {"episode_reward_max": 160.0, "episode_reward_min": 147.0, "episode_reward_mean": 155.5, "episode_len_mean": 155.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 160.0, 154.0, 155.0, 159.0, 154.0, 155.0, 159.0, 154.0, 158.0], "episode_lengths": [147, 160, 154, 155, 159, 154, 155, 159, 154, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853764899436389, "mean_inference_ms": 1.2037501369863768, "mean_action_processing_ms": 0.14179957791285708, "mean_env_wait_ms": 0.061721847658464536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004489421844482422, "StateBufferConnector_ms": 0.0035858154296875, "ViewRequirementAgentConnector_ms": 0.0922703742980957}}, "episode_reward_max": 160.0, "episode_reward_min": 147.0, "episode_reward_mean": 155.5, "episode_len_mean": 155.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 160.0, 154.0, 155.0, 159.0, 154.0, 155.0, 159.0, 154.0, 158.0], "episode_lengths": [147, 160, 154, 155, 159, 154, 155, 159, 154, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853764899436389, "mean_inference_ms": 1.2037501369863768, "mean_action_processing_ms": 0.14179957791285708, "mean_env_wait_ms": 0.061721847658464536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004489421844482422, "StateBufferConnector_ms": 0.0035858154296875, "ViewRequirementAgentConnector_ms": 0.0922703742980957}, "num_agent_steps_sampled_this_iter": 1555, "num_env_steps_sampled_this_iter": 1555, "timesteps_this_iter": 1555, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 57.2921257019043, "min_q": 0.048491477966308594, "max_q": 71.55902862548828, "mean_td_error": -0.30409637093544006}, "td_error": [0.7471122741699219, -0.20165252685546875, 0.3724098205566406, 0.21756744384765625, 0.5476226806640625, 0.36949920654296875, 0.47747039794921875, 0.0342864990234375, -0.3745269775390625, -0.2855072021484375, -1.7169036865234375, 1.4103946685791016, 0.39466094970703125, -0.44162750244140625, -10.945381164550781, 2.3442459106445312, 0.39923095703125, -0.0271759033203125, 1.5316944122314453, 0.0977325439453125, 0.23527908325195312, -0.7637710571289062, -0.5082550048828125, 0.9193801879882812, -6.459641456604004, -0.15792083740234375, -0.0600433349609375, 0.895538330078125, 0.4961395263671875, 1.4556312561035156, -0.8419113159179688, 0.10733795166015625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6250, "diff_num_grad_updates_vs_sampler_policy": 6249}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "last_target_update_ts": 50904, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 178.75, "episode_len_mean": 178.75, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0], "episode_lengths": [137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9517770092504738, "mean_inference_ms": 2.1686392588017975, "mean_action_processing_ms": 0.23126969280881432, "mean_env_wait_ms": 0.11830865283002037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010980844497680664, "StateBufferConnector_ms": 0.007509469985961914, "ViewRequirementAgentConnector_ms": 0.18538260459899902}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 178.75, "episode_len_mean": 178.75, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.0, 124.0, 119.0, 129.0, 121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0], "episode_lengths": [137, 124, 119, 129, 121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9517770092504738, "mean_inference_ms": 2.1686392588017975, "mean_action_processing_ms": 0.23126969280881432, "mean_env_wait_ms": 0.11830865283002037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010980844497680664, "StateBufferConnector_ms": 0.007509469985961914, "ViewRequirementAgentConnector_ms": 0.18538260459899902}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.14531507493186, "num_env_steps_trained_throughput_per_sec": 740.5812602997274, "timesteps_total": 51000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 41.636, "sample_time_ms": 15.044, "learn_time_ms": 4.368, "learn_throughput": 7325.376, "synch_weights_time_ms": 6.794}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "last_target_update_ts": 50904, "num_target_updates": 100}, "done": false, "episodes_total": 446, "training_iteration": 51, "trial_id": "default", "date": "2024-10-05_20-25-23", "timestamp": 1728152723, "time_this_iter_s": 7.093980073928833, "time_total_s": 290.7156388759613, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 290.7156388759613, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.56, "ram_util_percent": 91.0}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 149.0, "episode_reward_mean": 249.4, "episode_len_mean": 249.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 261.0, 300.0, 270.0, 149.0, 292.0, 300.0, 172.0, 300.0, 300.0], "episode_lengths": [150, 261, 300, 270, 149, 292, 300, 172, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38573976768177076, "mean_inference_ms": 1.2061818932551163, "mean_action_processing_ms": 0.1421966349185495, "mean_env_wait_ms": 0.06186539205935385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036454200744628906, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.08132457733154297}}, "episode_reward_max": 300.0, "episode_reward_min": 149.0, "episode_reward_mean": 249.4, "episode_len_mean": 249.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 261.0, 300.0, 270.0, 149.0, 292.0, 300.0, 172.0, 300.0, 300.0], "episode_lengths": [150, 261, 300, 270, 149, 292, 300, 172, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38573976768177076, "mean_inference_ms": 1.2061818932551163, "mean_action_processing_ms": 0.1421966349185495, "mean_env_wait_ms": 0.06186539205935385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036454200744628906, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.08132457733154297}, "num_agent_steps_sampled_this_iter": 2494, "num_env_steps_sampled_this_iter": 2494, "timesteps_this_iter": 2494, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 63.499114990234375, "min_q": -15.316362380981445, "max_q": 74.15989685058594, "mean_td_error": 1.248952865600586}, "td_error": [-16.316362380981445, 0.38106536865234375, 0.5724716186523438, 0.2210693359375, -0.93621826171875, 0.46996307373046875, 0.124053955078125, 0.5002212524414062, -0.2879638671875, 0.6664581298828125, -0.06768798828125, 58.69399642944336, -0.456298828125, 0.169769287109375, 0.6404190063476562, -0.722991943359375, -0.5075531005859375, -0.6890869140625, -0.8652114868164062, 0.58587646484375, 0.9110870361328125, -0.7283935546875, -0.4305572509765625, 0.0893402099609375, -1.0033645629882812, 0.59381103515625, -0.06650161743164062, -0.97900390625, -0.4724884033203125, -0.271331787109375, -0.37186431884765625, 0.5197677612304688], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6375, "diff_num_grad_updates_vs_sampler_policy": 6374}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "last_target_update_ts": 51912, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.67, "episode_len_mean": 179.67, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0], "episode_lengths": [121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956587360948665, "mean_inference_ms": 2.1737130052846907, "mean_action_processing_ms": 0.23183373389210868, "mean_env_wait_ms": 0.11853397950906501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010885953903198242, "StateBufferConnector_ms": 0.0075070858001708984, "ViewRequirementAgentConnector_ms": 0.18539834022521973}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.67, "episode_len_mean": 179.67, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [121.0, 102.0, 129.0, 107.0, 115.0, 138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0], "episode_lengths": [121, 102, 129, 107, 115, 138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956587360948665, "mean_inference_ms": 2.1737130052846907, "mean_action_processing_ms": 0.23183373389210868, "mean_env_wait_ms": 0.11853397950906501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010885953903198242, "StateBufferConnector_ms": 0.0075070858001708984, "ViewRequirementAgentConnector_ms": 0.18539834022521973}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.18759296855512, "num_env_steps_trained_throughput_per_sec": 728.7503718742205, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 44.179, "sample_time_ms": 15.616, "learn_time_ms": 4.858, "learn_throughput": 6587.212, "synch_weights_time_ms": 7.342}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "last_target_update_ts": 51912, "num_target_updates": 102}, "done": false, "episodes_total": 450, "training_iteration": 52, "trial_id": "default", "date": "2024-10-05_20-25-31", "timestamp": 1728152731, "time_this_iter_s": 8.115742683410645, "time_total_s": 298.83138155937195, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 298.83138155937195, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.458333333333336, "ram_util_percent": 91.0}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 94.0, "episode_reward_mean": 119.1, "episode_len_mean": 119.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 100.0, 100.0, 94.0, 97.0, 101.0, 99.0, 103.0, 99.0, 98.0], "episode_lengths": [300, 100, 100, 94, 97, 101, 99, 103, 99, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848288453129879, "mean_inference_ms": 1.2026168013984884, "mean_action_processing_ms": 0.1417461570508247, "mean_env_wait_ms": 0.061671886081361635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422332763671875, "StateBufferConnector_ms": 0.002143383026123047, "ViewRequirementAgentConnector_ms": 0.05651712417602539}}, "episode_reward_max": 300.0, "episode_reward_min": 94.0, "episode_reward_mean": 119.1, "episode_len_mean": 119.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 100.0, 100.0, 94.0, 97.0, 101.0, 99.0, 103.0, 99.0, 98.0], "episode_lengths": [300, 100, 100, 94, 97, 101, 99, 103, 99, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848288453129879, "mean_inference_ms": 1.2026168013984884, "mean_action_processing_ms": 0.1417461570508247, "mean_env_wait_ms": 0.061671886081361635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422332763671875, "StateBufferConnector_ms": 0.002143383026123047, "ViewRequirementAgentConnector_ms": 0.05651712417602539}, "num_agent_steps_sampled_this_iter": 1191, "num_env_steps_sampled_this_iter": 1191, "timesteps_this_iter": 1191, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 66.85640716552734, "min_q": 22.683256149291992, "max_q": 74.75202178955078, "mean_td_error": 1.1136151552200317}, "td_error": [-0.3630332946777344, 0.3936004638671875, 1.2954330444335938, 0.34276580810546875, 0.105987548828125, 0.16973114013671875, 0.722137451171875, -0.4367637634277344, -0.1417083740234375, 0.39940643310546875, 0.01671600341796875, 0.8618316650390625, -0.11441802978515625, -0.69775390625, 0.21192550659179688, 0.1047210693359375, 0.30477142333984375, -0.04264068603515625, 0.0534210205078125, 0.21808624267578125, 0.316314697265625, -0.113006591796875, -0.16623687744140625, 0.13777923583984375, 0.1355133056640625, -1.2001533508300781, 33.49613571166992, 0.11086273193359375, 0.5085067749023438, 0.18769073486328125, -0.01384735107421875, -1.1680908203125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6500, "diff_num_grad_updates_vs_sampler_policy": 6499}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "last_target_update_ts": 52920, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 182.06, "episode_len_mean": 182.06, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0], "episode_lengths": [138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.958645333159992, "mean_inference_ms": 2.175280717955659, "mean_action_processing_ms": 0.23203487376578993, "mean_env_wait_ms": 0.11863903317653925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010601043701171875, "StateBufferConnector_ms": 0.007384777069091797, "ViewRequirementAgentConnector_ms": 0.1827375888824463}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 182.06, "episode_len_mean": 182.06, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [138.0, 130.0, 120.0, 124.0, 188.0, 190.0, 177.0, 207.0, 202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0], "episode_lengths": [138, 130, 120, 124, 188, 190, 177, 207, 202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.958645333159992, "mean_inference_ms": 2.175280717955659, "mean_action_processing_ms": 0.23203487376578993, "mean_env_wait_ms": 0.11863903317653925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010601043701171875, "StateBufferConnector_ms": 0.007384777069091797, "ViewRequirementAgentConnector_ms": 0.1827375888824463}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.9046455477294, "num_env_steps_trained_throughput_per_sec": 1167.6185821909176, "timesteps_total": 53000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 25.889, "sample_time_ms": 9.495, "learn_time_ms": 2.818, "learn_throughput": 11354.177, "synch_weights_time_ms": 4.363}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "last_target_update_ts": 52920, "num_target_updates": 104}, "done": false, "episodes_total": 455, "training_iteration": 53, "trial_id": "default", "date": "2024-10-05_20-25-35", "timestamp": 1728152735, "time_this_iter_s": 4.11307430267334, "time_total_s": 302.9444558620453, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 302.9444558620453, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 43.44, "ram_util_percent": 91.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 173.0, "episode_reward_min": 100.0, "episode_reward_mean": 149.4, "episode_len_mean": 149.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 163.0, 148.0, 140.0, 173.0, 143.0, 166.0, 155.0, 148.0, 158.0], "episode_lengths": [100, 163, 148, 140, 173, 143, 166, 155, 148, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830438581631071, "mean_inference_ms": 1.1973947866632497, "mean_action_processing_ms": 0.14107728910401973, "mean_env_wait_ms": 0.06139001103879347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029516220092773438, "StateBufferConnector_ms": 0.0022482872009277344, "ViewRequirementAgentConnector_ms": 0.05720376968383789}}, "episode_reward_max": 173.0, "episode_reward_min": 100.0, "episode_reward_mean": 149.4, "episode_len_mean": 149.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 163.0, 148.0, 140.0, 173.0, 143.0, 166.0, 155.0, 148.0, 158.0], "episode_lengths": [100, 163, 148, 140, 173, 143, 166, 155, 148, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830438581631071, "mean_inference_ms": 1.1973947866632497, "mean_action_processing_ms": 0.14107728910401973, "mean_env_wait_ms": 0.06139001103879347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029516220092773438, "StateBufferConnector_ms": 0.0022482872009277344, "ViewRequirementAgentConnector_ms": 0.05720376968383789}, "num_agent_steps_sampled_this_iter": 1494, "num_env_steps_sampled_this_iter": 1494, "timesteps_this_iter": 1494, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 64.04716491699219, "min_q": 25.293472290039062, "max_q": 74.7275619506836, "mean_td_error": 2.6691105365753174}, "td_error": [-0.6534805297851562, -0.01676177978515625, 0.249786376953125, -0.147125244140625, -0.6941413879394531, 0.19838714599609375, -2.7023086547851562, 0.09183502197265625, -0.1708221435546875, 0.6939239501953125, 0.20175933837890625, 0.09446334838867188, 0.21984100341796875, -0.152008056640625, 0.31281280517578125, 0.1286773681640625, 0.01844024658203125, 0.17400360107421875, -0.07509613037109375, -0.040191650390625, 7.433979034423828, -0.14009857177734375, 24.293472290039062, 0.18277740478515625, -0.6514434814453125, 0.2232513427734375, -0.168365478515625, -1.8102684020996094, -0.24078369140625, -0.551788330078125, 59.23719787597656, -0.128387451171875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6625, "diff_num_grad_updates_vs_sampler_policy": 6624}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "last_target_update_ts": 53928, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 184.02, "episode_len_mean": 184.02, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0], "episode_lengths": [202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9618350565602987, "mean_inference_ms": 2.178244089855546, "mean_action_processing_ms": 0.23238471045439887, "mean_env_wait_ms": 0.11879891491258215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010296106338500977, "StateBufferConnector_ms": 0.007074594497680664, "ViewRequirementAgentConnector_ms": 0.17594528198242188}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 184.02, "episode_len_mean": 184.02, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.0, 156.0, 160.0, 199.0, 212.0, 189.0, 167.0, 164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0], "episode_lengths": [202, 156, 160, 199, 212, 189, 167, 164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9618350565602987, "mean_inference_ms": 2.178244089855546, "mean_action_processing_ms": 0.23238471045439887, "mean_env_wait_ms": 0.11879891491258215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010296106338500977, "StateBufferConnector_ms": 0.007074594497680664, "ViewRequirementAgentConnector_ms": 0.17594528198242188}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.8771681426559, "num_env_steps_trained_throughput_per_sec": 1259.5086725706235, "timesteps_total": 54000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 26.817, "sample_time_ms": 9.14, "learn_time_ms": 2.872, "learn_throughput": 11142.007, "synch_weights_time_ms": 4.269}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "last_target_update_ts": 53928, "num_target_updates": 106}, "done": false, "episodes_total": 463, "training_iteration": 54, "trial_id": "default", "date": "2024-10-05_20-25-39", "timestamp": 1728152739, "time_this_iter_s": 4.241360187530518, "time_total_s": 307.1858160495758, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 307.1858160495758, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 33.5, "ram_util_percent": 91.58333333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 154.0, "episode_reward_mean": 285.4, "episode_len_mean": 285.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [154, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37925652842643387, "mean_inference_ms": 1.1864896585094624, "mean_action_processing_ms": 0.13972585424413822, "mean_env_wait_ms": 0.0608059199359243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002353191375732422, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.055680274963378906}}, "episode_reward_max": 300.0, "episode_reward_min": 154.0, "episode_reward_mean": 285.4, "episode_len_mean": 285.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [154, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37925652842643387, "mean_inference_ms": 1.1864896585094624, "mean_action_processing_ms": 0.13972585424413822, "mean_env_wait_ms": 0.0608059199359243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002353191375732422, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.055680274963378906}, "num_agent_steps_sampled_this_iter": 2854, "num_env_steps_sampled_this_iter": 2854, "timesteps_this_iter": 2854, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 62.44335174560547, "min_q": 30.423633575439453, "max_q": 75.5897445678711, "mean_td_error": 1.1872196197509766}, "td_error": [-0.46332550048828125, -0.13767242431640625, 0.5475540161132812, 39.579219818115234, -0.13299560546875, 0.5668449401855469, -0.35385894775390625, -0.4817657470703125, -0.30925750732421875, 1.5071907043457031, 0.5528945922851562, -0.15038299560546875, 0.11481475830078125, 0.09296417236328125, -0.2455615997314453, -0.0770721435546875, -0.0333404541015625, -0.39910125732421875, -0.2370452880859375, -0.182098388671875, -0.9549064636230469, -0.08225250244140625, 0.2736968994140625, -0.23992919921875, 0.11545944213867188, 1.5256156921386719, 0.8032684326171875, -2.342498779296875, -0.11847686767578125, -0.24056243896484375, -0.18125152587890625, -0.32513999938964844], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6750, "diff_num_grad_updates_vs_sampler_policy": 6749}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "last_target_update_ts": 54936, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.61, "episode_len_mean": 179.61, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0], "episode_lengths": [164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620424416564288, "mean_inference_ms": 2.178441756235199, "mean_action_processing_ms": 0.2323952930818574, "mean_env_wait_ms": 0.1188217002120874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009984493255615234, "StateBufferConnector_ms": 0.006884336471557617, "ViewRequirementAgentConnector_ms": 0.17081475257873535}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.61, "episode_len_mean": 179.61, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [164.0, 185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0], "episode_lengths": [164, 185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620424416564288, "mean_inference_ms": 2.178441756235199, "mean_action_processing_ms": 0.2323952930818574, "mean_env_wait_ms": 0.1188217002120874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009984493255615234, "StateBufferConnector_ms": 0.006884336471557617, "ViewRequirementAgentConnector_ms": 0.17081475257873535}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.12075245362377, "num_env_steps_trained_throughput_per_sec": 1224.483009814495, "timesteps_total": 55000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 27.251, "sample_time_ms": 9.386, "learn_time_ms": 2.875, "learn_throughput": 11130.642, "synch_weights_time_ms": 4.147}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "last_target_update_ts": 54936, "num_target_updates": 108}, "done": false, "episodes_total": 470, "training_iteration": 55, "trial_id": "default", "date": "2024-10-05_20-25-45", "timestamp": 1728152745, "time_this_iter_s": 5.219714403152466, "time_total_s": 312.40553045272827, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 312.40553045272827, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 29.1875, "ram_util_percent": 91.25}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37588164649348527, "mean_inference_ms": 1.1763218938787845, "mean_action_processing_ms": 0.13846395023980626, "mean_env_wait_ms": 0.06026507353658693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377033233642578, "StateBufferConnector_ms": 0.0021982192993164062, "ViewRequirementAgentConnector_ms": 0.05560636520385742}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37588164649348527, "mean_inference_ms": 1.1763218938787845, "mean_action_processing_ms": 0.13846395023980626, "mean_env_wait_ms": 0.06026507353658693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377033233642578, "StateBufferConnector_ms": 0.0021982192993164062, "ViewRequirementAgentConnector_ms": 0.05560636520385742}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 62.37094497680664, "min_q": 4.052616119384766, "max_q": 76.35246276855469, "mean_td_error": 1.6263110637664795}, "td_error": [-0.5428428649902344, 3.0526161193847656, 0.3022727966308594, -0.5237884521484375, -0.32621002197265625, 0.12350082397460938, -0.41066741943359375, 0.7625217437744141, -0.06594085693359375, 58.44108200073242, -0.42250823974609375, 0.18164825439453125, 0.09508514404296875, 0.0041656494140625, -4.828155517578125, -0.14080810546875, -0.5594940185546875, -0.6766471862792969, -0.264617919921875, 0.07646942138671875, -0.25557708740234375, -0.5829010009765625, -0.19760894775390625, -0.140228271484375, -0.0272979736328125, 0.07181549072265625, 0.04344940185546875, -0.09464645385742188, -0.36272430419921875, -0.24090576171875, -0.3274688720703125, -0.12163543701171875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6875, "diff_num_grad_updates_vs_sampler_policy": 6874}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "last_target_update_ts": 55944, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.51, "episode_len_mean": 179.51, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0], "episode_lengths": [185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9635194942815253, "mean_inference_ms": 2.1802907356329513, "mean_action_processing_ms": 0.23267722714771644, "mean_env_wait_ms": 0.11893094304350742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009956836700439453, "StateBufferConnector_ms": 0.0068585872650146484, "ViewRequirementAgentConnector_ms": 0.17008256912231445}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 179.51, "episode_len_mean": 179.51, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [185.0, 117.0, 194.0, 300.0, 211.0, 103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0], "episode_lengths": [185, 117, 194, 300, 211, 103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9635194942815253, "mean_inference_ms": 2.1802907356329513, "mean_action_processing_ms": 0.23267722714771644, "mean_env_wait_ms": 0.11893094304350742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009956836700439453, "StateBufferConnector_ms": 0.0068585872650146484, "ViewRequirementAgentConnector_ms": 0.17008256912231445}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.28728571529194, "num_env_steps_trained_throughput_per_sec": 1257.1491428611678, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 26.907, "sample_time_ms": 9.446, "learn_time_ms": 2.78, "learn_throughput": 11512.732, "synch_weights_time_ms": 4.205}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "last_target_update_ts": 55944, "num_target_updates": 110}, "done": false, "episodes_total": 471, "training_iteration": 56, "trial_id": "default", "date": "2024-10-05_20-25-50", "timestamp": 1728152750, "time_this_iter_s": 5.143612623214722, "time_total_s": 317.549143075943, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 317.549143075943, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 91.20000000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 143.0, "episode_reward_mean": 163.8, "episode_len_mean": 163.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 147.0, 147.0, 148.0, 143.0, 150.0, 157.0, 145.0, 145.0, 156.0], "episode_lengths": [300, 147, 147, 148, 143, 150, 157, 145, 145, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37461424445219504, "mean_inference_ms": 1.1717470623519444, "mean_action_processing_ms": 0.13788740746640388, "mean_env_wait_ms": 0.06002084800125882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024080276489257812, "StateBufferConnector_ms": 0.002148151397705078, "ViewRequirementAgentConnector_ms": 0.055336952209472656}}, "episode_reward_max": 300.0, "episode_reward_min": 143.0, "episode_reward_mean": 163.8, "episode_len_mean": 163.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 147.0, 147.0, 148.0, 143.0, 150.0, 157.0, 145.0, 145.0, 156.0], "episode_lengths": [300, 147, 147, 148, 143, 150, 157, 145, 145, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37461424445219504, "mean_inference_ms": 1.1717470623519444, "mean_action_processing_ms": 0.13788740746640388, "mean_env_wait_ms": 0.06002084800125882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024080276489257812, "StateBufferConnector_ms": 0.002148151397705078, "ViewRequirementAgentConnector_ms": 0.055336952209472656}, "num_agent_steps_sampled_this_iter": 1638, "num_env_steps_sampled_this_iter": 1638, "timesteps_this_iter": 1638, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 63.267616271972656, "min_q": 17.641530990600586, "max_q": 77.50514221191406, "mean_td_error": 2.11924409866333}, "td_error": [0.0499420166015625, 0.371551513671875, 0.20645904541015625, 1.061513900756836, -0.03509521484375, 0.2198486328125, 0.1542510986328125, 0.25603485107421875, 0.45781707763671875, -0.162109375, -0.2638702392578125, -0.496368408203125, -0.235504150390625, 0.08600616455078125, 0.2047119140625, 0.33538818359375, 0.569091796875, 0.13287353515625, 0.5002403259277344, 0.5911178588867188, -0.6191558837890625, 0.18270111083984375, 0.8319816589355469, 1.5167369842529297, 0.3742523193359375, 59.17082977294922, 0.06478500366210938, 1.2415008544921875, -0.28841400146484375, 1.2736396789550781, -0.392486572265625, 0.455535888671875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7000, "diff_num_grad_updates_vs_sampler_policy": 6999}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "last_target_update_ts": 56952, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 184.44, "episode_len_mean": 184.44, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9613489528549195, "mean_inference_ms": 2.177978138893086, "mean_action_processing_ms": 0.23236411765953563, "mean_env_wait_ms": 0.11881625972519501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009742975234985352, "StateBufferConnector_ms": 0.006754636764526367, "ViewRequirementAgentConnector_ms": 0.1663646697998047}}, "episode_reward_max": 300.0, "episode_reward_min": 91.0, "episode_reward_mean": 184.44, "episode_len_mean": 184.44, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [103.0, 300.0, 300.0, 119.0, 102.0, 91.0, 104.0, 109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [103, 300, 300, 119, 102, 91, 104, 109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9613489528549195, "mean_inference_ms": 2.177978138893086, "mean_action_processing_ms": 0.23236411765953563, "mean_env_wait_ms": 0.11881625972519501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009742975234985352, "StateBufferConnector_ms": 0.006754636764526367, "ViewRequirementAgentConnector_ms": 0.1663646697998047}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.65212098299577, "num_env_steps_trained_throughput_per_sec": 1246.608483931983, "timesteps_total": 57000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 26.855, "sample_time_ms": 9.064, "learn_time_ms": 2.773, "learn_throughput": 11538.961, "synch_weights_time_ms": 4.311}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "last_target_update_ts": 56952, "num_target_updates": 112}, "done": false, "episodes_total": 476, "training_iteration": 57, "trial_id": "default", "date": "2024-10-05_20-25-54", "timestamp": 1728152754, "time_this_iter_s": 4.216731309890747, "time_total_s": 321.76587438583374, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 321.76587438583374, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 33.416666666666664, "ram_util_percent": 91.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 151.0, "episode_reward_mean": 285.1, "episode_len_mean": 285.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [151, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37150889720049085, "mean_inference_ms": 1.162821338407531, "mean_action_processing_ms": 0.13675651476215056, "mean_env_wait_ms": 0.059539447346733686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.0021314620971679688, "ViewRequirementAgentConnector_ms": 0.055947303771972656}}, "episode_reward_max": 300.0, "episode_reward_min": 151.0, "episode_reward_mean": 285.1, "episode_len_mean": 285.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [151, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37150889720049085, "mean_inference_ms": 1.162821338407531, "mean_action_processing_ms": 0.13675651476215056, "mean_env_wait_ms": 0.059539447346733686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.0021314620971679688, "ViewRequirementAgentConnector_ms": 0.055947303771972656}, "num_agent_steps_sampled_this_iter": 2851, "num_env_steps_sampled_this_iter": 2851, "timesteps_this_iter": 2851, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 63.82892608642578, "min_q": 15.034082412719727, "max_q": 78.7161865234375, "mean_td_error": 1.785920262336731}, "td_error": [0.08373641967773438, 0.48133087158203125, 39.32516098022461, -0.1088714599609375, 0.1123504638671875, 0.306549072265625, 0.7458724975585938, 0.145263671875, 0.5752944946289062, 0.36620330810546875, 0.0755767822265625, 0.31195831298828125, -1.0995521545410156, -0.3093719482421875, 0.6214141845703125, 0.1256561279296875, -0.006256103515625, 0.6887893676757812, 0.36631011962890625, -0.477203369140625, 0.06623077392578125, 14.034082412719727, 0.20197296142578125, -0.32240867614746094, -1.1928520202636719, 0.47313690185546875, 0.29004669189453125, -0.14223480224609375, -0.43566131591796875, 0.7165374755859375, 0.8799514770507812, 0.25043487548828125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7125, "diff_num_grad_updates_vs_sampler_policy": 7124}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "last_target_update_ts": 57960, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 97.0, "episode_reward_mean": 187.83, "episode_len_mean": 187.83, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0], "episode_lengths": [109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9604649440820185, "mean_inference_ms": 2.1780600278949747, "mean_action_processing_ms": 0.2324027940590781, "mean_env_wait_ms": 0.1188187405090566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009712934494018555, "StateBufferConnector_ms": 0.006590604782104492, "ViewRequirementAgentConnector_ms": 0.16191530227661133}}, "episode_reward_max": 300.0, "episode_reward_min": 97.0, "episode_reward_mean": 187.83, "episode_len_mean": 187.83, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.0, 121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0], "episode_lengths": [109, 121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9604649440820185, "mean_inference_ms": 2.1780600278949747, "mean_action_processing_ms": 0.2324027940590781, "mean_env_wait_ms": 0.1188187405090566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009712934494018555, "StateBufferConnector_ms": 0.006590604782104492, "ViewRequirementAgentConnector_ms": 0.16191530227661133}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0608466047072, "num_env_steps_trained_throughput_per_sec": 1236.2433864188288, "timesteps_total": 58000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 27.09, "sample_time_ms": 9.131, "learn_time_ms": 2.774, "learn_throughput": 11537.274, "synch_weights_time_ms": 4.361}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "last_target_update_ts": 57960, "num_target_updates": 114}, "done": false, "episodes_total": 483, "training_iteration": 58, "trial_id": "default", "date": "2024-10-05_20-25-59", "timestamp": 1728152759, "time_this_iter_s": 5.213465452194214, "time_total_s": 326.97933983802795, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 326.97933983802795, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 29.4375, "ram_util_percent": 91.61250000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 166.0, "episode_reward_mean": 188.0, "episode_len_mean": 188.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 181.0, 176.0, 168.0, 196.0, 166.0, 179.0, 174.0, 168.0, 172.0], "episode_lengths": [300, 181, 176, 168, 196, 166, 179, 174, 168, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37300340621223194, "mean_inference_ms": 1.166463249104801, "mean_action_processing_ms": 0.1371656585054724, "mean_env_wait_ms": 0.059733244757549965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807544708251953, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.08708477020263672}}, "episode_reward_max": 300.0, "episode_reward_min": 166.0, "episode_reward_mean": 188.0, "episode_len_mean": 188.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 181.0, 176.0, 168.0, 196.0, 166.0, 179.0, 174.0, 168.0, 172.0], "episode_lengths": [300, 181, 176, 168, 196, 166, 179, 174, 168, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37300340621223194, "mean_inference_ms": 1.166463249104801, "mean_action_processing_ms": 0.1371656585054724, "mean_env_wait_ms": 0.059733244757549965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807544708251953, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.08708477020263672}, "num_agent_steps_sampled_this_iter": 1880, "num_env_steps_sampled_this_iter": 1880, "timesteps_this_iter": 1880, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 66.10872650146484, "min_q": 3.4858994483947754, "max_q": 79.5017318725586, "mean_td_error": 2.449737071990967}, "td_error": [0.230194091796875, 0.38031005859375, -0.7272987365722656, -0.0161285400390625, 0.02385711669921875, 0.09972381591796875, -0.18030548095703125, -0.06891632080078125, 0.106292724609375, -1.1931042671203613, -0.32955169677734375, -2.242950439453125, -0.07367706298828125, 0.156158447265625, 0.7201881408691406, -0.3553314208984375, 0.69842529296875, 0.3394775390625, 0.18727874755859375, -1.0163536071777344, 0.4544525146484375, 0.043701171875, 0.5082015991210938, 22.449302673339844, -0.15438079833984375, -0.45090484619140625, -0.4619140625, 61.89548873901367, -1.5485191345214844, -0.146331787109375, -0.446990966796875, -0.488800048828125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7250, "diff_num_grad_updates_vs_sampler_policy": 7249}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "last_target_update_ts": 58968, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 97.0, "episode_reward_mean": 188.35, "episode_len_mean": 188.35, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0], "episode_lengths": [121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9591529882856193, "mean_inference_ms": 2.176387729547203, "mean_action_processing_ms": 0.2322153261131293, "mean_env_wait_ms": 0.11875125807680922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009596586227416992, "StateBufferConnector_ms": 0.006573200225830078, "ViewRequirementAgentConnector_ms": 0.161391019821167}}, "episode_reward_max": 300.0, "episode_reward_min": 97.0, "episode_reward_mean": 188.35, "episode_len_mean": 188.35, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [121.0, 97.0, 116.0, 112.0, 112.0, 106.0, 118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0], "episode_lengths": [121, 97, 116, 112, 112, 106, 118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9591529882856193, "mean_inference_ms": 2.176387729547203, "mean_action_processing_ms": 0.2322153261131293, "mean_env_wait_ms": 0.11875125807680922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009596586227416992, "StateBufferConnector_ms": 0.006573200225830078, "ViewRequirementAgentConnector_ms": 0.161391019821167}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.6895775924556, "num_env_steps_trained_throughput_per_sec": 802.7583103698224, "timesteps_total": 59000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 43.525, "sample_time_ms": 14.364, "learn_time_ms": 4.341, "learn_throughput": 7372.049, "synch_weights_time_ms": 6.865}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "last_target_update_ts": 58968, "num_target_updates": 116}, "done": false, "episodes_total": 484, "training_iteration": 59, "trial_id": "default", "date": "2024-10-05_20-26-06", "timestamp": 1728152766, "time_this_iter_s": 6.78041410446167, "time_total_s": 333.7597539424896, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 333.7597539424896, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.333333333333336, "ram_util_percent": 91.63333333333334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739075599935058, "mean_inference_ms": 1.1695450549405852, "mean_action_processing_ms": 0.13753051775846406, "mean_env_wait_ms": 0.059895803139063085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034666061401367188, "StateBufferConnector_ms": 0.00316619873046875, "ViewRequirementAgentConnector_ms": 0.0802469253540039}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739075599935058, "mean_inference_ms": 1.1695450549405852, "mean_action_processing_ms": 0.13753051775846406, "mean_env_wait_ms": 0.059895803139063085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034666061401367188, "StateBufferConnector_ms": 0.00316619873046875, "ViewRequirementAgentConnector_ms": 0.0802469253540039}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 68.56135559082031, "min_q": 17.39103889465332, "max_q": 80.20891571044922, "mean_td_error": 2.973951816558838}, "td_error": [0.06427764892578125, -0.0843505859375, 0.6236038208007812, -0.1989593505859375, 1.0702590942382812, 1.1366539001464844, -0.35990142822265625, 0.411895751953125, 0.18172454833984375, 0.45362091064453125, 0.06340789794921875, 0.22544097900390625, 0.959381103515625, 0.8996353149414062, 0.06705474853515625, 16.39103889465332, 0.726226806640625, 0.33428192138671875, 0.8230743408203125, 1.4129562377929688, 1.5041999816894531, 1.8993377685546875, 0.34462738037109375, 0.45398712158203125, 0.5000381469726562, 0.6710586547851562, 1.0046157836914062, 0.8820953369140625, -0.090179443359375, 0.4266777038574219, 0.5118484497070312, 61.856834411621094], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7375, "diff_num_grad_updates_vs_sampler_policy": 7374}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "last_target_update_ts": 59976, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 198.36, "episode_len_mean": 198.36, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0], "episode_lengths": [118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9572498522790696, "mean_inference_ms": 2.1749485749371127, "mean_action_processing_ms": 0.2318651533054284, "mean_env_wait_ms": 0.11859424933103507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00971364974975586, "StateBufferConnector_ms": 0.006609916687011719, "ViewRequirementAgentConnector_ms": 0.16188430786132812}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 198.36, "episode_len_mean": 198.36, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [118.0, 138.0, 217.0, 164.0, 127.0, 164.0, 170.0, 152.0, 166.0, 174.0, 158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0], "episode_lengths": [118, 138, 217, 164, 127, 164, 170, 152, 166, 174, 158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9572498522790696, "mean_inference_ms": 2.1749485749371127, "mean_action_processing_ms": 0.2318651533054284, "mean_env_wait_ms": 0.11859424933103507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00971364974975586, "StateBufferConnector_ms": 0.006609916687011719, "ViewRequirementAgentConnector_ms": 0.16188430786132812}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.14436644703122, "num_env_steps_trained_throughput_per_sec": 800.5774657881249, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 43.268, "sample_time_ms": 14.713, "learn_time_ms": 4.291, "learn_throughput": 7456.83, "synch_weights_time_ms": 6.588}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "last_target_update_ts": 59976, "num_target_updates": 118}, "done": false, "episodes_total": 490, "training_iteration": 60, "trial_id": "default", "date": "2024-10-05_20-26-14", "timestamp": 1728152774, "time_this_iter_s": 7.8602728843688965, "time_total_s": 341.6200268268585, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 341.6200268268585, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.291666666666668, "ram_util_percent": 91.22500000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 183.0, "episode_reward_min": 105.0, "episode_reward_mean": 118.5, "episode_len_mean": 118.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0, 113.0, 105.0, 111.0, 112.0, 114.0, 113.0, 110.0, 111.0, 113.0], "episode_lengths": [183, 113, 105, 111, 112, 114, 113, 110, 111, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750289690464809, "mean_inference_ms": 1.1722191174205698, "mean_action_processing_ms": 0.13784045107346815, "mean_env_wait_ms": 0.060030953619545545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037407875061035156, "StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.09077310562133789}}, "episode_reward_max": 183.0, "episode_reward_min": 105.0, "episode_reward_mean": 118.5, "episode_len_mean": 118.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0, 113.0, 105.0, 111.0, 112.0, 114.0, 113.0, 110.0, 111.0, 113.0], "episode_lengths": [183, 113, 105, 111, 112, 114, 113, 110, 111, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750289690464809, "mean_inference_ms": 1.1722191174205698, "mean_action_processing_ms": 0.13784045107346815, "mean_env_wait_ms": 0.060030953619545545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037407875061035156, "StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.09077310562133789}, "num_agent_steps_sampled_this_iter": 1185, "num_env_steps_sampled_this_iter": 1185, "timesteps_this_iter": 1185, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 62.48576354980469, "min_q": -4.821650505065918, "max_q": 80.23902893066406, "mean_td_error": 0.40752217173576355}, "td_error": [-0.01352691650390625, -0.44382476806640625, -0.1519927978515625, -5.821650505065918, -1.8124995231628418, -0.5659942626953125, -0.4737548828125, -0.1783599853515625, -0.0313568115234375, -0.31201171875, 26.31319236755371, -1.7861709594726562, -0.9103317260742188, 0.18951416015625, -0.5243301391601562, 0.10624313354492188, -0.27971649169921875, -0.45209503173828125, -0.20580291748046875, -0.2758903503417969, -0.29212379455566406, -0.07086181640625, 0.3370819091796875, 0.40233612060546875, -0.18084716796875, -0.02416229248046875, 0.03515625, -0.1642608642578125, 0.31857872009277344, 0.44867706298828125, -0.23326873779296875, 0.09476470947265625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7500, "diff_num_grad_updates_vs_sampler_policy": 7499}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "last_target_update_ts": 60984, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 197.77, "episode_len_mean": 197.77, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0], "episode_lengths": [158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9560207315058533, "mean_inference_ms": 2.1739573132588053, "mean_action_processing_ms": 0.2318110827086206, "mean_env_wait_ms": 0.11858531043651745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01014852523803711, "StateBufferConnector_ms": 0.006826877593994141, "ViewRequirementAgentConnector_ms": 0.16738533973693848}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 197.77, "episode_len_mean": 197.77, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [158.0, 180.0, 164.0, 163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0], "episode_lengths": [158, 180, 164, 163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9560207315058533, "mean_inference_ms": 2.1739573132588053, "mean_action_processing_ms": 0.2318110827086206, "mean_env_wait_ms": 0.11858531043651745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01014852523803711, "StateBufferConnector_ms": 0.006826877593994141, "ViewRequirementAgentConnector_ms": 0.16738533973693848}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.91937954674668, "num_env_steps_trained_throughput_per_sec": 819.6775181869867, "timesteps_total": 61000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 42.836, "sample_time_ms": 14.66, "learn_time_ms": 4.217, "learn_throughput": 7589.14, "synch_weights_time_ms": 6.403}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "last_target_update_ts": 60984, "num_target_updates": 120}, "done": false, "episodes_total": 500, "training_iteration": 61, "trial_id": "default", "date": "2024-10-05_20-26-20", "timestamp": 1728152780, "time_this_iter_s": 6.094574689865112, "time_total_s": 347.71460151672363, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 347.71460151672363, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 36.6875, "ram_util_percent": 91.1875}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37582010705456426, "mean_inference_ms": 1.1748287646534172, "mean_action_processing_ms": 0.1381673801673698, "mean_env_wait_ms": 0.06015937370039761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.08149385452270508}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37582010705456426, "mean_inference_ms": 1.1748287646534172, "mean_action_processing_ms": 0.1381673801673698, "mean_env_wait_ms": 0.06015937370039761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.08149385452270508}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 67.97268676757812, "min_q": -3.6564455032348633, "max_q": 81.3261947631836, "mean_td_error": 1.4031349420547485}, "td_error": [-0.1615753173828125, -0.13217926025390625, -0.1951904296875, -0.432861328125, -0.479339599609375, -0.2356414794921875, -0.6883544921875, -0.22307586669921875, -0.11957550048828125, -0.13858795166015625, -0.26761627197265625, -1.0102081298828125, -0.24663543701171875, -0.9763450622558594, -0.6566390991210938, 0.00997161865234375, -0.22344970703125, -0.36698150634765625, -0.01361083984375, -0.42903900146484375, -0.6517333984375, -0.3031005859375, -4.656445503234863, -0.0151519775390625, 59.85568618774414, -0.1021575927734375, -0.38910675048828125, -0.8778915405273438, -0.38559722900390625, -0.19124603271484375, -0.3465423583984375, -0.04946136474609375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7625, "diff_num_grad_updates_vs_sampler_policy": 7624}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "last_target_update_ts": 61992, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 196.89, "episode_len_mean": 196.89, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0], "episode_lengths": [163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9560974609333963, "mean_inference_ms": 2.173871512915736, "mean_action_processing_ms": 0.23176356147702634, "mean_env_wait_ms": 0.11856822371195655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031637191772461, "StateBufferConnector_ms": 0.006900787353515625, "ViewRequirementAgentConnector_ms": 0.16913747787475586}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 196.89, "episode_len_mean": 196.89, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [163.0, 171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0], "episode_lengths": [163, 171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9560974609333963, "mean_inference_ms": 2.173871512915736, "mean_action_processing_ms": 0.23176356147702634, "mean_env_wait_ms": 0.11856822371195655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031637191772461, "StateBufferConnector_ms": 0.006900787353515625, "ViewRequirementAgentConnector_ms": 0.16913747787475586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.4362472241773, "num_env_steps_trained_throughput_per_sec": 817.7449888967092, "timesteps_total": 62000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 42.212, "sample_time_ms": 14.253, "learn_time_ms": 4.243, "learn_throughput": 7542.483, "synch_weights_time_ms": 6.498}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "last_target_update_ts": 61992, "num_target_updates": 122}, "done": false, "episodes_total": 503, "training_iteration": 62, "trial_id": "default", "date": "2024-10-05_20-26-28", "timestamp": 1728152788, "time_this_iter_s": 7.743520021438599, "time_total_s": 355.45812153816223, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 355.45812153816223, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.063636363636363, "ram_util_percent": 91.16363636363639}}
{"evaluation": {"sampler_results": {"episode_reward_max": 219.0, "episode_reward_min": 136.0, "episode_reward_mean": 152.0, "episode_len_mean": 152.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 219.0, 148.0, 147.0, 137.0, 143.0, 149.0, 137.0, 136.0, 154.0], "episode_lengths": [150, 219, 148, 147, 137, 143, 149, 137, 136, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768684153221083, "mean_inference_ms": 1.1779351256866215, "mean_action_processing_ms": 0.13850311680049437, "mean_env_wait_ms": 0.06031575715987773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004563331604003906, "StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.09085416793823242}}, "episode_reward_max": 219.0, "episode_reward_min": 136.0, "episode_reward_mean": 152.0, "episode_len_mean": 152.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 219.0, 148.0, 147.0, 137.0, 143.0, 149.0, 137.0, 136.0, 154.0], "episode_lengths": [150, 219, 148, 147, 137, 143, 149, 137, 136, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768684153221083, "mean_inference_ms": 1.1779351256866215, "mean_action_processing_ms": 0.13850311680049437, "mean_env_wait_ms": 0.06031575715987773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004563331604003906, "StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.09085416793823242}, "num_agent_steps_sampled_this_iter": 1520, "num_env_steps_sampled_this_iter": 1520, "timesteps_this_iter": 1520, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 66.92642974853516, "min_q": 17.786115646362305, "max_q": 81.17123413085938, "mean_td_error": 0.727522075176239}, "td_error": [0.4381256103515625, -0.2921905517578125, -0.31063079833984375, -0.154693603515625, 0.17376708984375, -0.34908294677734375, -0.43897247314453125, -0.01873779296875, -0.5874710083007812, -0.06134796142578125, -0.379730224609375, -0.01758575439453125, 0.127288818359375, -0.47534942626953125, -0.29254150390625, -0.434326171875, -0.4751129150390625, 0.12485122680664062, 30.215543746948242, -0.5977783203125, -0.3277778625488281, -0.17600250244140625, 0.0444488525390625, -0.42281341552734375, -0.23291778564453125, -0.4954032897949219, -1.0595626831054688, -0.07305908203125, 0.3254680633544922, -0.25193214416503906, -0.09600830078125, -0.14775848388671875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7750, "diff_num_grad_updates_vs_sampler_policy": 7749}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "last_target_update_ts": 63000, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 196.75, "episode_len_mean": 196.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0], "episode_lengths": [171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9554321611013716, "mean_inference_ms": 2.1730257368465895, "mean_action_processing_ms": 0.2315473149479969, "mean_env_wait_ms": 0.11847838659624657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010321378707885742, "StateBufferConnector_ms": 0.00690150260925293, "ViewRequirementAgentConnector_ms": 0.16944169998168945}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 196.75, "episode_len_mean": 196.75, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [171.0, 163.0, 169.0, 184.0, 300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0], "episode_lengths": [171, 163, 169, 184, 300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9554321611013716, "mean_inference_ms": 2.1730257368465895, "mean_action_processing_ms": 0.2315473149479969, "mean_env_wait_ms": 0.11847838659624657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010321378707885742, "StateBufferConnector_ms": 0.00690150260925293, "ViewRequirementAgentConnector_ms": 0.16944169998168945}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.86777826555078, "num_env_steps_trained_throughput_per_sec": 823.4711130622031, "timesteps_total": 63000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 42.459, "sample_time_ms": 14.104, "learn_time_ms": 4.442, "learn_throughput": 7203.304, "synch_weights_time_ms": 6.453}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "last_target_update_ts": 63000, "num_target_updates": 124}, "done": false, "episodes_total": 504, "training_iteration": 63, "trial_id": "default", "date": "2024-10-05_20-26-34", "timestamp": 1728152794, "time_this_iter_s": 6.430634260177612, "time_total_s": 361.88875579833984, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 361.88875579833984, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 34.36666666666667, "ram_util_percent": 91.13333333333334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757254907518256, "mean_inference_ms": 1.180331000299526, "mean_action_processing_ms": 0.13882233904656252, "mean_env_wait_ms": 0.06043437364003049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034427642822265625, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.08030414581298828}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757254907518256, "mean_inference_ms": 1.180331000299526, "mean_action_processing_ms": 0.13882233904656252, "mean_env_wait_ms": 0.06043437364003049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034427642822265625, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.08030414581298828}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 63.112369537353516, "min_q": 10.401440620422363, "max_q": 82.23076629638672, "mean_td_error": 1.391616702079773}, "td_error": [-0.14288330078125, 0.6964797973632812, -2.6104469299316406, -0.7249221801757812, -0.30507659912109375, -0.18762969970703125, -0.7558746337890625, -7.695652008056641, 0.4289398193359375, 9.401440620422363, -0.44849395751953125, -0.28858184814453125, 0.00443267822265625, 58.081302642822266, 0.34320068359375, -0.39508819580078125, -0.15550994873046875, -0.5459175109863281, -0.2809600830078125, -2.147296905517578, -1.0040397644042969, -0.9886550903320312, -0.21381378173828125, -0.0114288330078125, -1.5485267639160156, -0.498382568359375, 0.0294036865234375, 0.02789306640625, -0.7367172241210938, -0.8111801147460938, -1.6972894668579102, -0.28699493408203125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7875, "diff_num_grad_updates_vs_sampler_policy": 7874}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "last_target_update_ts": 63504, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 201.88, "episode_len_mean": 201.88, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.958856857118038, "mean_inference_ms": 2.1773287074250787, "mean_action_processing_ms": 0.23225404426125995, "mean_env_wait_ms": 0.11876024942606903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01037454605102539, "StateBufferConnector_ms": 0.007010459899902344, "ViewRequirementAgentConnector_ms": 0.17220497131347656}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 201.88, "episode_len_mean": 201.88, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.958856857118038, "mean_inference_ms": 2.1773287074250787, "mean_action_processing_ms": 0.23225404426125995, "mean_env_wait_ms": 0.11876024942606903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01037454605102539, "StateBufferConnector_ms": 0.007010459899902344, "ViewRequirementAgentConnector_ms": 0.17220497131347656}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.52571249507233, "num_env_steps_trained_throughput_per_sec": 822.1028499802893, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 40.819, "sample_time_ms": 14.336, "learn_time_ms": 4.408, "learn_throughput": 7260.075, "synch_weights_time_ms": 6.707}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "last_target_update_ts": 63504, "num_target_updates": 125}, "done": false, "episodes_total": 508, "training_iteration": 64, "trial_id": "default", "date": "2024-10-05_20-26-42", "timestamp": 1728152802, "time_this_iter_s": 7.721271991729736, "time_total_s": 369.6100277900696, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 369.6100277900696, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.6909090909091, "ram_util_percent": 91.0909090909091}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37817699875663363, "mean_inference_ms": 1.1823701275243774, "mean_action_processing_ms": 0.1391202668645363, "mean_env_wait_ms": 0.060547702949522296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033974647521972656, "StateBufferConnector_ms": 0.0030565261840820312, "ViewRequirementAgentConnector_ms": 0.07922172546386719}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37817699875663363, "mean_inference_ms": 1.1823701275243774, "mean_action_processing_ms": 0.1391202668645363, "mean_env_wait_ms": 0.060547702949522296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033974647521972656, "StateBufferConnector_ms": 0.0030565261840820312, "ViewRequirementAgentConnector_ms": 0.07922172546386719}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 63.749488830566406, "min_q": 6.15419864654541, "max_q": 82.56610870361328, "mean_td_error": 1.0392897129058838}, "td_error": [6.185904502868652, 16.12763023376465, 0.15235137939453125, -0.018451690673828125, 0.058864593505859375, 0.34920501708984375, 0.09793853759765625, 0.034027099609375, 0.14424896240234375, -0.02169036865234375, 0.41600799560546875, 0.058704376220703125, 0.30759429931640625, 0.02602386474609375, 0.41773223876953125, 0.01410675048828125, 0.13262176513671875, -0.6529350280761719, 0.06473541259765625, 5.15419864654541, -0.0812835693359375, 0.17828369140625, -0.1318359375, 0.9188346862792969, 3.706644058227539, -0.0639495849609375, -0.13349151611328125, 0.004913330078125, 0.19652557373046875, -0.01955413818359375, 0.16306304931640625, -0.5296974182128906], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8000, "diff_num_grad_updates_vs_sampler_policy": 7999}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "last_target_update_ts": 64512, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 201.88, "episode_len_mean": 201.88, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9590853952856764, "mean_inference_ms": 2.177122750011101, "mean_action_processing_ms": 0.2319975516933237, "mean_env_wait_ms": 0.1186582182689061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010412216186523438, "StateBufferConnector_ms": 0.007109403610229492, "ViewRequirementAgentConnector_ms": 0.17426848411560059}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 201.88, "episode_len_mean": 201.88, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 293.0, 255.0, 300.0, 145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 293, 255, 300, 145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9590853952856764, "mean_inference_ms": 2.177122750011101, "mean_action_processing_ms": 0.2319975516933237, "mean_env_wait_ms": 0.1186582182689061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010412216186523438, "StateBufferConnector_ms": 0.007109403610229492, "ViewRequirementAgentConnector_ms": 0.17426848411560059}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.1828343000133, "num_env_steps_trained_throughput_per_sec": 820.7313372000532, "timesteps_total": 65000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 39.839, "sample_time_ms": 14.374, "learn_time_ms": 4.369, "learn_throughput": 7324.776, "synch_weights_time_ms": 6.449}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "last_target_update_ts": 64512, "num_target_updates": 127}, "done": false, "episodes_total": 512, "training_iteration": 65, "trial_id": "default", "date": "2024-10-05_20-26-50", "timestamp": 1728152810, "time_this_iter_s": 7.71091365814209, "time_total_s": 377.32094144821167, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 377.32094144821167, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 31.227272727272727, "ram_util_percent": 91.10000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755891482385661, "mean_inference_ms": 1.1745530812762333, "mean_action_processing_ms": 0.13818412317128068, "mean_env_wait_ms": 0.0601307816012107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0021195411682128906, "ViewRequirementAgentConnector_ms": 0.056264400482177734}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755891482385661, "mean_inference_ms": 1.1745530812762333, "mean_action_processing_ms": 0.13818412317128068, "mean_env_wait_ms": 0.0601307816012107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0021195411682128906, "ViewRequirementAgentConnector_ms": 0.056264400482177734}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 72.061767578125, "min_q": 20.697954177856445, "max_q": 83.29390716552734, "mean_td_error": 1.7534879446029663}, "td_error": [-0.14999771118164062, 0.2476959228515625, 0.04354095458984375, -0.33571624755859375, 0.08209991455078125, 0.0248260498046875, -0.24885940551757812, -0.0463104248046875, 0.12488555908203125, 0.189239501953125, -0.016632080078125, -0.102081298828125, -0.0531158447265625, -0.13823699951171875, 0.140045166015625, -0.21221160888671875, 0.017333984375, 0.1453399658203125, 0.00603485107421875, 0.1704559326171875, -0.237823486328125, 0.25933074951171875, -0.12570953369140625, 0.11133575439453125, -1.0319557189941406, -0.0297393798828125, -0.2677574157714844, -0.21480560302734375, -0.11431121826171875, -0.25543212890625, 58.642791748046875, -0.5126457214355469], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8125, "diff_num_grad_updates_vs_sampler_policy": 8124}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "last_target_update_ts": 65520, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 202.4, "episode_len_mean": 202.4, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9624529564471664, "mean_inference_ms": 2.180973387773222, "mean_action_processing_ms": 0.23267172264033908, "mean_env_wait_ms": 0.11894115843303674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010394573211669922, "StateBufferConnector_ms": 0.007078409194946289, "ViewRequirementAgentConnector_ms": 0.17497539520263672}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 202.4, "episode_len_mean": 202.4, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 143.0, 133.0, 137.0, 137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [145, 143, 133, 137, 137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9624529564471664, "mean_inference_ms": 2.180973387773222, "mean_action_processing_ms": 0.23267172264033908, "mean_env_wait_ms": 0.11894115843303674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010394573211669922, "StateBufferConnector_ms": 0.007078409194946289, "ViewRequirementAgentConnector_ms": 0.17497539520263672}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.83141594470916, "num_env_steps_trained_throughput_per_sec": 951.3256637788367, "timesteps_total": 66000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 25.529, "sample_time_ms": 9.313, "learn_time_ms": 2.901, "learn_throughput": 11031.473, "synch_weights_time_ms": 4.216}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "last_target_update_ts": 65520, "num_target_updates": 129}, "done": false, "episodes_total": 516, "training_iteration": 66, "trial_id": "default", "date": "2024-10-05_20-26-56", "timestamp": 1728152816, "time_this_iter_s": 6.1831560134887695, "time_total_s": 383.50409746170044, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 383.50409746170044, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 32.2, "ram_util_percent": 91.36666666666667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37306854933478284, "mean_inference_ms": 1.167397990393557, "mean_action_processing_ms": 0.13727863392195627, "mean_env_wait_ms": 0.05973586464299626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464221954345703, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05602836608886719}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37306854933478284, "mean_inference_ms": 1.167397990393557, "mean_action_processing_ms": 0.13727863392195627, "mean_env_wait_ms": 0.05973586464299626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464221954345703, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05602836608886719}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 72.16620635986328, "min_q": 9.427804946899414, "max_q": 84.01949310302734, "mean_td_error": 0.41346827149391174}, "td_error": [0.39655303955078125, 0.20728302001953125, 0.3332061767578125, 0.8169479370117188, 0.2071990966796875, 0.8075408935546875, 1.4007062911987305, 0.087371826171875, 0.0810394287109375, 1.5399932861328125, 0.22354888916015625, -0.224639892578125, 0.9581298828125, 0.23485565185546875, 0.0410308837890625, 0.23703765869140625, 0.10865020751953125, 0.5394744873046875, 0.14267730712890625, 0.22292327880859375, 0.006011962890625, 0.276153564453125, -0.03415679931640625, -0.05338287353515625, 0.2845916748046875, 0.4981842041015625, 0.460693359375, 0.7677993774414062, 0.3864898681640625, 0.05826568603515625, 0.25107574462890625, 1.9677295684814453], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8250, "diff_num_grad_updates_vs_sampler_policy": 8249}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "last_target_update_ts": 66528, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 208.82, "episode_len_mean": 208.82, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620430198055936, "mean_inference_ms": 2.1801553664510562, "mean_action_processing_ms": 0.23234058800014928, "mean_env_wait_ms": 0.11880740354090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010254859924316406, "StateBufferConnector_ms": 0.00696253776550293, "ViewRequirementAgentConnector_ms": 0.17171311378479004}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 208.82, "episode_len_mean": 208.82, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620430198055936, "mean_inference_ms": 2.1801553664510562, "mean_action_processing_ms": 0.23234058800014928, "mean_env_wait_ms": 0.11880740354090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010254859924316406, "StateBufferConnector_ms": 0.00696253776550293, "ViewRequirementAgentConnector_ms": 0.17171311378479004}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.84556168967384, "num_env_steps_trained_throughput_per_sec": 1275.3822467586954, "timesteps_total": 67000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 25.56, "sample_time_ms": 9.586, "learn_time_ms": 2.796, "learn_throughput": 11445.286, "synch_weights_time_ms": 4.194}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "last_target_update_ts": 66528, "num_target_updates": 131}, "done": false, "episodes_total": 520, "training_iteration": 67, "trial_id": "default", "date": "2024-10-05_20-27-01", "timestamp": 1728152821, "time_this_iter_s": 5.126240015029907, "time_total_s": 388.63033747673035, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 388.63033747673035, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.0375, "ram_util_percent": 91.2875}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707221049677804, "mean_inference_ms": 1.1604802713738958, "mean_action_processing_ms": 0.1364187292319366, "mean_env_wait_ms": 0.05936387605244868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.002346038818359375, "ViewRequirementAgentConnector_ms": 0.05773305892944336}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707221049677804, "mean_inference_ms": 1.1604802713738958, "mean_action_processing_ms": 0.1364187292319366, "mean_env_wait_ms": 0.05936387605244868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.002346038818359375, "ViewRequirementAgentConnector_ms": 0.05773305892944336}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 73.91358947753906, "min_q": 7.508965015411377, "max_q": 84.1027603149414, "mean_td_error": 0.001209452748298645}, "td_error": [0.628448486328125, -1.450408935546875, 0.12718963623046875, 0.02777099609375, -0.4825286865234375, 0.23325347900390625, -0.38268280029296875, 0.18897247314453125, 0.8603897094726562, 0.2270965576171875, 0.28389739990234375, -0.1270294189453125, 0.26450347900390625, -0.28964996337890625, 0.10245513916015625, 0.10013580322265625, -0.323760986328125, -0.1595916748046875, 0.152008056640625, 0.33155059814453125, -0.5846953392028809, 0.12509918212890625, -0.7570915222167969, 0.20420074462890625, -0.14441680908203125, 0.43145751953125, -0.7498588562011719, 0.5131988525390625, 0.25146484375, 0.206390380859375, 0.26747894287109375, -0.0365447998046875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8375, "diff_num_grad_updates_vs_sampler_policy": 8374}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "last_target_update_ts": 67536, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 208.82, "episode_len_mean": 208.82, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620430198055936, "mean_inference_ms": 2.1801553664510562, "mean_action_processing_ms": 0.23234058800014928, "mean_env_wait_ms": 0.11880740354090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010254859924316406, "StateBufferConnector_ms": 0.00696253776550293, "ViewRequirementAgentConnector_ms": 0.17171311378479004}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 208.82, "episode_len_mean": 208.82, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.0, 137.0, 137.0, 139.0, 159.0, 300.0, 300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [137, 137, 137, 139, 159, 300, 300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9620430198055936, "mean_inference_ms": 2.1801553664510562, "mean_action_processing_ms": 0.23234058800014928, "mean_env_wait_ms": 0.11880740354090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010254859924316406, "StateBufferConnector_ms": 0.00696253776550293, "ViewRequirementAgentConnector_ms": 0.17171311378479004}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.6015431130757, "num_env_steps_trained_throughput_per_sec": 1266.4061724523028, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 25.387, "sample_time_ms": 9.226, "learn_time_ms": 2.854, "learn_throughput": 11212.936, "synch_weights_time_ms": 4.195}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "last_target_update_ts": 67536, "num_target_updates": 133}, "done": false, "episodes_total": 520, "training_iteration": 68, "trial_id": "default", "date": "2024-10-05_20-27-06", "timestamp": 1728152826, "time_this_iter_s": 5.143967866897583, "time_total_s": 393.77430534362793, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 393.77430534362793, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.814285714285713, "ram_util_percent": 91.24285714285715}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3684360276995081, "mean_inference_ms": 1.1538204075026175, "mean_action_processing_ms": 0.13560060496709161, "mean_env_wait_ms": 0.059013639364844286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002346038818359375, "StateBufferConnector_ms": 0.0021004676818847656, "ViewRequirementAgentConnector_ms": 0.05449533462524414}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3684360276995081, "mean_inference_ms": 1.1538204075026175, "mean_action_processing_ms": 0.13560060496709161, "mean_env_wait_ms": 0.059013639364844286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002346038818359375, "StateBufferConnector_ms": 0.0021004676818847656, "ViewRequirementAgentConnector_ms": 0.05449533462524414}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 74.54998779296875, "min_q": 13.191977500915527, "max_q": 84.98020935058594, "mean_td_error": 1.6961945295333862}, "td_error": [0.2847023010253906, 0.36861419677734375, 0.1446685791015625, -0.01326751708984375, 0.13443756103515625, 0.06325531005859375, 0.17535400390625, 0.3088226318359375, -0.153594970703125, 0.08332061767578125, 0.15908050537109375, 0.500091552734375, -0.2274932861328125, 0.3558807373046875, 0.0457763671875, 0.1187744140625, 0.5092849731445312, 0.17418956756591797, 0.045806884765625, 0.18408203125, -0.2522735595703125, 0.0630950927734375, 0.06357574462890625, -0.00051116943359375, 0.25376129150390625, -0.16119384765625, 0.39385223388671875, 0.08496856689453125, 0.28348541259765625, 0.39823150634765625, 0.02965545654296875, 49.85979080200195], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8500, "diff_num_grad_updates_vs_sampler_policy": 8499}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "last_target_update_ts": 68544, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 216.73, "episode_len_mean": 216.73, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9631493446410448, "mean_inference_ms": 2.181420079154795, "mean_action_processing_ms": 0.23260648175769463, "mean_env_wait_ms": 0.11891977977790838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010048627853393555, "StateBufferConnector_ms": 0.006777286529541016, "ViewRequirementAgentConnector_ms": 0.16659307479858398}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 216.73, "episode_len_mean": 216.73, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 164.0, 170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 164, 170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9631493446410448, "mean_inference_ms": 2.181420079154795, "mean_action_processing_ms": 0.23260648175769463, "mean_env_wait_ms": 0.11891977977790838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010048627853393555, "StateBufferConnector_ms": 0.006777286529541016, "ViewRequirementAgentConnector_ms": 0.16659307479858398}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7285276754938, "num_env_steps_trained_throughput_per_sec": 1258.9141107019752, "timesteps_total": 69000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 25.486, "sample_time_ms": 9.323, "learn_time_ms": 2.802, "learn_throughput": 11420.453, "synch_weights_time_ms": 4.164}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "last_target_update_ts": 68544, "num_target_updates": 135}, "done": false, "episodes_total": 526, "training_iteration": 69, "trial_id": "default", "date": "2024-10-05_20-27-11", "timestamp": 1728152831, "time_this_iter_s": 5.1554577350616455, "time_total_s": 398.9297630786896, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 398.9297630786896, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.942857142857147, "ram_util_percent": 91.20000000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662907514609057, "mean_inference_ms": 1.1474407966521842, "mean_action_processing_ms": 0.13482537530367258, "mean_env_wait_ms": 0.05867447295220459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002319812774658203, "StateBufferConnector_ms": 0.002124309539794922, "ViewRequirementAgentConnector_ms": 0.05459308624267578}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662907514609057, "mean_inference_ms": 1.1474407966521842, "mean_action_processing_ms": 0.13482537530367258, "mean_env_wait_ms": 0.05867447295220459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002319812774658203, "StateBufferConnector_ms": 0.002124309539794922, "ViewRequirementAgentConnector_ms": 0.05459308624267578}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 67.65016174316406, "min_q": -2.1328673362731934, "max_q": 85.12976837158203, "mean_td_error": 0.70698082447052}, "td_error": [0.1011505126953125, -0.3956756591796875, -1.1587715148925781, -0.15319061279296875, 0.10608673095703125, -0.30204010009765625, -0.08435821533203125, 0.09691619873046875, 0.1302490234375, -0.6629295349121094, 18.341615676879883, 0.01796722412109375, 0.10174942016601562, -0.13599395751953125, 0.22586822509765625, 7.189648628234863, -1.7832841873168945, 0.2523193359375, 0.24697113037109375, -0.35320281982421875, -0.01010894775390625, -0.00659942626953125, 3.0517578125e-05, 0.205474853515625, -0.05173492431640625, 0.0601348876953125, 0.1822052001953125, -0.1035308837890625, 0.09188079833984375, 0.1381988525390625, 0.17244720458984375, 0.1638946533203125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8625, "diff_num_grad_updates_vs_sampler_policy": 8624}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "last_target_update_ts": 69552, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 218.09, "episode_len_mean": 218.09, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.962135499272086, "mean_inference_ms": 2.180017018495128, "mean_action_processing_ms": 0.23233776667243905, "mean_env_wait_ms": 0.11880867258505978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.006734371185302734, "ViewRequirementAgentConnector_ms": 0.16541171073913574}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 218.09, "episode_len_mean": 218.09, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [170.0, 125.0, 143.0, 170.0, 210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [170, 125, 143, 170, 210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.962135499272086, "mean_inference_ms": 2.180017018495128, "mean_action_processing_ms": 0.23233776667243905, "mean_env_wait_ms": 0.11880867258505978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.006734371185302734, "ViewRequirementAgentConnector_ms": 0.16541171073913574}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.20106871560256, "num_env_steps_trained_throughput_per_sec": 1256.8042748624102, "timesteps_total": 70000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 25.474, "sample_time_ms": 9.423, "learn_time_ms": 2.738, "learn_throughput": 11685.536, "synch_weights_time_ms": 4.249}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "last_target_update_ts": 69552, "num_target_updates": 137}, "done": false, "episodes_total": 528, "training_iteration": 70, "trial_id": "default", "date": "2024-10-05_20-27-17", "timestamp": 1728152837, "time_this_iter_s": 5.161311626434326, "time_total_s": 404.0910747051239, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 404.0910747051239, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 29.187499999999996, "ram_util_percent": 91.275}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3644599106199373, "mean_inference_ms": 1.1422547552036275, "mean_action_processing_ms": 0.13418009069835204, "mean_env_wait_ms": 0.058390306945048674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003120899200439453, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.055942535400390625}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3644599106199373, "mean_inference_ms": 1.1422547552036275, "mean_action_processing_ms": 0.13418009069835204, "mean_env_wait_ms": 0.058390306945048674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003120899200439453, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.055942535400390625}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 70.95133209228516, "min_q": 7.150885581970215, "max_q": 86.11187744140625, "mean_td_error": 0.24698588252067566}, "td_error": [0.10601806640625, 0.02240753173828125, 0.3659515380859375, 0.34511566162109375, 0.33719635009765625, 0.1996612548828125, 0.29337310791015625, -0.0627899169921875, 0.6444244384765625, 0.42020416259765625, 0.1400146484375, 0.52203369140625, 0.269989013671875, 0.3365478515625, 0.16506195068359375, 0.6317377090454102, 0.01796722412109375, 0.3419990539550781, 0.0618743896484375, 0.0592041015625, 0.5639114379882812, -0.03876495361328125, 0.3143310546875, 0.2355022430419922, -0.35784912109375, 0.37065887451171875, 0.02886199951171875, 0.027923583984375, 0.42928314208984375, 0.8131675720214844, 0.10669708251953125, 0.19183349609375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8750, "diff_num_grad_updates_vs_sampler_policy": 8749}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "last_target_update_ts": 70560, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 224.01, "episode_len_mean": 224.01, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9636861634471157, "mean_inference_ms": 2.182260945315325, "mean_action_processing_ms": 0.23276601990220475, "mean_env_wait_ms": 0.11897942502270385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009925603866577148, "StateBufferConnector_ms": 0.006660938262939453, "ViewRequirementAgentConnector_ms": 0.16365838050842285}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 224.01, "episode_len_mean": 224.01, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [210.0, 160.0, 180.0, 181.0, 225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [210, 160, 180, 181, 225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9636861634471157, "mean_inference_ms": 2.182260945315325, "mean_action_processing_ms": 0.23276601990220475, "mean_env_wait_ms": 0.11897942502270385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009925603866577148, "StateBufferConnector_ms": 0.006660938262939453, "ViewRequirementAgentConnector_ms": 0.16365838050842285}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.87832644014486, "num_env_steps_trained_throughput_per_sec": 1259.5133057605794, "timesteps_total": 71000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 25.416, "sample_time_ms": 9.307, "learn_time_ms": 2.716, "learn_throughput": 11780.719, "synch_weights_time_ms": 4.315}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "last_target_update_ts": 70560, "num_target_updates": 139}, "done": false, "episodes_total": 532, "training_iteration": 71, "trial_id": "default", "date": "2024-10-05_20-27-22", "timestamp": 1728152842, "time_this_iter_s": 5.237164258956909, "time_total_s": 409.3282389640808, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 409.3282389640808, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 31.285714285714285, "ram_util_percent": 91.29999999999998}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36547223873834567, "mean_inference_ms": 1.1457750602191639, "mean_action_processing_ms": 0.13461214568437513, "mean_env_wait_ms": 0.058575209855805846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004541873931884766, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.08019447326660156}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36547223873834567, "mean_inference_ms": 1.1457750602191639, "mean_action_processing_ms": 0.13461214568437513, "mean_env_wait_ms": 0.058575209855805846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004541873931884766, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.08019447326660156}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 76.77250671386719, "min_q": 29.876583099365234, "max_q": 85.877197265625, "mean_td_error": 0.986573338508606}, "td_error": [-0.0198974609375, 0.24413299560546875, 0.09122467041015625, 0.15570831298828125, -0.34881591796875, 0.06982421875, -0.268402099609375, 0.08612060546875, 0.27767181396484375, 0.2548675537109375, 0.0632476806640625, 0.3376007080078125, 0.00958251953125, 0.18166351318359375, -0.3148460388183594, 0.08622360229492188, 0.19373321533203125, -0.5806884765625, -0.040069580078125, 0.395660400390625, 0.379852294921875, 0.0643310546875, 0.49713134765625, 0.3187103271484375, -0.2000579833984375, -0.03745269775390625, 0.5080184936523438, -0.0068511962890625, 28.876583099365234, 0.26137542724609375, 0.08116912841796875, -0.04700469970703125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8875, "diff_num_grad_updates_vs_sampler_policy": 8874}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "last_target_update_ts": 71568, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 228.7, "episode_len_mean": 228.7, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.962870214688229, "mean_inference_ms": 2.1816435294325656, "mean_action_processing_ms": 0.23254112292047766, "mean_env_wait_ms": 0.11887510326969021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00989842414855957, "StateBufferConnector_ms": 0.006663084030151367, "ViewRequirementAgentConnector_ms": 0.1635754108428955}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 228.7, "episode_len_mean": 228.7, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [225.0, 270.0, 234.0, 152.0, 300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [225, 270, 234, 152, 300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.962870214688229, "mean_inference_ms": 2.1816435294325656, "mean_action_processing_ms": 0.23254112292047766, "mean_env_wait_ms": 0.11887510326969021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00989842414855957, "StateBufferConnector_ms": 0.006663084030151367, "ViewRequirementAgentConnector_ms": 0.1635754108428955}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.8844455602744, "num_env_steps_trained_throughput_per_sec": 807.5377822410976, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 41.21, "sample_time_ms": 14.635, "learn_time_ms": 4.469, "learn_throughput": 7160.685, "synch_weights_time_ms": 6.75}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "last_target_update_ts": 71568, "num_target_updates": 141}, "done": false, "episodes_total": 536, "training_iteration": 72, "trial_id": "default", "date": "2024-10-05_20-27-30", "timestamp": 1728152850, "time_this_iter_s": 7.878485679626465, "time_total_s": 417.2067246437073, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 417.2067246437073, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 31.37272727272727, "ram_util_percent": 91.33636363636363}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3663699017629138, "mean_inference_ms": 1.1486920218397338, "mean_action_processing_ms": 0.1349758637352682, "mean_env_wait_ms": 0.05872784838587165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.003077983856201172, "ViewRequirementAgentConnector_ms": 0.08316993713378906}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3663699017629138, "mean_inference_ms": 1.1486920218397338, "mean_action_processing_ms": 0.1349758637352682, "mean_env_wait_ms": 0.05872784838587165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.003077983856201172, "ViewRequirementAgentConnector_ms": 0.08316993713378906}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 74.08206176757812, "min_q": 2.661496639251709, "max_q": 85.96060943603516, "mean_td_error": 1.8189489841461182}, "td_error": [-1.0744552612304688, -0.13678741455078125, 58.6530647277832, -0.02751922607421875, -0.29949188232421875, 0.08385467529296875, 0.25057220458984375, 0.16931915283203125, 0.12823486328125, 1.661496639251709, -0.292816162109375, 0.089111328125, -0.042022705078125, -0.1937103271484375, -0.0252227783203125, 0.023590087890625, -0.09856033325195312, 0.28356170654296875, 0.05887603759765625, 0.06722259521484375, -0.2667388916015625, 0.7588424682617188, -0.5119781494140625, -0.32776641845703125, -0.10723876953125, 0.10236358642578125, 0.1306915283203125, -0.14968109130859375, -0.06653594970703125, -0.13199615478515625, -0.32378387451171875, -0.17812728881835938], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9000, "diff_num_grad_updates_vs_sampler_policy": 8999}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "last_target_update_ts": 72576, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 231.89, "episode_len_mean": 231.89, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9608917479477659, "mean_inference_ms": 2.17897257351913, "mean_action_processing_ms": 0.23242663119025742, "mean_env_wait_ms": 0.11884848554964628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009940624237060547, "StateBufferConnector_ms": 0.0066835880279541016, "ViewRequirementAgentConnector_ms": 0.1638627052307129}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 231.89, "episode_len_mean": 231.89, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 248.0, 300.0, 300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 248, 300, 300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9608917479477659, "mean_inference_ms": 2.17897257351913, "mean_action_processing_ms": 0.23242663119025742, "mean_env_wait_ms": 0.11884848554964628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009940624237060547, "StateBufferConnector_ms": 0.0066835880279541016, "ViewRequirementAgentConnector_ms": 0.1638627052307129}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.28304079103012, "num_env_steps_trained_throughput_per_sec": 805.1321631641205, "timesteps_total": 73000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 41.156, "sample_time_ms": 14.879, "learn_time_ms": 4.365, "learn_throughput": 7330.737, "synch_weights_time_ms": 6.709}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "last_target_update_ts": 72576, "num_target_updates": 143}, "done": false, "episodes_total": 540, "training_iteration": 73, "trial_id": "default", "date": "2024-10-05_20-27-38", "timestamp": 1728152858, "time_this_iter_s": 7.851998805999756, "time_total_s": 425.05872344970703, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 425.05872344970703, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.46363636363636, "ram_util_percent": 91.44545454545455}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3670544701360761, "mean_inference_ms": 1.154566861843053, "mean_action_processing_ms": 0.1352704718635839, "mean_env_wait_ms": 0.05884826326223251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033140182495117188, "StateBufferConnector_ms": 0.003020763397216797, "ViewRequirementAgentConnector_ms": 0.07994651794433594}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3670544701360761, "mean_inference_ms": 1.154566861843053, "mean_action_processing_ms": 0.1352704718635839, "mean_env_wait_ms": 0.05884826326223251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033140182495117188, "StateBufferConnector_ms": 0.003020763397216797, "ViewRequirementAgentConnector_ms": 0.07994651794433594}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 73.79488372802734, "min_q": 6.933247089385986, "max_q": 86.5564193725586, "mean_td_error": 0.18025146424770355}, "td_error": [0.196746826171875, 0.04840850830078125, 0.47600555419921875, -0.01320648193359375, 0.4195404052734375, 0.030857086181640625, 0.49285125732421875, 0.01845550537109375, -0.257354736328125, 0.2741708755493164, 0.42807769775390625, 0.30039215087890625, -0.28638458251953125, -0.0944976806640625, 0.1318359375, 0.4584808349609375, 1.4255599975585938, 0.0053253173828125, -0.2624359130859375, -0.26915740966796875, -0.006753444671630859, 0.12628936767578125, -0.29779815673828125, 0.9614334106445312, -0.16654205322265625, -0.15651702880859375, 0.12274169921875, 0.19512176513671875, 0.12467193603515625, 0.9869613647460938, 0.4476165771484375, -0.0928497314453125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9125, "diff_num_grad_updates_vs_sampler_policy": 9124}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "last_target_update_ts": 73584, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 232.41, "episode_len_mean": 232.41, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9598721716470155, "mean_inference_ms": 2.1775631073459523, "mean_action_processing_ms": 0.23213117662017624, "mean_env_wait_ms": 0.11871771561778127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009832143783569336, "StateBufferConnector_ms": 0.006658792495727539, "ViewRequirementAgentConnector_ms": 0.1633012294769287}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 232.41, "episode_len_mean": 232.41, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9598721716470155, "mean_inference_ms": 2.1775631073459523, "mean_action_processing_ms": 0.23213117662017624, "mean_env_wait_ms": 0.11871771561778127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009832143783569336, "StateBufferConnector_ms": 0.006658792495727539, "ViewRequirementAgentConnector_ms": 0.1633012294769287}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.19288509963442, "num_env_steps_trained_throughput_per_sec": 816.7715403985377, "timesteps_total": 74000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 40.696, "sample_time_ms": 14.47, "learn_time_ms": 4.385, "learn_throughput": 7298.408, "synch_weights_time_ms": 6.604}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "last_target_update_ts": 73584, "num_target_updates": 145}, "done": false, "episodes_total": 543, "training_iteration": 74, "trial_id": "default", "date": "2024-10-05_20-27-46", "timestamp": 1728152866, "time_this_iter_s": 7.979843854904175, "time_total_s": 433.0385673046112, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 433.0385673046112, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.183333333333334, "ram_util_percent": 91.35833333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3677774073925305, "mean_inference_ms": 1.1566665102888805, "mean_action_processing_ms": 0.1355812627273975, "mean_env_wait_ms": 0.058963697472166565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033426284790039062, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.08330106735229492}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3677774073925305, "mean_inference_ms": 1.1566665102888805, "mean_action_processing_ms": 0.1355812627273975, "mean_env_wait_ms": 0.058963697472166565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033426284790039062, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.08330106735229492}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 77.667724609375, "min_q": 39.997528076171875, "max_q": 86.97229766845703, "mean_td_error": -0.25911080837249756}, "td_error": [-0.81109619140625, -0.0029449462890625, 0.263916015625, -0.00600433349609375, 0.07476806640625, -0.18482208251953125, -0.11468505859375, 0.19606781005859375, -0.3214263916015625, 0.06143951416015625, -0.6726531982421875, -0.9816741943359375, 0.023834228515625, 0.17150115966796875, 0.16492462158203125, -0.5177993774414062, -0.08902740478515625, -0.2006988525390625, -0.25725555419921875, -0.4994773864746094, 0.19841766357421875, -3.3786239624023438, -0.6261138916015625, 0.097808837890625, 0.08274078369140625, -0.9654464721679688, 0.2576446533203125, -0.00106048583984375, -0.47299957275390625, -0.14614105224609375, -0.00989532470703125, 0.37523651123046875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9250, "diff_num_grad_updates_vs_sampler_policy": 9249}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "last_target_update_ts": 74592, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 232.41, "episode_len_mean": 232.41, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9589383982690936, "mean_inference_ms": 2.176697211179845, "mean_action_processing_ms": 0.2319268572255773, "mean_env_wait_ms": 0.11863096817202315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009783744812011719, "StateBufferConnector_ms": 0.0066318511962890625, "ViewRequirementAgentConnector_ms": 0.16276144981384277}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 232.41, "episode_len_mean": 232.41, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [181.0, 300.0, 158.0, 147.0, 145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [181, 300, 158, 147, 145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9589383982690936, "mean_inference_ms": 2.176697211179845, "mean_action_processing_ms": 0.2319268572255773, "mean_env_wait_ms": 0.11863096817202315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009783744812011719, "StateBufferConnector_ms": 0.0066318511962890625, "ViewRequirementAgentConnector_ms": 0.16276144981384277}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.68713223709213, "num_env_steps_trained_throughput_per_sec": 818.7485289483685, "timesteps_total": 75000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 41.795, "sample_time_ms": 14.876, "learn_time_ms": 4.645, "learn_throughput": 6888.648, "synch_weights_time_ms": 6.791}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "last_target_update_ts": 74592, "num_target_updates": 147}, "done": false, "episodes_total": 544, "training_iteration": 75, "trial_id": "default", "date": "2024-10-05_20-27-53", "timestamp": 1728152873, "time_this_iter_s": 7.721780776977539, "time_total_s": 440.76034808158875, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 440.76034808158875, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.181818181818183, "ram_util_percent": 91.39999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36852322119133774, "mean_inference_ms": 1.1592273061427396, "mean_action_processing_ms": 0.13589096821082716, "mean_env_wait_ms": 0.0590926412683048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038051605224609375, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.0826716423034668}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36852322119133774, "mean_inference_ms": 1.1592273061427396, "mean_action_processing_ms": 0.13589096821082716, "mean_env_wait_ms": 0.0590926412683048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038051605224609375, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.0826716423034668}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 79.85134887695312, "min_q": 43.85551071166992, "max_q": 86.99314880371094, "mean_td_error": -0.23427534103393555}, "td_error": [-0.29010009765625, -0.6072998046875, 0.9416427612304688, -0.11840057373046875, -0.264068603515625, -0.18172454833984375, -0.43082427978515625, -0.5114593505859375, -0.15108489990234375, 0.13707733154296875, -0.19661712646484375, -0.30104827880859375, -0.2107696533203125, -0.30228424072265625, -0.3587188720703125, -0.6306686401367188, -0.0147552490234375, -0.22768783569335938, -0.31988525390625, -0.15279769897460938, -0.4419097900390625, 0.36023712158203125, -0.1628570556640625, -0.04352569580078125, -0.9858779907226562, -0.642059326171875, -0.582733154296875, -0.2451171875, -0.6308059692382812, -0.0617218017578125, 0.53173828125, -0.40070343017578125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9375, "diff_num_grad_updates_vs_sampler_policy": 9374}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "last_target_update_ts": 75600, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 236.55, "episode_len_mean": 236.55, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9585495352861115, "mean_inference_ms": 2.1757328225794508, "mean_action_processing_ms": 0.2321179170662667, "mean_env_wait_ms": 0.11872015273204001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009792804718017578, "StateBufferConnector_ms": 0.006636142730712891, "ViewRequirementAgentConnector_ms": 0.16086745262145996}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 236.55, "episode_len_mean": 236.55, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 151.0, 172.0, 164.0, 155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [145, 151, 172, 164, 155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9585495352861115, "mean_inference_ms": 2.1757328225794508, "mean_action_processing_ms": 0.2321179170662667, "mean_env_wait_ms": 0.11872015273204001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009792804718017578, "StateBufferConnector_ms": 0.006636142730712891, "ViewRequirementAgentConnector_ms": 0.16086745262145996}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.9734537047907, "num_env_steps_trained_throughput_per_sec": 827.8938148191628, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 39.406, "sample_time_ms": 14.096, "learn_time_ms": 4.208, "learn_throughput": 7605.223, "synch_weights_time_ms": 6.49}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "last_target_update_ts": 75600, "num_target_updates": 149}, "done": false, "episodes_total": 548, "training_iteration": 76, "trial_id": "default", "date": "2024-10-05_20-28-01", "timestamp": 1728152881, "time_this_iter_s": 7.714411735534668, "time_total_s": 448.4747598171234, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 448.4747598171234, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.136363636363637, "ram_util_percent": 91.43636363636364}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692216162887988, "mean_inference_ms": 1.16162600514971, "mean_action_processing_ms": 0.13618855646979827, "mean_env_wait_ms": 0.05921927515365584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004773139953613281, "StateBufferConnector_ms": 0.0031137466430664062, "ViewRequirementAgentConnector_ms": 0.07977962493896484}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692216162887988, "mean_inference_ms": 1.16162600514971, "mean_action_processing_ms": 0.13618855646979827, "mean_env_wait_ms": 0.05921927515365584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004773139953613281, "StateBufferConnector_ms": 0.0031137466430664062, "ViewRequirementAgentConnector_ms": 0.07977962493896484}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 79.89453125, "min_q": 8.775659561157227, "max_q": 86.87096405029297, "mean_td_error": -0.19428589940071106}, "td_error": [-0.382659912109375, -0.11728668212890625, -0.4334564208984375, -0.11815643310546875, -0.03952789306640625, -0.12212371826171875, -0.09743499755859375, 0.00330352783203125, -0.08132171630859375, 0.118621826171875, -0.785888671875, -0.36745452880859375, -0.499298095703125, -0.028072357177734375, -0.40613555908203125, -0.405975341796875, -0.27616119384765625, -0.0346527099609375, -0.13747406005859375, 0.59124755859375, -0.128173828125, -0.06456756591796875, -0.34380340576171875, -0.0153656005859375, -0.7452821731567383, -0.3494720458984375, -0.03986358642578125, -0.31661224365234375, -0.23159027099609375, 0.09725189208984375, -0.209136962890625, -0.2506256103515625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9500, "diff_num_grad_updates_vs_sampler_policy": 9499}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "last_target_update_ts": 76608, "num_target_updates": 151}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 242.23, "episode_len_mean": 242.23, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9566770557760007, "mean_inference_ms": 2.173102527798384, "mean_action_processing_ms": 0.2317383976944609, "mean_env_wait_ms": 0.11856098313582521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009804248809814453, "StateBufferConnector_ms": 0.00667119026184082, "ViewRequirementAgentConnector_ms": 0.16124606132507324}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 242.23, "episode_len_mean": 242.23, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [155.0, 154.0, 168.0, 121.0, 264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [155, 154, 168, 121, 264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9566770557760007, "mean_inference_ms": 2.173102527798384, "mean_action_processing_ms": 0.2317383976944609, "mean_env_wait_ms": 0.11856098313582521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009804248809814453, "StateBufferConnector_ms": 0.00667119026184082, "ViewRequirementAgentConnector_ms": 0.16124606132507324}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.75013429897805, "num_env_steps_trained_throughput_per_sec": 827.0005371959122, "timesteps_total": 77000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 39.622, "sample_time_ms": 14.499, "learn_time_ms": 4.209, "learn_throughput": 7602.982, "synch_weights_time_ms": 6.413}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "last_target_update_ts": 76608, "num_target_updates": 151}, "done": false, "episodes_total": 552, "training_iteration": 77, "trial_id": "default", "date": "2024-10-05_20-28-09", "timestamp": 1728152889, "time_this_iter_s": 7.713982343673706, "time_total_s": 456.1887421607971, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 456.1887421607971, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 31.1, "ram_util_percent": 91.48181818181817}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36732888031186384, "mean_inference_ms": 1.1560219277441972, "mean_action_processing_ms": 0.13550018735182173, "mean_env_wait_ms": 0.0589245287624114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002288818359375, "StateBufferConnector_ms": 0.0020694732666015625, "ViewRequirementAgentConnector_ms": 0.05522727966308594}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36732888031186384, "mean_inference_ms": 1.1560219277441972, "mean_action_processing_ms": 0.13550018735182173, "mean_env_wait_ms": 0.0589245287624114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002288818359375, "StateBufferConnector_ms": 0.0020694732666015625, "ViewRequirementAgentConnector_ms": 0.05522727966308594}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 83.01707458496094, "min_q": 39.48120880126953, "max_q": 87.66522979736328, "mean_td_error": 0.007594108581542969}, "td_error": [0.168243408203125, 0.15456390380859375, 0.35747528076171875, -0.17392730712890625, -0.00075531005859375, 0.19348907470703125, 0.01229095458984375, 0.0908660888671875, -0.00682830810546875, -0.0244140625, -0.12790679931640625, 0.1402587890625, -0.28726959228515625, 0.1463623046875, 0.03795623779296875, 0.11685943603515625, -0.1036529541015625, -1.4307403564453125, 0.02545166015625, -0.00333404541015625, 0.006317138671875, -0.3118743896484375, -0.13580322265625, 0.091156005859375, -0.01444244384765625, 0.08868408203125, 0.154266357421875, 0.202606201171875, 0.5284652709960938, 0.13057708740234375, 0.08031463623046875, 0.13775634765625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9625, "diff_num_grad_updates_vs_sampler_policy": 9624}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "last_target_update_ts": 77616, "num_target_updates": 153}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 248.25, "episode_len_mean": 248.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9566169991113584, "mean_inference_ms": 2.1727872241640616, "mean_action_processing_ms": 0.2318587188829995, "mean_env_wait_ms": 0.1186102102669868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00980830192565918, "StateBufferConnector_ms": 0.006633758544921875, "ViewRequirementAgentConnector_ms": 0.16112303733825684}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 248.25, "episode_len_mean": 248.25, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [264.0, 160.0, 175.0, 165.0, 227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [264, 160, 175, 165, 227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9566169991113584, "mean_inference_ms": 2.1727872241640616, "mean_action_processing_ms": 0.2318587188829995, "mean_env_wait_ms": 0.1186102102669868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00980830192565918, "StateBufferConnector_ms": 0.006633758544921875, "ViewRequirementAgentConnector_ms": 0.16112303733825684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.1135317664793, "num_env_steps_trained_throughput_per_sec": 1044.4541270659172, "timesteps_total": 78000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 25.352, "sample_time_ms": 9.201, "learn_time_ms": 2.864, "learn_throughput": 11171.963, "synch_weights_time_ms": 4.26}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "last_target_update_ts": 77616, "num_target_updates": 153}, "done": false, "episodes_total": 556, "training_iteration": 78, "trial_id": "default", "date": "2024-10-05_20-28-15", "timestamp": 1728152895, "time_this_iter_s": 5.794799089431763, "time_total_s": 461.9835412502289, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 461.9835412502289, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 31.7875, "ram_util_percent": 91.42500000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36546634507758313, "mean_inference_ms": 1.1507010180824886, "mean_action_processing_ms": 0.13482846957045283, "mean_env_wait_ms": 0.05863661715154865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023293495178222656, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.05322694778442383}}, "episode_reward_max": 300.0, "episode_reward_min": 300.0, "episode_reward_mean": 300.0, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36546634507758313, "mean_inference_ms": 1.1507010180824886, "mean_action_processing_ms": 0.13482846957045283, "mean_env_wait_ms": 0.05863661715154865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023293495178222656, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.05322694778442383}, "num_agent_steps_sampled_this_iter": 3000, "num_env_steps_sampled_this_iter": 3000, "timesteps_this_iter": 3000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 78.65345001220703, "min_q": 29.031131744384766, "max_q": 88.61166381835938, "mean_td_error": 0.14271211624145508}, "td_error": [0.3031768798828125, -0.5362319946289062, 0.3090057373046875, -0.6419754028320312, 0.31592559814453125, 0.3043060302734375, -0.5898666381835938, 0.5662384033203125, 0.53790283203125, 0.35979461669921875, 0.3134307861328125, 0.32830810546875, 0.30446624755859375, 0.14075469970703125, 0.11888885498046875, 0.45030975341796875, 0.09387969970703125, 0.28586578369140625, 0.6497764587402344, 0.43711090087890625, -0.10727691650390625, 0.34459686279296875, 0.14199066162109375, 0.29439544677734375, -0.13052749633789062, -0.0293121337890625, -1.4295196533203125, 0.537689208984375, 0.8683090209960938, -0.6932220458984375, 0.23664093017578125, 0.48195648193359375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9750, "diff_num_grad_updates_vs_sampler_policy": 9749}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "last_target_update_ts": 78624, "num_target_updates": 155}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 252.61, "episode_len_mean": 252.61, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9540903395690574, "mean_inference_ms": 2.1692748170248803, "mean_action_processing_ms": 0.2312666268406444, "mean_env_wait_ms": 0.118361726470808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00981450080871582, "StateBufferConnector_ms": 0.006639003753662109, "ViewRequirementAgentConnector_ms": 0.16117119789123535}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 252.61, "episode_len_mean": 252.61, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9540903395690574, "mean_inference_ms": 2.1692748170248803, "mean_action_processing_ms": 0.2312666268406444, "mean_env_wait_ms": 0.118361726470808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00981450080871582, "StateBufferConnector_ms": 0.006639003753662109, "ViewRequirementAgentConnector_ms": 0.16117119789123535}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.966978255258, "num_env_steps_trained_throughput_per_sec": 1271.867913021032, "timesteps_total": 79000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 25.326, "sample_time_ms": 9.121, "learn_time_ms": 2.904, "learn_throughput": 11019.608, "synch_weights_time_ms": 4.211}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "last_target_update_ts": 78624, "num_target_updates": 155}, "done": false, "episodes_total": 560, "training_iteration": 79, "trial_id": "default", "date": "2024-10-05_20-28-20", "timestamp": 1728152900, "time_this_iter_s": 5.110803127288818, "time_total_s": 467.0943443775177, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 467.0943443775177, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 30.87142857142857, "ram_util_percent": 91.5}}
{"evaluation": {"sampler_results": {"episode_reward_max": 128.0, "episode_reward_min": 111.0, "episode_reward_mean": 119.3, "episode_len_mean": 119.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0, 121.0, 122.0, 123.0, 113.0, 111.0, 115.0, 120.0, 126.0, 114.0], "episode_lengths": [128, 121, 122, 123, 113, 111, 115, 120, 126, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36489256002298986, "mean_inference_ms": 1.1488222340426781, "mean_action_processing_ms": 0.13459299663699342, "mean_env_wait_ms": 0.05853617960461007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05488395690917969}}, "episode_reward_max": 128.0, "episode_reward_min": 111.0, "episode_reward_mean": 119.3, "episode_len_mean": 119.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0, 121.0, 122.0, 123.0, 113.0, 111.0, 115.0, 120.0, 126.0, 114.0], "episode_lengths": [128, 121, 122, 123, 113, 111, 115, 120, 126, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36489256002298986, "mean_inference_ms": 1.1488222340426781, "mean_action_processing_ms": 0.13459299663699342, "mean_env_wait_ms": 0.05853617960461007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.05488395690917969}, "num_agent_steps_sampled_this_iter": 1193, "num_env_steps_sampled_this_iter": 1193, "timesteps_this_iter": 1193, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 69.97061157226562, "min_q": 3.0406484603881836, "max_q": 89.42251586914062, "mean_td_error": 0.9342050552368164}, "td_error": [-0.42572784423828125, 29.562814712524414, 0.16449737548828125, -0.6154823303222656, -0.9388809204101562, 0.7294082641601562, 0.642059326171875, 0.6650619506835938, 0.163848876953125, -0.9584395885467529, 0.5577163696289062, 0.399017333984375, 0.5037994384765625, -0.5478439331054688, 0.48328399658203125, 0.15787506103515625, -0.9617080688476562, 0.13710784912109375, -1.8764190673828125, 0.3603515625, 3.258481025695801, 0.18084716796875, 0.705902099609375, 0.5328216552734375, -1.646697998046875, -0.10474395751953125, -0.03009033203125, -0.9388809204101562, 1.0679931640625, -0.17943572998046875, -0.40070343017578125, -0.7532730102539062], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9875, "diff_num_grad_updates_vs_sampler_policy": 9874}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "last_target_update_ts": 79632, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 252.61, "episode_len_mean": 252.61, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9540903395690574, "mean_inference_ms": 2.1692748170248803, "mean_action_processing_ms": 0.2312666268406444, "mean_env_wait_ms": 0.118361726470808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00981450080871582, "StateBufferConnector_ms": 0.006639003753662109, "ViewRequirementAgentConnector_ms": 0.16117119789123535}}, "episode_reward_max": 300.0, "episode_reward_min": 102.0, "episode_reward_mean": 252.61, "episode_len_mean": 252.61, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [227.0, 135.0, 223.0, 108.0, 102.0, 109.0, 129.0, 159.0, 103.0, 134.0, 154.0, 300.0, 300.0, 300.0, 300.0, 300.0, 262.0, 150.0, 159.0, 155.0, 279.0, 297.0, 156.0, 161.0, 300.0, 257.0, 246.0, 300.0, 300.0, 262.0, 145.0, 117.0, 278.0, 117.0, 119.0, 232.0, 146.0, 121.0, 142.0, 114.0, 149.0, 130.0, 135.0, 149.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0], "episode_lengths": [227, 135, 223, 108, 102, 109, 129, 159, 103, 134, 154, 300, 300, 300, 300, 300, 262, 150, 159, 155, 279, 297, 156, 161, 300, 257, 246, 300, 300, 262, 145, 117, 278, 117, 119, 232, 146, 121, 142, 114, 149, 130, 135, 149, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9540903395690574, "mean_inference_ms": 2.1692748170248803, "mean_action_processing_ms": 0.2312666268406444, "mean_env_wait_ms": 0.118361726470808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00981450080871582, "StateBufferConnector_ms": 0.006639003753662109, "ViewRequirementAgentConnector_ms": 0.16117119789123535}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7913832667559, "num_env_steps_trained_throughput_per_sec": 1259.1655330670235, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 25.863, "sample_time_ms": 9.54, "learn_time_ms": 2.854, "learn_throughput": 11211.063, "synch_weights_time_ms": 4.313}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "last_target_update_ts": 79632, "num_target_updates": 157}, "done": false, "episodes_total": 560, "training_iteration": 80, "trial_id": "default", "date": "2024-10-05_20-28-24", "timestamp": 1728152904, "time_this_iter_s": 3.9800169467926025, "time_total_s": 471.0743613243103, "pid": 312189, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FOCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x773dd109bd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 471.0743613243103, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 33.416666666666664, "ram_util_percent": 91.5}}
