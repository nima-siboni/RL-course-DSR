{"evaluation": {"sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.9, "episode_len_mean": 9.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 12.0, 10.0, 9.0, 10.0, 10.0, 9.0, 11.0, 9.0, 10.0], "episode_lengths": [9, 12, 10, 9, 10, 10, 9, 11, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4098145466930462, "mean_inference_ms": 3.1767521264418117, "mean_action_processing_ms": 0.11287995104519828, "mean_env_wait_ms": 0.05691456344892395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028371810913085938, "StateBufferConnector_ms": 0.003693103790283203, "ViewRequirementAgentConnector_ms": 0.05957841873168945}}, "episode_reward_max": 12.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.9, "episode_len_mean": 9.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 12.0, 10.0, 9.0, 10.0, 10.0, 9.0, 11.0, 9.0, 10.0], "episode_lengths": [9, 12, 10, 9, 10, 10, 9, 11, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4098145466930462, "mean_inference_ms": 3.1767521264418117, "mean_action_processing_ms": 0.11287995104519828, "mean_env_wait_ms": 0.05691456344892395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028371810913085938, "StateBufferConnector_ms": 0.003693103790283203, "ViewRequirementAgentConnector_ms": 0.05957841873168945}, "num_agent_steps_sampled_this_iter": 99, "num_env_steps_sampled_this_iter": 99, "timesteps_this_iter": 99, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 46.0, "episode_reward_min": 8.0, "episode_reward_mean": 19.717391304347824, "episode_len_mean": 19.717391304347824, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 24.0, 18.0, 27.0, 18.0, 11.0, 26.0, 20.0, 17.0, 21.0, 23.0, 31.0, 16.0, 24.0, 31.0, 20.0, 24.0, 30.0, 13.0, 16.0, 16.0, 8.0, 37.0, 19.0, 46.0, 28.0, 23.0, 20.0, 16.0, 21.0, 10.0, 11.0, 12.0, 20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0], "episode_lengths": [17, 24, 18, 27, 18, 11, 26, 20, 17, 21, 23, 31, 16, 24, 31, 20, 24, 30, 13, 16, 16, 8, 37, 19, 46, 28, 23, 20, 16, 21, 10, 11, 12, 20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4521120497899025, "mean_inference_ms": 3.0537058848031564, "mean_action_processing_ms": 0.1890433089662371, "mean_env_wait_ms": 0.10332014743338956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007797842440397843, "StateBufferConnector_ms": 0.005944915439771569, "ViewRequirementAgentConnector_ms": 0.1174455103666886}}, "episode_reward_max": 46.0, "episode_reward_min": 8.0, "episode_reward_mean": 19.717391304347824, "episode_len_mean": 19.717391304347824, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.0, 24.0, 18.0, 27.0, 18.0, 11.0, 26.0, 20.0, 17.0, 21.0, 23.0, 31.0, 16.0, 24.0, 31.0, 20.0, 24.0, 30.0, 13.0, 16.0, 16.0, 8.0, 37.0, 19.0, 46.0, 28.0, 23.0, 20.0, 16.0, 21.0, 10.0, 11.0, 12.0, 20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0], "episode_lengths": [17, 24, 18, 27, 18, 11, 26, 20, 17, 21, 23, 31, 16, 24, 31, 20, 24, 30, 13, 16, 16, 8, 37, 19, 46, 28, 23, 20, 16, 21, 10, 11, 12, 20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4521120497899025, "mean_inference_ms": 3.0537058848031564, "mean_action_processing_ms": 0.1890433089662371, "mean_env_wait_ms": 0.10332014743338956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007797842440397843, "StateBufferConnector_ms": 0.005944915439771569, "ViewRequirementAgentConnector_ms": 0.1174455103666886}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 863.6222311630135, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 7.582, "sample_time_ms": 6.853}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 46, "training_iteration": 1, "trial_id": "default", "date": "2024-10-05_21-53-38", "timestamp": 1728158018, "time_this_iter_s": 1.3654859066009521, "time_total_s": 1.3654859066009521, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.3654859066009521, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 84.80000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 40.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.8, "episode_len_mean": 21.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 40.0, 27.0, 35.0, 11.0, 11.0, 11.0, 29.0, 9.0, 10.0], "episode_lengths": [35, 40, 27, 35, 11, 11, 11, 29, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5065516421669408, "mean_inference_ms": 2.048012805961029, "mean_action_processing_ms": 0.1613117798030028, "mean_env_wait_ms": 0.07768262896621436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004436969757080078, "StateBufferConnector_ms": 0.005230903625488281, "ViewRequirementAgentConnector_ms": 0.09941816329956055}}, "episode_reward_max": 40.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.8, "episode_len_mean": 21.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 40.0, 27.0, 35.0, 11.0, 11.0, 11.0, 29.0, 9.0, 10.0], "episode_lengths": [35, 40, 27, 35, 11, 11, 11, 29, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5065516421669408, "mean_inference_ms": 2.048012805961029, "mean_action_processing_ms": 0.1613117798030028, "mean_env_wait_ms": 0.07768262896621436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004436969757080078, "StateBufferConnector_ms": 0.005230903625488281, "ViewRequirementAgentConnector_ms": 0.09941816329956055}, "num_agent_steps_sampled_this_iter": 218, "num_env_steps_sampled_this_iter": 218, "timesteps_this_iter": 218, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 1.8348097801208496, "min_q": 1.575419545173645, "max_q": 2.104173421859741, "mean_td_error": 0.041033804416656494}, "td_error": [0.039893388748168945, -0.16522502899169922, -0.051467180252075195, -0.05751681327819824, -0.3137049674987793, 0.09643220901489258, 0.003477811813354492, 0.031580209732055664, -0.11553812026977539, 0.06736230850219727, 1.012277364730835, -0.08444571495056152, -0.2968999147415161, -0.04956841468811035, -0.05504167079925537, 0.04240918159484863, 0.575419545173645, 0.02136850357055664, 1.0096180438995361, -0.026003241539001465, -0.1988539695739746, -0.048163533210754395, -0.12347269058227539, -0.10552763938903809, 0.04032635688781738, -0.04041862487792969, -0.16397356986999512, 0.09254300594329834, 0.029917240142822266, 0.10010695457458496, 0.007138252258300781, 0.0390324592590332], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 124}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "last_target_update_ts": 1512, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 8.0, "episode_reward_mean": 21.795454545454547, "episode_len_mean": 21.795454545454547, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 24.0, 18.0, 27.0, 18.0, 11.0, 26.0, 20.0, 17.0, 21.0, 23.0, 31.0, 16.0, 24.0, 31.0, 20.0, 24.0, 30.0, 13.0, 16.0, 16.0, 8.0, 37.0, 19.0, 46.0, 28.0, 23.0, 20.0, 16.0, 21.0, 10.0, 11.0, 12.0, 20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0, 72.0, 32.0, 14.0, 31.0, 19.0, 11.0, 17.0, 17.0, 10.0, 53.0, 21.0, 10.0, 31.0, 17.0, 22.0, 12.0, 38.0, 28.0, 39.0, 29.0, 15.0, 15.0, 29.0, 19.0, 13.0, 13.0, 10.0, 20.0, 47.0, 56.0, 26.0, 13.0, 17.0, 17.0, 22.0, 21.0, 16.0, 18.0, 27.0, 33.0, 14.0, 27.0], "episode_lengths": [17, 24, 18, 27, 18, 11, 26, 20, 17, 21, 23, 31, 16, 24, 31, 20, 24, 30, 13, 16, 16, 8, 37, 19, 46, 28, 23, 20, 16, 21, 10, 11, 12, 20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21, 72, 32, 14, 31, 19, 11, 17, 17, 10, 53, 21, 10, 31, 17, 22, 12, 38, 28, 39, 29, 15, 15, 29, 19, 13, 13, 10, 20, 47, 56, 26, 13, 17, 17, 22, 21, 16, 18, 27, 33, 14, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5936869768051019, "mean_inference_ms": 2.854935451320455, "mean_action_processing_ms": 0.20185098235609053, "mean_env_wait_ms": 0.11083629004214841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921785831451416, "StateBufferConnector_ms": 0.007296421311118386, "ViewRequirementAgentConnector_ms": 0.14229877428574997}}, "episode_reward_max": 72.0, "episode_reward_min": 8.0, "episode_reward_mean": 21.795454545454547, "episode_len_mean": 21.795454545454547, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.0, 24.0, 18.0, 27.0, 18.0, 11.0, 26.0, 20.0, 17.0, 21.0, 23.0, 31.0, 16.0, 24.0, 31.0, 20.0, 24.0, 30.0, 13.0, 16.0, 16.0, 8.0, 37.0, 19.0, 46.0, 28.0, 23.0, 20.0, 16.0, 21.0, 10.0, 11.0, 12.0, 20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0, 72.0, 32.0, 14.0, 31.0, 19.0, 11.0, 17.0, 17.0, 10.0, 53.0, 21.0, 10.0, 31.0, 17.0, 22.0, 12.0, 38.0, 28.0, 39.0, 29.0, 15.0, 15.0, 29.0, 19.0, 13.0, 13.0, 10.0, 20.0, 47.0, 56.0, 26.0, 13.0, 17.0, 17.0, 22.0, 21.0, 16.0, 18.0, 27.0, 33.0, 14.0, 27.0], "episode_lengths": [17, 24, 18, 27, 18, 11, 26, 20, 17, 21, 23, 31, 16, 24, 31, 20, 24, 30, 13, 16, 16, 8, 37, 19, 46, 28, 23, 20, 16, 21, 10, 11, 12, 20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21, 72, 32, 14, 31, 19, 11, 17, 17, 10, 53, 21, 10, 31, 17, 22, 12, 38, 28, 39, 29, 15, 15, 29, 19, 13, 13, 10, 20, 47, 56, 26, 13, 17, 17, 22, 21, 16, 18, 27, 33, 14, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5936869768051019, "mean_inference_ms": 2.854935451320455, "mean_action_processing_ms": 0.20185098235609053, "mean_env_wait_ms": 0.11083629004214841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921785831451416, "StateBufferConnector_ms": 0.007296421311118386, "ViewRequirementAgentConnector_ms": 0.14229877428574997}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.13210298390226, "num_env_steps_trained_throughput_per_sec": 808.528411935609, "timesteps_total": 2000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 38.107, "sample_time_ms": 13.89, "learn_time_ms": 4.099, "learn_throughput": 7807.169, "synch_weights_time_ms": 6.239}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 4000, "last_target_update_ts": 1512, "num_target_updates": 2}, "done": false, "episodes_total": 88, "training_iteration": 2, "trial_id": "default", "date": "2024-10-05_21-53-44", "timestamp": 1728158024, "time_this_iter_s": 5.241188287734985, "time_total_s": 6.6066741943359375, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 6.6066741943359375, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.25, "ram_util_percent": 85.1625}}
{"evaluation": {"sampler_results": {"episode_reward_max": 51.0, "episode_reward_min": 11.0, "episode_reward_mean": 29.9, "episode_len_mean": 29.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 29.0, 11.0, 12.0, 11.0, 35.0, 32.0, 51.0, 37.0, 40.0], "episode_lengths": [41, 29, 11, 12, 11, 35, 32, 51, 37, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204404693051995, "mean_inference_ms": 1.7997866653534307, "mean_action_processing_ms": 0.17147538173629578, "mean_env_wait_ms": 0.08253088916640684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043392181396484375, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.09549379348754883}}, "episode_reward_max": 51.0, "episode_reward_min": 11.0, "episode_reward_mean": 29.9, "episode_len_mean": 29.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 29.0, 11.0, 12.0, 11.0, 35.0, 32.0, 51.0, 37.0, 40.0], "episode_lengths": [41, 29, 11, 12, 11, 35, 32, 51, 37, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204404693051995, "mean_inference_ms": 1.7997866653534307, "mean_action_processing_ms": 0.17147538173629578, "mean_env_wait_ms": 0.08253088916640684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043392181396484375, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.09549379348754883}, "num_agent_steps_sampled_this_iter": 299, "num_env_steps_sampled_this_iter": 299, "timesteps_this_iter": 299, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 3.4641525745391846, "min_q": 2.0576930046081543, "max_q": 3.9780290126800537, "mean_td_error": 0.10753088444471359}, "td_error": [-0.8044071197509766, -0.7349815368652344, 2.1569619178771973, 1.1419308185577393, 0.06006813049316406, -0.05647706985473633, -0.08584356307983398, -0.0022745132446289062, -0.014207601547241211, -1.4171135425567627, -0.08909964561462402, 0.09707045555114746, -1.4646592140197754, -0.13749933242797852, 2.1424100399017334, -0.06203460693359375, 1.7103888988494873, -0.1807262897491455, -0.46038103103637695, -0.18608355522155762, -0.7254514694213867, -0.07831311225891113, -0.08909964561462402, -0.03279566764831543, 0.11511731147766113, -0.3356640338897705, -0.08944129943847656, 2.021929979324341, 0.008027315139770508, 1.0576930046081543, 0.09460902214050293, -0.11866474151611328], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 250, "diff_num_grad_updates_vs_sampler_policy": 249}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "last_target_update_ts": 2520, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 9.0, "episode_reward_mean": 22.31, "episode_len_mean": 22.31, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0, 72.0, 32.0, 14.0, 31.0, 19.0, 11.0, 17.0, 17.0, 10.0, 53.0, 21.0, 10.0, 31.0, 17.0, 22.0, 12.0, 38.0, 28.0, 39.0, 29.0, 15.0, 15.0, 29.0, 19.0, 13.0, 13.0, 10.0, 20.0, 47.0, 56.0, 26.0, 13.0, 17.0, 17.0, 22.0, 21.0, 16.0, 18.0, 27.0, 33.0, 14.0, 27.0, 12.0, 14.0, 36.0, 15.0, 35.0, 10.0, 42.0, 9.0, 11.0, 26.0, 16.0, 13.0, 17.0, 11.0, 29.0, 19.0, 44.0, 15.0, 51.0, 10.0, 13.0, 19.0, 16.0, 18.0, 17.0, 49.0, 25.0, 14.0, 24.0, 51.0, 13.0, 25.0, 22.0, 56.0, 23.0, 16.0, 21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0], "episode_lengths": [20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21, 72, 32, 14, 31, 19, 11, 17, 17, 10, 53, 21, 10, 31, 17, 22, 12, 38, 28, 39, 29, 15, 15, 29, 19, 13, 13, 10, 20, 47, 56, 26, 13, 17, 17, 22, 21, 16, 18, 27, 33, 14, 27, 12, 14, 36, 15, 35, 10, 42, 9, 11, 26, 16, 13, 17, 11, 29, 19, 44, 15, 51, 10, 13, 19, 16, 18, 17, 49, 25, 14, 24, 51, 13, 25, 22, 56, 23, 16, 21, 22, 10, 37, 10, 23, 11, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7910290903215502, "mean_inference_ms": 2.6236402193270565, "mean_action_processing_ms": 0.2198797123381388, "mean_env_wait_ms": 0.12086609995368948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010973691940307617, "StateBufferConnector_ms": 0.008655548095703125, "ViewRequirementAgentConnector_ms": 0.17168855667114258}}, "episode_reward_max": 72.0, "episode_reward_min": 9.0, "episode_reward_mean": 22.31, "episode_len_mean": 22.31, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.0, 15.0, 13.0, 11.0, 19.0, 15.0, 9.0, 13.0, 18.0, 20.0, 15.0, 24.0, 21.0, 72.0, 32.0, 14.0, 31.0, 19.0, 11.0, 17.0, 17.0, 10.0, 53.0, 21.0, 10.0, 31.0, 17.0, 22.0, 12.0, 38.0, 28.0, 39.0, 29.0, 15.0, 15.0, 29.0, 19.0, 13.0, 13.0, 10.0, 20.0, 47.0, 56.0, 26.0, 13.0, 17.0, 17.0, 22.0, 21.0, 16.0, 18.0, 27.0, 33.0, 14.0, 27.0, 12.0, 14.0, 36.0, 15.0, 35.0, 10.0, 42.0, 9.0, 11.0, 26.0, 16.0, 13.0, 17.0, 11.0, 29.0, 19.0, 44.0, 15.0, 51.0, 10.0, 13.0, 19.0, 16.0, 18.0, 17.0, 49.0, 25.0, 14.0, 24.0, 51.0, 13.0, 25.0, 22.0, 56.0, 23.0, 16.0, 21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0], "episode_lengths": [20, 15, 13, 11, 19, 15, 9, 13, 18, 20, 15, 24, 21, 72, 32, 14, 31, 19, 11, 17, 17, 10, 53, 21, 10, 31, 17, 22, 12, 38, 28, 39, 29, 15, 15, 29, 19, 13, 13, 10, 20, 47, 56, 26, 13, 17, 17, 22, 21, 16, 18, 27, 33, 14, 27, 12, 14, 36, 15, 35, 10, 42, 9, 11, 26, 16, 13, 17, 11, 29, 19, 44, 15, 51, 10, 13, 19, 16, 18, 17, 49, 25, 14, 24, 51, 13, 25, 22, 56, 23, 16, 21, 22, 10, 37, 10, 23, 11, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7910290903215502, "mean_inference_ms": 2.6236402193270565, "mean_action_processing_ms": 0.2198797123381388, "mean_env_wait_ms": 0.12086609995368948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010973691940307617, "StateBufferConnector_ms": 0.008655548095703125, "ViewRequirementAgentConnector_ms": 0.17168855667114258}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.04524135823306, "num_env_steps_trained_throughput_per_sec": 836.1809654329322, "timesteps_total": 3000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 39.986, "sample_time_ms": 14.942, "learn_time_ms": 4.244, "learn_throughput": 7539.602, "synch_weights_time_ms": 6.484}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 8000, "last_target_update_ts": 2520, "num_target_updates": 4}, "done": false, "episodes_total": 133, "training_iteration": 3, "trial_id": "default", "date": "2024-10-05_21-53-49", "timestamp": 1728158029, "time_this_iter_s": 5.1769397258758545, "time_total_s": 11.783613920211792, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 11.783613920211792, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.300000000000004, "ram_util_percent": 85.12857142857145}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 9.0, "episode_reward_mean": 15.4, "episode_len_mean": 15.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 63.0, 10.0, 10.0, 10.0, 9.0, 10.0, 10.0, 11.0, 10.0], "episode_lengths": [11, 63, 10, 10, 10, 9, 10, 10, 11, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522818909477942, "mean_inference_ms": 1.7727349222320872, "mean_action_processing_ms": 0.1735859310504088, "mean_env_wait_ms": 0.08386557864159652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004971027374267578, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.1094961166381836}}, "episode_reward_max": 63.0, "episode_reward_min": 9.0, "episode_reward_mean": 15.4, "episode_len_mean": 15.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 63.0, 10.0, 10.0, 10.0, 9.0, 10.0, 10.0, 11.0, 10.0], "episode_lengths": [11, 63, 10, 10, 10, 9, 10, 10, 11, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522818909477942, "mean_inference_ms": 1.7727349222320872, "mean_action_processing_ms": 0.1735859310504088, "mean_env_wait_ms": 0.08386557864159652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004971027374267578, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.1094961166381836}, "num_agent_steps_sampled_this_iter": 154, "num_env_steps_sampled_this_iter": 154, "timesteps_this_iter": 154, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 5.4529924392700195, "min_q": 2.0630695819854736, "max_q": 7.617068290710449, "mean_td_error": 0.11401224881410599}, "td_error": [-0.05761384963989258, -0.3588137626647949, -0.08870840072631836, -1.104797601699829, -0.1269392967224121, -0.06209087371826172, 0.06544685363769531, -0.21067094802856445, -0.10798406600952148, -0.030472278594970703, 0.11510467529296875, 0.11211299896240234, -0.023677349090576172, 0.11467409133911133, 4.389644622802734, 0.07928895950317383, 0.10274696350097656, -0.1583566665649414, -0.6968238353729248, -0.10054826736450195, 4.7821550369262695, 0.09808015823364258, -0.10852909088134766, -0.05890655517578125, 0.14350271224975586, -0.33921098709106445, -0.4631035327911377, -0.019164085388183594, -0.6672945022583008, -0.3915681838989258, -0.27586793899536133, -0.9032230377197266], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 375, "diff_num_grad_updates_vs_sampler_policy": 374}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "last_target_update_ts": 3528, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 20.63, "episode_len_mean": 20.63, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 14.0, 27.0, 12.0, 14.0, 36.0, 15.0, 35.0, 10.0, 42.0, 9.0, 11.0, 26.0, 16.0, 13.0, 17.0, 11.0, 29.0, 19.0, 44.0, 15.0, 51.0, 10.0, 13.0, 19.0, 16.0, 18.0, 17.0, 49.0, 25.0, 14.0, 24.0, 51.0, 13.0, 25.0, 22.0, 56.0, 23.0, 16.0, 21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0, 11.0, 11.0, 15.0, 18.0, 29.0, 40.0, 13.0, 12.0, 14.0, 41.0, 15.0, 25.0, 20.0, 25.0, 11.0, 30.0, 12.0, 45.0, 11.0, 26.0, 10.0, 13.0, 14.0, 12.0, 11.0, 24.0, 14.0, 9.0, 74.0, 29.0, 19.0, 14.0, 26.0, 11.0, 12.0, 16.0, 19.0, 23.0, 11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0], "episode_lengths": [33, 14, 27, 12, 14, 36, 15, 35, 10, 42, 9, 11, 26, 16, 13, 17, 11, 29, 19, 44, 15, 51, 10, 13, 19, 16, 18, 17, 49, 25, 14, 24, 51, 13, 25, 22, 56, 23, 16, 21, 22, 10, 37, 10, 23, 11, 21, 16, 11, 11, 15, 18, 29, 40, 13, 12, 14, 41, 15, 25, 20, 25, 11, 30, 12, 45, 11, 26, 10, 13, 14, 12, 11, 24, 14, 9, 74, 29, 19, 14, 26, 11, 12, 16, 19, 23, 11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9658742040343136, "mean_inference_ms": 2.520154034995148, "mean_action_processing_ms": 0.2362594974584949, "mean_env_wait_ms": 0.12925409554802492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0119476318359375, "StateBufferConnector_ms": 0.009623289108276367, "ViewRequirementAgentConnector_ms": 0.1892995834350586}}, "episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 20.63, "episode_len_mean": 20.63, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 14.0, 27.0, 12.0, 14.0, 36.0, 15.0, 35.0, 10.0, 42.0, 9.0, 11.0, 26.0, 16.0, 13.0, 17.0, 11.0, 29.0, 19.0, 44.0, 15.0, 51.0, 10.0, 13.0, 19.0, 16.0, 18.0, 17.0, 49.0, 25.0, 14.0, 24.0, 51.0, 13.0, 25.0, 22.0, 56.0, 23.0, 16.0, 21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0, 11.0, 11.0, 15.0, 18.0, 29.0, 40.0, 13.0, 12.0, 14.0, 41.0, 15.0, 25.0, 20.0, 25.0, 11.0, 30.0, 12.0, 45.0, 11.0, 26.0, 10.0, 13.0, 14.0, 12.0, 11.0, 24.0, 14.0, 9.0, 74.0, 29.0, 19.0, 14.0, 26.0, 11.0, 12.0, 16.0, 19.0, 23.0, 11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0], "episode_lengths": [33, 14, 27, 12, 14, 36, 15, 35, 10, 42, 9, 11, 26, 16, 13, 17, 11, 29, 19, 44, 15, 51, 10, 13, 19, 16, 18, 17, 49, 25, 14, 24, 51, 13, 25, 22, 56, 23, 16, 21, 22, 10, 37, 10, 23, 11, 21, 16, 11, 11, 15, 18, 29, 40, 13, 12, 14, 41, 15, 25, 20, 25, 11, 30, 12, 45, 11, 26, 10, 13, 14, 12, 11, 24, 14, 9, 74, 29, 19, 14, 26, 11, 12, 16, 19, 23, 11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9658742040343136, "mean_inference_ms": 2.520154034995148, "mean_action_processing_ms": 0.2362594974584949, "mean_env_wait_ms": 0.12925409554802492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0119476318359375, "StateBufferConnector_ms": 0.009623289108276367, "ViewRequirementAgentConnector_ms": 0.1892995834350586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.3628928706687, "num_env_steps_trained_throughput_per_sec": 821.4515714826748, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 38.069, "sample_time_ms": 14.261, "learn_time_ms": 4.072, "learn_throughput": 7858.411, "synch_weights_time_ms": 6.023}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 12000, "last_target_update_ts": 3528, "num_target_updates": 6}, "done": false, "episodes_total": 185, "training_iteration": 4, "trial_id": "default", "date": "2024-10-05_21-53-54", "timestamp": 1728158034, "time_this_iter_s": 5.031060695648193, "time_total_s": 16.814674615859985, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.814674615859985, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.32857142857143, "ram_util_percent": 85.10000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": 8.0, "episode_reward_mean": 9.4, "episode_len_mean": 9.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 10.0, 10.0, 10.0, 10.0, 9.0, 8.0, 9.0, 9.0, 10.0], "episode_lengths": [9, 10, 10, 10, 10, 9, 8, 9, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5420785431468158, "mean_inference_ms": 1.6922097687327533, "mean_action_processing_ms": 0.16789370720539615, "mean_env_wait_ms": 0.08112684302373764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033283233642578125, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.06976842880249023}}, "episode_reward_max": 10.0, "episode_reward_min": 8.0, "episode_reward_mean": 9.4, "episode_len_mean": 9.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 10.0, 10.0, 10.0, 10.0, 9.0, 8.0, 9.0, 9.0, 10.0], "episode_lengths": [9, 10, 10, 10, 10, 9, 8, 9, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5420785431468158, "mean_inference_ms": 1.6922097687327533, "mean_action_processing_ms": 0.16789370720539615, "mean_env_wait_ms": 0.08112684302373764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033283233642578125, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.06976842880249023}, "num_agent_steps_sampled_this_iter": 94, "num_env_steps_sampled_this_iter": 94, "timesteps_this_iter": 94, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 5.740462303161621, "min_q": 1.7777976989746094, "max_q": 8.357536315917969, "mean_td_error": 0.24983853101730347}, "td_error": [-1.3909432888031006, 0.11363887786865234, 2.722745895385742, -0.2414407730102539, 0.7777976989746094, -0.4403958320617676, -0.05719709396362305, 1.6232273578643799, -0.04126548767089844, -0.01393747329711914, -0.02319955825805664, -0.7991528511047363, -0.2528700828552246, -1.3109469413757324, 0.11171293258666992, 0.32254505157470703, -0.12897920608520508, 0.040149688720703125, 2.713916063308716, -0.19515037536621094, -0.18662357330322266, -0.6702432632446289, 0.9727383852005005, -0.2904691696166992, -0.09003257751464844, 2.3329219818115234, 3.5791735649108887, 0.27986860275268555, -0.4018688201904297, -0.17670440673828125, -0.8092184066772461, -0.07496309280395508], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 500, "diff_num_grad_updates_vs_sampler_policy": 499}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "last_target_update_ts": 4536, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.32, "episode_len_mean": 21.32, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0, 11.0, 11.0, 15.0, 18.0, 29.0, 40.0, 13.0, 12.0, 14.0, 41.0, 15.0, 25.0, 20.0, 25.0, 11.0, 30.0, 12.0, 45.0, 11.0, 26.0, 10.0, 13.0, 14.0, 12.0, 11.0, 24.0, 14.0, 9.0, 74.0, 29.0, 19.0, 14.0, 26.0, 11.0, 12.0, 16.0, 19.0, 23.0, 11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0, 48.0, 16.0, 62.0, 14.0, 12.0, 15.0, 11.0, 41.0, 21.0, 10.0, 25.0, 14.0, 17.0, 14.0, 55.0, 14.0, 40.0, 11.0, 10.0, 22.0, 54.0, 61.0, 16.0, 51.0, 15.0, 11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0], "episode_lengths": [21, 22, 10, 37, 10, 23, 11, 21, 16, 11, 11, 15, 18, 29, 40, 13, 12, 14, 41, 15, 25, 20, 25, 11, 30, 12, 45, 11, 26, 10, 13, 14, 12, 11, 24, 14, 9, 74, 29, 19, 14, 26, 11, 12, 16, 19, 23, 11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12, 48, 16, 62, 14, 12, 15, 11, 41, 21, 10, 25, 14, 17, 14, 55, 14, 40, 11, 10, 22, 54, 61, 16, 51, 15, 11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9935339412264863, "mean_inference_ms": 2.4595055202427494, "mean_action_processing_ms": 0.2385328818291078, "mean_env_wait_ms": 0.13006083872790147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011060714721679688, "StateBufferConnector_ms": 0.008669137954711914, "ViewRequirementAgentConnector_ms": 0.17456269264221191}}, "episode_reward_max": 74.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.32, "episode_len_mean": 21.32, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 22.0, 10.0, 37.0, 10.0, 23.0, 11.0, 21.0, 16.0, 11.0, 11.0, 15.0, 18.0, 29.0, 40.0, 13.0, 12.0, 14.0, 41.0, 15.0, 25.0, 20.0, 25.0, 11.0, 30.0, 12.0, 45.0, 11.0, 26.0, 10.0, 13.0, 14.0, 12.0, 11.0, 24.0, 14.0, 9.0, 74.0, 29.0, 19.0, 14.0, 26.0, 11.0, 12.0, 16.0, 19.0, 23.0, 11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0, 48.0, 16.0, 62.0, 14.0, 12.0, 15.0, 11.0, 41.0, 21.0, 10.0, 25.0, 14.0, 17.0, 14.0, 55.0, 14.0, 40.0, 11.0, 10.0, 22.0, 54.0, 61.0, 16.0, 51.0, 15.0, 11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0], "episode_lengths": [21, 22, 10, 37, 10, 23, 11, 21, 16, 11, 11, 15, 18, 29, 40, 13, 12, 14, 41, 15, 25, 20, 25, 11, 30, 12, 45, 11, 26, 10, 13, 14, 12, 11, 24, 14, 9, 74, 29, 19, 14, 26, 11, 12, 16, 19, 23, 11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12, 48, 16, 62, 14, 12, 15, 11, 41, 21, 10, 25, 14, 17, 14, 55, 14, 40, 11, 10, 22, 54, 61, 16, 51, 15, 11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9935339412264863, "mean_inference_ms": 2.4595055202427494, "mean_action_processing_ms": 0.2385328818291078, "mean_env_wait_ms": 0.13006083872790147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011060714721679688, "StateBufferConnector_ms": 0.008669137954711914, "ViewRequirementAgentConnector_ms": 0.17456269264221191}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.30791676403095, "num_env_steps_trained_throughput_per_sec": 1005.2316670561238, "timesteps_total": 5000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 25.969, "sample_time_ms": 9.566, "learn_time_ms": 2.894, "learn_throughput": 11057.283, "synch_weights_time_ms": 4.49}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 16000, "last_target_update_ts": 4536, "num_target_updates": 8}, "done": false, "episodes_total": 224, "training_iteration": 5, "trial_id": "default", "date": "2024-10-05_21-53-58", "timestamp": 1728158038, "time_this_iter_s": 4.071443796157837, "time_total_s": 20.886118412017822, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.886118412017822, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.36666666666667, "ram_util_percent": 85.10000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 42.0, "episode_reward_min": 9.0, "episode_reward_mean": 25.8, "episode_len_mean": 25.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 36.0, 39.0, 30.0, 37.0, 30.0, 12.0, 42.0, 12.0, 11.0], "episode_lengths": [9, 36, 39, 30, 37, 30, 12, 42, 12, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4914980284206531, "mean_inference_ms": 1.5128736512615213, "mean_action_processing_ms": 0.1542380967065302, "mean_env_wait_ms": 0.0741789686326165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.003147125244140625, "ViewRequirementAgentConnector_ms": 0.05934476852416992}}, "episode_reward_max": 42.0, "episode_reward_min": 9.0, "episode_reward_mean": 25.8, "episode_len_mean": 25.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 36.0, 39.0, 30.0, 37.0, 30.0, 12.0, 42.0, 12.0, 11.0], "episode_lengths": [9, 36, 39, 30, 37, 30, 12, 42, 12, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4914980284206531, "mean_inference_ms": 1.5128736512615213, "mean_action_processing_ms": 0.1542380967065302, "mean_env_wait_ms": 0.0741789686326165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.003147125244140625, "ViewRequirementAgentConnector_ms": 0.05934476852416992}, "num_agent_steps_sampled_this_iter": 258, "num_env_steps_sampled_this_iter": 258, "timesteps_this_iter": 258, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 7.477280616760254, "min_q": 1.8470197916030884, "max_q": 10.10844898223877, "mean_td_error": 0.47078678011894226}, "td_error": [-1.3527956008911133, 0.7381391525268555, 0.7251825332641602, -0.10745716094970703, 5.924311637878418, 0.430403470993042, 0.13906002044677734, 0.07234382629394531, -0.2121114730834961, 0.11343574523925781, 1.688560962677002, 0.2327108383178711, 1.3048069477081299, -0.9236283302307129, -0.131591796875, 0.0637807846069336, -0.07467269897460938, 0.13903331756591797, 0.7712407112121582, 1.4950230121612549, 2.067135810852051, 0.7301311492919922, -0.9933652877807617, 0.5983190536499023, -0.4328269958496094, 0.649226188659668, 0.027202606201171875, 0.8470197916030884, -0.07891178131103516, 0.48373889923095703, 0.07325553894042969, 0.05847644805908203], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 625, "diff_num_grad_updates_vs_sampler_policy": 624}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "last_target_update_ts": 5544, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 8.0, "episode_reward_mean": 21.3, "episode_len_mean": 21.3, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0, 48.0, 16.0, 62.0, 14.0, 12.0, 15.0, 11.0, 41.0, 21.0, 10.0, 25.0, 14.0, 17.0, 14.0, 55.0, 14.0, 40.0, 11.0, 10.0, 22.0, 54.0, 61.0, 16.0, 51.0, 15.0, 11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0, 14.0, 13.0, 63.0, 23.0, 13.0, 27.0, 11.0, 10.0, 17.0, 16.0, 23.0, 39.0, 15.0, 10.0, 19.0, 32.0, 29.0, 22.0, 11.0, 14.0, 28.0, 23.0, 15.0, 13.0, 18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0], "episode_lengths": [11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12, 48, 16, 62, 14, 12, 15, 11, 41, 21, 10, 25, 14, 17, 14, 55, 14, 40, 11, 10, 22, 54, 61, 16, 51, 15, 11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44, 14, 13, 63, 23, 13, 27, 11, 10, 17, 16, 23, 39, 15, 10, 19, 32, 29, 22, 11, 14, 28, 23, 15, 13, 18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.947033196353246, "mean_inference_ms": 2.34957546431573, "mean_action_processing_ms": 0.23211351711672581, "mean_env_wait_ms": 0.12665933038016597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921177864074707, "StateBufferConnector_ms": 0.006934404373168945, "ViewRequirementAgentConnector_ms": 0.1460566520690918}}, "episode_reward_max": 63.0, "episode_reward_min": 8.0, "episode_reward_mean": 21.3, "episode_len_mean": 21.3, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.0, 19.0, 15.0, 13.0, 19.0, 17.0, 11.0, 16.0, 10.0, 14.0, 10.0, 14.0, 27.0, 12.0, 48.0, 16.0, 62.0, 14.0, 12.0, 15.0, 11.0, 41.0, 21.0, 10.0, 25.0, 14.0, 17.0, 14.0, 55.0, 14.0, 40.0, 11.0, 10.0, 22.0, 54.0, 61.0, 16.0, 51.0, 15.0, 11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0, 14.0, 13.0, 63.0, 23.0, 13.0, 27.0, 11.0, 10.0, 17.0, 16.0, 23.0, 39.0, 15.0, 10.0, 19.0, 32.0, 29.0, 22.0, 11.0, 14.0, 28.0, 23.0, 15.0, 13.0, 18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0], "episode_lengths": [11, 19, 15, 13, 19, 17, 11, 16, 10, 14, 10, 14, 27, 12, 48, 16, 62, 14, 12, 15, 11, 41, 21, 10, 25, 14, 17, 14, 55, 14, 40, 11, 10, 22, 54, 61, 16, 51, 15, 11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44, 14, 13, 63, 23, 13, 27, 11, 10, 17, 16, 23, 39, 15, 10, 19, 32, 29, 22, 11, 14, 28, 23, 15, 13, 18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.947033196353246, "mean_inference_ms": 2.34957546431573, "mean_action_processing_ms": 0.23211351711672581, "mean_env_wait_ms": 0.12665933038016597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921177864074707, "StateBufferConnector_ms": 0.006934404373168945, "ViewRequirementAgentConnector_ms": 0.1460566520690918}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3081956782691, "num_env_steps_trained_throughput_per_sec": 1241.2327827130764, "timesteps_total": 6000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 24.81, "sample_time_ms": 9.018, "learn_time_ms": 2.831, "learn_throughput": 11303.212, "synch_weights_time_ms": 4.218}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 20000, "last_target_update_ts": 5544, "num_target_updates": 10}, "done": false, "episodes_total": 271, "training_iteration": 6, "trial_id": "default", "date": "2024-10-05_21-54-01", "timestamp": 1728158041, "time_this_iter_s": 3.429215669631958, "time_total_s": 24.31533408164978, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 24.31533408164978, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.62, "ram_util_percent": 85.64}}
{"evaluation": {"sampler_results": {"episode_reward_max": 85.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.8, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 10.0, 8.0, 23.0, 22.0, 13.0, 8.0, 85.0, 9.0, 42.0], "episode_lengths": [28, 10, 8, 23, 22, 13, 8, 85, 9, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46675491609035114, "mean_inference_ms": 1.4155697719060565, "mean_action_processing_ms": 0.14650114365838543, "mean_env_wait_ms": 0.07033382586908409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030374526977539062, "StateBufferConnector_ms": 0.002925395965576172, "ViewRequirementAgentConnector_ms": 0.059185028076171875}}, "episode_reward_max": 85.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.8, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 10.0, 8.0, 23.0, 22.0, 13.0, 8.0, 85.0, 9.0, 42.0], "episode_lengths": [28, 10, 8, 23, 22, 13, 8, 85, 9, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46675491609035114, "mean_inference_ms": 1.4155697719060565, "mean_action_processing_ms": 0.14650114365838543, "mean_env_wait_ms": 0.07033382586908409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030374526977539062, "StateBufferConnector_ms": 0.002925395965576172, "ViewRequirementAgentConnector_ms": 0.059185028076171875}, "num_agent_steps_sampled_this_iter": 248, "num_env_steps_sampled_this_iter": 248, "timesteps_this_iter": 248, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 8.061269760131836, "min_q": 2.243964672088623, "max_q": 11.879237174987793, "mean_td_error": 0.19887001812458038}, "td_error": [1.7997121810913086, -1.7690057754516602, 0.2480630874633789, -0.5980973243713379, -0.8087868690490723, 0.1211557388305664, 0.12364387512207031, -1.1493029594421387, -0.49799633026123047, 2.595299005508423, 1.243964672088623, 0.1835956573486328, 0.9463531970977783, -0.6311383247375488, 0.24098682403564453, 0.29994678497314453, -0.13934803009033203, -0.04510784149169922, -1.584000587463379, 0.04114055633544922, 1.4253408908843994, -0.12048077583312988, 1.480558156967163, 0.2705726623535156, 1.1208295822143555, 0.48342180252075195, 0.4791383743286133, 1.087303638458252, 0.1360492706298828, 1.0865898132324219, -0.19366741180419922, -1.512892723083496], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 750, "diff_num_grad_updates_vs_sampler_policy": 749}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "last_target_update_ts": 6552, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 8.0, "episode_reward_mean": 22.39, "episode_len_mean": 22.39, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0, 14.0, 13.0, 63.0, 23.0, 13.0, 27.0, 11.0, 10.0, 17.0, 16.0, 23.0, 39.0, 15.0, 10.0, 19.0, 32.0, 29.0, 22.0, 11.0, 14.0, 28.0, 23.0, 15.0, 13.0, 18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0, 33.0, 39.0, 10.0, 10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0], "episode_lengths": [11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44, 14, 13, 63, 23, 13, 27, 11, 10, 17, 16, 23, 39, 15, 10, 19, 32, 29, 22, 11, 14, 28, 23, 15, 13, 18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10, 33, 39, 10, 10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.885595582595199, "mean_inference_ms": 2.259254472333175, "mean_action_processing_ms": 0.22453976768315, "mean_env_wait_ms": 0.12284980256426033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00834035873413086, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12828779220581055}}, "episode_reward_max": 63.0, "episode_reward_min": 8.0, "episode_reward_mean": 22.39, "episode_len_mean": 22.39, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.0, 10.0, 33.0, 13.0, 14.0, 18.0, 18.0, 17.0, 13.0, 54.0, 16.0, 39.0, 10.0, 44.0, 14.0, 13.0, 63.0, 23.0, 13.0, 27.0, 11.0, 10.0, 17.0, 16.0, 23.0, 39.0, 15.0, 10.0, 19.0, 32.0, 29.0, 22.0, 11.0, 14.0, 28.0, 23.0, 15.0, 13.0, 18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0, 33.0, 39.0, 10.0, 10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0], "episode_lengths": [11, 10, 33, 13, 14, 18, 18, 17, 13, 54, 16, 39, 10, 44, 14, 13, 63, 23, 13, 27, 11, 10, 17, 16, 23, 39, 15, 10, 19, 32, 29, 22, 11, 14, 28, 23, 15, 13, 18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10, 33, 39, 10, 10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.885595582595199, "mean_inference_ms": 2.259254472333175, "mean_action_processing_ms": 0.22453976768315, "mean_env_wait_ms": 0.12284980256426033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00834035873413086, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12828779220581055}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0073850072864, "num_env_steps_trained_throughput_per_sec": 1284.0295400291457, "timesteps_total": 7000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 24.632, "sample_time_ms": 9.09, "learn_time_ms": 2.733, "learn_throughput": 11709.187, "synch_weights_time_ms": 4.157}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 24000, "last_target_update_ts": 6552, "num_target_updates": 12}, "done": false, "episodes_total": 310, "training_iteration": 7, "trial_id": "default", "date": "2024-10-05_21-54-05", "timestamp": 1728158045, "time_this_iter_s": 3.29613995552063, "time_total_s": 27.61147403717041, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.61147403717041, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.900000000000006, "ram_util_percent": 85.64000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": 31.0, "episode_reward_mean": 45.6, "episode_len_mean": 45.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 48.0, 43.0, 40.0, 65.0, 31.0, 61.0, 41.0, 39.0, 50.0], "episode_lengths": [38, 48, 43, 40, 65, 31, 61, 41, 39, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4304002542964748, "mean_inference_ms": 1.3018279779152793, "mean_action_processing_ms": 0.13698176608059578, "mean_env_wait_ms": 0.06558178552512915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037932395935058594, "StateBufferConnector_ms": 0.002892017364501953, "ViewRequirementAgentConnector_ms": 0.05789518356323242}}, "episode_reward_max": 65.0, "episode_reward_min": 31.0, "episode_reward_mean": 45.6, "episode_len_mean": 45.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 48.0, 43.0, 40.0, 65.0, 31.0, 61.0, 41.0, 39.0, 50.0], "episode_lengths": [38, 48, 43, 40, 65, 31, 61, 41, 39, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4304002542964748, "mean_inference_ms": 1.3018279779152793, "mean_action_processing_ms": 0.13698176608059578, "mean_env_wait_ms": 0.06558178552512915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037932395935058594, "StateBufferConnector_ms": 0.002892017364501953, "ViewRequirementAgentConnector_ms": 0.05789518356323242}, "num_agent_steps_sampled_this_iter": 456, "num_env_steps_sampled_this_iter": 456, "timesteps_this_iter": 456, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 8.885917663574219, "min_q": 1.5390061140060425, "max_q": 14.039266586303711, "mean_td_error": -0.019637838006019592}, "td_error": [-2.9899020195007324, -0.20944499969482422, -0.07733345031738281, -1.4892940521240234, -1.1479692459106445, 0.3888784646987915, -2.1007819175720215, -1.6324214935302734, 1.4425954818725586, -0.12004470825195312, -0.7110414505004883, 0.33840084075927734, 0.7253754138946533, -0.13026809692382812, -1.256232500076294, -0.3681607246398926, 0.5802850723266602, 1.0429821014404297, -0.3699808120727539, -0.6128807067871094, 2.1533432006835938, 1.8928413391113281, 0.23986101150512695, -1.2619552612304688, 1.4898443222045898, 0.02424335479736328, 0.5390061140060425, 1.7548649311065674, -0.028893470764160156, 0.08666801452636719, 1.2019233703613281, -0.022918701171875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 875, "diff_num_grad_updates_vs_sampler_policy": 874}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "last_target_update_ts": 7560, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.8, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0, 33.0, 39.0, 10.0, 10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0], "episode_lengths": [18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10, 33, 39, 10, 10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8269330585664927, "mean_inference_ms": 2.178658949178762, "mean_action_processing_ms": 0.21745666216628293, "mean_env_wait_ms": 0.1195552701973209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008256912231445312, "StateBufferConnector_ms": 0.0059201717376708984, "ViewRequirementAgentConnector_ms": 0.1247866153717041}}, "episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.8, "episode_len_mean": 24.8, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.0, 13.0, 9.0, 35.0, 30.0, 11.0, 27.0, 18.0, 8.0, 17.0, 23.0, 31.0, 24.0, 31.0, 10.0, 16.0, 42.0, 10.0, 13.0, 14.0, 11.0, 22.0, 10.0, 33.0, 39.0, 10.0, 10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0], "episode_lengths": [18, 13, 9, 35, 30, 11, 27, 18, 8, 17, 23, 31, 24, 31, 10, 16, 42, 10, 13, 14, 11, 22, 10, 33, 39, 10, 10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8269330585664927, "mean_inference_ms": 2.178658949178762, "mean_action_processing_ms": 0.21745666216628293, "mean_env_wait_ms": 0.1195552701973209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008256912231445312, "StateBufferConnector_ms": 0.0059201717376708984, "ViewRequirementAgentConnector_ms": 0.1247866153717041}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.76758215137323, "num_env_steps_trained_throughput_per_sec": 1275.070328605493, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 25.546, "sample_time_ms": 9.337, "learn_time_ms": 2.877, "learn_throughput": 11121.879, "synch_weights_time_ms": 4.367}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 28000, "last_target_update_ts": 7560, "num_target_updates": 14}, "done": false, "episodes_total": 348, "training_iteration": 8, "trial_id": "default", "date": "2024-10-05_21-54-08", "timestamp": 1728158048, "time_this_iter_s": 3.467968702316284, "time_total_s": 31.079442739486694, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.079442739486694, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.64, "ram_util_percent": 85.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": 40.0, "episode_reward_min": 29.0, "episode_reward_mean": 34.5, "episode_len_mean": 34.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 39.0, 30.0, 40.0, 39.0, 38.0, 35.0, 29.0, 32.0, 29.0], "episode_lengths": [34, 39, 30, 40, 39, 38, 35, 29, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4124927958217236, "mean_inference_ms": 1.2451270304688618, "mean_action_processing_ms": 0.13237218244360127, "mean_env_wait_ms": 0.06331019445296823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028562545776367188, "StateBufferConnector_ms": 0.002238750457763672, "ViewRequirementAgentConnector_ms": 0.055692195892333984}}, "episode_reward_max": 40.0, "episode_reward_min": 29.0, "episode_reward_mean": 34.5, "episode_len_mean": 34.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 39.0, 30.0, 40.0, 39.0, 38.0, 35.0, 29.0, 32.0, 29.0], "episode_lengths": [34, 39, 30, 40, 39, 38, 35, 29, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4124927958217236, "mean_inference_ms": 1.2451270304688618, "mean_action_processing_ms": 0.13237218244360127, "mean_env_wait_ms": 0.06331019445296823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028562545776367188, "StateBufferConnector_ms": 0.002238750457763672, "ViewRequirementAgentConnector_ms": 0.055692195892333984}, "num_agent_steps_sampled_this_iter": 345, "num_env_steps_sampled_this_iter": 345, "timesteps_this_iter": 345, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 9.041091918945312, "min_q": 0.8180437088012695, "max_q": 14.648150444030762, "mean_td_error": 0.23953422904014587}, "td_error": [1.5807867050170898, 0.9634075164794922, -1.1122465133666992, -0.4208059310913086, 1.4156532287597656, -0.23481106758117676, 1.948483943939209, 2.4634313583374023, -0.644150972366333, 0.9027070999145508, -0.8071079254150391, 2.092526435852051, -0.9298162460327148, 1.97686767578125, -0.32741785049438477, -0.6248989105224609, -2.582235336303711, 0.5285320281982422, 0.21444320678710938, 0.26509857177734375, 1.3984882831573486, 0.32306957244873047, -1.8422696590423584, -1.2674579620361328, 0.2505683898925781, -0.4110221862792969, -0.18195629119873047, 0.7839250564575195, -1.3528907299041748, 1.9790267944335938, -0.4680396318435669, 1.7852067947387695], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1000, "diff_num_grad_updates_vs_sampler_policy": 999}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "last_target_update_ts": 8568, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 29.33, "episode_len_mean": 29.33, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0], "episode_lengths": [10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7980857650793372, "mean_inference_ms": 2.1359150311328134, "mean_action_processing_ms": 0.21444746248434654, "mean_env_wait_ms": 0.11786283421819817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008271217346191406, "StateBufferConnector_ms": 0.005829572677612305, "ViewRequirementAgentConnector_ms": 0.12517976760864258}}, "episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 29.33, "episode_len_mean": 29.33, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 20.0, 30.0, 59.0, 9.0, 22.0, 33.0, 35.0, 15.0, 12.0, 8.0, 11.0, 10.0, 26.0, 40.0, 25.0, 39.0, 47.0, 47.0, 15.0, 27.0, 53.0, 41.0, 18.0, 18.0, 19.0, 34.0, 10.0, 11.0, 25.0, 13.0, 13.0, 27.0, 15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0], "episode_lengths": [10, 20, 30, 59, 9, 22, 33, 35, 15, 12, 8, 11, 10, 26, 40, 25, 39, 47, 47, 15, 27, 53, 41, 18, 18, 19, 34, 10, 11, 25, 13, 13, 27, 15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7980857650793372, "mean_inference_ms": 2.1359150311328134, "mean_action_processing_ms": 0.21444746248434654, "mean_env_wait_ms": 0.11786283421819817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008271217346191406, "StateBufferConnector_ms": 0.005829572677612305, "ViewRequirementAgentConnector_ms": 0.12517976760864258}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.1083175878658, "num_env_steps_trained_throughput_per_sec": 1284.4332703514633, "timesteps_total": 9000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 25.088, "sample_time_ms": 9.211, "learn_time_ms": 2.865, "learn_throughput": 11170.568, "synch_weights_time_ms": 4.225}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 32000, "last_target_update_ts": 8568, "num_target_updates": 16}, "done": false, "episodes_total": 374, "training_iteration": 9, "trial_id": "default", "date": "2024-10-05_21-54-11", "timestamp": 1728158051, "time_this_iter_s": 3.374671220779419, "time_total_s": 34.45411396026611, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.45411396026611, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.260000000000005, "ram_util_percent": 85.63999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 26.0, "episode_reward_mean": 38.7, "episode_len_mean": 38.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 49.0, 33.0, 31.0, 32.0, 56.0, 39.0, 26.0, 40.0, 36.0], "episode_lengths": [45, 49, 33, 31, 32, 56, 39, 26, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39802649006340074, "mean_inference_ms": 1.2036543455183133, "mean_action_processing_ms": 0.12891651680750876, "mean_env_wait_ms": 0.061583815154081546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030112266540527344, "StateBufferConnector_ms": 0.0023293495178222656, "ViewRequirementAgentConnector_ms": 0.0565791130065918}}, "episode_reward_max": 56.0, "episode_reward_min": 26.0, "episode_reward_mean": 38.7, "episode_len_mean": 38.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 49.0, 33.0, 31.0, 32.0, 56.0, 39.0, 26.0, 40.0, 36.0], "episode_lengths": [45, 49, 33, 31, 32, 56, 39, 26, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39802649006340074, "mean_inference_ms": 1.2036543455183133, "mean_action_processing_ms": 0.12891651680750876, "mean_env_wait_ms": 0.061583815154081546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030112266540527344, "StateBufferConnector_ms": 0.0023293495178222656, "ViewRequirementAgentConnector_ms": 0.0565791130065918}, "num_agent_steps_sampled_this_iter": 387, "num_env_steps_sampled_this_iter": 387, "timesteps_this_iter": 387, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 9.909119606018066, "min_q": 0.9869785308837891, "max_q": 16.339319229125977, "mean_td_error": -0.46554654836654663}, "td_error": [-0.5115413665771484, 0.5248069763183594, -2.3713865280151367, -0.18068218231201172, 0.45719003677368164, -2.4348630905151367, 1.1473760604858398, -0.35016345977783203, 0.47193241119384766, -1.0405547618865967, -0.005198955535888672, -0.013021469116210938, -0.10422134399414062, -1.4821529388427734, -2.682246208190918, -1.4630908966064453, -0.15391159057617188, 0.10164356231689453, -0.5778207778930664, 1.0997085571289062, -0.7640113830566406, 0.13643455505371094, 0.9602184295654297, -1.5902395248413086, 1.2530736923217773, 0.5390338897705078, 0.7246990203857422, -3.453840732574463, -0.15981483459472656, 0.023879170417785645, -3.6101369857788086, 0.6114130020141602], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1125, "diff_num_grad_updates_vs_sampler_policy": 1124}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "last_target_update_ts": 9576, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 30.9, "episode_len_mean": 30.9, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0], "episode_lengths": [15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7620853787999167, "mean_inference_ms": 2.082758450677181, "mean_action_processing_ms": 0.20999049246876333, "mean_env_wait_ms": 0.11575060273340743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008248567581176758, "StateBufferConnector_ms": 0.0059053897857666016, "ViewRequirementAgentConnector_ms": 0.12648749351501465}}, "episode_reward_max": 92.0, "episode_reward_min": 8.0, "episode_reward_mean": 30.9, "episode_len_mean": 30.9, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.0, 43.0, 24.0, 10.0, 18.0, 30.0, 12.0, 8.0, 48.0, 10.0, 12.0, 63.0, 13.0, 14.0, 92.0, 33.0, 13.0, 42.0, 48.0, 18.0, 23.0, 9.0, 48.0, 49.0, 13.0, 12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0], "episode_lengths": [15, 43, 24, 10, 18, 30, 12, 8, 48, 10, 12, 63, 13, 14, 92, 33, 13, 42, 48, 18, 23, 9, 48, 49, 13, 12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7620853787999167, "mean_inference_ms": 2.082758450677181, "mean_action_processing_ms": 0.20999049246876333, "mean_env_wait_ms": 0.11575060273340743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008248567581176758, "StateBufferConnector_ms": 0.0059053897857666016, "ViewRequirementAgentConnector_ms": 0.12648749351501465}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1726761358341, "num_env_steps_trained_throughput_per_sec": 1280.6907045433363, "timesteps_total": 10000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 24.472, "sample_time_ms": 9.025, "learn_time_ms": 2.813, "learn_throughput": 11375.926, "synch_weights_time_ms": 4.014}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 36000, "last_target_update_ts": 9576, "num_target_updates": 18}, "done": false, "episodes_total": 407, "training_iteration": 10, "trial_id": "default", "date": "2024-10-05_21-54-15", "timestamp": 1728158055, "time_this_iter_s": 3.4221882820129395, "time_total_s": 37.87630224227905, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 37.87630224227905, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.76, "ram_util_percent": 85.72}}
{"evaluation": {"sampler_results": {"episode_reward_max": 50.0, "episode_reward_min": 23.0, "episode_reward_mean": 35.0, "episode_len_mean": 35.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 24.0, 50.0, 38.0, 36.0, 23.0, 39.0, 48.0, 28.0, 36.0], "episode_lengths": [28, 24, 50, 38, 36, 23, 39, 48, 28, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39023018922020253, "mean_inference_ms": 1.178492973904126, "mean_action_processing_ms": 0.12702273218870325, "mean_env_wait_ms": 0.060757136490979594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027513504028320312, "StateBufferConnector_ms": 0.0023317337036132812, "ViewRequirementAgentConnector_ms": 0.06058216094970703}}, "episode_reward_max": 50.0, "episode_reward_min": 23.0, "episode_reward_mean": 35.0, "episode_len_mean": 35.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 24.0, 50.0, 38.0, 36.0, 23.0, 39.0, 48.0, 28.0, 36.0], "episode_lengths": [28, 24, 50, 38, 36, 23, 39, 48, 28, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39023018922020253, "mean_inference_ms": 1.178492973904126, "mean_action_processing_ms": 0.12702273218870325, "mean_env_wait_ms": 0.060757136490979594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027513504028320312, "StateBufferConnector_ms": 0.0023317337036132812, "ViewRequirementAgentConnector_ms": 0.06058216094970703}, "num_agent_steps_sampled_this_iter": 350, "num_env_steps_sampled_this_iter": 350, "timesteps_this_iter": 350, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 11.465009689331055, "min_q": 1.2837319374084473, "max_q": 17.967439651489258, "mean_td_error": -0.13343079388141632}, "td_error": [-2.7299413681030273, 2.2820606231689453, -0.10498809814453125, 2.859476089477539, -0.45387840270996094, 1.1220874786376953, 0.8340415954589844, -1.238774299621582, 0.9103460311889648, 2.616898536682129, 1.4961042404174805, -1.844923973083496, 0.4604678153991699, -2.2004847526550293, -0.48902130126953125, -0.6221146583557129, -3.7243118286132812, -3.53568696975708, 2.269204616546631, -0.5142154693603516, 0.9856376647949219, -0.9123153686523438, -0.296417236328125, 0.28373193740844727, 0.802889347076416, 0.3731498718261719, -1.844923973083496, -0.015895843505859375, 1.1912474632263184, -1.0501861572265625, -1.9079437255859375, 0.7288945913314819], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1250, "diff_num_grad_updates_vs_sampler_policy": 1249}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "last_target_update_ts": 10584, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 85.0, "episode_reward_min": 8.0, "episode_reward_mean": 34.49, "episode_len_mean": 34.49, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0], "episode_lengths": [12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7310136531289146, "mean_inference_ms": 2.0385137407490292, "mean_action_processing_ms": 0.2059636104609327, "mean_env_wait_ms": 0.11376880881084257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008284568786621094, "StateBufferConnector_ms": 0.005764961242675781, "ViewRequirementAgentConnector_ms": 0.1257796287536621}}, "episode_reward_max": 85.0, "episode_reward_min": 8.0, "episode_reward_mean": 34.49, "episode_len_mean": 34.49, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 11.0, 24.0, 20.0, 16.0, 85.0, 55.0, 32.0, 28.0, 11.0, 8.0, 37.0, 41.0, 10.0, 22.0, 13.0, 30.0, 28.0, 52.0, 35.0, 13.0, 45.0, 35.0, 45.0, 19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0], "episode_lengths": [12, 11, 24, 20, 16, 85, 55, 32, 28, 11, 8, 37, 41, 10, 22, 13, 30, 28, 52, 35, 13, 45, 35, 45, 19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7310136531289146, "mean_inference_ms": 2.0385137407490292, "mean_action_processing_ms": 0.2059636104609327, "mean_env_wait_ms": 0.11376880881084257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008284568786621094, "StateBufferConnector_ms": 0.005764961242675781, "ViewRequirementAgentConnector_ms": 0.1257796287536621}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.2499562468439, "num_env_steps_trained_throughput_per_sec": 1284.9998249873756, "timesteps_total": 11000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 24.395, "sample_time_ms": 8.666, "learn_time_ms": 2.857, "learn_throughput": 11200.772, "synch_weights_time_ms": 4.161}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 40000, "last_target_update_ts": 10584, "num_target_updates": 20}, "done": false, "episodes_total": 432, "training_iteration": 11, "trial_id": "default", "date": "2024-10-05_21-54-18", "timestamp": 1728158058, "time_this_iter_s": 3.396188259124756, "time_total_s": 41.27249050140381, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 41.27249050140381, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.675, "ram_util_percent": 85.85}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 24.0, "episode_reward_mean": 39.8, "episode_len_mean": 39.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.0, 49.0, 24.0, 33.0, 42.0, 41.0, 38.0, 39.0, 43.0, 34.0], "episode_lengths": [55, 49, 24, 33, 42, 41, 38, 39, 43, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813379877680415, "mean_inference_ms": 1.1479264623052008, "mean_action_processing_ms": 0.12459497194032412, "mean_env_wait_ms": 0.059517153032549154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031328201293945312, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.05746603012084961}}, "episode_reward_max": 55.0, "episode_reward_min": 24.0, "episode_reward_mean": 39.8, "episode_len_mean": 39.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.0, 49.0, 24.0, 33.0, 42.0, 41.0, 38.0, 39.0, 43.0, 34.0], "episode_lengths": [55, 49, 24, 33, 42, 41, 38, 39, 43, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813379877680415, "mean_inference_ms": 1.1479264623052008, "mean_action_processing_ms": 0.12459497194032412, "mean_env_wait_ms": 0.059517153032549154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031328201293945312, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.05746603012084961}, "num_agent_steps_sampled_this_iter": 398, "num_env_steps_sampled_this_iter": 398, "timesteps_this_iter": 398, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.513713836669922, "min_q": -0.3990298807621002, "max_q": 19.399599075317383, "mean_td_error": 0.17917807400226593}, "td_error": [0.4327983856201172, 0.5618076324462891, -1.9550247192382812, 2.970369338989258, -0.7863655090332031, -2.1912684440612793, -1.00677490234375, 0.013614654541015625, 2.4529194831848145, 3.02731990814209, -1.0468206405639648, -0.876600980758667, -0.2368021011352539, 2.1628637313842773, 3.099081039428711, -1.3990298509597778, -1.6344184875488281, -0.2732410430908203, 0.0052547454833984375, -0.3380928039550781, 1.6309318542480469, -2.1865453720092773, -0.6287283897399902, -1.7803993225097656, 4.283164024353027, 0.11571311950683594, 1.652618408203125, 0.016957879066467285, -0.08183097839355469, -1.3023433685302734, -0.7815485000610352, 1.8141193389892578], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1375, "diff_num_grad_updates_vs_sampler_policy": 1374}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "last_target_update_ts": 11592, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 67.0, "episode_reward_min": 9.0, "episode_reward_mean": 36.96, "episode_len_mean": 36.96, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0], "episode_lengths": [19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7097328043931581, "mean_inference_ms": 2.0068196393147186, "mean_action_processing_ms": 0.20355319814500347, "mean_env_wait_ms": 0.11239513039543308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008278369903564453, "StateBufferConnector_ms": 0.005730867385864258, "ViewRequirementAgentConnector_ms": 0.12607741355895996}}, "episode_reward_max": 67.0, "episode_reward_min": 9.0, "episode_reward_mean": 36.96, "episode_len_mean": 36.96, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.0, 30.0, 33.0, 11.0, 15.0, 25.0, 27.0, 40.0, 49.0, 48.0, 65.0, 67.0, 50.0, 57.0, 37.0, 28.0, 43.0, 51.0, 35.0, 37.0, 10.0, 12.0, 12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0], "episode_lengths": [19, 30, 33, 11, 15, 25, 27, 40, 49, 48, 65, 67, 50, 57, 37, 28, 43, 51, 35, 37, 10, 12, 12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7097328043931581, "mean_inference_ms": 2.0068196393147186, "mean_action_processing_ms": 0.20355319814500347, "mean_env_wait_ms": 0.11239513039543308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008278369903564453, "StateBufferConnector_ms": 0.005730867385864258, "ViewRequirementAgentConnector_ms": 0.12607741355895996}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.82002315591444, "num_env_steps_trained_throughput_per_sec": 1279.2800926236578, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 25.012, "sample_time_ms": 9.183, "learn_time_ms": 2.799, "learn_throughput": 11434.366, "synch_weights_time_ms": 4.246}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 44000, "last_target_update_ts": 11592, "num_target_updates": 22}, "done": false, "episodes_total": 456, "training_iteration": 12, "trial_id": "default", "date": "2024-10-05_21-54-22", "timestamp": 1728158062, "time_this_iter_s": 3.4098618030548096, "time_total_s": 44.68235230445862, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 44.68235230445862, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 85.88000000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 29.0, "episode_reward_mean": 40.6, "episode_len_mean": 40.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 46.0, 55.0, 37.0, 34.0, 39.0, 36.0, 48.0, 45.0, 29.0], "episode_lengths": [37, 46, 55, 37, 34, 39, 36, 48, 45, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3748625644798443, "mean_inference_ms": 1.124264344636974, "mean_action_processing_ms": 0.12272276591845335, "mean_env_wait_ms": 0.0586047960453279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025463104248046875, "StateBufferConnector_ms": 0.0022149085998535156, "ViewRequirementAgentConnector_ms": 0.056324005126953125}}, "episode_reward_max": 55.0, "episode_reward_min": 29.0, "episode_reward_mean": 40.6, "episode_len_mean": 40.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 46.0, 55.0, 37.0, 34.0, 39.0, 36.0, 48.0, 45.0, 29.0], "episode_lengths": [37, 46, 55, 37, 34, 39, 36, 48, 45, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3748625644798443, "mean_inference_ms": 1.124264344636974, "mean_action_processing_ms": 0.12272276591845335, "mean_env_wait_ms": 0.0586047960453279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025463104248046875, "StateBufferConnector_ms": 0.0022149085998535156, "ViewRequirementAgentConnector_ms": 0.056324005126953125}, "num_agent_steps_sampled_this_iter": 406, "num_env_steps_sampled_this_iter": 406, "timesteps_this_iter": 406, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.39547348022461, "min_q": 0.5203781723976135, "max_q": 19.17943572998047, "mean_td_error": -0.09837928414344788}, "td_error": [-2.2578468322753906, -2.6040267944335938, 0.42379093170166016, -2.287594795227051, 1.6090664863586426, -1.2268190383911133, 0.6800193786621094, 0.19550704956054688, 2.4547348022460938, 0.1250448226928711, -2.755918502807617, -1.9572763442993164, 2.3663434982299805, -1.7687416076660156, -1.2903399467468262, 1.774653434753418, 0.28972434997558594, -3.4545412063598633, 0.45133399963378906, 3.6247787475585938, 4.5705108642578125, 0.2535419464111328, -3.6556715965270996, 3.506044387817383, 1.8774871826171875, 1.461050033569336, -1.4267082214355469, -0.9605655670166016, -1.0565242767333984, -2.9292821884155273, -0.4796218276023865, 1.2997093200683594], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1500, "diff_num_grad_updates_vs_sampler_policy": 1499}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "last_target_update_ts": 12600, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 9.0, "episode_reward_mean": 39.08, "episode_len_mean": 39.08, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0], "episode_lengths": [12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.691214066374572, "mean_inference_ms": 1.9800833695159306, "mean_action_processing_ms": 0.20103912608030378, "mean_env_wait_ms": 0.11125082827950723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193492889404297, "StateBufferConnector_ms": 0.0056574344635009766, "ViewRequirementAgentConnector_ms": 0.12660789489746094}}, "episode_reward_max": 77.0, "episode_reward_min": 9.0, "episode_reward_mean": 39.08, "episode_len_mean": 39.08, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 9.0, 34.0, 42.0, 36.0, 44.0, 16.0, 37.0, 9.0, 10.0, 11.0, 39.0, 42.0, 33.0, 40.0, 35.0, 38.0, 10.0, 11.0, 40.0, 54.0, 41.0, 45.0, 29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0], "episode_lengths": [12, 9, 34, 42, 36, 44, 16, 37, 9, 10, 11, 39, 42, 33, 40, 35, 38, 10, 11, 40, 54, 41, 45, 29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.691214066374572, "mean_inference_ms": 1.9800833695159306, "mean_action_processing_ms": 0.20103912608030378, "mean_env_wait_ms": 0.11125082827950723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193492889404297, "StateBufferConnector_ms": 0.0056574344635009766, "ViewRequirementAgentConnector_ms": 0.12660789489746094}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.00753241546937, "num_env_steps_trained_throughput_per_sec": 1284.0301296618775, "timesteps_total": 13000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 24.651, "sample_time_ms": 9.142, "learn_time_ms": 2.688, "learn_throughput": 11904.117, "synch_weights_time_ms": 4.074}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 48000, "last_target_update_ts": 12600, "num_target_updates": 24}, "done": false, "episodes_total": 478, "training_iteration": 13, "trial_id": "default", "date": "2024-10-05_21-54-25", "timestamp": 1728158065, "time_this_iter_s": 3.4055685997009277, "time_total_s": 48.087920904159546, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.087920904159546, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.06, "ram_util_percent": 85.9}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 30.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 62.0, 34.0, 45.0, 38.0, 37.0, 41.0, 39.0, 38.0, 30.0], "episode_lengths": [47, 62, 34, 45, 38, 37, 41, 39, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695997634791542, "mean_inference_ms": 1.1062375908619102, "mean_action_processing_ms": 0.12131842143086051, "mean_env_wait_ms": 0.05785470094371061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002772808074951172, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.05661964416503906}}, "episode_reward_max": 62.0, "episode_reward_min": 30.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 62.0, 34.0, 45.0, 38.0, 37.0, 41.0, 39.0, 38.0, 30.0], "episode_lengths": [47, 62, 34, 45, 38, 37, 41, 39, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695997634791542, "mean_inference_ms": 1.1062375908619102, "mean_action_processing_ms": 0.12131842143086051, "mean_env_wait_ms": 0.05785470094371061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002772808074951172, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.05661964416503906}, "num_agent_steps_sampled_this_iter": 411, "num_env_steps_sampled_this_iter": 411, "timesteps_this_iter": 411, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.469575881958008, "min_q": 1.8540563583374023, "max_q": 21.25079345703125, "mean_td_error": 0.13050934672355652}, "td_error": [0.0020978450775146484, -1.2468490600585938, -2.4779129028320312, 1.6545677185058594, -1.5595097541809082, -0.06810569763183594, 0.4168052673339844, 1.0088233947753906, -1.4399070739746094, 3.7497711181640625, 0.8282570838928223, 3.695516586303711, -2.6498708724975586, 1.6887526512145996, 0.8066005706787109, -1.837301254272461, 1.9609088897705078, 0.09299182891845703, 0.0036411285400390625, -3.4052772521972656, 4.724424839019775, 0.011725902557373047, -1.4231834411621094, -0.3865070343017578, -3.025087356567383, 1.0569820404052734, -0.22688627243041992, -0.6092624664306641, 0.9364337921142578, 0.8428592681884766, 0.3474912643432617, 0.70330810546875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1625, "diff_num_grad_updates_vs_sampler_policy": 1624}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "last_target_update_ts": 13608, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 9.0, "episode_reward_mean": 41.7, "episode_len_mean": 41.7, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0], "episode_lengths": [29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6683423873884038, "mean_inference_ms": 1.9471092547325675, "mean_action_processing_ms": 0.19760334331672808, "mean_env_wait_ms": 0.1097819103430425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008287668228149414, "StateBufferConnector_ms": 0.005463838577270508, "ViewRequirementAgentConnector_ms": 0.1253347396850586}}, "episode_reward_max": 77.0, "episode_reward_min": 9.0, "episode_reward_mean": 41.7, "episode_len_mean": 41.7, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.0, 11.0, 9.0, 63.0, 46.0, 39.0, 31.0, 39.0, 49.0, 46.0, 30.0, 29.0, 42.0, 32.0, 40.0, 30.0, 49.0, 57.0, 52.0, 27.0, 38.0, 41.0, 36.0, 37.0, 48.0, 35.0, 65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0], "episode_lengths": [29, 11, 9, 63, 46, 39, 31, 39, 49, 46, 30, 29, 42, 32, 40, 30, 49, 57, 52, 27, 38, 41, 36, 37, 48, 35, 65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6683423873884038, "mean_inference_ms": 1.9471092547325675, "mean_action_processing_ms": 0.19760334331672808, "mean_env_wait_ms": 0.1097819103430425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008287668228149414, "StateBufferConnector_ms": 0.005463838577270508, "ViewRequirementAgentConnector_ms": 0.1253347396850586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.93255816206346, "num_env_steps_trained_throughput_per_sec": 1279.7302326482538, "timesteps_total": 14000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 25.687, "sample_time_ms": 9.477, "learn_time_ms": 2.981, "learn_throughput": 10735.099, "synch_weights_time_ms": 4.228}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 52000, "last_target_update_ts": 13608, "num_target_updates": 26}, "done": false, "episodes_total": 501, "training_iteration": 14, "trial_id": "default", "date": "2024-10-05_21-54-29", "timestamp": 1728158069, "time_this_iter_s": 3.418699264526367, "time_total_s": 51.50662016868591, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 51.50662016868591, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.00000000000001, "ram_util_percent": 85.92}}
{"evaluation": {"sampler_results": {"episode_reward_max": 46.0, "episode_reward_min": 28.0, "episode_reward_mean": 33.8, "episode_len_mean": 33.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 31.0, 29.0, 32.0, 37.0, 46.0, 28.0, 35.0, 37.0, 34.0], "episode_lengths": [29, 31, 29, 32, 37, 46, 28, 35, 37, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36593983250279577, "mean_inference_ms": 1.092622677485148, "mean_action_processing_ms": 0.12023891172101422, "mean_env_wait_ms": 0.05731841142032309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029039382934570312, "StateBufferConnector_ms": 0.003402233123779297, "ViewRequirementAgentConnector_ms": 0.05896806716918945}}, "episode_reward_max": 46.0, "episode_reward_min": 28.0, "episode_reward_mean": 33.8, "episode_len_mean": 33.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 31.0, 29.0, 32.0, 37.0, 46.0, 28.0, 35.0, 37.0, 34.0], "episode_lengths": [29, 31, 29, 32, 37, 46, 28, 35, 37, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36593983250279577, "mean_inference_ms": 1.092622677485148, "mean_action_processing_ms": 0.12023891172101422, "mean_env_wait_ms": 0.05731841142032309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029039382934570312, "StateBufferConnector_ms": 0.003402233123779297, "ViewRequirementAgentConnector_ms": 0.05896806716918945}, "num_agent_steps_sampled_this_iter": 338, "num_env_steps_sampled_this_iter": 338, "timesteps_this_iter": 338, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.840721130371094, "min_q": 5.1729960441589355, "max_q": 22.601882934570312, "mean_td_error": 1.6566941738128662}, "td_error": [-0.7168335914611816, 1.563751220703125, 3.1148557662963867, 0.7402744293212891, 4.298181533813477, 1.156752109527588, 4.1729960441589355, -0.9910993576049805, 15.892435073852539, 2.2636938095092773, -0.5565776824951172, -1.7674331665039062, 2.8438491821289062, -0.2337017059326172, 0.032634735107421875, 4.623495101928711, 1.9652023315429688, 1.955099105834961, -2.214700698852539, 2.027681350708008, -0.092132568359375, -0.01302337646484375, 6.79786491394043, -2.3261470794677734, -0.07335472106933594, 3.6401538848876953, 0.8486843109130859, 3.7138586044311523, -4.855526924133301, 0.5541591644287109, -0.22788429260253906, 4.877002239227295], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1750, "diff_num_grad_updates_vs_sampler_policy": 1749}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "last_target_update_ts": 14616, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.09, "episode_len_mean": 42.09, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0], "episode_lengths": [65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.648971760354441, "mean_inference_ms": 1.9194490382829326, "mean_action_processing_ms": 0.19521355453745248, "mean_env_wait_ms": 0.1085269292065249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008452892303466797, "StateBufferConnector_ms": 0.005654811859130859, "ViewRequirementAgentConnector_ms": 0.12625694274902344}}, "episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.09, "episode_len_mean": 42.09, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 60.0, 65.0, 38.0, 51.0, 41.0, 42.0, 38.0, 45.0, 34.0, 30.0, 34.0, 49.0, 31.0, 42.0, 46.0, 54.0, 44.0, 31.0, 39.0, 32.0, 63.0, 38.0, 35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0], "episode_lengths": [65, 60, 65, 38, 51, 41, 42, 38, 45, 34, 30, 34, 49, 31, 42, 46, 54, 44, 31, 39, 32, 63, 38, 35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.648971760354441, "mean_inference_ms": 1.9194490382829326, "mean_action_processing_ms": 0.19521355453745248, "mean_env_wait_ms": 0.1085269292065249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008452892303466797, "StateBufferConnector_ms": 0.005654811859130859, "ViewRequirementAgentConnector_ms": 0.12625694274902344}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.78327408868154, "num_env_steps_trained_throughput_per_sec": 1267.1330963547261, "timesteps_total": 15000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 24.898, "sample_time_ms": 9.188, "learn_time_ms": 2.755, "learn_throughput": 11614.75, "synch_weights_time_ms": 4.163}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 56000, "last_target_update_ts": 14616, "num_target_updates": 28}, "done": false, "episodes_total": 527, "training_iteration": 15, "trial_id": "default", "date": "2024-10-05_21-54-32", "timestamp": 1728158072, "time_this_iter_s": 3.404658317565918, "time_total_s": 54.91127848625183, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 54.91127848625183, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.339999999999996, "ram_util_percent": 85.9}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 22.0, "episode_reward_mean": 37.8, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 37.0, 35.0, 53.0, 22.0, 33.0, 36.0, 24.0, 55.0, 51.0], "episode_lengths": [32, 37, 35, 53, 22, 33, 36, 24, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36245140336383364, "mean_inference_ms": 1.0794809002992103, "mean_action_processing_ms": 0.11933325935951129, "mean_env_wait_ms": 0.056809385699369906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026702880859375, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.060575008392333984}}, "episode_reward_max": 55.0, "episode_reward_min": 22.0, "episode_reward_mean": 37.8, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 37.0, 35.0, 53.0, 22.0, 33.0, 36.0, 24.0, 55.0, 51.0], "episode_lengths": [32, 37, 35, 53, 22, 33, 36, 24, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36245140336383364, "mean_inference_ms": 1.0794809002992103, "mean_action_processing_ms": 0.11933325935951129, "mean_env_wait_ms": 0.056809385699369906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026702880859375, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.060575008392333984}, "num_agent_steps_sampled_this_iter": 378, "num_env_steps_sampled_this_iter": 378, "timesteps_this_iter": 378, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.284358978271484, "min_q": 6.808080673217773, "max_q": 23.97232437133789, "mean_td_error": -0.5987963676452637}, "td_error": [-2.2979812622070312, 0.31904125213623047, -3.9805679321289062, 3.267658233642578, -1.244002342224121, -3.400726318359375, -5.251599311828613, -3.3825578689575195, -1.313253402709961, 3.4874820709228516, 2.6916985511779785, -0.7019443511962891, -1.3747901916503906, -1.0268611907958984, -1.7921676635742188, -2.905925750732422, 0.8457965850830078, 0.17489051818847656, 0.35053253173828125, 3.1374263763427734, -0.3203754425048828, -0.024206161499023438, 0.6082706451416016, 1.1453666687011719, -2.6046762466430664, -2.5915679931640625, -0.7532539367675781, -0.40046119689941406, -4.929893493652344, 8.1568021774292, -0.6553888320922852, -2.3942480087280273], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 1875, "diff_num_grad_updates_vs_sampler_policy": 1874}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "last_target_update_ts": 15624, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.4, "episode_len_mean": 42.4, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0], "episode_lengths": [35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.633571216547922, "mean_inference_ms": 1.8974018422983319, "mean_action_processing_ms": 0.19313918759590654, "mean_env_wait_ms": 0.10755901698248951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008430957794189453, "StateBufferConnector_ms": 0.005657672882080078, "ViewRequirementAgentConnector_ms": 0.1269090175628662}}, "episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.4, "episode_len_mean": 42.4, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 44.0, 46.0, 35.0, 30.0, 32.0, 32.0, 33.0, 33.0, 62.0, 54.0, 40.0, 32.0, 66.0, 42.0, 59.0, 53.0, 35.0, 47.0, 77.0, 38.0, 41.0, 35.0, 53.0, 49.0, 45.0, 25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0], "episode_lengths": [35, 44, 46, 35, 30, 32, 32, 33, 33, 62, 54, 40, 32, 66, 42, 59, 53, 35, 47, 77, 38, 41, 35, 53, 49, 45, 25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.633571216547922, "mean_inference_ms": 1.8974018422983319, "mean_action_processing_ms": 0.19313918759590654, "mean_env_wait_ms": 0.10755901698248951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008430957794189453, "StateBufferConnector_ms": 0.005657672882080078, "ViewRequirementAgentConnector_ms": 0.1269090175628662}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.5460063377364, "num_env_steps_trained_throughput_per_sec": 1278.1840253509456, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 24.805, "sample_time_ms": 9.331, "learn_time_ms": 2.704, "learn_throughput": 11833.065, "synch_weights_time_ms": 4.104}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 60000, "last_target_update_ts": 15624, "num_target_updates": 30}, "done": false, "episodes_total": 550, "training_iteration": 16, "trial_id": "default", "date": "2024-10-05_21-54-35", "timestamp": 1728158075, "time_this_iter_s": 3.420233726501465, "time_total_s": 58.331512212753296, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 58.331512212753296, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.88, "ram_util_percent": 85.94000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.5, "episode_len_mean": 39.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 37.0, 37.0, 36.0, 40.0, 63.0, 29.0, 45.0, 30.0, 45.0], "episode_lengths": [33, 37, 37, 36, 40, 63, 29, 45, 30, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.359295524227205, "mean_inference_ms": 1.069922172281295, "mean_action_processing_ms": 0.1184314933156366, "mean_env_wait_ms": 0.05634288926213785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030231475830078125, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.05788564682006836}}, "episode_reward_max": 63.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.5, "episode_len_mean": 39.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 37.0, 37.0, 36.0, 40.0, 63.0, 29.0, 45.0, 30.0, 45.0], "episode_lengths": [33, 37, 37, 36, 40, 63, 29, 45, 30, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.359295524227205, "mean_inference_ms": 1.069922172281295, "mean_action_processing_ms": 0.1184314933156366, "mean_env_wait_ms": 0.05634288926213785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030231475830078125, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.05788564682006836}, "num_agent_steps_sampled_this_iter": 395, "num_env_steps_sampled_this_iter": 395, "timesteps_this_iter": 395, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.449254989624023, "min_q": -1.0804945230484009, "max_q": 23.94349479675293, "mean_td_error": 0.052772924304008484}, "td_error": [-3.6955795288085938, -0.727325439453125, 2.990123748779297, 0.26482200622558594, -6.0466156005859375, 5.230476379394531, 0.6473007202148438, -2.794513702392578, -3.344921112060547, -2.0804944038391113, 3.172872543334961, 5.020598411560059, -1.2186698913574219, -3.0405960083007812, 0.5389261245727539, -1.0964486598968506, 2.752033233642578, -2.2099828720092773, 2.1742610931396484, 2.756092071533203, -2.3887176513671875, 1.4468536376953125, -2.072124481201172, 1.2403850555419922, 2.1451215744018555, -0.8742961883544922, -1.4735019207000732, 0.40253162384033203, 0.5012588500976562, 1.3170928955078125, 2.135310173034668, 0.01646137237548828], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2000, "diff_num_grad_updates_vs_sampler_policy": 1999}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "last_target_update_ts": 16632, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": 67.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.12, "episode_len_mean": 41.12, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0], "episode_lengths": [25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6243934119167387, "mean_inference_ms": 1.883381378393483, "mean_action_processing_ms": 0.19230925585405673, "mean_env_wait_ms": 0.10701075650315434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008460760116577148, "StateBufferConnector_ms": 0.0056531429290771484, "ViewRequirementAgentConnector_ms": 0.1278684139251709}}, "episode_reward_max": 67.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.12, "episode_len_mean": 41.12, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, 50.0, 39.0, 49.0, 43.0, 60.0, 37.0, 42.0, 46.0, 43.0, 39.0, 41.0, 44.0, 41.0, 41.0, 32.0, 48.0, 35.0, 33.0, 31.0, 51.0, 45.0, 39.0, 31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0], "episode_lengths": [25, 50, 39, 49, 43, 60, 37, 42, 46, 43, 39, 41, 44, 41, 41, 32, 48, 35, 33, 31, 51, 45, 39, 31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6243934119167387, "mean_inference_ms": 1.883381378393483, "mean_action_processing_ms": 0.19230925585405673, "mean_env_wait_ms": 0.10701075650315434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008460760116577148, "StateBufferConnector_ms": 0.0056531429290771484, "ViewRequirementAgentConnector_ms": 0.1278684139251709}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.2653076714093, "num_env_steps_trained_throughput_per_sec": 1281.0612306856372, "timesteps_total": 17000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 24.698, "sample_time_ms": 9.03, "learn_time_ms": 2.813, "learn_throughput": 11376.601, "synch_weights_time_ms": 4.085}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 64000, "last_target_update_ts": 16632, "num_target_updates": 32}, "done": false, "episodes_total": 576, "training_iteration": 17, "trial_id": "default", "date": "2024-10-05_21-54-39", "timestamp": 1728158079, "time_this_iter_s": 3.4027562141418457, "time_total_s": 61.73426842689514, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 61.73426842689514, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.64, "ram_util_percent": 86.0}}
{"evaluation": {"sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.7, "episode_len_mean": 41.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 44.0, 29.0, 37.0, 40.0, 57.0, 30.0, 29.0, 48.0, 58.0], "episode_lengths": [45, 44, 29, 37, 40, 57, 30, 29, 48, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3554101734724729, "mean_inference_ms": 1.0592362381067288, "mean_action_processing_ms": 0.11768279028676565, "mean_env_wait_ms": 0.05596314469134924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026273727416992188, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.05820274353027344}}, "episode_reward_max": 58.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.7, "episode_len_mean": 41.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 44.0, 29.0, 37.0, 40.0, 57.0, 30.0, 29.0, 48.0, 58.0], "episode_lengths": [45, 44, 29, 37, 40, 57, 30, 29, 48, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3554101734724729, "mean_inference_ms": 1.0592362381067288, "mean_action_processing_ms": 0.11768279028676565, "mean_env_wait_ms": 0.05596314469134924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026273727416992188, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.05820274353027344}, "num_agent_steps_sampled_this_iter": 417, "num_env_steps_sampled_this_iter": 417, "timesteps_this_iter": 417, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.93985366821289, "min_q": 2.4371752738952637, "max_q": 26.297414779663086, "mean_td_error": 0.29255664348602295}, "td_error": [1.7563495635986328, 2.5537643432617188, -0.82049560546875, -3.351520538330078, 2.452866554260254, 5.158148765563965, -4.064019203186035, -4.243765830993652, 0.19351768493652344, -2.0285873413085938, -1.8482627868652344, -0.236083984375, 0.11802101135253906, 0.5288248062133789, 0.40620994567871094, -0.58935546875, -0.7117366790771484, -0.98291015625, -0.11257743835449219, 0.08043289184570312, 4.810630798339844, -0.2708606719970703, 4.7686967849731445, -0.3167896270751953, -3.5963592529296875, -0.45762062072753906, 3.6473560333251953, -2.8092212677001953, 1.169600486755371, 1.5386037826538086, 1.0296516418457031, 5.589303970336914], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2125, "diff_num_grad_updates_vs_sampler_policy": 2124}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "last_target_update_ts": 17640, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 67.0, "episode_reward_min": 20.0, "episode_reward_mean": 40.2, "episode_len_mean": 40.2, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0], "episode_lengths": [31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127019670138225, "mean_inference_ms": 1.866643306788057, "mean_action_processing_ms": 0.19062950642251855, "mean_env_wait_ms": 0.10619251930097985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008321762084960938, "StateBufferConnector_ms": 0.005619525909423828, "ViewRequirementAgentConnector_ms": 0.12863564491271973}}, "episode_reward_max": 67.0, "episode_reward_min": 20.0, "episode_reward_mean": 40.2, "episode_len_mean": 40.2, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.0, 40.0, 48.0, 41.0, 25.0, 42.0, 25.0, 38.0, 52.0, 23.0, 24.0, 22.0, 38.0, 46.0, 47.0, 59.0, 42.0, 37.0, 42.0, 42.0, 45.0, 33.0, 52.0, 49.0, 44.0, 29.0, 33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0], "episode_lengths": [31, 40, 48, 41, 25, 42, 25, 38, 52, 23, 24, 22, 38, 46, 47, 59, 42, 37, 42, 42, 45, 33, 52, 49, 44, 29, 33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127019670138225, "mean_inference_ms": 1.866643306788057, "mean_action_processing_ms": 0.19062950642251855, "mean_env_wait_ms": 0.10619251930097985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008321762084960938, "StateBufferConnector_ms": 0.005619525909423828, "ViewRequirementAgentConnector_ms": 0.12863564491271973}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.7419527099956, "num_env_steps_trained_throughput_per_sec": 1274.9678108399823, "timesteps_total": 18000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 25.828, "sample_time_ms": 9.58, "learn_time_ms": 2.857, "learn_throughput": 11200.304, "synch_weights_time_ms": 4.44}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 68000, "last_target_update_ts": 17640, "num_target_updates": 34}, "done": false, "episodes_total": 599, "training_iteration": 18, "trial_id": "default", "date": "2024-10-05_21-54-42", "timestamp": 1728158082, "time_this_iter_s": 3.4643349647521973, "time_total_s": 65.19860339164734, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 65.19860339164734, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 35.92, "ram_util_percent": 86.04}}
{"evaluation": {"sampler_results": {"episode_reward_max": 53.0, "episode_reward_min": 12.0, "episode_reward_mean": 36.5, "episode_len_mean": 36.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 39.0, 39.0, 12.0, 37.0, 53.0, 33.0, 30.0, 31.0, 52.0], "episode_lengths": [39, 39, 39, 12, 37, 53, 33, 30, 31, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35412607101080384, "mean_inference_ms": 1.0538037808165672, "mean_action_processing_ms": 0.11712397876155063, "mean_env_wait_ms": 0.05566301279267667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003249645233154297, "StateBufferConnector_ms": 0.0031280517578125, "ViewRequirementAgentConnector_ms": 0.05814552307128906}}, "episode_reward_max": 53.0, "episode_reward_min": 12.0, "episode_reward_mean": 36.5, "episode_len_mean": 36.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 39.0, 39.0, 12.0, 37.0, 53.0, 33.0, 30.0, 31.0, 52.0], "episode_lengths": [39, 39, 39, 12, 37, 53, 33, 30, 31, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35412607101080384, "mean_inference_ms": 1.0538037808165672, "mean_action_processing_ms": 0.11712397876155063, "mean_env_wait_ms": 0.05566301279267667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003249645233154297, "StateBufferConnector_ms": 0.0031280517578125, "ViewRequirementAgentConnector_ms": 0.05814552307128906}, "num_agent_steps_sampled_this_iter": 365, "num_env_steps_sampled_this_iter": 365, "timesteps_this_iter": 365, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 19.565792083740234, "min_q": 4.310053825378418, "max_q": 27.86315155029297, "mean_td_error": 0.9210172891616821}, "td_error": [0.38664817810058594, -0.5612754821777344, 4.8335418701171875, 1.6747093200683594, 0.6513004302978516, 2.4157276153564453, 3.7111263275146484, -5.088911056518555, 0.5483036041259766, 4.343595504760742, -0.9834022521972656, -1.9105567932128906, -1.4954833984375, 3.310053825378418, 1.3277702331542969, 0.1266803741455078, 1.1777315139770508, 2.335325241088867, -2.5711965560913086, 1.521738052368164, 0.29004669189453125, -1.2665319442749023, -2.0477237701416016, 2.6942405700683594, -2.029630661010742, 3.68035888671875, 1.6601619720458984, -1.130441665649414, 2.2640933990478516, 5.614267349243164, 4.622424125671387, -0.6321392059326172], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2250, "diff_num_grad_updates_vs_sampler_policy": 2249}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "last_target_update_ts": 18648, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 20.0, "episode_reward_mean": 40.99, "episode_len_mean": 40.99, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0], "episode_lengths": [33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6032682550866297, "mean_inference_ms": 1.8526747768279859, "mean_action_processing_ms": 0.18926811114167483, "mean_env_wait_ms": 0.10558589594075668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008090972900390625, "StateBufferConnector_ms": 0.005583286285400391, "ViewRequirementAgentConnector_ms": 0.12879467010498047}}, "episode_reward_max": 74.0, "episode_reward_min": 20.0, "episode_reward_mean": 40.99, "episode_len_mean": 40.99, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 46.0, 63.0, 38.0, 49.0, 48.0, 52.0, 36.0, 41.0, 43.0, 33.0, 58.0, 56.0, 45.0, 36.0, 37.0, 37.0, 49.0, 41.0, 44.0, 47.0, 42.0, 52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0], "episode_lengths": [33, 46, 63, 38, 49, 48, 52, 36, 41, 43, 33, 58, 56, 45, 36, 37, 37, 49, 41, 44, 47, 42, 52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6032682550866297, "mean_inference_ms": 1.8526747768279859, "mean_action_processing_ms": 0.18926811114167483, "mean_env_wait_ms": 0.10558589594075668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008090972900390625, "StateBufferConnector_ms": 0.005583286285400391, "ViewRequirementAgentConnector_ms": 0.12879467010498047}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.937332074512, "num_env_steps_trained_throughput_per_sec": 1271.749328298048, "timesteps_total": 19000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 25.037, "sample_time_ms": 9.1, "learn_time_ms": 2.878, "learn_throughput": 11120.589, "synch_weights_time_ms": 4.209}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 72000, "last_target_update_ts": 18648, "num_target_updates": 36}, "done": false, "episodes_total": 625, "training_iteration": 19, "trial_id": "default", "date": "2024-10-05_21-54-46", "timestamp": 1728158086, "time_this_iter_s": 3.39485764503479, "time_total_s": 68.59346103668213, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 68.59346103668213, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.88, "ram_util_percent": 86.1}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 28.0, "episode_reward_mean": 42.7, "episode_len_mean": 42.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, 63.0, 30.0, 46.0, 47.0, 55.0, 33.0, 36.0, 28.0, 40.0], "episode_lengths": [49, 63, 30, 46, 47, 55, 33, 36, 28, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3510195179553541, "mean_inference_ms": 1.0451762463259637, "mean_action_processing_ms": 0.11640091983615315, "mean_env_wait_ms": 0.05530645474606648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003063678741455078, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.055158138275146484}}, "episode_reward_max": 63.0, "episode_reward_min": 28.0, "episode_reward_mean": 42.7, "episode_len_mean": 42.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, 63.0, 30.0, 46.0, 47.0, 55.0, 33.0, 36.0, 28.0, 40.0], "episode_lengths": [49, 63, 30, 46, 47, 55, 33, 36, 28, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3510195179553541, "mean_inference_ms": 1.0451762463259637, "mean_action_processing_ms": 0.11640091983615315, "mean_env_wait_ms": 0.05530645474606648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003063678741455078, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.055158138275146484}, "num_agent_steps_sampled_this_iter": 427, "num_env_steps_sampled_this_iter": 427, "timesteps_this_iter": 427, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 19.251474380493164, "min_q": 7.9175896644592285, "max_q": 27.99481773376465, "mean_td_error": 1.208785057067871}, "td_error": [-1.4814891815185547, 1.2267436981201172, 9.311677932739258, 0.91455078125, -0.9882965087890625, 4.999906539916992, -2.475153923034668, 2.6850662231445312, 4.423923492431641, 1.0673828125, 2.2666726112365723, 8.92323112487793, -0.7397384643554688, 10.97797966003418, -1.8661861419677734, 1.0780811309814453, 1.185598373413086, 1.081878662109375, 4.615278244018555, 0.3357524871826172, -1.122746467590332, -0.7550525665283203, 0.4701423645019531, -2.355661392211914, -1.9127826690673828, 0.6714210510253906, 3.653012275695801, -2.2927818298339844, -4.7802734375, 0.3606986999511719, -0.8705081939697266, 0.07279205322265625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2375, "diff_num_grad_updates_vs_sampler_policy": 2374}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "last_target_update_ts": 19656, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 40.75, "episode_len_mean": 40.75, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0], "episode_lengths": [52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5945123694451255, "mean_inference_ms": 1.8404494656143544, "mean_action_processing_ms": 0.1881103192327064, "mean_env_wait_ms": 0.10498185589328163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008133411407470703, "StateBufferConnector_ms": 0.0055408477783203125, "ViewRequirementAgentConnector_ms": 0.12807655334472656}}, "episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 40.75, "episode_len_mean": 40.75, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, 52.0, 44.0, 41.0, 45.0, 42.0, 52.0, 20.0, 29.0, 29.0, 32.0, 62.0, 29.0, 31.0, 35.0, 48.0, 30.0, 40.0, 44.0, 43.0, 34.0, 41.0, 22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0], "episode_lengths": [52, 52, 44, 41, 45, 42, 52, 20, 29, 29, 32, 62, 29, 31, 35, 48, 30, 40, 44, 43, 34, 41, 22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5945123694451255, "mean_inference_ms": 1.8404494656143544, "mean_action_processing_ms": 0.1881103192327064, "mean_env_wait_ms": 0.10498185589328163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008133411407470703, "StateBufferConnector_ms": 0.0055408477783203125, "ViewRequirementAgentConnector_ms": 0.12807655334472656}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7129774013457, "num_env_steps_trained_throughput_per_sec": 1278.8519096053828, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 24.682, "sample_time_ms": 9.027, "learn_time_ms": 2.754, "learn_throughput": 11618.068, "synch_weights_time_ms": 4.156}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 76000, "last_target_update_ts": 19656, "num_target_updates": 38}, "done": false, "episodes_total": 647, "training_iteration": 20, "trial_id": "default", "date": "2024-10-05_21-54-49", "timestamp": 1728158089, "time_this_iter_s": 3.4373366832733154, "time_total_s": 72.03079771995544, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 72.03079771995544, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 38.325, "ram_util_percent": 86.175}}
{"evaluation": {"sampler_results": {"episode_reward_max": 52.0, "episode_reward_min": 35.0, "episode_reward_mean": 40.8, "episode_len_mean": 40.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 52.0, 39.0, 40.0, 38.0, 36.0, 35.0, 36.0, 44.0, 45.0], "episode_lengths": [43, 52, 39, 40, 38, 36, 35, 36, 44, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3498188094359391, "mean_inference_ms": 1.0427940423100395, "mean_action_processing_ms": 0.11626471939775847, "mean_env_wait_ms": 0.055276719050819934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06045341491699219}}, "episode_reward_max": 52.0, "episode_reward_min": 35.0, "episode_reward_mean": 40.8, "episode_len_mean": 40.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 52.0, 39.0, 40.0, 38.0, 36.0, 35.0, 36.0, 44.0, 45.0], "episode_lengths": [43, 52, 39, 40, 38, 36, 35, 36, 44, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3498188094359391, "mean_inference_ms": 1.0427940423100395, "mean_action_processing_ms": 0.11626471939775847, "mean_env_wait_ms": 0.055276719050819934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06045341491699219}, "num_agent_steps_sampled_this_iter": 408, "num_env_steps_sampled_this_iter": 408, "timesteps_this_iter": 408, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 18.735294342041016, "min_q": 0.7466311454772949, "max_q": 29.316984176635742, "mean_td_error": 0.7998852133750916}, "td_error": [6.444524765014648, 3.968231201171875, -1.205850601196289, 2.0307884216308594, 0.5203323364257812, 1.793214201927185, -2.6382408142089844, 0.9224700927734375, 0.20671463012695312, 0.107330322265625, -2.7982559204101562, 4.140407562255859, 6.0828938484191895, -0.2533688545227051, -0.7343482971191406, -1.0363969802856445, -0.7782373428344727, 3.379344940185547, -0.7573480606079102, 1.44089937210083, 3.790567398071289, 4.694084167480469, 4.145017623901367, -2.1717166900634766, 1.4861621856689453, -1.297640323638916, 1.8318824768066406, 2.649892807006836, 0.22047042846679688, -4.169404983520508, -1.320901870727539, -5.097188949584961], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2500, "diff_num_grad_updates_vs_sampler_policy": 2499}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "last_target_update_ts": 20664, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.37, "episode_len_mean": 42.37, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0], "episode_lengths": [22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5847076649027705, "mean_inference_ms": 1.827910251662515, "mean_action_processing_ms": 0.18676326128409265, "mean_env_wait_ms": 0.1043384792966256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00822758674621582, "StateBufferConnector_ms": 0.0054988861083984375, "ViewRequirementAgentConnector_ms": 0.12724757194519043}}, "episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.37, "episode_len_mean": 42.37, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.0, 40.0, 44.0, 40.0, 67.0, 49.0, 31.0, 37.0, 33.0, 34.0, 52.0, 40.0, 26.0, 34.0, 40.0, 30.0, 23.0, 24.0, 39.0, 33.0, 34.0, 49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0], "episode_lengths": [22, 40, 44, 40, 67, 49, 31, 37, 33, 34, 52, 40, 26, 34, 40, 30, 23, 24, 39, 33, 34, 49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5847076649027705, "mean_inference_ms": 1.827910251662515, "mean_action_processing_ms": 0.18676326128409265, "mean_env_wait_ms": 0.1043384792966256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00822758674621582, "StateBufferConnector_ms": 0.0054988861083984375, "ViewRequirementAgentConnector_ms": 0.12724757194519043}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.20393649067285, "num_env_steps_trained_throughput_per_sec": 1272.8157459626914, "timesteps_total": 21000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 25.414, "sample_time_ms": 9.711, "learn_time_ms": 2.768, "learn_throughput": 11561.424, "synch_weights_time_ms": 4.094}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 80000, "last_target_update_ts": 20664, "num_target_updates": 40}, "done": false, "episodes_total": 669, "training_iteration": 21, "trial_id": "default", "date": "2024-10-05_21-54-53", "timestamp": 1728158093, "time_this_iter_s": 3.4689111709594727, "time_total_s": 75.49970889091492, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 75.49970889091492, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 35.92, "ram_util_percent": 86.22}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 31.0, "episode_reward_mean": 47.5, "episode_len_mean": 47.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 39.0, 31.0, 53.0, 54.0, 55.0, 51.0, 50.0, 49.0, 50.0], "episode_lengths": [43, 39, 31, 53, 54, 55, 51, 50, 49, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3470218699911366, "mean_inference_ms": 1.0358669835588206, "mean_action_processing_ms": 0.11570110269214795, "mean_env_wait_ms": 0.05499837191208549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028848648071289062, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.05538463592529297}}, "episode_reward_max": 55.0, "episode_reward_min": 31.0, "episode_reward_mean": 47.5, "episode_len_mean": 47.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 39.0, 31.0, 53.0, 54.0, 55.0, 51.0, 50.0, 49.0, 50.0], "episode_lengths": [43, 39, 31, 53, 54, 55, 51, 50, 49, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3470218699911366, "mean_inference_ms": 1.0358669835588206, "mean_action_processing_ms": 0.11570110269214795, "mean_env_wait_ms": 0.05499837191208549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028848648071289062, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.05538463592529297}, "num_agent_steps_sampled_this_iter": 475, "num_env_steps_sampled_this_iter": 475, "timesteps_this_iter": 475, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 20.379728317260742, "min_q": 3.2010388374328613, "max_q": 30.002117156982422, "mean_td_error": 1.1218175888061523}, "td_error": [-0.9914417266845703, 2.577310562133789, -1.5338897705078125, 2.9573974609375, 0.9308643341064453, 5.364465713500977, 4.623950958251953, 6.73962926864624, 1.2450523376464844, 1.8943099975585938, 2.923539161682129, -1.0491046905517578, 0.6596183776855469, 0.2573108673095703, -0.6046371459960938, 0.9749069213867188, 0.31377315521240234, -0.30028724670410156, -0.42937278747558594, -0.2792370319366455, -0.7164449691772461, 0.6346206665039062, 2.830944061279297, -3.936422348022461, 0.5821819305419922, -0.6032924652099609, -0.06641578674316406, -0.7331695556640625, -1.7919206619262695, 8.445760726928711, 0.29245567321777344, 4.685707092285156], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2625, "diff_num_grad_updates_vs_sampler_policy": 2624}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "last_target_update_ts": 21672, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 44.71, "episode_len_mean": 44.71, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0], "episode_lengths": [49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5775461846259764, "mean_inference_ms": 1.816856122215001, "mean_action_processing_ms": 0.18572797078968342, "mean_env_wait_ms": 0.10380175393889086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008240222930908203, "StateBufferConnector_ms": 0.005579948425292969, "ViewRequirementAgentConnector_ms": 0.12629079818725586}}, "episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 44.71, "episode_len_mean": 44.71, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 44.0, 51.0, 44.0, 37.0, 46.0, 37.0, 42.0, 33.0, 31.0, 64.0, 27.0, 36.0, 48.0, 42.0, 26.0, 74.0, 53.0, 38.0, 35.0, 43.0, 48.0, 38.0, 50.0, 32.0, 35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0], "episode_lengths": [49, 44, 51, 44, 37, 46, 37, 42, 33, 31, 64, 27, 36, 48, 42, 26, 74, 53, 38, 35, 43, 48, 38, 50, 32, 35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5775461846259764, "mean_inference_ms": 1.816856122215001, "mean_action_processing_ms": 0.18572797078968342, "mean_env_wait_ms": 0.10380175393889086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008240222930908203, "StateBufferConnector_ms": 0.005579948425292969, "ViewRequirementAgentConnector_ms": 0.12629079818725586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.6886191199426, "num_env_steps_trained_throughput_per_sec": 1178.7544764797703, "timesteps_total": 22000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 24.728, "sample_time_ms": 9.141, "learn_time_ms": 2.738, "learn_throughput": 11688.08, "synch_weights_time_ms": 4.07}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 84000, "last_target_update_ts": 21672, "num_target_updates": 42}, "done": false, "episodes_total": 690, "training_iteration": 22, "trial_id": "default", "date": "2024-10-05_21-54-56", "timestamp": 1728158096, "time_this_iter_s": 3.751633405685425, "time_total_s": 79.25134229660034, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 79.25134229660034, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.13333333333333, "ram_util_percent": 86.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": 30.0, "episode_reward_mean": 41.9, "episode_len_mean": 41.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 33.0, 37.0, 34.0, 45.0, 58.0, 55.0, 30.0, 50.0, 44.0], "episode_lengths": [33, 33, 37, 34, 45, 58, 55, 30, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34538503778459606, "mean_inference_ms": 1.030214046474343, "mean_action_processing_ms": 0.11532025528739827, "mean_env_wait_ms": 0.05476015603628267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002880096435546875, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.057604312896728516}}, "episode_reward_max": 58.0, "episode_reward_min": 30.0, "episode_reward_mean": 41.9, "episode_len_mean": 41.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 33.0, 37.0, 34.0, 45.0, 58.0, 55.0, 30.0, 50.0, 44.0], "episode_lengths": [33, 33, 37, 34, 45, 58, 55, 30, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34538503778459606, "mean_inference_ms": 1.030214046474343, "mean_action_processing_ms": 0.11532025528739827, "mean_env_wait_ms": 0.05476015603628267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002880096435546875, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.057604312896728516}, "num_agent_steps_sampled_this_iter": 419, "num_env_steps_sampled_this_iter": 419, "timesteps_this_iter": 419, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 19.478271484375, "min_q": 6.60496711730957, "max_q": 29.70779800415039, "mean_td_error": 0.6347965002059937}, "td_error": [2.484018325805664, -0.5167198181152344, -4.442018508911133, 3.8852081298828125, 7.61553955078125, -3.5872020721435547, -2.8587112426757812, 5.514204025268555, -3.1948394775390625, -0.2427043914794922, -5.799562454223633, 5.766898155212402, -1.9186458587646484, 6.983729362487793, 4.4052934646606445, -5.325267791748047, 5.765676498413086, -1.1610889434814453, -2.1417160034179688, -2.9946632385253906, -3.539857864379883, 0.3245429992675781, 3.3554115295410156, -3.685657501220703, -0.9456920623779297, 5.836334228515625, 1.1804828643798828, 5.325078964233398, 0.6624984741210938, 0.000743865966796875, 2.6896800994873047, 0.872492790222168], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2750, "diff_num_grad_updates_vs_sampler_policy": 2749}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "last_target_update_ts": 22680, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 43.92, "episode_len_mean": 43.92, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0], "episode_lengths": [35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5691671627731936, "mean_inference_ms": 1.805664310790325, "mean_action_processing_ms": 0.18475620846131657, "mean_env_wait_ms": 0.10323609607780382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008349418640136719, "StateBufferConnector_ms": 0.005707740783691406, "ViewRequirementAgentConnector_ms": 0.12663722038269043}}, "episode_reward_max": 83.0, "episode_reward_min": 15.0, "episode_reward_mean": 43.92, "episode_len_mean": 43.92, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 26.0, 38.0, 50.0, 37.0, 38.0, 49.0, 59.0, 42.0, 36.0, 44.0, 52.0, 45.0, 39.0, 45.0, 43.0, 45.0, 44.0, 52.0, 53.0, 15.0, 38.0, 38.0, 36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0], "episode_lengths": [35, 26, 38, 50, 37, 38, 49, 59, 42, 36, 44, 52, 45, 39, 45, 43, 45, 44, 52, 53, 15, 38, 38, 36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5691671627731936, "mean_inference_ms": 1.805664310790325, "mean_action_processing_ms": 0.18475620846131657, "mean_env_wait_ms": 0.10323609607780382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008349418640136719, "StateBufferConnector_ms": 0.005707740783691406, "ViewRequirementAgentConnector_ms": 0.12663722038269043}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5739277497758, "num_env_steps_trained_throughput_per_sec": 1242.2957109991032, "timesteps_total": 23000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 25.04, "sample_time_ms": 9.154, "learn_time_ms": 2.797, "learn_throughput": 11440.311, "synch_weights_time_ms": 4.236}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 88000, "last_target_update_ts": 22680, "num_target_updates": 44}, "done": false, "episodes_total": 715, "training_iteration": 23, "trial_id": "default", "date": "2024-10-05_21-55-00", "timestamp": 1728158100, "time_this_iter_s": 3.5165293216705322, "time_total_s": 82.76787161827087, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 82.76787161827087, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 38.42, "ram_util_percent": 86.33999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.8, "episode_len_mean": 41.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.0, 49.0, 36.0, 36.0, 37.0, 29.0, 53.0, 55.0, 29.0, 43.0], "episode_lengths": [51, 49, 36, 36, 37, 29, 53, 55, 29, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34382526064291596, "mean_inference_ms": 1.0257430258207023, "mean_action_processing_ms": 0.11502782581374049, "mean_env_wait_ms": 0.054598902352154255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029850006103515625, "StateBufferConnector_ms": 0.0022220611572265625, "ViewRequirementAgentConnector_ms": 0.05614042282104492}}, "episode_reward_max": 55.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.8, "episode_len_mean": 41.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.0, 49.0, 36.0, 36.0, 37.0, 29.0, 53.0, 55.0, 29.0, 43.0], "episode_lengths": [51, 49, 36, 36, 37, 29, 53, 55, 29, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34382526064291596, "mean_inference_ms": 1.0257430258207023, "mean_action_processing_ms": 0.11502782581374049, "mean_env_wait_ms": 0.054598902352154255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029850006103515625, "StateBufferConnector_ms": 0.0022220611572265625, "ViewRequirementAgentConnector_ms": 0.05614042282104492}, "num_agent_steps_sampled_this_iter": 418, "num_env_steps_sampled_this_iter": 418, "timesteps_this_iter": 418, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 20.114370346069336, "min_q": 4.345257759094238, "max_q": 31.772951126098633, "mean_td_error": 0.3111709952354431}, "td_error": [0.08679771423339844, 0.29106998443603516, 5.585895538330078, -1.8854217529296875, -3.9957962036132812, 1.6191940307617188, 0.12955951690673828, 0.8142833709716797, -5.211125373840332, 1.1012964248657227, 3.078960418701172, -2.2575340270996094, -1.8164100646972656, 2.6494674682617188, 1.1035490036010742, -2.4091262817382812, -2.8393173217773438, -0.3094606399536133, 3.1257686614990234, 0.5944232940673828, -2.4121103286743164, 8.76352596282959, -0.30803871154785156, -0.028051376342773438, 1.6377649307250977, 0.0052585601806640625, 0.8454642295837402, -1.8026409149169922, 0.48145484924316406, 1.4390697479248047, 0.3390617370605469, 1.5406389236450195], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 2875, "diff_num_grad_updates_vs_sampler_policy": 2874}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "last_target_update_ts": 23688, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.92, "episode_len_mean": 44.92, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0], "episode_lengths": [36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.564922532841087, "mean_inference_ms": 1.798763671695541, "mean_action_processing_ms": 0.18422989087623592, "mean_env_wait_ms": 0.10297432851365099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008117198944091797, "StateBufferConnector_ms": 0.00579524040222168, "ViewRequirementAgentConnector_ms": 0.12616515159606934}}, "episode_reward_max": 83.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.92, "episode_len_mean": 44.92, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.0, 35.0, 21.0, 43.0, 44.0, 40.0, 62.0, 33.0, 83.0, 55.0, 28.0, 46.0, 45.0, 54.0, 61.0, 80.0, 49.0, 52.0, 44.0, 30.0, 42.0, 49.0, 41.0, 37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0], "episode_lengths": [36, 35, 21, 43, 44, 40, 62, 33, 83, 55, 28, 46, 45, 54, 61, 80, 49, 52, 44, 30, 42, 49, 41, 37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.564922532841087, "mean_inference_ms": 1.798763671695541, "mean_action_processing_ms": 0.18422989087623592, "mean_env_wait_ms": 0.10297432851365099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008117198944091797, "StateBufferConnector_ms": 0.00579524040222168, "ViewRequirementAgentConnector_ms": 0.12616515159606934}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.02879506379867, "num_env_steps_trained_throughput_per_sec": 1272.1151802551947, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 26.299, "sample_time_ms": 9.29, "learn_time_ms": 2.99, "learn_throughput": 10702.741, "synch_weights_time_ms": 4.467}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 92000, "last_target_update_ts": 23688, "num_target_updates": 46}, "done": false, "episodes_total": 738, "training_iteration": 24, "trial_id": "default", "date": "2024-10-05_21-55-03", "timestamp": 1728158103, "time_this_iter_s": 3.4562578201293945, "time_total_s": 86.22412943840027, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 86.22412943840027, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.89999999999999, "ram_util_percent": 86.38000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 26.0, "episode_reward_mean": 41.3, "episode_len_mean": 41.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 72.0, 41.0, 46.0, 30.0, 36.0, 46.0, 35.0, 26.0, 46.0], "episode_lengths": [35, 72, 41, 46, 30, 36, 46, 35, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429787293333312, "mean_inference_ms": 1.0229015439179645, "mean_action_processing_ms": 0.11482764023317533, "mean_env_wait_ms": 0.05442911822350569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027942657470703125, "StateBufferConnector_ms": 0.0021123886108398438, "ViewRequirementAgentConnector_ms": 0.058455467224121094}}, "episode_reward_max": 72.0, "episode_reward_min": 26.0, "episode_reward_mean": 41.3, "episode_len_mean": 41.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 72.0, 41.0, 46.0, 30.0, 36.0, 46.0, 35.0, 26.0, 46.0], "episode_lengths": [35, 72, 41, 46, 30, 36, 46, 35, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429787293333312, "mean_inference_ms": 1.0229015439179645, "mean_action_processing_ms": 0.11482764023317533, "mean_env_wait_ms": 0.05442911822350569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027942657470703125, "StateBufferConnector_ms": 0.0021123886108398438, "ViewRequirementAgentConnector_ms": 0.058455467224121094}, "num_agent_steps_sampled_this_iter": 413, "num_env_steps_sampled_this_iter": 413, "timesteps_this_iter": 413, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 22.108776092529297, "min_q": 8.897527694702148, "max_q": 31.655397415161133, "mean_td_error": 0.9453528523445129}, "td_error": [3.2356319427490234, 3.0201759338378906, -1.2630271911621094, -2.986128807067871, 1.8187618255615234, 2.8472537994384766, -5.714141845703125, -2.2162723541259766, 3.0945968627929688, -0.6235275268554688, 0.06951332092285156, 2.9605841636657715, 0.09266471862792969, -2.7301559448242188, -0.1428966522216797, 0.2516155242919922, -2.189533233642578, 8.473747253417969, 0.3449077606201172, 0.6223220825195312, 1.3419837951660156, -1.4748210906982422, -1.1885786056518555, 5.642570495605469, 0.3029136657714844, 4.668987274169922, 5.739930152893066, -0.7713851928710938, 1.2503280639648438, 6.482592582702637, -1.322723388671875, 0.6134014129638672], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3000, "diff_num_grad_updates_vs_sampler_policy": 2999}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "last_target_update_ts": 24696, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.67, "episode_len_mean": 43.67, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0], "episode_lengths": [37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5586251037737486, "mean_inference_ms": 1.7893979553709172, "mean_action_processing_ms": 0.18326222794512617, "mean_env_wait_ms": 0.1025171887293712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007999181747436523, "StateBufferConnector_ms": 0.005608558654785156, "ViewRequirementAgentConnector_ms": 0.12577152252197266}}, "episode_reward_max": 77.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.67, "episode_len_mean": 43.67, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 28.0, 39.0, 38.0, 49.0, 75.0, 52.0, 43.0, 65.0, 77.0, 48.0, 47.0, 60.0, 56.0, 35.0, 41.0, 51.0, 23.0, 32.0, 53.0, 59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0], "episode_lengths": [37, 28, 39, 38, 49, 75, 52, 43, 65, 77, 48, 47, 60, 56, 35, 41, 51, 23, 32, 53, 59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5586251037737486, "mean_inference_ms": 1.7893979553709172, "mean_action_processing_ms": 0.18326222794512617, "mean_env_wait_ms": 0.1025171887293712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007999181747436523, "StateBufferConnector_ms": 0.005608558654785156, "ViewRequirementAgentConnector_ms": 0.12577152252197266}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.67520097324063, "num_env_steps_trained_throughput_per_sec": 1282.7008038929625, "timesteps_total": 25000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 25.128, "sample_time_ms": 9.251, "learn_time_ms": 2.901, "learn_throughput": 11029.569, "synch_weights_time_ms": 4.17}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 96000, "last_target_update_ts": 24696, "num_target_updates": 48}, "done": false, "episodes_total": 761, "training_iteration": 25, "trial_id": "default", "date": "2024-10-05_21-55-07", "timestamp": 1728158107, "time_this_iter_s": 3.416285276412964, "time_total_s": 89.64041471481323, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 89.64041471481323, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 35.38, "ram_util_percent": 86.38}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 43.4, "episode_len_mean": 43.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 38.0, 55.0, 62.0, 31.0, 34.0, 43.0, 42.0, 51.0, 43.0], "episode_lengths": [35, 38, 55, 62, 31, 34, 43, 42, 51, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34140420546427075, "mean_inference_ms": 1.0187998859786733, "mean_action_processing_ms": 0.11452343731742198, "mean_env_wait_ms": 0.05426672063379945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0021791458129882812, "ViewRequirementAgentConnector_ms": 0.05656242370605469}}, "episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 43.4, "episode_len_mean": 43.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 38.0, 55.0, 62.0, 31.0, 34.0, 43.0, 42.0, 51.0, 43.0], "episode_lengths": [35, 38, 55, 62, 31, 34, 43, 42, 51, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34140420546427075, "mean_inference_ms": 1.0187998859786733, "mean_action_processing_ms": 0.11452343731742198, "mean_env_wait_ms": 0.05426672063379945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0021791458129882812, "ViewRequirementAgentConnector_ms": 0.05656242370605469}, "num_agent_steps_sampled_this_iter": 434, "num_env_steps_sampled_this_iter": 434, "timesteps_this_iter": 434, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 20.824426651000977, "min_q": -3.5174732208251953, "max_q": 32.83647537231445, "mean_td_error": -0.5560903549194336}, "td_error": [-2.865436553955078, -0.6160030364990234, 0.75628662109375, 0.23440933227539062, 1.3267993927001953, -3.233051300048828, -4.966655731201172, -3.5626354217529297, -2.1688766479492188, -0.47075462341308594, -2.713947296142578, -0.6780214309692383, 3.0068893432617188, 3.4483819007873535, -7.1119384765625, 0.23726511001586914, -4.2811279296875, 2.7814788818359375, -4.517473220825195, -0.268035888671875, -2.8046646118164062, 0.5233306884765625, 1.7887115478515625, 2.4095821380615234, -0.8035125732421875, -0.2138824462890625, 0.6685357093811035, 0.6508617401123047, 6.459197998046875, -0.5361671447753906, 0.015699386596679688, -0.29013633728027344], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3125, "diff_num_grad_updates_vs_sampler_policy": 3124}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "last_target_update_ts": 25704, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 75.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.26, "episode_len_mean": 43.26, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0], "episode_lengths": [59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542053845543216, "mean_inference_ms": 1.7831301172650231, "mean_action_processing_ms": 0.18257645296468186, "mean_env_wait_ms": 0.10223411741220094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814509391784668, "StateBufferConnector_ms": 0.0055773258209228516, "ViewRequirementAgentConnector_ms": 0.1263260841369629}}, "episode_reward_max": 75.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.26, "episode_len_mean": 43.26, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 36.0, 44.0, 40.0, 54.0, 50.0, 35.0, 56.0, 44.0, 37.0, 31.0, 48.0, 50.0, 63.0, 30.0, 36.0, 50.0, 52.0, 38.0, 54.0, 22.0, 32.0, 33.0, 36.0, 22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0], "episode_lengths": [59, 36, 44, 40, 54, 50, 35, 56, 44, 37, 31, 48, 50, 63, 30, 36, 50, 52, 38, 54, 22, 32, 33, 36, 22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542053845543216, "mean_inference_ms": 1.7831301172650231, "mean_action_processing_ms": 0.18257645296468186, "mean_env_wait_ms": 0.10223411741220094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814509391784668, "StateBufferConnector_ms": 0.0055773258209228516, "ViewRequirementAgentConnector_ms": 0.1263260841369629}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.9561990963715, "num_env_steps_trained_throughput_per_sec": 1275.824796385486, "timesteps_total": 26000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 24.834, "sample_time_ms": 9.2, "learn_time_ms": 2.747, "learn_throughput": 11650.541, "synch_weights_time_ms": 4.122}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 100000, "last_target_update_ts": 25704, "num_target_updates": 50}, "done": false, "episodes_total": 781, "training_iteration": 26, "trial_id": "default", "date": "2024-10-05_21-55-10", "timestamp": 1728158110, "time_this_iter_s": 3.4544246196746826, "time_total_s": 93.09483933448792, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 93.09483933448792, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.675, "ram_util_percent": 86.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 57.0, "episode_reward_min": 30.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 41.0, 51.0, 55.0, 39.0, 51.0, 40.0, 30.0, 57.0, 49.0], "episode_lengths": [33, 41, 51, 55, 39, 51, 40, 30, 57, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34087877488795076, "mean_inference_ms": 1.0173631554237272, "mean_action_processing_ms": 0.11446636403519703, "mean_env_wait_ms": 0.05422687510402111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033593177795410156, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.059027671813964844}}, "episode_reward_max": 57.0, "episode_reward_min": 30.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 41.0, 51.0, 55.0, 39.0, 51.0, 40.0, 30.0, 57.0, 49.0], "episode_lengths": [33, 41, 51, 55, 39, 51, 40, 30, 57, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34087877488795076, "mean_inference_ms": 1.0173631554237272, "mean_action_processing_ms": 0.11446636403519703, "mean_env_wait_ms": 0.05422687510402111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033593177795410156, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.059027671813964844}, "num_agent_steps_sampled_this_iter": 446, "num_env_steps_sampled_this_iter": 446, "timesteps_this_iter": 446, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.124778747558594, "min_q": -6.043156147003174, "max_q": 31.569263458251953, "mean_td_error": -1.3821943998336792}, "td_error": [-3.530912399291992, 2.6960086822509766, -5.196930885314941, -1.5293006896972656, 0.9839935302734375, -4.835641860961914, 3.8088016510009766, -6.570196151733398, -1.1609954833984375, -7.043156147003174, -3.3639936447143555, -3.7009105682373047, -0.3966522216796875, -5.217794418334961, 3.945577621459961, -1.0305328369140625, 1.7057361602783203, -2.5082435607910156, -2.812074661254883, -3.4236011505126953, 3.506359100341797, -6.17599630355835, -4.267122268676758, 2.1447572708129883, -7.272556304931641, -1.193593978881836, 0.6875717639923096, 3.1726512908935547, 1.6517705917358398, 1.7057361602783203, 1.9060754776000977, -0.9150543212890625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3250, "diff_num_grad_updates_vs_sampler_policy": 3249}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "last_target_update_ts": 26712, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 75.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.75, "episode_len_mean": 43.75, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0], "episode_lengths": [22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5515933003540225, "mean_inference_ms": 1.7781362643869927, "mean_action_processing_ms": 0.1822032413708047, "mean_env_wait_ms": 0.1020886688668041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193731307983398, "StateBufferConnector_ms": 0.005571603775024414, "ViewRequirementAgentConnector_ms": 0.12613725662231445}}, "episode_reward_max": 75.0, "episode_reward_min": 22.0, "episode_reward_mean": 43.75, "episode_len_mean": 43.75, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.0, 36.0, 35.0, 24.0, 54.0, 37.0, 60.0, 31.0, 37.0, 41.0, 38.0, 36.0, 63.0, 34.0, 37.0, 37.0, 53.0, 44.0, 37.0, 36.0, 45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0], "episode_lengths": [22, 36, 35, 24, 54, 37, 60, 31, 37, 41, 38, 36, 63, 34, 37, 37, 53, 44, 37, 36, 45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5515933003540225, "mean_inference_ms": 1.7781362643869927, "mean_action_processing_ms": 0.1822032413708047, "mean_env_wait_ms": 0.1020886688668041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008193731307983398, "StateBufferConnector_ms": 0.005571603775024414, "ViewRequirementAgentConnector_ms": 0.12613725662231445}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.731706931555, "num_env_steps_trained_throughput_per_sec": 1274.92682772622, "timesteps_total": 27000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 25.553, "sample_time_ms": 9.109, "learn_time_ms": 2.798, "learn_throughput": 11437.971, "synch_weights_time_ms": 4.175}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 104000, "last_target_update_ts": 26712, "num_target_updates": 52}, "done": false, "episodes_total": 805, "training_iteration": 27, "trial_id": "default", "date": "2024-10-05_21-55-14", "timestamp": 1728158114, "time_this_iter_s": 3.4866950511932373, "time_total_s": 96.58153438568115, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 96.58153438568115, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.82000000000001, "ram_util_percent": 86.35999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 51.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 35.0, 40.0, 42.0, 38.0, 51.0, 46.0, 48.0, 38.0, 46.0], "episode_lengths": [46, 35, 40, 42, 38, 51, 46, 48, 38, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3392802547260371, "mean_inference_ms": 1.013553745439642, "mean_action_processing_ms": 0.11406534745667747, "mean_env_wait_ms": 0.054035123355826276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032830238342285156, "StateBufferConnector_ms": 0.0021529197692871094, "ViewRequirementAgentConnector_ms": 0.05486726760864258}}, "episode_reward_max": 51.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 35.0, 40.0, 42.0, 38.0, 51.0, 46.0, 48.0, 38.0, 46.0], "episode_lengths": [46, 35, 40, 42, 38, 51, 46, 48, 38, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3392802547260371, "mean_inference_ms": 1.013553745439642, "mean_action_processing_ms": 0.11406534745667747, "mean_env_wait_ms": 0.054035123355826276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032830238342285156, "StateBufferConnector_ms": 0.0021529197692871094, "ViewRequirementAgentConnector_ms": 0.05486726760864258}, "num_agent_steps_sampled_this_iter": 430, "num_env_steps_sampled_this_iter": 430, "timesteps_this_iter": 430, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 19.897802352905273, "min_q": 1.1008819341659546, "max_q": 34.64997100830078, "mean_td_error": -0.017152488231658936}, "td_error": [6.986766815185547, -4.571651458740234, -3.286945343017578, 4.678231239318848, -1.0099258422851562, 0.37468910217285156, -4.7228899002075195, 1.38006591796875, -2.0617313385009766, 7.274561882019043, 0.5705642700195312, -3.053041458129883, 5.387304782867432, 1.3490076065063477, -0.3930797576904297, 0.9172115325927734, -0.9621448516845703, -1.0939903259277344, 3.996835708618164, 3.1639833450317383, -0.5280838012695312, -2.8515186309814453, 1.1420574188232422, -4.788303375244141, 0.16675758361816406, 0.7825946807861328, -1.2225914001464844, 0.10088193416595459, -3.062091827392578, -2.6571788787841797, -5.2827911376953125, 2.7275657653808594], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3375, "diff_num_grad_updates_vs_sampler_policy": 3374}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "last_target_update_ts": 27720, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 75.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.14, "episode_len_mean": 45.14, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0], "episode_lengths": [45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.546462713872951, "mean_inference_ms": 1.7717751252593468, "mean_action_processing_ms": 0.1817022356242075, "mean_env_wait_ms": 0.10173807331360236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008221864700317383, "StateBufferConnector_ms": 0.005415439605712891, "ViewRequirementAgentConnector_ms": 0.1256544589996338}}, "episode_reward_max": 75.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.14, "episode_len_mean": 45.14, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.0, 46.0, 43.0, 58.0, 32.0, 44.0, 40.0, 61.0, 52.0, 46.0, 53.0, 55.0, 73.0, 62.0, 53.0, 35.0, 31.0, 35.0, 44.0, 28.0, 49.0, 50.0, 39.0, 35.0, 46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0], "episode_lengths": [45, 46, 43, 58, 32, 44, 40, 61, 52, 46, 53, 55, 73, 62, 53, 35, 31, 35, 44, 28, 49, 50, 39, 35, 46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.546462713872951, "mean_inference_ms": 1.7717751252593468, "mean_action_processing_ms": 0.1817022356242075, "mean_env_wait_ms": 0.10173807331360236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008221864700317383, "StateBufferConnector_ms": 0.005415439605712891, "ViewRequirementAgentConnector_ms": 0.1256544589996338}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.4729954625823, "num_env_steps_trained_throughput_per_sec": 1273.891981850329, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 24.979, "sample_time_ms": 9.274, "learn_time_ms": 2.786, "learn_throughput": 11486.13, "synch_weights_time_ms": 4.105}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 108000, "last_target_update_ts": 27720, "num_target_updates": 54}, "done": false, "episodes_total": 825, "training_iteration": 28, "trial_id": "default", "date": "2024-10-05_21-55-17", "timestamp": 1728158117, "time_this_iter_s": 3.459665060043335, "time_total_s": 100.04119944572449, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 100.04119944572449, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.160000000000004, "ram_util_percent": 86.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 38.0, "episode_reward_mean": 45.2, "episode_len_mean": 45.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 44.0, 49.0, 52.0, 45.0, 38.0, 45.0, 38.0, 46.0, 39.0], "episode_lengths": [56, 44, 49, 52, 45, 38, 45, 38, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33858083231733904, "mean_inference_ms": 1.0108973097976313, "mean_action_processing_ms": 0.11377939165997883, "mean_env_wait_ms": 0.05389467187032858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567768096923828, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.05623340606689453}}, "episode_reward_max": 56.0, "episode_reward_min": 38.0, "episode_reward_mean": 45.2, "episode_len_mean": 45.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 44.0, 49.0, 52.0, 45.0, 38.0, 45.0, 38.0, 46.0, 39.0], "episode_lengths": [56, 44, 49, 52, 45, 38, 45, 38, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33858083231733904, "mean_inference_ms": 1.0108973097976313, "mean_action_processing_ms": 0.11377939165997883, "mean_env_wait_ms": 0.05389467187032858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567768096923828, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.05623340606689453}, "num_agent_steps_sampled_this_iter": 452, "num_env_steps_sampled_this_iter": 452, "timesteps_this_iter": 452, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 21.632068634033203, "min_q": 3.648892402648926, "max_q": 36.02672576904297, "mean_td_error": 1.3483240604400635}, "td_error": [2.733264923095703, 0.8041210174560547, -2.7307186126708984, 5.330178260803223, 0.15215301513671875, 0.9543380737304688, -3.2124176025390625, -2.94046688079834, 2.8445987701416016, -3.3119754791259766, 3.00701904296875, -1.7546863555908203, -1.4552135467529297, -6.209012985229492, 4.477837562561035, 0.11168098449707031, -1.1006145477294922, 5.489370822906494, 2.6103477478027344, 3.706666946411133, 0.340606689453125, 5.452401638031006, 3.8008956909179688, 5.1613311767578125, 2.852092742919922, 2.3361587524414062, -0.28990936279296875, 5.017867088317871, 0.13825416564941406, 6.671534538269043, -1.229024887084961, 3.387693405151367], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3500, "diff_num_grad_updates_vs_sampler_policy": 3499}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "last_target_update_ts": 28728, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 75.0, "episode_reward_min": 24.0, "episode_reward_mean": 44.98, "episode_len_mean": 44.98, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0], "episode_lengths": [46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5416124156871438, "mean_inference_ms": 1.765474391517124, "mean_action_processing_ms": 0.18107334513352352, "mean_env_wait_ms": 0.10143867046469253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008525848388671875, "StateBufferConnector_ms": 0.005530834197998047, "ViewRequirementAgentConnector_ms": 0.12534117698669434}}, "episode_reward_max": 75.0, "episode_reward_min": 24.0, "episode_reward_mean": 44.98, "episode_len_mean": 44.98, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, 26.0, 57.0, 50.0, 75.0, 24.0, 30.0, 34.0, 28.0, 31.0, 47.0, 39.0, 62.0, 41.0, 39.0, 50.0, 26.0, 46.0, 33.0, 44.0, 67.0, 34.0, 51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0], "episode_lengths": [46, 26, 57, 50, 75, 24, 30, 34, 28, 31, 47, 39, 62, 41, 39, 50, 26, 46, 33, 44, 67, 34, 51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5416124156871438, "mean_inference_ms": 1.765474391517124, "mean_action_processing_ms": 0.18107334513352352, "mean_env_wait_ms": 0.10143867046469253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008525848388671875, "StateBufferConnector_ms": 0.005530834197998047, "ViewRequirementAgentConnector_ms": 0.12534117698669434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.14982336177826, "num_env_steps_trained_throughput_per_sec": 1276.599293447113, "timesteps_total": 29000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 24.985, "sample_time_ms": 9.488, "learn_time_ms": 2.722, "learn_throughput": 11755.954, "synch_weights_time_ms": 4.057}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 112000, "last_target_update_ts": 28728, "num_target_updates": 56}, "done": false, "episodes_total": 849, "training_iteration": 29, "trial_id": "default", "date": "2024-10-05_21-55-21", "timestamp": 1728158121, "time_this_iter_s": 3.4450252056121826, "time_total_s": 103.48622465133667, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 103.48622465133667, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.96, "ram_util_percent": 86.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 31.0, "episode_reward_mean": 40.8, "episode_len_mean": 40.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 38.0, 39.0, 48.0, 42.0, 40.0, 35.0, 63.0, 39.0, 31.0], "episode_lengths": [33, 38, 39, 48, 42, 40, 35, 63, 39, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33806490108431786, "mean_inference_ms": 1.0091066360473633, "mean_action_processing_ms": 0.11366954025478668, "mean_env_wait_ms": 0.05386729288331895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026178359985351562, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.05781412124633789}}, "episode_reward_max": 63.0, "episode_reward_min": 31.0, "episode_reward_mean": 40.8, "episode_len_mean": 40.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 38.0, 39.0, 48.0, 42.0, 40.0, 35.0, 63.0, 39.0, 31.0], "episode_lengths": [33, 38, 39, 48, 42, 40, 35, 63, 39, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33806490108431786, "mean_inference_ms": 1.0091066360473633, "mean_action_processing_ms": 0.11366954025478668, "mean_env_wait_ms": 0.05386729288331895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026178359985351562, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.05781412124633789}, "num_agent_steps_sampled_this_iter": 408, "num_env_steps_sampled_this_iter": 408, "timesteps_this_iter": 408, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 22.505340576171875, "min_q": 1.8321831226348877, "max_q": 37.469886779785156, "mean_td_error": 1.5320080518722534}, "td_error": [0.8321831226348877, -1.9031257629394531, 0.9598731994628906, 9.416686058044434, 6.087542533874512, 5.279754638671875, 1.5883045196533203, -5.723604202270508, -0.7307682037353516, 0.8909244537353516, -0.1137685775756836, 5.995307922363281, 0.21212387084960938, -1.000396728515625, 8.349365234375, 0.8484830856323242, -1.7278823852539062, 0.5143356323242188, -1.1543712615966797, 2.230113983154297, -2.7313499450683594, 4.438928604125977, 8.170912742614746, -3.8243560791015625, -3.7948055267333984, 1.7244186401367188, 2.2434396743774414, 3.974559783935547, -7.539376258850098, 1.4077205657958984, 4.181195259094238, 9.92188835144043], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3625, "diff_num_grad_updates_vs_sampler_policy": 3624}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "last_target_update_ts": 29736, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.44, "episode_len_mean": 45.44, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0], "episode_lengths": [51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5390351862392446, "mean_inference_ms": 1.7618722829591018, "mean_action_processing_ms": 0.1808885718558274, "mean_env_wait_ms": 0.10130072900062327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008509397506713867, "StateBufferConnector_ms": 0.005563974380493164, "ViewRequirementAgentConnector_ms": 0.12612533569335938}}, "episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.44, "episode_len_mean": 45.44, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.0, 58.0, 31.0, 31.0, 42.0, 42.0, 47.0, 42.0, 48.0, 74.0, 74.0, 62.0, 47.0, 34.0, 38.0, 35.0, 24.0, 57.0, 31.0, 37.0, 28.0, 66.0, 24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0], "episode_lengths": [51, 58, 31, 31, 42, 42, 47, 42, 48, 74, 74, 62, 47, 34, 38, 35, 24, 57, 31, 37, 28, 66, 24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5390351862392446, "mean_inference_ms": 1.7618722829591018, "mean_action_processing_ms": 0.1808885718558274, "mean_env_wait_ms": 0.10130072900062327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008509397506713867, "StateBufferConnector_ms": 0.005563974380493164, "ViewRequirementAgentConnector_ms": 0.12612533569335938}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.37685061815574, "num_env_steps_trained_throughput_per_sec": 1277.507402472623, "timesteps_total": 30000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 25.191, "sample_time_ms": 9.466, "learn_time_ms": 2.82, "learn_throughput": 11349.473, "synch_weights_time_ms": 4.056}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 116000, "last_target_update_ts": 29736, "num_target_updates": 58}, "done": false, "episodes_total": 871, "training_iteration": 30, "trial_id": "default", "date": "2024-10-05_21-55-24", "timestamp": 1728158124, "time_this_iter_s": 3.4315667152404785, "time_total_s": 106.91779136657715, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 106.91779136657715, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.68, "ram_util_percent": 86.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 74.0, "episode_reward_min": 28.0, "episode_reward_mean": 48.3, "episode_len_mean": 48.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 50.0, 74.0, 71.0, 50.0, 64.0, 39.0, 37.0, 31.0, 28.0], "episode_lengths": [39, 50, 74, 71, 50, 64, 39, 37, 31, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3363136707837326, "mean_inference_ms": 1.0055127774283434, "mean_action_processing_ms": 0.11339961900685673, "mean_env_wait_ms": 0.05373413201021535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543926239013672, "StateBufferConnector_ms": 0.0021719932556152344, "ViewRequirementAgentConnector_ms": 0.05992889404296875}}, "episode_reward_max": 74.0, "episode_reward_min": 28.0, "episode_reward_mean": 48.3, "episode_len_mean": 48.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 50.0, 74.0, 71.0, 50.0, 64.0, 39.0, 37.0, 31.0, 28.0], "episode_lengths": [39, 50, 74, 71, 50, 64, 39, 37, 31, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3363136707837326, "mean_inference_ms": 1.0055127774283434, "mean_action_processing_ms": 0.11339961900685673, "mean_env_wait_ms": 0.05373413201021535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543926239013672, "StateBufferConnector_ms": 0.0021719932556152344, "ViewRequirementAgentConnector_ms": 0.05992889404296875}, "num_agent_steps_sampled_this_iter": 483, "num_env_steps_sampled_this_iter": 483, "timesteps_this_iter": 483, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.408477783203125, "min_q": 9.105467796325684, "max_q": 37.39480972290039, "mean_td_error": 2.033834934234619}, "td_error": [5.62483024597168, -5.364709854125977, -0.30855560302734375, 5.755596160888672, 6.626995086669922, -2.0070838928222656, -0.3852863311767578, 6.400769233703613, -4.463498115539551, -1.7720565795898438, 5.790785789489746, 4.457296371459961, 0.03741455078125, 7.717787742614746, 0.08126449584960938, 0.22266769409179688, -3.552628517150879, 6.308250427246094, 5.771583557128906, 6.416847229003906, -0.6711826324462891, 1.6274833679199219, 3.835174560546875, 0.6352691650390625, -4.034168243408203, -1.6465950012207031, -2.2232284545898438, 6.733659744262695, -0.8964290618896484, 10.052108764648438, 2.6638145446777344, 5.648534774780273], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3750, "diff_num_grad_updates_vs_sampler_policy": 3749}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "last_target_update_ts": 30744, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.36, "episode_len_mean": 45.36, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0], "episode_lengths": [24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5346364164423514, "mean_inference_ms": 1.7561461287996536, "mean_action_processing_ms": 0.1803362019533079, "mean_env_wait_ms": 0.10099457393725196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008402585983276367, "StateBufferConnector_ms": 0.005511045455932617, "ViewRequirementAgentConnector_ms": 0.1265723705291748}}, "episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.36, "episode_len_mean": 45.36, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.0, 56.0, 35.0, 64.0, 53.0, 39.0, 68.0, 39.0, 26.0, 36.0, 33.0, 73.0, 46.0, 67.0, 25.0, 47.0, 63.0, 38.0, 45.0, 40.0, 32.0, 33.0, 59.0, 44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0], "episode_lengths": [24, 56, 35, 64, 53, 39, 68, 39, 26, 36, 33, 73, 46, 67, 25, 47, 63, 38, 45, 40, 32, 33, 59, 44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5346364164423514, "mean_inference_ms": 1.7561461287996536, "mean_action_processing_ms": 0.1803362019533079, "mean_env_wait_ms": 0.10099457393725196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008402585983276367, "StateBufferConnector_ms": 0.005511045455932617, "ViewRequirementAgentConnector_ms": 0.1265723705291748}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.1583960234255, "num_env_steps_trained_throughput_per_sec": 1276.633584093702, "timesteps_total": 31000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 24.738, "sample_time_ms": 8.978, "learn_time_ms": 2.828, "learn_throughput": 11315.219, "synch_weights_time_ms": 4.114}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 120000, "last_target_update_ts": 30744, "num_target_updates": 60}, "done": false, "episodes_total": 893, "training_iteration": 31, "trial_id": "default", "date": "2024-10-05_21-55-28", "timestamp": 1728158128, "time_this_iter_s": 3.50740909576416, "time_total_s": 110.42520046234131, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 110.42520046234131, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.16, "ram_util_percent": 86.42}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 44.1, "episode_len_mean": 44.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 45.0, 56.0, 41.0, 62.0, 45.0, 39.0, 37.0, 31.0, 40.0], "episode_lengths": [45, 45, 56, 41, 62, 45, 39, 37, 31, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336258245600785, "mean_inference_ms": 1.0048761968949187, "mean_action_processing_ms": 0.11333009485268926, "mean_env_wait_ms": 0.053709236960494386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029087066650390625, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.0590825080871582}}, "episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 44.1, "episode_len_mean": 44.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 45.0, 56.0, 41.0, 62.0, 45.0, 39.0, 37.0, 31.0, 40.0], "episode_lengths": [45, 45, 56, 41, 62, 45, 39, 37, 31, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336258245600785, "mean_inference_ms": 1.0048761968949187, "mean_action_processing_ms": 0.11333009485268926, "mean_env_wait_ms": 0.053709236960494386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029087066650390625, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.0590825080871582}, "num_agent_steps_sampled_this_iter": 441, "num_env_steps_sampled_this_iter": 441, "timesteps_this_iter": 441, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 20.742515563964844, "min_q": 1.016005516052246, "max_q": 35.890777587890625, "mean_td_error": 0.37739408016204834}, "td_error": [3.3542938232421875, -1.0961856842041016, 0.2649421691894531, -0.35386228561401367, -5.106195449829102, 2.6267566680908203, -1.7162799835205078, -0.9157333374023438, 2.360811233520508, 2.7352352142333984, -0.1840343475341797, 1.9259400367736816, 4.123388290405273, -1.7964248657226562, 5.552793502807617, 2.180269241333008, 5.651865005493164, -2.455089569091797, -5.17396354675293, 3.692445755004883, 0.22160911560058594, 7.925461769104004, -5.313037872314453, 1.2299690246582031, -4.135737419128418, -0.3843727111816406, -2.581298828125, -5.5659027099609375, -0.042392730712890625, 4.099541664123535, 3.846741199493408, -2.8949413299560547], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 3875, "diff_num_grad_updates_vs_sampler_policy": 3874}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "last_target_update_ts": 31752, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.88, "episode_len_mean": 45.88, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0], "episode_lengths": [44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5328535299357413, "mean_inference_ms": 1.7526226181268811, "mean_action_processing_ms": 0.17991721352670997, "mean_env_wait_ms": 0.1008761087971226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008402347564697266, "StateBufferConnector_ms": 0.0054514408111572266, "ViewRequirementAgentConnector_ms": 0.12755107879638672}}, "episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.88, "episode_len_mean": 45.88, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 40.0, 40.0, 34.0, 46.0, 74.0, 37.0, 54.0, 67.0, 64.0, 72.0, 46.0, 30.0, 54.0, 57.0, 60.0, 40.0, 24.0, 40.0, 64.0, 38.0, 37.0, 33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0], "episode_lengths": [44, 40, 40, 34, 46, 74, 37, 54, 67, 64, 72, 46, 30, 54, 57, 60, 40, 24, 40, 64, 38, 37, 33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5328535299357413, "mean_inference_ms": 1.7526226181268811, "mean_action_processing_ms": 0.17991721352670997, "mean_env_wait_ms": 0.1008761087971226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008402347564697266, "StateBufferConnector_ms": 0.0054514408111572266, "ViewRequirementAgentConnector_ms": 0.12755107879638672}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8704888222807, "num_env_steps_trained_throughput_per_sec": 1227.4819552891229, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 29.003, "sample_time_ms": 10.498, "learn_time_ms": 3.229, "learn_throughput": 9909.463, "synch_weights_time_ms": 4.762}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 124000, "last_target_update_ts": 31752, "num_target_updates": 62}, "done": false, "episodes_total": 916, "training_iteration": 32, "trial_id": "default", "date": "2024-10-05_21-55-31", "timestamp": 1728158131, "time_this_iter_s": 3.5717036724090576, "time_total_s": 113.99690413475037, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 113.99690413475037, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.660000000000004, "ram_util_percent": 86.56}}
{"evaluation": {"sampler_results": {"episode_reward_max": 52.0, "episode_reward_min": 32.0, "episode_reward_mean": 42.9, "episode_len_mean": 42.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 51.0, 44.0, 50.0, 36.0, 37.0, 40.0, 41.0, 46.0, 52.0], "episode_lengths": [32, 51, 44, 50, 36, 37, 40, 41, 46, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33567426703203684, "mean_inference_ms": 1.0038181552582117, "mean_action_processing_ms": 0.1132505535981195, "mean_env_wait_ms": 0.05368558632559469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028514862060546875, "StateBufferConnector_ms": 0.0023674964904785156, "ViewRequirementAgentConnector_ms": 0.060503482818603516}}, "episode_reward_max": 52.0, "episode_reward_min": 32.0, "episode_reward_mean": 42.9, "episode_len_mean": 42.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 51.0, 44.0, 50.0, 36.0, 37.0, 40.0, 41.0, 46.0, 52.0], "episode_lengths": [32, 51, 44, 50, 36, 37, 40, 41, 46, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33567426703203684, "mean_inference_ms": 1.0038181552582117, "mean_action_processing_ms": 0.1132505535981195, "mean_env_wait_ms": 0.05368558632559469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028514862060546875, "StateBufferConnector_ms": 0.0023674964904785156, "ViewRequirementAgentConnector_ms": 0.060503482818603516}, "num_agent_steps_sampled_this_iter": 429, "num_env_steps_sampled_this_iter": 429, "timesteps_this_iter": 429, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 25.452484130859375, "min_q": 7.789519786834717, "max_q": 38.048133850097656, "mean_td_error": 1.7493038177490234}, "td_error": [0.41676902770996094, -5.19342041015625, -2.579507827758789, 5.531412124633789, 2.867671012878418, -1.1971454620361328, 3.705036163330078, 6.299888610839844, 2.5278539657592773, 4.4190521240234375, -1.5648956298828125, 0.4300498962402344, 0.426025390625, -4.083791732788086, 1.2396430969238281, 5.993040084838867, -2.3334789276123047, 5.759857177734375, 1.262986183166504, 2.4701995849609375, 6.914531707763672, 12.363542556762695, -3.700206756591797, 4.93134880065918, -1.9341979026794434, 0.26402854919433594, -1.2407073974609375, -3.4622249603271484, 0.058963775634765625, 4.748781204223633, 9.577679634094238, 1.0589408874511719], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4000, "diff_num_grad_updates_vs_sampler_policy": 3999}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "last_target_update_ts": 32760, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 44.89, "episode_len_mean": 44.89, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0], "episode_lengths": [33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5299777400517311, "mean_inference_ms": 1.7482351365009288, "mean_action_processing_ms": 0.17942446258587416, "mean_env_wait_ms": 0.1006526991059901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008421659469604492, "StateBufferConnector_ms": 0.00549769401550293, "ViewRequirementAgentConnector_ms": 0.12826204299926758}}, "episode_reward_max": 79.0, "episode_reward_min": 24.0, "episode_reward_mean": 44.89, "episode_len_mean": 44.89, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 41.0, 51.0, 39.0, 34.0, 28.0, 35.0, 66.0, 57.0, 33.0, 50.0, 39.0, 79.0, 53.0, 25.0, 28.0, 41.0, 50.0, 31.0, 54.0, 53.0, 28.0, 36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0], "episode_lengths": [33, 41, 51, 39, 34, 28, 35, 66, 57, 33, 50, 39, 79, 53, 25, 28, 41, 50, 31, 54, 53, 28, 36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5299777400517311, "mean_inference_ms": 1.7482351365009288, "mean_action_processing_ms": 0.17942446258587416, "mean_env_wait_ms": 0.1006526991059901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008421659469604492, "StateBufferConnector_ms": 0.00549769401550293, "ViewRequirementAgentConnector_ms": 0.12826204299926758}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0412219972274, "num_env_steps_trained_throughput_per_sec": 1240.1648879889096, "timesteps_total": 33000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 25.272, "sample_time_ms": 9.243, "learn_time_ms": 2.763, "learn_throughput": 11579.877, "synch_weights_time_ms": 4.286}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 128000, "last_target_update_ts": 32760, "num_target_updates": 64}, "done": false, "episodes_total": 938, "training_iteration": 33, "trial_id": "default", "date": "2024-10-05_21-55-35", "timestamp": 1728158135, "time_this_iter_s": 3.573835849761963, "time_total_s": 117.57073998451233, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 117.57073998451233, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.239999999999995, "ram_util_percent": 86.92}}
{"evaluation": {"sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 40.0, 53.0, 35.0, 54.0, 41.0, 38.0, 38.0, 53.0, 39.0], "episode_lengths": [39, 40, 53, 35, 54, 41, 38, 38, 53, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350982817995596, "mean_inference_ms": 1.0015492230297558, "mean_action_processing_ms": 0.11308480068981885, "mean_env_wait_ms": 0.053595964652133656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029277801513671875, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.058612823486328125}}, "episode_reward_max": 54.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 40.0, 53.0, 35.0, 54.0, 41.0, 38.0, 38.0, 53.0, 39.0], "episode_lengths": [39, 40, 53, 35, 54, 41, 38, 38, 53, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350982817995596, "mean_inference_ms": 1.0015492230297558, "mean_action_processing_ms": 0.11308480068981885, "mean_env_wait_ms": 0.053595964652133656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029277801513671875, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.058612823486328125}, "num_agent_steps_sampled_this_iter": 430, "num_env_steps_sampled_this_iter": 430, "timesteps_this_iter": 430, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.110153198242188, "min_q": 1.5029159784317017, "max_q": 40.229026794433594, "mean_td_error": 1.212120771408081}, "td_error": [-3.123912811279297, -0.3139457702636719, 7.939632415771484, -4.792293548583984, 2.4505577087402344, 12.658090591430664, 3.1913833618164062, -2.020427703857422, 0.5029159784317017, 2.6149940490722656, 5.810213088989258, -4.2774810791015625, 0.8269081115722656, -4.945411682128906, 10.814286231994629, 2.4127368927001953, -4.662021636962891, 2.1229727268218994, -6.173824310302734, 0.598576545715332, -1.0423870086669922, 7.44312858581543, -1.5797853469848633, 4.338047027587891, 3.4520835876464844, 5.596587657928467, 4.470300674438477, 0.4162635803222656, -4.433610916137695, -3.3100032806396484, 1.5679969787597656, 0.23529434204101562], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4125, "diff_num_grad_updates_vs_sampler_policy": 4124}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "last_target_update_ts": 33768, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.06, "episode_len_mean": 45.06, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0], "episode_lengths": [36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5268791581472516, "mean_inference_ms": 1.743897656024365, "mean_action_processing_ms": 0.17889650634072696, "mean_env_wait_ms": 0.10042336588322347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123636245727539, "StateBufferConnector_ms": 0.005576372146606445, "ViewRequirementAgentConnector_ms": 0.12821650505065918}}, "episode_reward_max": 71.0, "episode_reward_min": 24.0, "episode_reward_mean": 45.06, "episode_len_mean": 45.06, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.0, 44.0, 38.0, 41.0, 44.0, 50.0, 62.0, 41.0, 43.0, 58.0, 37.0, 41.0, 42.0, 60.0, 24.0, 39.0, 38.0, 36.0, 36.0, 51.0, 64.0, 60.0, 44.0, 37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0], "episode_lengths": [36, 44, 38, 41, 44, 50, 62, 41, 43, 58, 37, 41, 42, 60, 24, 39, 38, 36, 36, 51, 64, 60, 44, 37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5268791581472516, "mean_inference_ms": 1.743897656024365, "mean_action_processing_ms": 0.17889650634072696, "mean_env_wait_ms": 0.10042336588322347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008123636245727539, "StateBufferConnector_ms": 0.005576372146606445, "ViewRequirementAgentConnector_ms": 0.12821650505065918}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.22170509252874, "num_env_steps_trained_throughput_per_sec": 1272.886820370115, "timesteps_total": 34000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 24.879, "sample_time_ms": 9.043, "learn_time_ms": 2.816, "learn_throughput": 11362.347, "synch_weights_time_ms": 4.103}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 132000, "last_target_update_ts": 33768, "num_target_updates": 66}, "done": false, "episodes_total": 960, "training_iteration": 34, "trial_id": "default", "date": "2024-10-05_21-55-38", "timestamp": 1728158138, "time_this_iter_s": 3.444077730178833, "time_total_s": 121.01481771469116, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 121.01481771469116, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 86.93999999999998}}
{"evaluation": {"sampler_results": {"episode_reward_max": 50.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.7, "episode_len_mean": 43.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 48.0, 47.0, 43.0, 50.0, 38.0, 45.0, 46.0, 46.0, 39.0], "episode_lengths": [35, 48, 47, 43, 50, 38, 45, 46, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33438317781972454, "mean_inference_ms": 0.9996502659210236, "mean_action_processing_ms": 0.11284760286892888, "mean_env_wait_ms": 0.05348130318871961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029134750366210938, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.057005882263183594}}, "episode_reward_max": 50.0, "episode_reward_min": 35.0, "episode_reward_mean": 43.7, "episode_len_mean": 43.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 48.0, 47.0, 43.0, 50.0, 38.0, 45.0, 46.0, 46.0, 39.0], "episode_lengths": [35, 48, 47, 43, 50, 38, 45, 46, 46, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33438317781972454, "mean_inference_ms": 0.9996502659210236, "mean_action_processing_ms": 0.11284760286892888, "mean_env_wait_ms": 0.05348130318871961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029134750366210938, "StateBufferConnector_ms": 0.002186298370361328, "ViewRequirementAgentConnector_ms": 0.057005882263183594}, "num_agent_steps_sampled_this_iter": 437, "num_env_steps_sampled_this_iter": 437, "timesteps_this_iter": 437, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.58539390563965, "min_q": 3.635983467102051, "max_q": 38.09164810180664, "mean_td_error": -0.6498769521713257}, "td_error": [-4.759893417358398, 8.058326721191406, -0.051239013671875, 3.303468704223633, 3.12347412109375, -2.340668201446533, -0.6238975524902344, 3.751781463623047, -4.802726745605469, -3.0797042846679688, -2.5314598083496094, -1.0385246276855469, 12.449775695800781, -4.742490768432617, 2.2592811584472656, 0.9801616668701172, -0.8631515502929688, -8.317987442016602, -0.7248039245605469, 0.5532283782958984, -0.9299321174621582, -1.2226943969726562, 1.6914558410644531, -4.704883575439453, 8.003839492797852, -5.233750820159912, -3.8945865631103516, -1.9050331115722656, -3.05039644241333, -8.054327011108398, -2.3631858825683594, 0.2644805908203125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4250, "diff_num_grad_updates_vs_sampler_policy": 4249}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "last_target_update_ts": 34776, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 21.0, "episode_reward_mean": 45.08, "episode_len_mean": 45.08, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0], "episode_lengths": [37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5260648774523282, "mean_inference_ms": 1.7413697097971386, "mean_action_processing_ms": 0.17864816826669538, "mean_env_wait_ms": 0.10038575594409839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00809168815612793, "StateBufferConnector_ms": 0.005547761917114258, "ViewRequirementAgentConnector_ms": 0.1284008026123047}}, "episode_reward_max": 71.0, "episode_reward_min": 21.0, "episode_reward_mean": 45.08, "episode_len_mean": 45.08, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 51.0, 45.0, 35.0, 42.0, 52.0, 41.0, 47.0, 57.0, 49.0, 48.0, 62.0, 33.0, 56.0, 41.0, 38.0, 50.0, 42.0, 35.0, 35.0, 57.0, 41.0, 53.0, 55.0, 49.0, 59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0], "episode_lengths": [37, 51, 45, 35, 42, 52, 41, 47, 57, 49, 48, 62, 33, 56, 41, 38, 50, 42, 35, 35, 57, 41, 53, 55, 49, 59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5260648774523282, "mean_inference_ms": 1.7413697097971386, "mean_action_processing_ms": 0.17864816826669538, "mean_env_wait_ms": 0.10038575594409839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00809168815612793, "StateBufferConnector_ms": 0.005547761917114258, "ViewRequirementAgentConnector_ms": 0.1284008026123047}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.98662490835994, "num_env_steps_trained_throughput_per_sec": 1271.9464996334398, "timesteps_total": 35000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 24.857, "sample_time_ms": 9.068, "learn_time_ms": 2.855, "learn_throughput": 11207.599, "synch_weights_time_ms": 4.088}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 136000, "last_target_update_ts": 34776, "num_target_updates": 68}, "done": false, "episodes_total": 983, "training_iteration": 35, "trial_id": "default", "date": "2024-10-05_21-55-42", "timestamp": 1728158142, "time_this_iter_s": 3.4577465057373047, "time_total_s": 124.47256422042847, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 124.47256422042847, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.94, "ram_util_percent": 86.9}}
{"evaluation": {"sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": 38.0, "episode_reward_mean": 46.5, "episode_len_mean": 46.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 58.0, 53.0, 38.0, 47.0, 40.0, 45.0, 44.0, 45.0, 54.0], "episode_lengths": [41, 58, 53, 38, 47, 40, 45, 44, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3339786191731093, "mean_inference_ms": 0.999003191898401, "mean_action_processing_ms": 0.11283404984313086, "mean_env_wait_ms": 0.05344635568429431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028944015502929688, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.06146669387817383}}, "episode_reward_max": 58.0, "episode_reward_min": 38.0, "episode_reward_mean": 46.5, "episode_len_mean": 46.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 58.0, 53.0, 38.0, 47.0, 40.0, 45.0, 44.0, 45.0, 54.0], "episode_lengths": [41, 58, 53, 38, 47, 40, 45, 44, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3339786191731093, "mean_inference_ms": 0.999003191898401, "mean_action_processing_ms": 0.11283404984313086, "mean_env_wait_ms": 0.05344635568429431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028944015502929688, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.06146669387817383}, "num_agent_steps_sampled_this_iter": 465, "num_env_steps_sampled_this_iter": 465, "timesteps_this_iter": 465, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 23.143604278564453, "min_q": -9.18565845489502, "max_q": 38.27553176879883, "mean_td_error": -0.008938610553741455}, "td_error": [-2.3112449645996094, -10.18565845489502, 5.138174057006836, 5.135859489440918, -2.1957168579101562, 4.587833404541016, -3.806155204772949, -0.6783103942871094, -5.87784481048584, -1.2608528137207031, 2.339874267578125, 2.3371124267578125, -0.9288654327392578, 4.2672553062438965, 0.0159912109375, 3.8663177490234375, 3.1199951171875, 2.6717262268066406, 13.522720336914062, -7.618566513061523, 1.7849979400634766, -2.5826148986816406, -2.757213592529297, -5.057519912719727, 3.726390838623047, -4.9867706298828125, -5.677646636962891, 5.846050262451172, 2.1468544006347656, -4.319171905517578, 0.7275600433349609, -1.2765960693359375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4375, "diff_num_grad_updates_vs_sampler_policy": 4374}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "last_target_update_ts": 35784, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 42.95, "episode_len_mean": 42.95, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0], "episode_lengths": [59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5235333485107823, "mean_inference_ms": 1.7370939602349038, "mean_action_processing_ms": 0.1782377224106101, "mean_env_wait_ms": 0.10019077446430198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00830841064453125, "StateBufferConnector_ms": 0.005615711212158203, "ViewRequirementAgentConnector_ms": 0.12921833992004395}}, "episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 42.95, "episode_len_mean": 42.95, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 46.0, 52.0, 41.0, 35.0, 58.0, 54.0, 53.0, 33.0, 51.0, 45.0, 52.0, 44.0, 34.0, 48.0, 34.0, 33.0, 54.0, 46.0, 35.0, 51.0, 49.0, 64.0, 54.0, 41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0], "episode_lengths": [59, 46, 52, 41, 35, 58, 54, 53, 33, 51, 45, 52, 44, 34, 48, 34, 33, 54, 46, 35, 51, 49, 64, 54, 41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5235333485107823, "mean_inference_ms": 1.7370939602349038, "mean_action_processing_ms": 0.1782377224106101, "mean_env_wait_ms": 0.10019077446430198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00830841064453125, "StateBufferConnector_ms": 0.005615711212158203, "ViewRequirementAgentConnector_ms": 0.12921833992004395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.44644425582027, "num_env_steps_trained_throughput_per_sec": 1269.785777023281, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 24.985, "sample_time_ms": 9.019, "learn_time_ms": 2.812, "learn_throughput": 11381.714, "synch_weights_time_ms": 4.181}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 140000, "last_target_update_ts": 35784, "num_target_updates": 70}, "done": false, "episodes_total": 1008, "training_iteration": 36, "trial_id": "default", "date": "2024-10-05_21-55-45", "timestamp": 1728158145, "time_this_iter_s": 3.4987099170684814, "time_total_s": 127.97127413749695, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 127.97127413749695, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 36.040000000000006, "ram_util_percent": 86.94000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 31.0, "episode_reward_mean": 43.5, "episode_len_mean": 43.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 47.0, 44.0, 54.0, 31.0, 40.0, 49.0, 52.0, 44.0, 35.0], "episode_lengths": [39, 47, 44, 54, 31, 40, 49, 52, 44, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33309277926042447, "mean_inference_ms": 0.9968690354055451, "mean_action_processing_ms": 0.1126334172089551, "mean_env_wait_ms": 0.053331958129196735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.055871009826660156}}, "episode_reward_max": 54.0, "episode_reward_min": 31.0, "episode_reward_mean": 43.5, "episode_len_mean": 43.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 47.0, 44.0, 54.0, 31.0, 40.0, 49.0, 52.0, 44.0, 35.0], "episode_lengths": [39, 47, 44, 54, 31, 40, 49, 52, 44, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33309277926042447, "mean_inference_ms": 0.9968690354055451, "mean_action_processing_ms": 0.1126334172089551, "mean_env_wait_ms": 0.053331958129196735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.055871009826660156}, "num_agent_steps_sampled_this_iter": 435, "num_env_steps_sampled_this_iter": 435, "timesteps_this_iter": 435, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.7896728515625, "min_q": -0.06169593334197998, "max_q": 39.67022705078125, "mean_td_error": -0.07287946343421936}, "td_error": [-0.9169225692749023, 0.3644752502441406, -4.230129241943359, -5.170509338378906, -1.737548828125, -2.2430038452148438, 0.11236190795898438, 2.86041259765625, 2.153573989868164, -0.6757831573486328, 0.37404537200927734, 1.6229267120361328, -1.3301925659179688, -0.328369140625, -0.4621238708496094, 9.958979606628418, 4.651802062988281, -2.1662826538085938, 3.7025012969970703, -2.8322677612304688, 3.0004348754882812, -3.236236572265625, 7.266063690185547, -1.4055500030517578, -1.609100341796875, 1.5614147186279297, -4.554193496704102, -0.6215667724609375, 0.422271728515625, -3.131326675415039, -2.1321487426757812, -1.6001510620117188], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4500, "diff_num_grad_updates_vs_sampler_policy": 4499}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "last_target_update_ts": 36792, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 42.01, "episode_len_mean": 42.01, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0], "episode_lengths": [41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5210493597633523, "mean_inference_ms": 1.7335848418046276, "mean_action_processing_ms": 0.17792678169405984, "mean_env_wait_ms": 0.10003579395338381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008217811584472656, "StateBufferConnector_ms": 0.005395174026489258, "ViewRequirementAgentConnector_ms": 0.12768793106079102}}, "episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 42.01, "episode_len_mean": 42.01, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.0, 26.0, 38.0, 40.0, 41.0, 50.0, 41.0, 52.0, 35.0, 46.0, 24.0, 52.0, 45.0, 41.0, 49.0, 41.0, 35.0, 63.0, 45.0, 42.0, 48.0, 42.0, 40.0, 34.0, 39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0], "episode_lengths": [41, 26, 38, 40, 41, 50, 41, 52, 35, 46, 24, 52, 45, 41, 49, 41, 35, 63, 45, 42, 48, 42, 40, 34, 39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5210493597633523, "mean_inference_ms": 1.7335848418046276, "mean_action_processing_ms": 0.17792678169405984, "mean_env_wait_ms": 0.10003579395338381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008217811584472656, "StateBufferConnector_ms": 0.005395174026489258, "ViewRequirementAgentConnector_ms": 0.12768793106079102}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.72943398338913, "num_env_steps_trained_throughput_per_sec": 1270.9177359335565, "timesteps_total": 37000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 25.035, "sample_time_ms": 9.098, "learn_time_ms": 2.868, "learn_throughput": 11159.33, "synch_weights_time_ms": 4.17}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 144000, "last_target_update_ts": 36792, "num_target_updates": 72}, "done": false, "episodes_total": 1032, "training_iteration": 37, "trial_id": "default", "date": "2024-10-05_21-55-49", "timestamp": 1728158149, "time_this_iter_s": 3.4645674228668213, "time_total_s": 131.43584156036377, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 131.43584156036377, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 35.94, "ram_util_percent": 87.0}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 33.0, "episode_reward_mean": 44.2, "episode_len_mean": 44.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 51.0, 46.0, 38.0, 33.0, 51.0, 39.0, 35.0, 46.0, 55.0], "episode_lengths": [48, 51, 46, 38, 33, 51, 39, 35, 46, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3329108429488229, "mean_inference_ms": 0.995942848200235, "mean_action_processing_ms": 0.11256159309904364, "mean_env_wait_ms": 0.053258045497763674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002486705780029297, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.06044626235961914}}, "episode_reward_max": 55.0, "episode_reward_min": 33.0, "episode_reward_mean": 44.2, "episode_len_mean": 44.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 51.0, 46.0, 38.0, 33.0, 51.0, 39.0, 35.0, 46.0, 55.0], "episode_lengths": [48, 51, 46, 38, 33, 51, 39, 35, 46, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3329108429488229, "mean_inference_ms": 0.995942848200235, "mean_action_processing_ms": 0.11256159309904364, "mean_env_wait_ms": 0.053258045497763674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002486705780029297, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.06044626235961914}, "num_agent_steps_sampled_this_iter": 442, "num_env_steps_sampled_this_iter": 442, "timesteps_this_iter": 442, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.06047821044922, "min_q": 1.0594433546066284, "max_q": 39.57205581665039, "mean_td_error": 1.123023271560669}, "td_error": [4.829819202423096, 3.5693397521972656, 0.6448850631713867, 0.6383955478668213, -3.786388397216797, 3.098184585571289, 1.1442642211914062, 3.8734283447265625, 1.2886028289794922, 2.0467071533203125, -4.478151321411133, 5.952919006347656, -0.630157470703125, -2.1893138885498047, 4.783931732177734, -3.647549629211426, 7.15205192565918, 7.543743133544922, 8.964776992797852, -1.577585220336914, 0.5751991271972656, -3.1356048583984375, 5.122035980224609, -7.413665771484375, -3.598051071166992, 4.352230072021484, 3.8154258728027344, -1.2448997497558594, -2.790435791015625, -2.7478199005126953, -3.3154964447021484, 7.095922470092773], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4625, "diff_num_grad_updates_vs_sampler_policy": 4624}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "last_target_update_ts": 37800, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.88, "episode_len_mean": 41.88, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0], "episode_lengths": [39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5202220636740873, "mean_inference_ms": 1.73194650708109, "mean_action_processing_ms": 0.1778609070796123, "mean_env_wait_ms": 0.10001047262029894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008311748504638672, "StateBufferConnector_ms": 0.005366086959838867, "ViewRequirementAgentConnector_ms": 0.12816667556762695}}, "episode_reward_max": 71.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.88, "episode_len_mean": 41.88, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 37.0, 71.0, 43.0, 42.0, 36.0, 37.0, 21.0, 47.0, 26.0, 52.0, 38.0, 57.0, 56.0, 55.0, 35.0, 37.0, 70.0, 63.0, 54.0, 58.0, 41.0, 37.0, 39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0], "episode_lengths": [39, 37, 71, 43, 42, 36, 37, 21, 47, 26, 52, 38, 57, 56, 55, 35, 37, 70, 63, 54, 58, 41, 37, 39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5202220636740873, "mean_inference_ms": 1.73194650708109, "mean_action_processing_ms": 0.1778609070796123, "mean_env_wait_ms": 0.10001047262029894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008311748504638672, "StateBufferConnector_ms": 0.005366086959838867, "ViewRequirementAgentConnector_ms": 0.12816667556762695}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.37429252438625, "num_env_steps_trained_throughput_per_sec": 1273.497170097545, "timesteps_total": 38000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 25.268, "sample_time_ms": 9.337, "learn_time_ms": 2.854, "learn_throughput": 11212.936, "synch_weights_time_ms": 4.144}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 148000, "last_target_update_ts": 37800, "num_target_updates": 74}, "done": false, "episodes_total": 1056, "training_iteration": 38, "trial_id": "default", "date": "2024-10-05_21-55-52", "timestamp": 1728158152, "time_this_iter_s": 3.4655303955078125, "time_total_s": 134.90137195587158, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 134.90137195587158, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.64, "ram_util_percent": 87.02000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 53.0, "episode_reward_min": 14.0, "episode_reward_mean": 38.3, "episode_len_mean": 38.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 38.0, 53.0, 43.0, 47.0, 37.0, 38.0, 29.0, 45.0, 39.0], "episode_lengths": [14, 38, 53, 43, 47, 37, 38, 29, 45, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3322834982151999, "mean_inference_ms": 0.995041638018399, "mean_action_processing_ms": 0.11248799454582029, "mean_env_wait_ms": 0.053245910325734135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026845932006835938, "StateBufferConnector_ms": 0.00263214111328125, "ViewRequirementAgentConnector_ms": 0.06116628646850586}}, "episode_reward_max": 53.0, "episode_reward_min": 14.0, "episode_reward_mean": 38.3, "episode_len_mean": 38.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 38.0, 53.0, 43.0, 47.0, 37.0, 38.0, 29.0, 45.0, 39.0], "episode_lengths": [14, 38, 53, 43, 47, 37, 38, 29, 45, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3322834982151999, "mean_inference_ms": 0.995041638018399, "mean_action_processing_ms": 0.11248799454582029, "mean_env_wait_ms": 0.053245910325734135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026845932006835938, "StateBufferConnector_ms": 0.00263214111328125, "ViewRequirementAgentConnector_ms": 0.06116628646850586}, "num_agent_steps_sampled_this_iter": 383, "num_env_steps_sampled_this_iter": 383, "timesteps_this_iter": 383, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.724578857421875, "min_q": 1.7558655738830566, "max_q": 40.285335540771484, "mean_td_error": -0.5280261039733887}, "td_error": [-2.6741867065429688, -6.091497421264648, 5.700386047363281, -2.543050765991211, -4.546375274658203, -0.5695209503173828, 3.060779571533203, 3.2959346771240234, 0.003086090087890625, 0.7558655738830566, 1.6945915222167969, 5.009998321533203, 0.5507736206054688, -1.3567771911621094, -3.3718338012695312, 0.14427947998046875, 2.0129241943359375, -0.8790397644042969, 1.7482457160949707, 2.346843719482422, -6.262016296386719, -0.5424289703369141, 4.813987731933594, 2.4899768829345703, -1.1128997802734375, -4.480154037475586, -1.5958099365234375, -7.610445022583008, -4.494842529296875, -5.358654022216797, -0.10083961486816406, 3.0658645629882812], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4750, "diff_num_grad_updates_vs_sampler_policy": 4749}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "last_target_update_ts": 38808, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": 78.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.71, "episode_len_mean": 41.71, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0], "episode_lengths": [39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5154862649963792, "mean_inference_ms": 1.7260381805124383, "mean_action_processing_ms": 0.17730496526759107, "mean_env_wait_ms": 0.09958831749979946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00844264030456543, "StateBufferConnector_ms": 0.0055043697357177734, "ViewRequirementAgentConnector_ms": 0.1269087791442871}}, "episode_reward_max": 78.0, "episode_reward_min": 20.0, "episode_reward_mean": 41.71, "episode_len_mean": 41.71, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 40.0, 54.0, 36.0, 38.0, 34.0, 34.0, 40.0, 35.0, 44.0, 40.0, 30.0, 35.0, 46.0, 39.0, 51.0, 26.0, 20.0, 47.0, 45.0, 38.0, 25.0, 37.0, 44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0], "episode_lengths": [39, 40, 54, 36, 38, 34, 34, 40, 35, 44, 40, 30, 35, 46, 39, 51, 26, 20, 47, 45, 38, 25, 37, 44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5154862649963792, "mean_inference_ms": 1.7260381805124383, "mean_action_processing_ms": 0.17730496526759107, "mean_env_wait_ms": 0.09958831749979946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00844264030456543, "StateBufferConnector_ms": 0.0055043697357177734, "ViewRequirementAgentConnector_ms": 0.1269087791442871}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.95832485556457, "num_env_steps_trained_throughput_per_sec": 1271.8332994222583, "timesteps_total": 39000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 24.881, "sample_time_ms": 9.003, "learn_time_ms": 2.776, "learn_throughput": 11528.95, "synch_weights_time_ms": 4.104}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 152000, "last_target_update_ts": 38808, "num_target_updates": 76}, "done": false, "episodes_total": 1079, "training_iteration": 39, "trial_id": "default", "date": "2024-10-05_21-55-56", "timestamp": 1728158156, "time_this_iter_s": 3.466526985168457, "time_total_s": 138.36789894104004, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 138.36789894104004, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.660000000000004, "ram_util_percent": 87.1}}
{"evaluation": {"sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.3, "episode_len_mean": 41.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 48.0, 41.0, 35.0, 47.0, 29.0, 35.0, 38.0, 40.0, 41.0], "episode_lengths": [59, 48, 41, 35, 47, 29, 35, 38, 40, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33230681925089833, "mean_inference_ms": 0.9940820407438645, "mean_action_processing_ms": 0.11241442310340315, "mean_env_wait_ms": 0.053204767478896464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002930164337158203, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.059723854064941406}}, "episode_reward_max": 59.0, "episode_reward_min": 29.0, "episode_reward_mean": 41.3, "episode_len_mean": 41.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 48.0, 41.0, 35.0, 47.0, 29.0, 35.0, 38.0, 40.0, 41.0], "episode_lengths": [59, 48, 41, 35, 47, 29, 35, 38, 40, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33230681925089833, "mean_inference_ms": 0.9940820407438645, "mean_action_processing_ms": 0.11241442310340315, "mean_env_wait_ms": 0.053204767478896464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002930164337158203, "StateBufferConnector_ms": 0.0026607513427734375, "ViewRequirementAgentConnector_ms": 0.059723854064941406}, "num_agent_steps_sampled_this_iter": 413, "num_env_steps_sampled_this_iter": 413, "timesteps_this_iter": 413, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.24656105041504, "min_q": -0.21351557970046997, "max_q": 41.54910659790039, "mean_td_error": 1.7391250133514404}, "td_error": [1.4652671813964844, -1.2135155200958252, 0.16753387451171875, -0.15816116333007812, -1.1968040466308594, 2.8645286560058594, 2.6763229370117188, 11.192544937133789, 2.3233814239501953, 1.0512828826904297, 8.389345169067383, 2.2251758575439453, 0.6221847534179688, 0.030637741088867188, -0.12296676635742188, 5.279117584228516, 3.9642772674560547, 6.295900344848633, -0.2992591857910156, 3.4832539558410645, 5.959005355834961, -3.2205028533935547, 0.5638713836669922, -1.7645606994628906, 1.1580867767333984, -2.4533185958862305, -1.5494751930236816, 10.21687126159668, -1.3033103942871094, -0.7958946228027344, 0.35235595703125, -0.5511741638183594], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 4875, "diff_num_grad_updates_vs_sampler_policy": 4874}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "last_target_update_ts": 39816, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": 78.0, "episode_reward_min": 21.0, "episode_reward_mean": 42.26, "episode_len_mean": 42.26, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0], "episode_lengths": [44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5140796592896826, "mean_inference_ms": 1.723999936931793, "mean_action_processing_ms": 0.17698521610921528, "mean_env_wait_ms": 0.09953025815441505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008490800857543945, "StateBufferConnector_ms": 0.005452632904052734, "ViewRequirementAgentConnector_ms": 0.12737131118774414}}, "episode_reward_max": 78.0, "episode_reward_min": 21.0, "episode_reward_mean": 42.26, "episode_len_mean": 42.26, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 37.0, 40.0, 36.0, 35.0, 37.0, 52.0, 37.0, 53.0, 48.0, 30.0, 41.0, 46.0, 39.0, 41.0, 41.0, 41.0, 42.0, 54.0, 39.0, 50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0], "episode_lengths": [44, 42, 37, 40, 36, 35, 37, 52, 37, 53, 48, 30, 41, 46, 39, 41, 41, 41, 42, 54, 39, 50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5140796592896826, "mean_inference_ms": 1.723999936931793, "mean_action_processing_ms": 0.17698521610921528, "mean_env_wait_ms": 0.09953025815441505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008490800857543945, "StateBufferConnector_ms": 0.005452632904052734, "ViewRequirementAgentConnector_ms": 0.12737131118774414}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.96679473141734, "num_env_steps_trained_throughput_per_sec": 1267.8671789256694, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 24.55, "sample_time_ms": 8.683, "learn_time_ms": 2.921, "learn_throughput": 10956.102, "synch_weights_time_ms": 4.108}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 156000, "last_target_update_ts": 39816, "num_target_updates": 78}, "done": false, "episodes_total": 1102, "training_iteration": 40, "trial_id": "default", "date": "2024-10-05_21-55-59", "timestamp": 1728158159, "time_this_iter_s": 3.4420576095581055, "time_total_s": 141.80995655059814, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 141.80995655059814, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 36.459999999999994, "ram_util_percent": 87.11999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 61.0, "episode_reward_min": 34.0, "episode_reward_mean": 44.1, "episode_len_mean": 44.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 39.0, 50.0, 37.0, 34.0, 50.0, 34.0, 61.0, 52.0, 45.0], "episode_lengths": [39, 39, 50, 37, 34, 50, 34, 61, 52, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33676417682944987, "mean_inference_ms": 1.0079821751778568, "mean_action_processing_ms": 0.11407828542200253, "mean_env_wait_ms": 0.053997905435879255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004451274871826172, "StateBufferConnector_ms": 0.0042438507080078125, "ViewRequirementAgentConnector_ms": 0.0903940200805664}}, "episode_reward_max": 61.0, "episode_reward_min": 34.0, "episode_reward_mean": 44.1, "episode_len_mean": 44.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 39.0, 50.0, 37.0, 34.0, 50.0, 34.0, 61.0, 52.0, 45.0], "episode_lengths": [39, 39, 50, 37, 34, 50, 34, 61, 52, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33676417682944987, "mean_inference_ms": 1.0079821751778568, "mean_action_processing_ms": 0.11407828542200253, "mean_env_wait_ms": 0.053997905435879255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004451274871826172, "StateBufferConnector_ms": 0.0042438507080078125, "ViewRequirementAgentConnector_ms": 0.0903940200805664}, "num_agent_steps_sampled_this_iter": 441, "num_env_steps_sampled_this_iter": 441, "timesteps_this_iter": 441, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 25.814102172851562, "min_q": 3.4125051498413086, "max_q": 41.374088287353516, "mean_td_error": 3.6402430534362793}, "td_error": [3.496769905090332, -1.5047645568847656, -2.2810592651367188, 6.0418243408203125, 0.43730926513671875, 5.673208236694336, 5.7916107177734375, 11.198200225830078, 1.5286827087402344, -4.967863082885742, 5.097589492797852, 3.5609359741210938, 10.899799346923828, 1.7315049171447754, 3.162398338317871, 3.235158920288086, 4.665742874145508, 3.1452507972717285, 0.5605869293212891, 2.3979721069335938, -0.20508193969726562, 6.241952896118164, -0.4995918273925781, 10.71367073059082, 0.6012172698974609, 8.847511291503906, 2.602222442626953, -0.842559814453125, 6.587602615356445, 10.334954261779785, 12.226079940795898, -3.991061210632324], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5000, "diff_num_grad_updates_vs_sampler_policy": 4999}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "last_target_update_ts": 40824, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 43.7, "episode_len_mean": 43.7, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0], "episode_lengths": [50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5144601839785121, "mean_inference_ms": 1.723685475006154, "mean_action_processing_ms": 0.17701853239246476, "mean_env_wait_ms": 0.0994993577884307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008994102478027344, "StateBufferConnector_ms": 0.005869150161743164, "ViewRequirementAgentConnector_ms": 0.135239839553833}}, "episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 43.7, "episode_len_mean": 43.7, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.0, 48.0, 49.0, 35.0, 36.0, 44.0, 57.0, 23.0, 48.0, 37.0, 36.0, 24.0, 46.0, 30.0, 50.0, 35.0, 49.0, 33.0, 38.0, 55.0, 36.0, 37.0, 56.0, 29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0], "episode_lengths": [50, 48, 49, 35, 36, 44, 57, 23, 48, 37, 36, 24, 46, 30, 50, 35, 49, 33, 38, 55, 36, 37, 56, 29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5144601839785121, "mean_inference_ms": 1.723685475006154, "mean_action_processing_ms": 0.17701853239246476, "mean_env_wait_ms": 0.0994993577884307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008994102478027344, "StateBufferConnector_ms": 0.005869150161743164, "ViewRequirementAgentConnector_ms": 0.135239839553833}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.40461966628837, "num_env_steps_trained_throughput_per_sec": 893.6184786651535, "timesteps_total": 41000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 38.117, "sample_time_ms": 13.903, "learn_time_ms": 4.107, "learn_throughput": 7791.94, "synch_weights_time_ms": 6.131}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 160000, "last_target_update_ts": 40824, "num_target_updates": 80}, "done": false, "episodes_total": 1123, "training_iteration": 41, "trial_id": "default", "date": "2024-10-05_21-56-04", "timestamp": 1728158164, "time_this_iter_s": 4.992683410644531, "time_total_s": 146.80263996124268, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 146.80263996124268, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 37.22857142857142, "ram_util_percent": 87.20000000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 33.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 54.0, 52.0, 45.0, 50.0, 38.0, 38.0, 33.0, 40.0, 40.0], "episode_lengths": [56, 54, 52, 45, 50, 38, 38, 33, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3414816939245092, "mean_inference_ms": 1.0212393816835748, "mean_action_processing_ms": 0.11573739164485712, "mean_env_wait_ms": 0.0548011020565498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696846008300781, "StateBufferConnector_ms": 0.0037431716918945312, "ViewRequirementAgentConnector_ms": 0.09424686431884766}}, "episode_reward_max": 56.0, "episode_reward_min": 33.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 54.0, 52.0, 45.0, 50.0, 38.0, 38.0, 33.0, 40.0, 40.0], "episode_lengths": [56, 54, 52, 45, 50, 38, 38, 33, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3414816939245092, "mean_inference_ms": 1.0212393816835748, "mean_action_processing_ms": 0.11573739164485712, "mean_env_wait_ms": 0.0548011020565498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696846008300781, "StateBufferConnector_ms": 0.0037431716918945312, "ViewRequirementAgentConnector_ms": 0.09424686431884766}, "num_agent_steps_sampled_this_iter": 446, "num_env_steps_sampled_this_iter": 446, "timesteps_this_iter": 446, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.065229415893555, "min_q": 5.889217853546143, "max_q": 40.584163665771484, "mean_td_error": 2.214275360107422}, "td_error": [7.524814605712891, -1.0402336120605469, 8.703954696655273, 2.353343963623047, -4.745395660400391, 0.13678359985351562, -2.6291027069091797, -3.081705093383789, -0.4899749755859375, 0.27481842041015625, 1.0979633331298828, -5.013526916503906, 4.941478729248047, 0.18123149871826172, 5.710988998413086, 1.2454967498779297, 0.826416015625, 10.482656478881836, 6.156871795654297, -2.0378456115722656, 4.532428741455078, -1.3368263244628906, 21.568445205688477, -0.08874130249023438, 6.319123268127441, -2.508319854736328, 2.4534950256347656, -4.142611026763916, -1.4680156707763672, 10.098482131958008, 5.588800430297852, -0.7584857940673828], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5125, "diff_num_grad_updates_vs_sampler_policy": 5124}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "last_target_update_ts": 41832, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 43.88, "episode_len_mean": 43.88, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0], "episode_lengths": [29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.519456373523107, "mean_inference_ms": 1.7275783848876842, "mean_action_processing_ms": 0.17759519142322244, "mean_env_wait_ms": 0.09975017354965562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009581327438354492, "StateBufferConnector_ms": 0.006289005279541016, "ViewRequirementAgentConnector_ms": 0.14672088623046875}}, "episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 43.88, "episode_len_mean": 43.88, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.0, 55.0, 49.0, 37.0, 54.0, 34.0, 33.0, 62.0, 36.0, 47.0, 52.0, 48.0, 66.0, 47.0, 78.0, 39.0, 40.0, 30.0, 41.0, 33.0, 33.0, 37.0, 45.0, 67.0, 33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0], "episode_lengths": [29, 55, 49, 37, 54, 34, 33, 62, 36, 47, 52, 48, 66, 47, 78, 39, 40, 30, 41, 33, 33, 37, 45, 67, 33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.519456373523107, "mean_inference_ms": 1.7275783848876842, "mean_action_processing_ms": 0.17759519142322244, "mean_env_wait_ms": 0.09975017354965562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009581327438354492, "StateBufferConnector_ms": 0.006289005279541016, "ViewRequirementAgentConnector_ms": 0.14672088623046875}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.92449990547365, "num_env_steps_trained_throughput_per_sec": 875.6979996218946, "timesteps_total": 42000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 36.57, "sample_time_ms": 12.999, "learn_time_ms": 3.985, "learn_throughput": 8030.738, "synch_weights_time_ms": 5.929}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 164000, "last_target_update_ts": 41832, "num_target_updates": 82}, "done": false, "episodes_total": 1146, "training_iteration": 42, "trial_id": "default", "date": "2024-10-05_21-56-09", "timestamp": 1728158169, "time_this_iter_s": 5.0645740032196045, "time_total_s": 151.86721396446228, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 151.86721396446228, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 87.20000000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 42.7, "episode_len_mean": 42.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 62.0, 31.0, 48.0, 47.0, 52.0, 41.0, 33.0, 39.0, 35.0], "episode_lengths": [39, 62, 31, 48, 47, 52, 41, 33, 39, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3451892556136028, "mean_inference_ms": 1.033180510288021, "mean_action_processing_ms": 0.11723870060713296, "mean_env_wait_ms": 0.05553637790795809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004391670227050781, "StateBufferConnector_ms": 0.004246234893798828, "ViewRequirementAgentConnector_ms": 0.09057283401489258}}, "episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 42.7, "episode_len_mean": 42.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 62.0, 31.0, 48.0, 47.0, 52.0, 41.0, 33.0, 39.0, 35.0], "episode_lengths": [39, 62, 31, 48, 47, 52, 41, 33, 39, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3451892556136028, "mean_inference_ms": 1.033180510288021, "mean_action_processing_ms": 0.11723870060713296, "mean_env_wait_ms": 0.05553637790795809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004391670227050781, "StateBufferConnector_ms": 0.004246234893798828, "ViewRequirementAgentConnector_ms": 0.09057283401489258}, "num_agent_steps_sampled_this_iter": 427, "num_env_steps_sampled_this_iter": 427, "timesteps_this_iter": 427, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.005990982055664, "min_q": -0.5355657339096069, "max_q": 41.53693771362305, "mean_td_error": 0.6516903638839722}, "td_error": [-1.7503509521484375, 1.9386577606201172, -3.3694958686828613, 5.082326889038086, -1.904876708984375, 6.203668594360352, -2.0598506927490234, 3.8880538940429688, -0.15266132354736328, 1.7554397583007812, 7.074164390563965, 0.145751953125, -5.641887664794922, 1.3515625, 4.512989044189453, 4.469135284423828, -5.550472259521484, 7.090091705322266, -2.0553441047668457, 6.728236198425293, 8.215509414672852, 3.882946014404297, 0.982696533203125, 0.3700103759765625, -5.12358283996582, -2.1250381469726562, -6.270114898681641, -0.6236190795898438, -6.475767135620117, -6.606832504272461, -3.049877166748047, 9.922622680664062], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5250, "diff_num_grad_updates_vs_sampler_policy": 5249}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "last_target_update_ts": 42840, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.06, "episode_len_mean": 44.06, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0], "episode_lengths": [33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5288290060630119, "mean_inference_ms": 1.7363685994491118, "mean_action_processing_ms": 0.1788057837276181, "mean_env_wait_ms": 0.10031660751982968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010381221771240234, "StateBufferConnector_ms": 0.00682520866394043, "ViewRequirementAgentConnector_ms": 0.15915608406066895}}, "episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.06, "episode_len_mean": 44.06, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 61.0, 52.0, 35.0, 42.0, 31.0, 40.0, 43.0, 42.0, 55.0, 65.0, 28.0, 48.0, 34.0, 36.0, 28.0, 34.0, 36.0, 57.0, 44.0, 31.0, 38.0, 32.0, 48.0, 42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0], "episode_lengths": [33, 61, 52, 35, 42, 31, 40, 43, 42, 55, 65, 28, 48, 34, 36, 28, 34, 36, 57, 44, 31, 38, 32, 48, 42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5288290060630119, "mean_inference_ms": 1.7363685994491118, "mean_action_processing_ms": 0.1788057837276181, "mean_env_wait_ms": 0.10031660751982968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010381221771240234, "StateBufferConnector_ms": 0.00682520866394043, "ViewRequirementAgentConnector_ms": 0.15915608406066895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.1429488003394, "num_env_steps_trained_throughput_per_sec": 876.5717952013576, "timesteps_total": 43000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 36.37, "sample_time_ms": 13.025, "learn_time_ms": 3.928, "learn_throughput": 8145.762, "synch_weights_time_ms": 6.05}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 168000, "last_target_update_ts": 42840, "num_target_updates": 84}, "done": false, "episodes_total": 1170, "training_iteration": 43, "trial_id": "default", "date": "2024-10-05_21-56-14", "timestamp": 1728158174, "time_this_iter_s": 5.080475807189941, "time_total_s": 156.94768977165222, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 156.94768977165222, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 35.2625, "ram_util_percent": 87.225}}
{"evaluation": {"sampler_results": {"episode_reward_max": 46.0, "episode_reward_min": 33.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 39.0, 40.0, 38.0, 46.0, 33.0, 44.0, 42.0, 40.0, 33.0], "episode_lengths": [42, 39, 40, 38, 46, 33, 44, 42, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.344762756791911, "mean_inference_ms": 1.0309541785001612, "mean_action_processing_ms": 0.11707117213284905, "mean_env_wait_ms": 0.05544743506737004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027322769165039062, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.060520172119140625}}, "episode_reward_max": 46.0, "episode_reward_min": 33.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 39.0, 40.0, 38.0, 46.0, 33.0, 44.0, 42.0, 40.0, 33.0], "episode_lengths": [42, 39, 40, 38, 46, 33, 44, 42, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.344762756791911, "mean_inference_ms": 1.0309541785001612, "mean_action_processing_ms": 0.11707117213284905, "mean_env_wait_ms": 0.05544743506737004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027322769165039062, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.060520172119140625}, "num_agent_steps_sampled_this_iter": 397, "num_env_steps_sampled_this_iter": 397, "timesteps_this_iter": 397, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.737537384033203, "min_q": 6.340290546417236, "max_q": 43.63453674316406, "mean_td_error": 2.1514358520507812}, "td_error": [-1.679823875427246, 7.038281440734863, 7.529476165771484, 5.843318939208984, -3.9541778564453125, -0.5514183044433594, -2.865459442138672, 1.3034400939941406, -0.6052513122558594, 2.3067665100097656, -2.19732666015625, 5.089563369750977, 7.883815765380859, 0.029603958129882812, 4.7725653648376465, -0.09140205383300781, 6.354303359985352, 4.135120391845703, -0.8064994812011719, -3.703662872314453, 4.412506103515625, 3.3752002716064453, -6.407926559448242, 8.752087593078613, 1.1628761291503906, 8.19461441040039, 0.1414318084716797, 7.920167922973633, 2.3091392517089844, 7.074489593505859, -3.102855682373047, -0.8170166015625], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5375, "diff_num_grad_updates_vs_sampler_policy": 5374}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "last_target_update_ts": 43848, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.0, "episode_len_mean": 44.0, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0], "episode_lengths": [42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5390673990268635, "mean_inference_ms": 1.7450159914499628, "mean_action_processing_ms": 0.18009013692804168, "mean_env_wait_ms": 0.10078927365981409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010584592819213867, "StateBufferConnector_ms": 0.0073108673095703125, "ViewRequirementAgentConnector_ms": 0.16882991790771484}}, "episode_reward_max": 79.0, "episode_reward_min": 21.0, "episode_reward_mean": 44.0, "episode_len_mean": 44.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 43.0, 53.0, 21.0, 39.0, 30.0, 46.0, 40.0, 25.0, 40.0, 54.0, 32.0, 63.0, 52.0, 71.0, 52.0, 55.0, 43.0, 47.0, 48.0, 79.0, 45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0], "episode_lengths": [42, 43, 53, 21, 39, 30, 46, 40, 25, 40, 54, 32, 63, 52, 71, 52, 55, 43, 47, 48, 79, 45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5390673990268635, "mean_inference_ms": 1.7450159914499628, "mean_action_processing_ms": 0.18009013692804168, "mean_env_wait_ms": 0.10078927365981409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010584592819213867, "StateBufferConnector_ms": 0.0073108673095703125, "ViewRequirementAgentConnector_ms": 0.16882991790771484}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.5450991245029, "num_env_steps_trained_throughput_per_sec": 942.1803964980116, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 24.888, "sample_time_ms": 9.051, "learn_time_ms": 2.769, "learn_throughput": 11554.656, "synch_weights_time_ms": 4.022}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 172000, "last_target_update_ts": 43848, "num_target_updates": 86}, "done": false, "episodes_total": 1194, "training_iteration": 44, "trial_id": "default", "date": "2024-10-05_21-56-19", "timestamp": 1728158179, "time_this_iter_s": 4.517770767211914, "time_total_s": 161.46546053886414, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 161.46546053886414, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.38333333333333, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 25.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 63.0, 32.0, 45.0, 35.0, 58.0, 29.0, 43.0, 25.0, 34.0], "episode_lengths": [47, 63, 32, 45, 35, 58, 29, 43, 25, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34444339582881117, "mean_inference_ms": 1.0296218377826307, "mean_action_processing_ms": 0.1169970723814284, "mean_env_wait_ms": 0.05541810404730776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002906322479248047, "StateBufferConnector_ms": 0.0028467178344726562, "ViewRequirementAgentConnector_ms": 0.06060600280761719}}, "episode_reward_max": 63.0, "episode_reward_min": 25.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 63.0, 32.0, 45.0, 35.0, 58.0, 29.0, 43.0, 25.0, 34.0], "episode_lengths": [47, 63, 32, 45, 35, 58, 29, 43, 25, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34444339582881117, "mean_inference_ms": 1.0296218377826307, "mean_action_processing_ms": 0.1169970723814284, "mean_env_wait_ms": 0.05541810404730776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002906322479248047, "StateBufferConnector_ms": 0.0028467178344726562, "ViewRequirementAgentConnector_ms": 0.06060600280761719}, "num_agent_steps_sampled_this_iter": 411, "num_env_steps_sampled_this_iter": 411, "timesteps_this_iter": 411, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.883893966674805, "min_q": -4.536895275115967, "max_q": 42.426246643066406, "mean_td_error": -0.3096807599067688}, "td_error": [-0.12745094299316406, -5.119887828826904, -0.11956405639648438, 7.763294219970703, 6.803951263427734, -5.144142150878906, 4.857206344604492, 4.577959060668945, -0.7881965637207031, -1.312255859375, -8.126251220703125, 5.490467071533203, -1.4014129638671875, -3.5140342712402344, 1.3020553588867188, 3.1012868881225586, -2.1989212036132812, -3.1054210662841797, 3.8330442905426025, -2.0639266967773438, -0.6758193969726562, 1.0989112854003906, -5.211782455444336, -3.2715110778808594, -0.26828813552856445, -0.6482391357421875, 3.2227954864501953, -3.1627235412597656, -1.8107490539550781, -5.905858993530273, -0.9643821716308594, 2.9800634384155273], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5500, "diff_num_grad_updates_vs_sampler_policy": 5499}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "last_target_update_ts": 44856, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 43.38, "episode_len_mean": 43.38, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0], "episode_lengths": [45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5475839597071108, "mean_inference_ms": 1.7525194622324392, "mean_action_processing_ms": 0.18111597361950538, "mean_env_wait_ms": 0.10126883648641986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010379314422607422, "StateBufferConnector_ms": 0.007042884826660156, "ViewRequirementAgentConnector_ms": 0.16272687911987305}}, "episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 43.38, "episode_len_mean": 43.38, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.0, 38.0, 51.0, 60.0, 34.0, 37.0, 41.0, 52.0, 37.0, 38.0, 40.0, 42.0, 52.0, 53.0, 41.0, 54.0, 35.0, 51.0, 38.0, 49.0, 34.0, 42.0, 44.0, 49.0, 23.0, 52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0], "episode_lengths": [45, 38, 51, 60, 34, 37, 41, 52, 37, 38, 40, 42, 52, 53, 41, 54, 35, 51, 38, 49, 34, 42, 44, 49, 23, 52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5475839597071108, "mean_inference_ms": 1.7525194622324392, "mean_action_processing_ms": 0.18111597361950538, "mean_env_wait_ms": 0.10126883648641986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010379314422607422, "StateBufferConnector_ms": 0.007042884826660156, "ViewRequirementAgentConnector_ms": 0.16272687911987305}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.74599538108083, "num_env_steps_trained_throughput_per_sec": 1290.9839815243233, "timesteps_total": 45000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 24.286, "sample_time_ms": 8.924, "learn_time_ms": 2.703, "learn_throughput": 11838.597, "synch_weights_time_ms": 4.069}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 176000, "last_target_update_ts": 44856, "num_target_updates": 88}, "done": false, "episodes_total": 1215, "training_iteration": 45, "trial_id": "default", "date": "2024-10-05_21-56-22", "timestamp": 1728158182, "time_this_iter_s": 3.4251158237457275, "time_total_s": 164.89057636260986, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 164.89057636260986, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 66.0, "episode_reward_min": 25.0, "episode_reward_mean": 42.9, "episode_len_mean": 42.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 25.0, 41.0, 38.0, 44.0, 26.0, 53.0, 53.0, 66.0, 39.0], "episode_lengths": [44, 25, 41, 38, 44, 26, 53, 53, 66, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34429360084058475, "mean_inference_ms": 1.0289658506486317, "mean_action_processing_ms": 0.1169431520075382, "mean_env_wait_ms": 0.05539476128963759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002720355987548828, "StateBufferConnector_ms": 0.0032138824462890625, "ViewRequirementAgentConnector_ms": 0.06205558776855469}}, "episode_reward_max": 66.0, "episode_reward_min": 25.0, "episode_reward_mean": 42.9, "episode_len_mean": 42.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 25.0, 41.0, 38.0, 44.0, 26.0, 53.0, 53.0, 66.0, 39.0], "episode_lengths": [44, 25, 41, 38, 44, 26, 53, 53, 66, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34429360084058475, "mean_inference_ms": 1.0289658506486317, "mean_action_processing_ms": 0.1169431520075382, "mean_env_wait_ms": 0.05539476128963759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002720355987548828, "StateBufferConnector_ms": 0.0032138824462890625, "ViewRequirementAgentConnector_ms": 0.06205558776855469}, "num_agent_steps_sampled_this_iter": 429, "num_env_steps_sampled_this_iter": 429, "timesteps_this_iter": 429, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.815017700195312, "min_q": 1.4756393432617188, "max_q": 42.463497161865234, "mean_td_error": 0.7174592018127441}, "td_error": [-1.0530891418457031, -2.200521469116211, 3.6464805603027344, 5.741484642028809, -0.6351280212402344, -0.047962188720703125, 5.375480651855469, -2.449892044067383, 0.47563934326171875, 4.642326354980469, -1.37945556640625, -10.748929977416992, 1.8346977233886719, 4.5821533203125, -5.878063201904297, 2.7528257369995117, -0.7958011627197266, -2.524860382080078, 1.6279945373535156, 12.228683471679688, 1.5349807739257812, 2.086721897125244, -6.343513488769531, -3.602330207824707, -4.138082504272461, 7.286520957946777, -1.3082618713378906, 0.3803596496582031, 3.30532169342041, -0.2954673767089844, -2.0254478454589844, 10.883828163146973], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5625, "diff_num_grad_updates_vs_sampler_policy": 5624}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "last_target_update_ts": 45864, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 42.92, "episode_len_mean": 42.92, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0], "episode_lengths": [52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5538851410311987, "mean_inference_ms": 1.7575658631270756, "mean_action_processing_ms": 0.18187841125885085, "mean_env_wait_ms": 0.10161980194299329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00978231430053711, "StateBufferConnector_ms": 0.006626605987548828, "ViewRequirementAgentConnector_ms": 0.15061116218566895}}, "episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 42.92, "episode_len_mean": 42.92, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, 56.0, 38.0, 33.0, 31.0, 38.0, 45.0, 38.0, 54.0, 69.0, 47.0, 36.0, 36.0, 53.0, 41.0, 66.0, 41.0, 37.0, 40.0, 38.0, 41.0, 42.0, 51.0, 36.0, 77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0], "episode_lengths": [52, 56, 38, 33, 31, 38, 45, 38, 54, 69, 47, 36, 36, 53, 41, 66, 41, 37, 40, 38, 41, 42, 51, 36, 77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5538851410311987, "mean_inference_ms": 1.7575658631270756, "mean_action_processing_ms": 0.18187841125885085, "mean_env_wait_ms": 0.10161980194299329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00978231430053711, "StateBufferConnector_ms": 0.006626605987548828, "ViewRequirementAgentConnector_ms": 0.15061116218566895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.8391433995598, "num_env_steps_trained_throughput_per_sec": 1279.3565735982393, "timesteps_total": 46000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 24.895, "sample_time_ms": 9.151, "learn_time_ms": 2.766, "learn_throughput": 11570.494, "synch_weights_time_ms": 4.072}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 180000, "last_target_update_ts": 45864, "num_target_updates": 90}, "done": false, "episodes_total": 1240, "training_iteration": 46, "trial_id": "default", "date": "2024-10-05_21-56-26", "timestamp": 1728158186, "time_this_iter_s": 3.4400007724761963, "time_total_s": 168.33057713508606, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 168.33057713508606, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 36.239999999999995, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 35.0, "episode_reward_mean": 42.4, "episode_len_mean": 42.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 36.0, 38.0, 52.0, 38.0, 51.0, 35.0, 41.0, 55.0, 41.0], "episode_lengths": [37, 36, 38, 52, 38, 51, 35, 41, 55, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3434423978335817, "mean_inference_ms": 1.0269327251150677, "mean_action_processing_ms": 0.1166867572370122, "mean_env_wait_ms": 0.055270357798929436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002815723419189453, "StateBufferConnector_ms": 0.0027513504028320312, "ViewRequirementAgentConnector_ms": 0.05720376968383789}}, "episode_reward_max": 55.0, "episode_reward_min": 35.0, "episode_reward_mean": 42.4, "episode_len_mean": 42.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 36.0, 38.0, 52.0, 38.0, 51.0, 35.0, 41.0, 55.0, 41.0], "episode_lengths": [37, 36, 38, 52, 38, 51, 35, 41, 55, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3434423978335817, "mean_inference_ms": 1.0269327251150677, "mean_action_processing_ms": 0.1166867572370122, "mean_env_wait_ms": 0.055270357798929436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002815723419189453, "StateBufferConnector_ms": 0.0027513504028320312, "ViewRequirementAgentConnector_ms": 0.05720376968383789}, "num_agent_steps_sampled_this_iter": 424, "num_env_steps_sampled_this_iter": 424, "timesteps_this_iter": 424, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.252635955810547, "min_q": -4.161803245544434, "max_q": 42.50035095214844, "mean_td_error": 0.25926417112350464}, "td_error": [-0.18709754943847656, -4.043082237243652, 2.1118667125701904, 4.224203109741211, -5.316947937011719, -2.1671571731567383, 0.5968818664550781, 0.19704055786132812, 5.841757774353027, 6.666202545166016, 4.677499771118164, 1.1045455932617188, -6.810178756713867, 5.350580215454102, -0.5308074951171875, -0.9715728759765625, 3.2224788665771484, -5.161803245544434, -0.04850006103515625, 2.500335693359375, 7.19911003112793, -0.3541679382324219, 3.4755477905273438, -0.1755523681640625, -7.110561370849609, -1.3691816329956055, -9.698436737060547, -4.076641082763672, 8.519306182861328, -2.4483957290649414, 1.135589599609375, 1.9435906410217285], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5750, "diff_num_grad_updates_vs_sampler_policy": 5749}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "last_target_update_ts": 46872, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 42.82, "episode_len_mean": 42.82, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0], "episode_lengths": [77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5553362305969876, "mean_inference_ms": 1.757919783231626, "mean_action_processing_ms": 0.18203711721754345, "mean_env_wait_ms": 0.10166287536259827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009120941162109375, "StateBufferConnector_ms": 0.006086826324462891, "ViewRequirementAgentConnector_ms": 0.13917827606201172}}, "episode_reward_max": 77.0, "episode_reward_min": 23.0, "episode_reward_mean": 42.82, "episode_len_mean": 42.82, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [77.0, 35.0, 49.0, 35.0, 51.0, 52.0, 42.0, 27.0, 49.0, 51.0, 39.0, 35.0, 35.0, 30.0, 38.0, 50.0, 43.0, 50.0, 33.0, 49.0, 38.0, 45.0, 37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0], "episode_lengths": [77, 35, 49, 35, 51, 52, 42, 27, 49, 51, 39, 35, 35, 30, 38, 50, 43, 50, 33, 49, 38, 45, 37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5553362305969876, "mean_inference_ms": 1.757919783231626, "mean_action_processing_ms": 0.18203711721754345, "mean_env_wait_ms": 0.10166287536259827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009120941162109375, "StateBufferConnector_ms": 0.006086826324462891, "ViewRequirementAgentConnector_ms": 0.13917827606201172}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.92337859079953, "num_env_steps_trained_throughput_per_sec": 1271.6935143631981, "timesteps_total": 47000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 25.04, "sample_time_ms": 9.313, "learn_time_ms": 2.75, "learn_throughput": 11637.207, "synch_weights_time_ms": 4.161}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 184000, "last_target_update_ts": 46872, "num_target_updates": 92}, "done": false, "episodes_total": 1264, "training_iteration": 47, "trial_id": "default", "date": "2024-10-05_21-56-29", "timestamp": 1728158189, "time_this_iter_s": 3.4680051803588867, "time_total_s": 171.79858231544495, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 171.79858231544495, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.22, "ram_util_percent": 87.38000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 28.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 30.0, 28.0, 47.0, 62.0, 46.0, 35.0, 45.0, 37.0, 55.0], "episode_lengths": [45, 30, 28, 47, 62, 46, 35, 45, 37, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3433551040955775, "mean_inference_ms": 1.0260001519801085, "mean_action_processing_ms": 0.11663141440027532, "mean_env_wait_ms": 0.05523407500436681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06350994110107422}}, "episode_reward_max": 62.0, "episode_reward_min": 28.0, "episode_reward_mean": 43.0, "episode_len_mean": 43.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 30.0, 28.0, 47.0, 62.0, 46.0, 35.0, 45.0, 37.0, 55.0], "episode_lengths": [45, 30, 28, 47, 62, 46, 35, 45, 37, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3433551040955775, "mean_inference_ms": 1.0260001519801085, "mean_action_processing_ms": 0.11663141440027532, "mean_env_wait_ms": 0.05523407500436681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06350994110107422}, "num_agent_steps_sampled_this_iter": 430, "num_env_steps_sampled_this_iter": 430, "timesteps_this_iter": 430, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 22.98917007446289, "min_q": -2.3401148319244385, "max_q": 37.337547302246094, "mean_td_error": -1.0174274444580078}, "td_error": [3.688112258911133, -4.217108726501465, -0.15007400512695312, -2.485323905944824, -3.6549205780029297, -3.6622886657714844, -1.9763259887695312, -2.1010875701904297, -2.7752017974853516, -3.3401148319244385, -3.2144784927368164, -6.280303955078125, -5.3143768310546875, 8.322150230407715, 4.702340126037598, -0.6632003784179688, -11.183822631835938, -4.452426910400391, -2.1259803771972656, -3.205280303955078, -7.752450942993164, 2.105518341064453, 8.25566577911377, 7.555663108825684, -5.014963150024414, 4.962646484375, 2.971010208129883, 0.29071044921875, -2.1648330688476562, -3.965444564819336, 6.820285797119141, -2.5317764282226562], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 5875, "diff_num_grad_updates_vs_sampler_policy": 5874}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "last_target_update_ts": 47880, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.55, "episode_len_mean": 42.55, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0], "episode_lengths": [37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5529276377910386, "mean_inference_ms": 1.7552407895693876, "mean_action_processing_ms": 0.18180917931959426, "mean_env_wait_ms": 0.10150726468100213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008655548095703125, "StateBufferConnector_ms": 0.005589485168457031, "ViewRequirementAgentConnector_ms": 0.1283278465270996}}, "episode_reward_max": 72.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.55, "episode_len_mean": 42.55, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 50.0, 43.0, 33.0, 45.0, 46.0, 35.0, 44.0, 40.0, 50.0, 49.0, 38.0, 42.0, 28.0, 47.0, 57.0, 34.0, 35.0, 34.0, 39.0, 38.0, 35.0, 44.0, 68.0, 45.0, 72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0], "episode_lengths": [37, 50, 43, 33, 45, 46, 35, 44, 40, 50, 49, 38, 42, 28, 47, 57, 34, 35, 34, 39, 38, 35, 44, 68, 45, 72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5529276377910386, "mean_inference_ms": 1.7552407895693876, "mean_action_processing_ms": 0.18180917931959426, "mean_env_wait_ms": 0.10150726468100213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008655548095703125, "StateBufferConnector_ms": 0.005589485168457031, "ViewRequirementAgentConnector_ms": 0.1283278465270996}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.53592789280947, "num_env_steps_trained_throughput_per_sec": 1278.1437115712379, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 25.094, "sample_time_ms": 8.988, "learn_time_ms": 2.838, "learn_throughput": 11273.969, "synch_weights_time_ms": 4.146}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 188000, "last_target_update_ts": 47880, "num_target_updates": 94}, "done": false, "episodes_total": 1286, "training_iteration": 48, "trial_id": "default", "date": "2024-10-05_21-56-33", "timestamp": 1728158193, "time_this_iter_s": 3.459293842315674, "time_total_s": 175.25787615776062, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 175.25787615776062, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.31999999999999, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 25.0, "episode_reward_mean": 41.0, "episode_len_mean": 41.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 36.0, 38.0, 50.0, 39.0, 56.0, 25.0, 41.0, 42.0, 33.0], "episode_lengths": [50, 36, 38, 50, 39, 56, 25, 41, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34266797814870475, "mean_inference_ms": 1.0238856281858868, "mean_action_processing_ms": 0.11642154284526103, "mean_env_wait_ms": 0.05511809327397092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002548694610595703, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.056879520416259766}}, "episode_reward_max": 56.0, "episode_reward_min": 25.0, "episode_reward_mean": 41.0, "episode_len_mean": 41.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 36.0, 38.0, 50.0, 39.0, 56.0, 25.0, 41.0, 42.0, 33.0], "episode_lengths": [50, 36, 38, 50, 39, 56, 25, 41, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34266797814870475, "mean_inference_ms": 1.0238856281858868, "mean_action_processing_ms": 0.11642154284526103, "mean_env_wait_ms": 0.05511809327397092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002548694610595703, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.056879520416259766}, "num_agent_steps_sampled_this_iter": 410, "num_env_steps_sampled_this_iter": 410, "timesteps_this_iter": 410, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.304996490478516, "min_q": -1.8323655128479004, "max_q": 41.39137268066406, "mean_td_error": 2.776218891143799}, "td_error": [1.1582796573638916, -7.293149948120117, -8.895000457763672, -2.2709426879882812, 6.391534805297852, 6.482217788696289, -1.711578369140625, 2.0990142822265625, 2.2671470642089844, 0.81488037109375, 6.776487350463867, 10.979267120361328, 2.710683822631836, 8.615119934082031, 6.520567893981934, -4.556949615478516, 4.5314483642578125, 5.082433700561523, 0.9450836181640625, 4.118324279785156, 6.851015090942383, -1.6263198852539062, 2.4930152893066406, 1.613844871520996, -3.3775100708007812, 5.154256820678711, 9.097475051879883, -2.978604316711426, 2.38955020904541, 9.501398086547852, 6.6558637619018555, 8.300155639648438], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6000, "diff_num_grad_updates_vs_sampler_policy": 5999}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "last_target_update_ts": 48888, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.41, "episode_len_mean": 42.41, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0], "episode_lengths": [72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.550535970069508, "mean_inference_ms": 1.7519163018802117, "mean_action_processing_ms": 0.18150262224750732, "mean_env_wait_ms": 0.10135011882096727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008344411849975586, "StateBufferConnector_ms": 0.0054891109466552734, "ViewRequirementAgentConnector_ms": 0.12635588645935059}}, "episode_reward_max": 72.0, "episode_reward_min": 15.0, "episode_reward_mean": 42.41, "episode_len_mean": 42.41, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.0, 32.0, 48.0, 38.0, 35.0, 35.0, 39.0, 35.0, 29.0, 38.0, 23.0, 61.0, 36.0, 48.0, 58.0, 45.0, 30.0, 41.0, 44.0, 55.0, 32.0, 46.0, 39.0, 40.0, 57.0, 52.0, 33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0], "episode_lengths": [72, 32, 48, 38, 35, 35, 39, 35, 29, 38, 23, 61, 36, 48, 58, 45, 30, 41, 44, 55, 32, 46, 39, 40, 57, 52, 33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.550535970069508, "mean_inference_ms": 1.7519163018802117, "mean_action_processing_ms": 0.18150262224750732, "mean_env_wait_ms": 0.10135011882096727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008344411849975586, "StateBufferConnector_ms": 0.0054891109466552734, "ViewRequirementAgentConnector_ms": 0.12635588645935059}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.12750102413094, "num_env_steps_trained_throughput_per_sec": 1272.5100040965237, "timesteps_total": 49000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 24.758, "sample_time_ms": 9.132, "learn_time_ms": 2.691, "learn_throughput": 11890.513, "synch_weights_time_ms": 4.163}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 192000, "last_target_update_ts": 48888, "num_target_updates": 96}, "done": false, "episodes_total": 1311, "training_iteration": 49, "trial_id": "default", "date": "2024-10-05_21-56-36", "timestamp": 1728158196, "time_this_iter_s": 3.4345319271087646, "time_total_s": 178.69240808486938, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 178.69240808486938, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 35.82000000000001, "ram_util_percent": 87.26}}
{"evaluation": {"sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": 31.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 36.0, 37.0, 43.0, 39.0, 34.0, 43.0, 49.0, 31.0, 43.0], "episode_lengths": [42, 36, 37, 43, 39, 34, 43, 49, 31, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34212004817544056, "mean_inference_ms": 1.022348221291173, "mean_action_processing_ms": 0.11623233988665153, "mean_env_wait_ms": 0.05502876040851602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.00301361083984375, "ViewRequirementAgentConnector_ms": 0.057718753814697266}}, "episode_reward_max": 49.0, "episode_reward_min": 31.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 36.0, 37.0, 43.0, 39.0, 34.0, 43.0, 49.0, 31.0, 43.0], "episode_lengths": [42, 36, 37, 43, 39, 34, 43, 49, 31, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34212004817544056, "mean_inference_ms": 1.022348221291173, "mean_action_processing_ms": 0.11623233988665153, "mean_env_wait_ms": 0.05502876040851602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.00301361083984375, "ViewRequirementAgentConnector_ms": 0.057718753814697266}, "num_agent_steps_sampled_this_iter": 397, "num_env_steps_sampled_this_iter": 397, "timesteps_this_iter": 397, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.79876708984375, "min_q": 9.369955062866211, "max_q": 40.490447998046875, "mean_td_error": 0.02799960970878601}, "td_error": [6.305408477783203, 3.6432952880859375, 2.6621246337890625, -3.020221710205078, -7.11952018737793, 6.129474639892578, 7.65092658996582, -0.7419052124023438, -3.0939693450927734, 5.328498840332031, 0.3043346405029297, -5.026348114013672, 2.3711204528808594, 0.7559318542480469, -3.026641845703125, 3.8273773193359375, -3.928546905517578, -5.187055587768555, -6.179573059082031, -0.17576217651367188, -1.9997406005859375, 1.1007080078125, -5.981147766113281, -4.8070526123046875, 3.1233043670654297, -1.3551979064941406, 4.6953887939453125, -0.9296684265136719, -1.5610980987548828, 3.5222129821777344, -0.4568643569946289, 4.066194534301758], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6125, "diff_num_grad_updates_vs_sampler_policy": 6124}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "last_target_update_ts": 49896, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": 70.0, "episode_reward_min": 15.0, "episode_reward_mean": 41.77, "episode_len_mean": 41.77, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0], "episode_lengths": [33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5487202763383336, "mean_inference_ms": 1.7494376085969043, "mean_action_processing_ms": 0.18134371871767374, "mean_env_wait_ms": 0.1012538207619365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00818943977355957, "StateBufferConnector_ms": 0.005444049835205078, "ViewRequirementAgentConnector_ms": 0.1262984275817871}}, "episode_reward_max": 70.0, "episode_reward_min": 15.0, "episode_reward_mean": 41.77, "episode_len_mean": 41.77, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 36.0, 47.0, 46.0, 70.0, 47.0, 44.0, 61.0, 62.0, 34.0, 36.0, 33.0, 59.0, 25.0, 39.0, 49.0, 40.0, 30.0, 40.0, 37.0, 41.0, 48.0, 37.0, 38.0, 40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0], "episode_lengths": [33, 36, 47, 46, 70, 47, 44, 61, 62, 34, 36, 33, 59, 25, 39, 49, 40, 30, 40, 37, 41, 48, 37, 38, 40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5487202763383336, "mean_inference_ms": 1.7494376085969043, "mean_action_processing_ms": 0.18134371871767374, "mean_env_wait_ms": 0.1012538207619365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00818943977355957, "StateBufferConnector_ms": 0.005444049835205078, "ViewRequirementAgentConnector_ms": 0.1262984275817871}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.3934614068696, "num_env_steps_trained_throughput_per_sec": 1277.5738456274785, "timesteps_total": 50000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 24.717, "sample_time_ms": 9.073, "learn_time_ms": 2.868, "learn_throughput": 11158.495, "synch_weights_time_ms": 4.095}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 196000, "last_target_update_ts": 49896, "num_target_updates": 98}, "done": false, "episodes_total": 1337, "training_iteration": 50, "trial_id": "default", "date": "2024-10-05_21-56-40", "timestamp": 1728158200, "time_this_iter_s": 3.4187605381011963, "time_total_s": 182.11116862297058, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 182.11116862297058, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.44, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": 36.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 49.0, 36.0, 38.0, 39.0, 39.0, 45.0, 37.0, 37.0, 38.0], "episode_lengths": [39, 49, 36, 38, 39, 39, 45, 37, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.341516033822897, "mean_inference_ms": 1.0207884331743708, "mean_action_processing_ms": 0.11607191284848158, "mean_env_wait_ms": 0.05494164061732496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0023651123046875, "ViewRequirementAgentConnector_ms": 0.056586265563964844}}, "episode_reward_max": 49.0, "episode_reward_min": 36.0, "episode_reward_mean": 39.7, "episode_len_mean": 39.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 49.0, 36.0, 38.0, 39.0, 39.0, 45.0, 37.0, 37.0, 38.0], "episode_lengths": [39, 49, 36, 38, 39, 39, 45, 37, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.341516033822897, "mean_inference_ms": 1.0207884331743708, "mean_action_processing_ms": 0.11607191284848158, "mean_env_wait_ms": 0.05494164061732496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0023651123046875, "ViewRequirementAgentConnector_ms": 0.056586265563964844}, "num_agent_steps_sampled_this_iter": 397, "num_env_steps_sampled_this_iter": 397, "timesteps_this_iter": 397, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 23.589176177978516, "min_q": -11.001850128173828, "max_q": 42.04145050048828, "mean_td_error": -0.2526969909667969}, "td_error": [-3.5263843536376953, 0.9091320037841797, -3.261837959289551, 1.1602935791015625, -8.712326049804688, -2.746793746948242, 0.19393157958984375, 5.111656188964844, -5.47733211517334, -3.2338390350341797, -2.693004608154297, -3.3619532585144043, 10.477287292480469, -3.0847396850585938, 1.8835678100585938, 4.398138046264648, 0.16077423095703125, -1.043060302734375, 3.0206756591796875, -12.001850128173828, 0.897125244140625, -1.7729072570800781, 1.2860450744628906, 5.35423469543457, 1.4193897247314453, 2.545866012573242, 4.455499172210693, -0.7036590576171875, -1.8264694213867188, -0.7519073486328125, -1.3564529418945312, 4.194597244262695], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6250, "diff_num_grad_updates_vs_sampler_policy": 6249}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "last_target_update_ts": 50904, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": 60.0, "episode_reward_min": 15.0, "episode_reward_mean": 41.28, "episode_len_mean": 41.28, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0], "episode_lengths": [40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5466908437530003, "mean_inference_ms": 1.7471705970446567, "mean_action_processing_ms": 0.18106175071032357, "mean_env_wait_ms": 0.10116305124681507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008133888244628906, "StateBufferConnector_ms": 0.005539655685424805, "ViewRequirementAgentConnector_ms": 0.1266794204711914}}, "episode_reward_max": 60.0, "episode_reward_min": 15.0, "episode_reward_mean": 41.28, "episode_len_mean": 41.28, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.0, 46.0, 47.0, 50.0, 49.0, 59.0, 50.0, 40.0, 54.0, 51.0, 28.0, 47.0, 27.0, 28.0, 47.0, 40.0, 34.0, 40.0, 50.0, 15.0, 43.0, 55.0, 43.0, 48.0, 28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0], "episode_lengths": [40, 46, 47, 50, 49, 59, 50, 40, 54, 51, 28, 47, 27, 28, 47, 40, 34, 40, 50, 15, 43, 55, 43, 48, 28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5466908437530003, "mean_inference_ms": 1.7471705970446567, "mean_action_processing_ms": 0.18106175071032357, "mean_env_wait_ms": 0.10116305124681507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008133888244628906, "StateBufferConnector_ms": 0.005539655685424805, "ViewRequirementAgentConnector_ms": 0.1266794204711914}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.1131482459441, "num_env_steps_trained_throughput_per_sec": 1264.4525929837764, "timesteps_total": 51000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 25.052, "sample_time_ms": 8.971, "learn_time_ms": 2.784, "learn_throughput": 11495.574, "synch_weights_time_ms": 4.318}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 200000, "last_target_update_ts": 50904, "num_target_updates": 100}, "done": false, "episodes_total": 1361, "training_iteration": 51, "trial_id": "default", "date": "2024-10-05_21-56-43", "timestamp": 1728158203, "time_this_iter_s": 3.4581215381622314, "time_total_s": 185.5692901611328, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 185.5692901611328, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.88, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 27.0, "episode_reward_mean": 42.3, "episode_len_mean": 42.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 40.0, 27.0, 56.0, 53.0, 37.0, 40.0, 46.0, 34.0, 52.0], "episode_lengths": [38, 40, 27, 56, 53, 37, 40, 46, 34, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3412104784335823, "mean_inference_ms": 1.0197226771363481, "mean_action_processing_ms": 0.11596918271762617, "mean_env_wait_ms": 0.05489087774632149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06678342819213867}}, "episode_reward_max": 56.0, "episode_reward_min": 27.0, "episode_reward_mean": 42.3, "episode_len_mean": 42.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 40.0, 27.0, 56.0, 53.0, 37.0, 40.0, 46.0, 34.0, 52.0], "episode_lengths": [38, 40, 27, 56, 53, 37, 40, 46, 34, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3412104784335823, "mean_inference_ms": 1.0197226771363481, "mean_action_processing_ms": 0.11596918271762617, "mean_env_wait_ms": 0.05489087774632149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06678342819213867}, "num_agent_steps_sampled_this_iter": 423, "num_env_steps_sampled_this_iter": 423, "timesteps_this_iter": 423, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.222496032714844, "min_q": 3.9214460849761963, "max_q": 42.27125549316406, "mean_td_error": 1.1086859703063965}, "td_error": [-2.427173614501953, -0.5661697387695312, 2.6439313888549805, 0.08428096771240234, 0.6063804626464844, 0.304290771484375, 3.4417076110839844, 6.706306457519531, 5.092235565185547, 0.9189872741699219, -4.561557769775391, -3.834024429321289, -1.2368011474609375, 5.97667121887207, 2.7894439697265625, -0.6611919403076172, 8.574481010437012, 2.1876983642578125, 5.307699203491211, -1.4807014465332031, -0.6806106567382812, -3.768291473388672, -1.4843711853027344, 8.267114639282227, -2.7370262145996094, 3.4926490783691406, 4.439894676208496, 5.283848762512207, -1.6753501892089844, -4.313282012939453, -0.029842376708984375, -1.1832771301269531], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6375, "diff_num_grad_updates_vs_sampler_policy": 6374}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "last_target_update_ts": 51912, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": 23.0, "episode_reward_mean": 40.95, "episode_len_mean": 40.95, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0], "episode_lengths": [28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.54751815755102, "mean_inference_ms": 1.7477545144927698, "mean_action_processing_ms": 0.18127866461160175, "mean_env_wait_ms": 0.10130468453807434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008085250854492188, "StateBufferConnector_ms": 0.00568699836730957, "ViewRequirementAgentConnector_ms": 0.12767815589904785}}, "episode_reward_max": 64.0, "episode_reward_min": 23.0, "episode_reward_mean": 40.95, "episode_len_mean": 40.95, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.0, 31.0, 43.0, 55.0, 48.0, 37.0, 35.0, 38.0, 29.0, 43.0, 47.0, 37.0, 60.0, 54.0, 42.0, 49.0, 26.0, 40.0, 52.0, 52.0, 50.0, 42.0, 39.0, 25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0], "episode_lengths": [28, 31, 43, 55, 48, 37, 35, 38, 29, 43, 47, 37, 60, 54, 42, 49, 26, 40, 52, 52, 50, 42, 39, 25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.54751815755102, "mean_inference_ms": 1.7477545144927698, "mean_action_processing_ms": 0.18127866461160175, "mean_env_wait_ms": 0.10130468453807434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008085250854492188, "StateBufferConnector_ms": 0.00568699836730957, "ViewRequirementAgentConnector_ms": 0.12767815589904785}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.47486213225335, "num_env_steps_trained_throughput_per_sec": 1253.8994485290134, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 25.037, "sample_time_ms": 9.083, "learn_time_ms": 2.801, "learn_throughput": 11425.216, "synch_weights_time_ms": 4.132}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 204000, "last_target_update_ts": 51912, "num_target_updates": 102}, "done": false, "episodes_total": 1385, "training_iteration": 52, "trial_id": "default", "date": "2024-10-05_21-56-47", "timestamp": 1728158207, "time_this_iter_s": 3.510730743408203, "time_total_s": 189.08002090454102, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 189.08002090454102, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 38.4, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": 26.0, "episode_reward_mean": 37.4, "episode_len_mean": 37.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 43.0, 38.0, 41.0, 35.0, 27.0, 46.0, 26.0, 34.0, 47.0], "episode_lengths": [37, 43, 38, 41, 35, 27, 46, 26, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34060198400400177, "mean_inference_ms": 1.0184692751809101, "mean_action_processing_ms": 0.11582423759926705, "mean_env_wait_ms": 0.05482504366900309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.002529621124267578, "ViewRequirementAgentConnector_ms": 0.0576329231262207}}, "episode_reward_max": 47.0, "episode_reward_min": 26.0, "episode_reward_mean": 37.4, "episode_len_mean": 37.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 43.0, 38.0, 41.0, 35.0, 27.0, 46.0, 26.0, 34.0, 47.0], "episode_lengths": [37, 43, 38, 41, 35, 27, 46, 26, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34060198400400177, "mean_inference_ms": 1.0184692751809101, "mean_action_processing_ms": 0.11582423759926705, "mean_env_wait_ms": 0.05482504366900309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.002529621124267578, "ViewRequirementAgentConnector_ms": 0.0576329231262207}, "num_agent_steps_sampled_this_iter": 374, "num_env_steps_sampled_this_iter": 374, "timesteps_this_iter": 374, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.092918395996094, "min_q": 0.10194158554077148, "max_q": 42.414215087890625, "mean_td_error": 1.599866271018982}, "td_error": [-2.4023361206054688, 6.409454345703125, 3.8757858276367188, 11.62252426147461, 5.920162200927734, 0.5918935537338257, 5.8497161865234375, -2.15435791015625, 0.7658843994140625, -0.14054107666015625, -0.1794605255126953, 4.391288757324219, -0.8645877838134766, 1.6059722900390625, 0.059581756591796875, 7.6137237548828125, 3.573719024658203, -5.031116485595703, -5.898712158203125, -1.8169364929199219, -4.121858596801758, -0.20832324028015137, 12.233283042907715, -0.23048019409179688, 3.164663314819336, -0.6252326965332031, 3.1785659790039062, 4.766010761260986, -4.0638017654418945, 4.425647735595703, -1.209808349609375, 0.09539604187011719], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6500, "diff_num_grad_updates_vs_sampler_policy": 6499}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "last_target_update_ts": 52920, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.76, "episode_len_mean": 40.76, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0], "episode_lengths": [25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5440012683332467, "mean_inference_ms": 1.7437749638574405, "mean_action_processing_ms": 0.18074587809276277, "mean_env_wait_ms": 0.10103209290965694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008120059967041016, "StateBufferConnector_ms": 0.005675792694091797, "ViewRequirementAgentConnector_ms": 0.12714433670043945}}, "episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.76, "episode_len_mean": 40.76, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, 38.0, 30.0, 31.0, 42.0, 45.0, 35.0, 24.0, 40.0, 51.0, 39.0, 40.0, 41.0, 43.0, 50.0, 52.0, 40.0, 26.0, 47.0, 26.0, 41.0, 27.0, 38.0, 32.0, 46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0], "episode_lengths": [25, 38, 30, 31, 42, 45, 35, 24, 40, 51, 39, 40, 41, 43, 50, 52, 40, 26, 47, 26, 41, 27, 38, 32, 46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5440012683332467, "mean_inference_ms": 1.7437749638574405, "mean_action_processing_ms": 0.18074587809276277, "mean_env_wait_ms": 0.10103209290965694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008120059967041016, "StateBufferConnector_ms": 0.005675792694091797, "ViewRequirementAgentConnector_ms": 0.12714433670043945}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.60534298086856, "num_env_steps_trained_throughput_per_sec": 1266.4213719234742, "timesteps_total": 53000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 24.965, "sample_time_ms": 9.162, "learn_time_ms": 2.834, "learn_throughput": 11293.416, "synch_weights_time_ms": 4.126}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 208000, "last_target_update_ts": 52920, "num_target_updates": 104}, "done": false, "episodes_total": 1408, "training_iteration": 53, "trial_id": "default", "date": "2024-10-05_21-56-50", "timestamp": 1728158210, "time_this_iter_s": 3.458275556564331, "time_total_s": 192.53829646110535, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 192.53829646110535, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 35.839999999999996, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 56.0, "episode_reward_min": 34.0, "episode_reward_mean": 43.1, "episode_len_mean": 43.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 45.0, 46.0, 38.0, 39.0, 46.0, 40.0, 34.0, 45.0, 42.0], "episode_lengths": [56, 45, 46, 38, 39, 46, 40, 34, 45, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403246761016656, "mean_inference_ms": 1.0503182121388228, "mean_action_processing_ms": 0.11569838773634425, "mean_env_wait_ms": 0.054757748154235376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030946731567382812, "StateBufferConnector_ms": 0.002238750457763672, "ViewRequirementAgentConnector_ms": 0.05926370620727539}}, "episode_reward_max": 56.0, "episode_reward_min": 34.0, "episode_reward_mean": 43.1, "episode_len_mean": 43.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 45.0, 46.0, 38.0, 39.0, 46.0, 40.0, 34.0, 45.0, 42.0], "episode_lengths": [56, 45, 46, 38, 39, 46, 40, 34, 45, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403246761016656, "mean_inference_ms": 1.0503182121388228, "mean_action_processing_ms": 0.11569838773634425, "mean_env_wait_ms": 0.054757748154235376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030946731567382812, "StateBufferConnector_ms": 0.002238750457763672, "ViewRequirementAgentConnector_ms": 0.05926370620727539}, "num_agent_steps_sampled_this_iter": 431, "num_env_steps_sampled_this_iter": 431, "timesteps_this_iter": 431, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 23.895137786865234, "min_q": 3.3423094749450684, "max_q": 40.016910552978516, "mean_td_error": 1.760581374168396}, "td_error": [-2.1999893188476562, 12.443891525268555, -3.66439151763916, 8.415487289428711, 4.320180892944336, 3.0052223205566406, 5.274859428405762, -3.865673065185547, 3.095775604248047, 3.4143543243408203, 7.473699569702148, -1.2446670532226562, 1.4193687438964844, 7.5544023513793945, 2.968029022216797, 8.756195068359375, 3.4903926849365234, 9.377867698669434, 0.4568347930908203, 1.1117801666259766, 1.5193023681640625, -6.59697151184082, 1.082406997680664, 3.202928304672241, -7.933757781982422, -4.9820709228515625, 3.886280059814453, -1.3480100631713867, -2.398468017578125, -5.910602569580078, -2.7411231994628906, 6.955068588256836], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6625, "diff_num_grad_updates_vs_sampler_policy": 6624}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "last_target_update_ts": 53928, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.26, "episode_len_mean": 42.26, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0], "episode_lengths": [46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.540317989864667, "mean_inference_ms": 1.742827440785647, "mean_action_processing_ms": 0.18008355108400217, "mean_env_wait_ms": 0.10070970064968453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008147001266479492, "StateBufferConnector_ms": 0.005713462829589844, "ViewRequirementAgentConnector_ms": 0.1268305778503418}}, "episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.26, "episode_len_mean": 42.26, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, 35.0, 59.0, 46.0, 48.0, 28.0, 29.0, 46.0, 29.0, 38.0, 47.0, 45.0, 52.0, 49.0, 43.0, 55.0, 39.0, 33.0, 36.0, 39.0, 51.0, 40.0, 38.0, 48.0, 43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0], "episode_lengths": [46, 35, 59, 46, 48, 28, 29, 46, 29, 38, 47, 45, 52, 49, 43, 55, 39, 33, 36, 39, 51, 40, 38, 48, 43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.540317989864667, "mean_inference_ms": 1.742827440785647, "mean_action_processing_ms": 0.18008355108400217, "mean_env_wait_ms": 0.10070970064968453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008147001266479492, "StateBufferConnector_ms": 0.005713462829589844, "ViewRequirementAgentConnector_ms": 0.1268305778503418}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.64096059677695, "num_env_steps_trained_throughput_per_sec": 1070.5638423871078, "timesteps_total": 54000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 44.15, "sample_time_ms": 27.348, "learn_time_ms": 2.767, "learn_throughput": 11565.808, "synch_weights_time_ms": 4.095}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 212000, "last_target_update_ts": 53928, "num_target_updates": 106}, "done": false, "episodes_total": 1432, "training_iteration": 54, "trial_id": "default", "date": "2024-10-05_21-56-55", "timestamp": 1728158215, "time_this_iter_s": 4.38898491859436, "time_total_s": 196.9272813796997, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 196.9272813796997, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 36.128571428571426, "ram_util_percent": 87.57142857142857}}
{"evaluation": {"sampler_results": {"episode_reward_max": 46.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.9, "episode_len_mean": 39.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 44.0, 29.0, 39.0, 34.0, 40.0, 41.0, 45.0, 46.0, 41.0], "episode_lengths": [40, 44, 29, 39, 34, 40, 41, 45, 46, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33977205670805477, "mean_inference_ms": 1.0482537177704114, "mean_action_processing_ms": 0.11552332493609865, "mean_env_wait_ms": 0.054676271800798606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029349327087402344, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.059838294982910156}}, "episode_reward_max": 46.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.9, "episode_len_mean": 39.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 44.0, 29.0, 39.0, 34.0, 40.0, 41.0, 45.0, 46.0, 41.0], "episode_lengths": [40, 44, 29, 39, 34, 40, 41, 45, 46, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33977205670805477, "mean_inference_ms": 1.0482537177704114, "mean_action_processing_ms": 0.11552332493609865, "mean_env_wait_ms": 0.054676271800798606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029349327087402344, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.059838294982910156}, "num_agent_steps_sampled_this_iter": 399, "num_env_steps_sampled_this_iter": 399, "timesteps_this_iter": 399, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.190868377685547, "min_q": 9.944348335266113, "max_q": 45.7755126953125, "mean_td_error": 0.03493452072143555}, "td_error": [4.345066070556641, 0.4995765686035156, 0.046871185302734375, -1.0749855041503906, 9.521261215209961, 3.0921669006347656, -1.6153850555419922, -2.449718475341797, -4.9422712326049805, -3.07635498046875, -3.934507369995117, 2.8710060119628906, -4.612770080566406, -0.7151985168457031, 3.1078033447265625, -3.7180213928222656, 9.988147735595703, -2.7085485458374023, -5.045001029968262, 3.3728103637695312, 6.219255447387695, -2.2615013122558594, 1.8156929016113281, -3.0310935974121094, -5.593791961669922, 4.067371368408203, -4.349557876586914, -0.17688369750976562, 8.805049896240234, -1.17474365234375, -3.3912811279296875, -2.7625579833984375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6750, "diff_num_grad_updates_vs_sampler_policy": 6749}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "last_target_update_ts": 54936, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.53, "episode_len_mean": 41.53, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0], "episode_lengths": [43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538680600574864, "mean_inference_ms": 1.7437064083990592, "mean_action_processing_ms": 0.1797598385578442, "mean_env_wait_ms": 0.10055653453576806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334875106811523, "StateBufferConnector_ms": 0.005620479583740234, "ViewRequirementAgentConnector_ms": 0.12657499313354492}}, "episode_reward_max": 80.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.53, "episode_len_mean": 41.53, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 46.0, 43.0, 27.0, 39.0, 43.0, 50.0, 34.0, 36.0, 26.0, 64.0, 54.0, 45.0, 38.0, 38.0, 57.0, 32.0, 50.0, 36.0, 55.0, 31.0, 38.0, 37.0, 27.0, 44.0, 51.0, 40.0, 23.0, 49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0], "episode_lengths": [43, 46, 43, 27, 39, 43, 50, 34, 36, 26, 64, 54, 45, 38, 38, 57, 32, 50, 36, 55, 31, 38, 37, 27, 44, 51, 40, 23, 49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538680600574864, "mean_inference_ms": 1.7437064083990592, "mean_action_processing_ms": 0.1797598385578442, "mean_env_wait_ms": 0.10055653453576806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334875106811523, "StateBufferConnector_ms": 0.005620479583740234, "ViewRequirementAgentConnector_ms": 0.12657499313354492}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.54011910022336, "num_env_steps_trained_throughput_per_sec": 1282.1604764008935, "timesteps_total": 55000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 27.287, "sample_time_ms": 9.327, "learn_time_ms": 2.742, "learn_throughput": 11668.57, "synch_weights_time_ms": 4.341}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 216000, "last_target_update_ts": 54936, "num_target_updates": 108}, "done": false, "episodes_total": 1456, "training_iteration": 55, "trial_id": "default", "date": "2024-10-05_21-56-58", "timestamp": 1728158218, "time_this_iter_s": 3.4254255294799805, "time_total_s": 200.3527069091797, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 200.3527069091797, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.45, "ram_util_percent": 87.35}}
{"evaluation": {"sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": 28.0, "episode_reward_mean": 40.3, "episode_len_mean": 40.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 38.0, 40.0, 28.0, 45.0, 31.0, 49.0, 31.0, 48.0, 47.0], "episode_lengths": [46, 38, 40, 28, 45, 31, 49, 31, 48, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3393035196332162, "mean_inference_ms": 1.0460533408940051, "mean_action_processing_ms": 0.1153769948797034, "mean_env_wait_ms": 0.054603917401957344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.0022363662719726562, "ViewRequirementAgentConnector_ms": 0.057926177978515625}}, "episode_reward_max": 49.0, "episode_reward_min": 28.0, "episode_reward_mean": 40.3, "episode_len_mean": 40.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 38.0, 40.0, 28.0, 45.0, 31.0, 49.0, 31.0, 48.0, 47.0], "episode_lengths": [46, 38, 40, 28, 45, 31, 49, 31, 48, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3393035196332162, "mean_inference_ms": 1.0460533408940051, "mean_action_processing_ms": 0.1153769948797034, "mean_env_wait_ms": 0.054603917401957344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028586387634277344, "StateBufferConnector_ms": 0.0022363662719726562, "ViewRequirementAgentConnector_ms": 0.057926177978515625}, "num_agent_steps_sampled_this_iter": 403, "num_env_steps_sampled_this_iter": 403, "timesteps_this_iter": 403, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.84588050842285, "min_q": -2.6293258666992188, "max_q": 45.70573425292969, "mean_td_error": 0.7780676484107971}, "td_error": [0.35581207275390625, 4.468788146972656, 4.701089382171631, 0.6717332601547241, -1.0391674041748047, -3.6293258666992188, 3.5078353881835938, 4.215312957763672, -0.9989309310913086, 5.881551742553711, -0.4840202331542969, -1.8452682495117188, 3.802806854248047, 4.350992202758789, 4.161434173583984, 2.7224292755126953, -3.9785423278808594, 0.03335094451904297, -0.4138984680175781, 2.3035926818847656, -1.981851577758789, -0.6891708374023438, 3.69476318359375, -3.487818717956543, -1.3006591796875, -0.1319122314453125, 7.128423690795898, -6.276020050048828, -8.997297286987305, -0.08816146850585938, 10.220743179321289, -1.9804534912109375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 6875, "diff_num_grad_updates_vs_sampler_policy": 6874}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "last_target_update_ts": 55944, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": 90.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.67, "episode_len_mean": 40.67, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0], "episode_lengths": [49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5381191747245253, "mean_inference_ms": 1.7468770770249582, "mean_action_processing_ms": 0.179789944228325, "mean_env_wait_ms": 0.10055058489773037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008394002914428711, "StateBufferConnector_ms": 0.005627155303955078, "ViewRequirementAgentConnector_ms": 0.12597370147705078}}, "episode_reward_max": 90.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.67, "episode_len_mean": 40.67, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 42.0, 46.0, 39.0, 33.0, 40.0, 45.0, 48.0, 40.0, 51.0, 80.0, 42.0, 40.0, 47.0, 26.0, 12.0, 44.0, 31.0, 38.0, 51.0, 38.0, 50.0, 30.0, 45.0, 64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0], "episode_lengths": [49, 42, 46, 39, 33, 40, 45, 48, 40, 51, 80, 42, 40, 47, 26, 12, 44, 31, 38, 51, 38, 50, 30, 45, 64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5381191747245253, "mean_inference_ms": 1.7468770770249582, "mean_action_processing_ms": 0.179789944228325, "mean_env_wait_ms": 0.10055058489773037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008394002914428711, "StateBufferConnector_ms": 0.005627155303955078, "ViewRequirementAgentConnector_ms": 0.12597370147705078}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.5081342139129, "num_env_steps_trained_throughput_per_sec": 1254.0325368556516, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 27.041, "sample_time_ms": 9.412, "learn_time_ms": 2.826, "learn_throughput": 11324.479, "synch_weights_time_ms": 4.085}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 220000, "last_target_update_ts": 55944, "num_target_updates": 110}, "done": false, "episodes_total": 1484, "training_iteration": 56, "trial_id": "default", "date": "2024-10-05_21-57-01", "timestamp": 1728158221, "time_this_iter_s": 3.4852523803710938, "time_total_s": 203.83795928955078, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 203.83795928955078, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 36.14, "ram_util_percent": 87.28}}
{"evaluation": {"sampler_results": {"episode_reward_max": 68.0, "episode_reward_min": 36.0, "episode_reward_mean": 46.9, "episode_len_mean": 46.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.0, 48.0, 52.0, 68.0, 48.0, 38.0, 42.0, 36.0, 38.0, 36.0], "episode_lengths": [63, 48, 52, 68, 48, 38, 42, 36, 38, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33887559019497526, "mean_inference_ms": 1.044304832536032, "mean_action_processing_ms": 0.11521799228358412, "mean_env_wait_ms": 0.054534878144537405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028395652770996094, "StateBufferConnector_ms": 0.002200603485107422, "ViewRequirementAgentConnector_ms": 0.056688785552978516}}, "episode_reward_max": 68.0, "episode_reward_min": 36.0, "episode_reward_mean": 46.9, "episode_len_mean": 46.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.0, 48.0, 52.0, 68.0, 48.0, 38.0, 42.0, 36.0, 38.0, 36.0], "episode_lengths": [63, 48, 52, 68, 48, 38, 42, 36, 38, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33887559019497526, "mean_inference_ms": 1.044304832536032, "mean_action_processing_ms": 0.11521799228358412, "mean_env_wait_ms": 0.054534878144537405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028395652770996094, "StateBufferConnector_ms": 0.002200603485107422, "ViewRequirementAgentConnector_ms": 0.056688785552978516}, "num_agent_steps_sampled_this_iter": 469, "num_env_steps_sampled_this_iter": 469, "timesteps_this_iter": 469, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.64356231689453, "min_q": -0.45998382568359375, "max_q": 42.75077438354492, "mean_td_error": 0.4751034677028656}, "td_error": [2.282073974609375, -3.48077392578125, -1.9118690490722656, 1.1002311706542969, -2.7493667602539062, -4.696208953857422, -0.3839530944824219, -5.814619064331055, -2.6360435485839844, 0.8089046478271484, -4.530246734619141, 1.8077163696289062, 2.145050048828125, -1.8043384552001953, -5.013460159301758, 0.40603065490722656, -1.4599838256835938, 3.3573837280273438, 4.725889205932617, 3.739501953125, 2.3225975036621094, -1.1975650787353516, -1.8240432739257812, 22.844053268432617, -4.816135406494141, 1.637533187866211, 0.4600715637207031, -4.187078475952148, 0.1533985137939453, 12.372918128967285, 7.1108598709106445, -5.565216064453125], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7000, "diff_num_grad_updates_vs_sampler_policy": 6999}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "last_target_update_ts": 56952, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": 90.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.39, "episode_len_mean": 40.39, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0], "episode_lengths": [64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538169914333293, "mean_inference_ms": 1.749428712111846, "mean_action_processing_ms": 0.17972267095821087, "mean_env_wait_ms": 0.10055035328198116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008382320404052734, "StateBufferConnector_ms": 0.0056836605072021484, "ViewRequirementAgentConnector_ms": 0.12708282470703125}}, "episode_reward_max": 90.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.39, "episode_len_mean": 40.39, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 40.0, 32.0, 40.0, 30.0, 42.0, 40.0, 56.0, 33.0, 74.0, 45.0, 57.0, 37.0, 52.0, 57.0, 28.0, 29.0, 33.0, 37.0, 45.0, 52.0, 48.0, 41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0], "episode_lengths": [64, 40, 32, 40, 30, 42, 40, 56, 33, 74, 45, 57, 37, 52, 57, 28, 29, 33, 37, 45, 52, 48, 41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538169914333293, "mean_inference_ms": 1.749428712111846, "mean_action_processing_ms": 0.17972267095821087, "mean_env_wait_ms": 0.10055035328198116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008382320404052734, "StateBufferConnector_ms": 0.0056836605072021484, "ViewRequirementAgentConnector_ms": 0.12708282470703125}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3093565216248, "num_env_steps_trained_throughput_per_sec": 1253.2374260864992, "timesteps_total": 57000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 28.425, "sample_time_ms": 9.283, "learn_time_ms": 3.107, "learn_throughput": 10299.958, "synch_weights_time_ms": 4.372}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 224000, "last_target_update_ts": 56952, "num_target_updates": 112}, "done": false, "episodes_total": 1508, "training_iteration": 57, "trial_id": "default", "date": "2024-10-05_21-57-05", "timestamp": 1728158225, "time_this_iter_s": 3.5274226665496826, "time_total_s": 207.36538195610046, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 207.36538195610046, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 34.51666666666667, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": 25.0, "episode_reward_mean": 39.3, "episode_len_mean": 39.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 41.0, 35.0, 42.0, 37.0, 25.0, 47.0, 40.0, 39.0, 47.0], "episode_lengths": [40, 41, 35, 42, 37, 25, 47, 40, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33847809849388927, "mean_inference_ms": 1.04270681846852, "mean_action_processing_ms": 0.11508964661977013, "mean_env_wait_ms": 0.05447805528403045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003044605255126953, "StateBufferConnector_ms": 0.0022339820861816406, "ViewRequirementAgentConnector_ms": 0.056302547454833984}}, "episode_reward_max": 47.0, "episode_reward_min": 25.0, "episode_reward_mean": 39.3, "episode_len_mean": 39.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 41.0, 35.0, 42.0, 37.0, 25.0, 47.0, 40.0, 39.0, 47.0], "episode_lengths": [40, 41, 35, 42, 37, 25, 47, 40, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33847809849388927, "mean_inference_ms": 1.04270681846852, "mean_action_processing_ms": 0.11508964661977013, "mean_env_wait_ms": 0.05447805528403045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003044605255126953, "StateBufferConnector_ms": 0.0022339820861816406, "ViewRequirementAgentConnector_ms": 0.056302547454833984}, "num_agent_steps_sampled_this_iter": 393, "num_env_steps_sampled_this_iter": 393, "timesteps_this_iter": 393, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.656238555908203, "min_q": -11.02834701538086, "max_q": 43.514434814453125, "mean_td_error": 0.5449041724205017}, "td_error": [17.82134246826172, 5.337586402893066, -4.02635383605957, 6.798007965087891, 5.528236389160156, 0.6512179374694824, -6.779045104980469, 0.3984870910644531, -6.594568252563477, -3.894948959350586, 0.8530426025390625, 8.432884216308594, -4.966339111328125, -12.02834701538086, 1.4425811767578125, 5.429012298583984, 6.35865592956543, -0.6399917602539062, 2.9514503479003906, 4.825502395629883, -1.4746246337890625, 4.326201438903809, -4.191646575927734, -2.6941380500793457, -0.7680740356445312, 6.212383270263672, -0.3961753845214844, -4.345846176147461, -2.882749557495117, -4.9622650146484375, 3.8467369079589844, -3.1312828063964844], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7125, "diff_num_grad_updates_vs_sampler_policy": 7124}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "last_target_update_ts": 57960, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": 90.0, "episode_reward_min": 11.0, "episode_reward_mean": 39.81, "episode_len_mean": 39.81, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0], "episode_lengths": [41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5359022473248165, "mean_inference_ms": 1.74643625048358, "mean_action_processing_ms": 0.1793158441613199, "mean_env_wait_ms": 0.1003844757656157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00851130485534668, "StateBufferConnector_ms": 0.0056610107421875, "ViewRequirementAgentConnector_ms": 0.12693142890930176}}, "episode_reward_max": 90.0, "episode_reward_min": 11.0, "episode_reward_mean": 39.81, "episode_len_mean": 39.81, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.0, 41.0, 52.0, 33.0, 56.0, 53.0, 31.0, 46.0, 24.0, 47.0, 56.0, 28.0, 29.0, 36.0, 31.0, 41.0, 37.0, 52.0, 44.0, 35.0, 28.0, 27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0], "episode_lengths": [41, 41, 52, 33, 56, 53, 31, 46, 24, 47, 56, 28, 29, 36, 31, 41, 37, 52, 44, 35, 28, 27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5359022473248165, "mean_inference_ms": 1.74643625048358, "mean_action_processing_ms": 0.1793158441613199, "mean_env_wait_ms": 0.1003844757656157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00851130485534668, "StateBufferConnector_ms": 0.0056610107421875, "ViewRequirementAgentConnector_ms": 0.12693142890930176}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.8278208029156, "num_env_steps_trained_throughput_per_sec": 1263.3112832116624, "timesteps_total": 58000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 26.509, "sample_time_ms": 9.031, "learn_time_ms": 2.752, "learn_throughput": 11627.63, "synch_weights_time_ms": 4.079}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 228000, "last_target_update_ts": 57960, "num_target_updates": 114}, "done": false, "episodes_total": 1530, "training_iteration": 58, "trial_id": "default", "date": "2024-10-05_21-57-08", "timestamp": 1728158228, "time_this_iter_s": 3.455131769180298, "time_total_s": 210.82051372528076, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 210.82051372528076, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.425, "ram_util_percent": 87.2}}
{"evaluation": {"sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": 25.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 65.0, 52.0, 53.0, 29.0, 40.0, 35.0, 25.0, 34.0, 35.0], "episode_lengths": [36, 65, 52, 53, 29, 40, 35, 25, 34, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33816308671164064, "mean_inference_ms": 1.0406525664652226, "mean_action_processing_ms": 0.1149594902878331, "mean_env_wait_ms": 0.05441401278399932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028085708618164062, "StateBufferConnector_ms": 0.0022363662719726562, "ViewRequirementAgentConnector_ms": 0.05596160888671875}}, "episode_reward_max": 65.0, "episode_reward_min": 25.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 65.0, 52.0, 53.0, 29.0, 40.0, 35.0, 25.0, 34.0, 35.0], "episode_lengths": [36, 65, 52, 53, 29, 40, 35, 25, 34, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33816308671164064, "mean_inference_ms": 1.0406525664652226, "mean_action_processing_ms": 0.1149594902878331, "mean_env_wait_ms": 0.05441401278399932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028085708618164062, "StateBufferConnector_ms": 0.0022363662719726562, "ViewRequirementAgentConnector_ms": 0.05596160888671875}, "num_agent_steps_sampled_this_iter": 404, "num_env_steps_sampled_this_iter": 404, "timesteps_this_iter": 404, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.1656494140625, "min_q": 5.462589263916016, "max_q": 40.54734420776367, "mean_td_error": -0.12371477484703064}, "td_error": [3.2436981201171875, -2.400951385498047, 6.697154998779297, 3.019327163696289, 1.8328666687011719, -8.141777038574219, -1.363546371459961, 1.1521568298339844, 1.4417476654052734, -0.9065017700195312, 6.103851318359375, -2.798330307006836, -6.415572166442871, 2.886812210083008, 2.339214324951172, 3.432750701904297, -1.0077629089355469, -9.041922569274902, 1.9552650451660156, 2.2168807983398438, -4.8763580322265625, -0.4236946105957031, 2.0534820556640625, -3.5471324920654297, 1.7795734405517578, 4.471240997314453, 0.7601661682128906, -0.3052330017089844, -1.7781047821044922, -7.884960174560547, 2.0295944213867188, -0.48280906677246094], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7250, "diff_num_grad_updates_vs_sampler_policy": 7249}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "last_target_update_ts": 58968, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": 90.0, "episode_reward_min": 11.0, "episode_reward_mean": 41.54, "episode_len_mean": 41.54, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0], "episode_lengths": [27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5325483435241924, "mean_inference_ms": 1.7421168643839056, "mean_action_processing_ms": 0.17869180968189877, "mean_env_wait_ms": 0.1000892391986007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008562326431274414, "StateBufferConnector_ms": 0.0057642459869384766, "ViewRequirementAgentConnector_ms": 0.127593994140625}}, "episode_reward_max": 90.0, "episode_reward_min": 11.0, "episode_reward_mean": 41.54, "episode_len_mean": 41.54, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, 36.0, 29.0, 61.0, 34.0, 46.0, 39.0, 39.0, 35.0, 13.0, 38.0, 39.0, 43.0, 45.0, 31.0, 41.0, 48.0, 40.0, 25.0, 29.0, 90.0, 29.0, 12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0], "episode_lengths": [27, 36, 29, 61, 34, 46, 39, 39, 35, 13, 38, 39, 43, 45, 31, 41, 48, 40, 25, 29, 90, 29, 12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5325483435241924, "mean_inference_ms": 1.7421168643839056, "mean_action_processing_ms": 0.17869180968189877, "mean_env_wait_ms": 0.1000892391986007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008562326431274414, "StateBufferConnector_ms": 0.0057642459869384766, "ViewRequirementAgentConnector_ms": 0.127593994140625}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5113602057838, "num_env_steps_trained_throughput_per_sec": 1258.045440823135, "timesteps_total": 59000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 26.795, "sample_time_ms": 9.072, "learn_time_ms": 2.762, "learn_throughput": 11587.776, "synch_weights_time_ms": 4.385}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 232000, "last_target_update_ts": 58968, "num_target_updates": 116}, "done": false, "episodes_total": 1551, "training_iteration": 59, "trial_id": "default", "date": "2024-10-05_21-57-12", "timestamp": 1728158232, "time_this_iter_s": 3.466022253036499, "time_total_s": 214.28653597831726, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 214.28653597831726, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.739999999999995, "ram_util_percent": 87.28}}
{"evaluation": {"sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": 33.0, "episode_reward_mean": 46.8, "episode_len_mean": 46.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 54.0, 45.0, 47.0, 55.0, 65.0, 36.0, 45.0, 33.0, 47.0], "episode_lengths": [41, 54, 45, 47, 55, 65, 36, 45, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33743290643215024, "mean_inference_ms": 1.0379715288687255, "mean_action_processing_ms": 0.11479805910331775, "mean_env_wait_ms": 0.054325973066840706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027990341186523438, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.05658149719238281}}, "episode_reward_max": 65.0, "episode_reward_min": 33.0, "episode_reward_mean": 46.8, "episode_len_mean": 46.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 54.0, 45.0, 47.0, 55.0, 65.0, 36.0, 45.0, 33.0, 47.0], "episode_lengths": [41, 54, 45, 47, 55, 65, 36, 45, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33743290643215024, "mean_inference_ms": 1.0379715288687255, "mean_action_processing_ms": 0.11479805910331775, "mean_env_wait_ms": 0.054325973066840706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027990341186523438, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.05658149719238281}, "num_agent_steps_sampled_this_iter": 468, "num_env_steps_sampled_this_iter": 468, "timesteps_this_iter": 468, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.173450469970703, "min_q": -1.210720419883728, "max_q": 42.64521026611328, "mean_td_error": 0.5047050714492798}, "td_error": [2.3899307250976562, 0.04089546203613281, 1.9063949584960938, -1.2810630798339844, -4.719764709472656, -0.765960693359375, 1.6782855987548828, 5.953601837158203, 8.325851440429688, -0.4288482666015625, -0.08400344848632812, -2.4087066650390625, 1.1491012573242188, 6.184741973876953, 3.890456199645996, -0.4096946716308594, -1.423379898071289, -0.8551292419433594, -1.1562080383300781, -2.9466552734375, -0.4952983856201172, 4.935333251953125, -6.072622299194336, 7.513740539550781, -7.773589134216309, -2.188505172729492, 0.37316155433654785, -2.363224983215332, -0.9369432926177979, 12.623096466064453, -4.745243072509766, 0.24081039428710938], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7375, "diff_num_grad_updates_vs_sampler_policy": 7374}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "last_target_update_ts": 59976, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": 83.0, "episode_reward_min": 11.0, "episode_reward_mean": 43.5, "episode_len_mean": 43.5, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0], "episode_lengths": [12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5295245206237218, "mean_inference_ms": 1.738787769418539, "mean_action_processing_ms": 0.17826467319373712, "mean_env_wait_ms": 0.0998762052952423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008423328399658203, "StateBufferConnector_ms": 0.005781650543212891, "ViewRequirementAgentConnector_ms": 0.12788963317871094}}, "episode_reward_max": 83.0, "episode_reward_min": 11.0, "episode_reward_mean": 43.5, "episode_len_mean": 43.5, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 29.0, 42.0, 39.0, 53.0, 41.0, 15.0, 36.0, 45.0, 43.0, 36.0, 51.0, 53.0, 37.0, 39.0, 37.0, 31.0, 25.0, 47.0, 49.0, 52.0, 39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0], "episode_lengths": [12, 29, 42, 39, 53, 41, 15, 36, 45, 43, 36, 51, 53, 37, 39, 37, 31, 25, 47, 49, 52, 39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5295245206237218, "mean_inference_ms": 1.738787769418539, "mean_action_processing_ms": 0.17826467319373712, "mean_env_wait_ms": 0.0998762052952423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008423328399658203, "StateBufferConnector_ms": 0.005781650543212891, "ViewRequirementAgentConnector_ms": 0.12788963317871094}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.95238299833784, "num_env_steps_trained_throughput_per_sec": 1255.8095319933514, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 27.919, "sample_time_ms": 9.388, "learn_time_ms": 2.967, "learn_throughput": 10784.352, "synch_weights_time_ms": 4.341}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 236000, "last_target_update_ts": 59976, "num_target_updates": 118}, "done": false, "episodes_total": 1573, "training_iteration": 60, "trial_id": "default", "date": "2024-10-05_21-57-15", "timestamp": 1728158235, "time_this_iter_s": 3.53263258934021, "time_total_s": 217.81916856765747, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 217.81916856765747, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.720000000000006, "ram_util_percent": 87.22}}
{"evaluation": {"sampler_results": {"episode_reward_max": 66.0, "episode_reward_min": 17.0, "episode_reward_mean": 43.9, "episode_len_mean": 43.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 35.0, 39.0, 17.0, 66.0, 47.0, 37.0, 47.0, 55.0, 40.0], "episode_lengths": [56, 35, 39, 17, 66, 47, 37, 47, 55, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33713606169014826, "mean_inference_ms": 1.036671829637962, "mean_action_processing_ms": 0.11466465574805225, "mean_env_wait_ms": 0.05427157035277534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028753280639648438, "StateBufferConnector_ms": 0.0022268295288085938, "ViewRequirementAgentConnector_ms": 0.06335973739624023}}, "episode_reward_max": 66.0, "episode_reward_min": 17.0, "episode_reward_mean": 43.9, "episode_len_mean": 43.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 35.0, 39.0, 17.0, 66.0, 47.0, 37.0, 47.0, 55.0, 40.0], "episode_lengths": [56, 35, 39, 17, 66, 47, 37, 47, 55, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33713606169014826, "mean_inference_ms": 1.036671829637962, "mean_action_processing_ms": 0.11466465574805225, "mean_env_wait_ms": 0.05427157035277534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028753280639648438, "StateBufferConnector_ms": 0.0022268295288085938, "ViewRequirementAgentConnector_ms": 0.06335973739624023}, "num_agent_steps_sampled_this_iter": 439, "num_env_steps_sampled_this_iter": 439, "timesteps_this_iter": 439, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.201066970825195, "min_q": 6.636549949645996, "max_q": 43.61778259277344, "mean_td_error": 1.847299575805664}, "td_error": [2.7616424560546875, -3.676544189453125, 4.233432769775391, -1.3193931579589844, 6.6898345947265625, 18.672557830810547, -0.605712890625, -0.5883407592773438, 1.5125846862792969, 5.146633148193359, -4.144491195678711, -6.2221221923828125, 0.055492401123046875, -1.8625288009643555, 0.9863882064819336, 7.924263000488281, 0.8852214813232422, -1.8673114776611328, 5.086827278137207, -0.5803031921386719, 0.9918212890625, 5.810370922088623, -5.094812393188477, 0.56915283203125, 0.7513046264648438, 3.097869873046875, 7.263063430786133, -2.597553253173828, 16.22101593017578, 0.4195060729980469, 1.7412223815917969, -3.1475048065185547], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7500, "diff_num_grad_updates_vs_sampler_policy": 7499}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "last_target_update_ts": 60984, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": 11.0, "episode_reward_mean": 45.5, "episode_len_mean": 45.5, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0], "episode_lengths": [39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5269511851657784, "mean_inference_ms": 1.7357186682024062, "mean_action_processing_ms": 0.1778959960838101, "mean_env_wait_ms": 0.09967714674902282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008416414260864258, "StateBufferConnector_ms": 0.005705118179321289, "ViewRequirementAgentConnector_ms": 0.12722349166870117}}, "episode_reward_max": 98.0, "episode_reward_min": 11.0, "episode_reward_mean": 45.5, "episode_len_mean": 45.5, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 32.0, 36.0, 52.0, 56.0, 51.0, 44.0, 45.0, 43.0, 33.0, 36.0, 40.0, 36.0, 15.0, 46.0, 39.0, 11.0, 37.0, 38.0, 48.0, 35.0, 45.0, 83.0, 38.0, 44.0, 24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0], "episode_lengths": [39, 32, 36, 52, 56, 51, 44, 45, 43, 33, 36, 40, 36, 15, 46, 39, 11, 37, 38, 48, 35, 45, 83, 38, 44, 24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5269511851657784, "mean_inference_ms": 1.7357186682024062, "mean_action_processing_ms": 0.1778959960838101, "mean_env_wait_ms": 0.09967714674902282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008416414260864258, "StateBufferConnector_ms": 0.005705118179321289, "ViewRequirementAgentConnector_ms": 0.12722349166870117}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.76119884798425, "num_env_steps_trained_throughput_per_sec": 1263.044795391937, "timesteps_total": 61000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 26.766, "sample_time_ms": 9.213, "learn_time_ms": 2.76, "learn_throughput": 11594.282, "synch_weights_time_ms": 4.031}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 240000, "last_target_update_ts": 60984, "num_target_updates": 120}, "done": false, "episodes_total": 1594, "training_iteration": 61, "trial_id": "default", "date": "2024-10-05_21-57-19", "timestamp": 1728158239, "time_this_iter_s": 3.4861364364624023, "time_total_s": 221.30530500411987, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 221.30530500411987, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 36.04, "ram_util_percent": 87.28}}
{"evaluation": {"sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": 30.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 51.0, 43.0, 46.0, 45.0, 34.0, 52.0, 30.0, 59.0], "episode_lengths": [44, 42, 51, 43, 46, 45, 34, 52, 30, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367001850773969, "mean_inference_ms": 1.0351106485356811, "mean_action_processing_ms": 0.11453705196931294, "mean_env_wait_ms": 0.05421527414497116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002963542938232422, "StateBufferConnector_ms": 0.002155303955078125, "ViewRequirementAgentConnector_ms": 0.056595802307128906}}, "episode_reward_max": 59.0, "episode_reward_min": 30.0, "episode_reward_mean": 44.6, "episode_len_mean": 44.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 51.0, 43.0, 46.0, 45.0, 34.0, 52.0, 30.0, 59.0], "episode_lengths": [44, 42, 51, 43, 46, 45, 34, 52, 30, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367001850773969, "mean_inference_ms": 1.0351106485356811, "mean_action_processing_ms": 0.11453705196931294, "mean_env_wait_ms": 0.05421527414497116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002963542938232422, "StateBufferConnector_ms": 0.002155303955078125, "ViewRequirementAgentConnector_ms": 0.056595802307128906}, "num_agent_steps_sampled_this_iter": 446, "num_env_steps_sampled_this_iter": 446, "timesteps_this_iter": 446, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.306636810302734, "min_q": 4.190831661224365, "max_q": 42.313533782958984, "mean_td_error": 1.1062324047088623}, "td_error": [8.808670997619629, 2.115053176879883, 4.070743083953857, -2.179962158203125, 8.206038475036621, -3.7687015533447266, 4.323505401611328, 2.7311248779296875, -3.5907821655273438, -2.478321075439453, 2.2589950561523438, 2.370267868041992, 1.6888465881347656, -0.6505165100097656, -1.4247665405273438, -0.19683074951171875, 4.1614837646484375, -3.3358192443847656, 4.243318557739258, 0.32697486877441406, -3.2231454849243164, 0.31558799743652344, -1.8408164978027344, 1.8239097595214844, -2.6599998474121094, -2.7820472717285156, 5.235282897949219, -4.724174499511719, -0.8475608825683594, 2.739612579345703, 8.261524200439453, 5.421939373016357], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7625, "diff_num_grad_updates_vs_sampler_policy": 7624}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "last_target_update_ts": 61992, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 44.7, "episode_len_mean": 44.7, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0], "episode_lengths": [24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526788001604308, "mean_inference_ms": 1.73498832750466, "mean_action_processing_ms": 0.17790222913984743, "mean_env_wait_ms": 0.09970277787072625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008327960968017578, "StateBufferConnector_ms": 0.005635499954223633, "ViewRequirementAgentConnector_ms": 0.1277477741241455}}, "episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 44.7, "episode_len_mean": 44.7, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.0, 50.0, 37.0, 40.0, 38.0, 43.0, 28.0, 40.0, 51.0, 50.0, 48.0, 37.0, 44.0, 42.0, 81.0, 42.0, 83.0, 47.0, 45.0, 66.0, 50.0, 26.0, 48.0, 46.0, 34.0, 41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0], "episode_lengths": [24, 50, 37, 40, 38, 43, 28, 40, 51, 50, 48, 37, 44, 42, 81, 42, 83, 47, 45, 66, 50, 26, 48, 46, 34, 41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526788001604308, "mean_inference_ms": 1.73498832750466, "mean_action_processing_ms": 0.17790222913984743, "mean_env_wait_ms": 0.09970277787072625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008327960968017578, "StateBufferConnector_ms": 0.005635499954223633, "ViewRequirementAgentConnector_ms": 0.1277477741241455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.64692280478545, "num_env_steps_trained_throughput_per_sec": 1262.5876912191418, "timesteps_total": 62000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 26.42, "sample_time_ms": 8.883, "learn_time_ms": 2.816, "learn_throughput": 11365.33, "synch_weights_time_ms": 4.084}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 244000, "last_target_update_ts": 61992, "num_target_updates": 122}, "done": false, "episodes_total": 1619, "training_iteration": 62, "trial_id": "default", "date": "2024-10-05_21-57-22", "timestamp": 1728158242, "time_this_iter_s": 3.4959025382995605, "time_total_s": 224.80120754241943, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 224.80120754241943, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.42, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 70.0, "episode_reward_min": 27.0, "episode_reward_mean": 38.9, "episode_len_mean": 38.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 70.0, 27.0, 32.0, 44.0, 36.0, 28.0, 30.0, 35.0, 55.0], "episode_lengths": [32, 70, 27, 32, 44, 36, 28, 30, 35, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367103846937221, "mean_inference_ms": 1.034023554110531, "mean_action_processing_ms": 0.11446487924782597, "mean_env_wait_ms": 0.05418155628253039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003147125244140625, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.05842924118041992}}, "episode_reward_max": 70.0, "episode_reward_min": 27.0, "episode_reward_mean": 38.9, "episode_len_mean": 38.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 70.0, 27.0, 32.0, 44.0, 36.0, 28.0, 30.0, 35.0, 55.0], "episode_lengths": [32, 70, 27, 32, 44, 36, 28, 30, 35, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367103846937221, "mean_inference_ms": 1.034023554110531, "mean_action_processing_ms": 0.11446487924782597, "mean_env_wait_ms": 0.05418155628253039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003147125244140625, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.05842924118041992}, "num_agent_steps_sampled_this_iter": 389, "num_env_steps_sampled_this_iter": 389, "timesteps_this_iter": 389, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.637981414794922, "min_q": 2.58201265335083, "max_q": 43.24732208251953, "mean_td_error": 1.4558407068252563}, "td_error": [2.7916297912597656, 7.578557968139648, -1.1587371826171875, 5.28924560546875, 1.1359138488769531, -3.4763264656066895, -3.261046886444092, -3.848115921020508, -6.835796356201172, -1.2230758666992188, 5.89840841293335, 3.2340359687805176, -0.03092193603515625, 0.9812431335449219, 26.05908203125, 2.7752456665039062, 1.0175743103027344, 8.288074493408203, -3.688182830810547, 5.974786758422852, -6.595346450805664, -1.8270606994628906, 5.423450469970703, 1.8404521942138672, 2.6441402435302734, 2.5472946166992188, -0.5805549621582031, -4.122020721435547, -2.237537384033203, -1.8771591186523438, 0.8262557983398438, 3.043394088745117], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7750, "diff_num_grad_updates_vs_sampler_policy": 7749}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "last_target_update_ts": 63000, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 43.57, "episode_len_mean": 43.57, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0], "episode_lengths": [41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5266105455584686, "mean_inference_ms": 1.7334756811569108, "mean_action_processing_ms": 0.17779358549263125, "mean_env_wait_ms": 0.0996701410033513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008202314376831055, "StateBufferConnector_ms": 0.005601644515991211, "ViewRequirementAgentConnector_ms": 0.1273341178894043}}, "episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 43.57, "episode_len_mean": 43.57, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.0, 40.0, 76.0, 58.0, 28.0, 45.0, 35.0, 40.0, 49.0, 47.0, 52.0, 53.0, 52.0, 52.0, 37.0, 63.0, 54.0, 65.0, 51.0, 49.0, 29.0, 53.0, 48.0, 56.0, 47.0, 34.0, 36.0, 38.0, 48.0, 46.0, 35.0, 75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0], "episode_lengths": [41, 40, 76, 58, 28, 45, 35, 40, 49, 47, 52, 53, 52, 52, 37, 63, 54, 65, 51, 49, 29, 53, 48, 56, 47, 34, 36, 38, 48, 46, 35, 75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5266105455584686, "mean_inference_ms": 1.7334756811569108, "mean_action_processing_ms": 0.17779358549263125, "mean_env_wait_ms": 0.0996701410033513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008202314376831055, "StateBufferConnector_ms": 0.005601644515991211, "ViewRequirementAgentConnector_ms": 0.1273341178894043}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.4809401173917, "num_env_steps_trained_throughput_per_sec": 1257.9237604695668, "timesteps_total": 63000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 28.526, "sample_time_ms": 9.559, "learn_time_ms": 2.982, "learn_throughput": 10730.551, "synch_weights_time_ms": 4.319}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 248000, "last_target_update_ts": 63000, "num_target_updates": 124}, "done": false, "episodes_total": 1644, "training_iteration": 63, "trial_id": "default", "date": "2024-10-05_21-57-26", "timestamp": 1728158246, "time_this_iter_s": 3.462087631225586, "time_total_s": 228.26329517364502, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 228.26329517364502, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 35.519999999999996, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 50.0, "episode_reward_min": 12.0, "episode_reward_mean": 29.2, "episode_len_mean": 29.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 32.0, 50.0, 17.0, 25.0, 43.0, 38.0, 15.0, 25.0, 35.0], "episode_lengths": [12, 32, 50, 17, 25, 43, 38, 15, 25, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367513834663848, "mean_inference_ms": 1.033695401127209, "mean_action_processing_ms": 0.11444327873724065, "mean_env_wait_ms": 0.054155058214613624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032091140747070312, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.06175518035888672}}, "episode_reward_max": 50.0, "episode_reward_min": 12.0, "episode_reward_mean": 29.2, "episode_len_mean": 29.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 32.0, 50.0, 17.0, 25.0, 43.0, 38.0, 15.0, 25.0, 35.0], "episode_lengths": [12, 32, 50, 17, 25, 43, 38, 15, 25, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3367513834663848, "mean_inference_ms": 1.033695401127209, "mean_action_processing_ms": 0.11444327873724065, "mean_env_wait_ms": 0.054155058214613624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032091140747070312, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.06175518035888672}, "num_agent_steps_sampled_this_iter": 292, "num_env_steps_sampled_this_iter": 292, "timesteps_this_iter": 292, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.02248764038086, "min_q": 1.5237549543380737, "max_q": 43.701263427734375, "mean_td_error": -1.1632118225097656}, "td_error": [-6.215368270874023, -0.7876205444335938, -1.6706724166870117, -0.9450950622558594, -2.8973445892333984, -2.6077442169189453, -1.2926673889160156, 2.991344451904297, 2.6195783615112305, 2.6405296325683594, -13.90814208984375, -9.256336212158203, -8.472103118896484, 0.023876190185546875, -2.3934335708618164, 2.822150230407715, -5.393709182739258, 0.9822158813476562, 6.016324996948242, 4.507035255432129, 13.642709732055664, 2.9075241088867188, 0.5237549543380737, -5.8514404296875, -1.6761150360107422, 4.573001861572266, -1.9601898193359375, -4.256072998046875, -3.813526153564453, -5.518451690673828, -1.5125646591186523, -1.0442237854003906], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 7875, "diff_num_grad_updates_vs_sampler_policy": 7874}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "last_target_update_ts": 63504, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 39.49, "episode_len_mean": 39.49, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0], "episode_lengths": [75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5264043573990682, "mean_inference_ms": 1.7327694717489397, "mean_action_processing_ms": 0.1779992333347404, "mean_env_wait_ms": 0.0996879626246627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008208036422729492, "StateBufferConnector_ms": 0.005774497985839844, "ViewRequirementAgentConnector_ms": 0.12750816345214844}}, "episode_reward_max": 98.0, "episode_reward_min": 12.0, "episode_reward_mean": 39.49, "episode_len_mean": 39.49, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [75.0, 46.0, 44.0, 33.0, 47.0, 98.0, 34.0, 61.0, 36.0, 48.0, 55.0, 41.0, 34.0, 84.0, 28.0, 33.0, 53.0, 37.0, 44.0, 30.0, 35.0, 43.0, 57.0, 24.0, 12.0, 39.0, 36.0, 72.0, 36.0, 54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0], "episode_lengths": [75, 46, 44, 33, 47, 98, 34, 61, 36, 48, 55, 41, 34, 84, 28, 33, 53, 37, 44, 30, 35, 43, 57, 24, 12, 39, 36, 72, 36, 54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5264043573990682, "mean_inference_ms": 1.7327694717489397, "mean_action_processing_ms": 0.1779992333347404, "mean_env_wait_ms": 0.0996879626246627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008208036422729492, "StateBufferConnector_ms": 0.005774497985839844, "ViewRequirementAgentConnector_ms": 0.12750816345214844}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.0793686045007, "num_env_steps_trained_throughput_per_sec": 1264.3174744180028, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 25.092, "sample_time_ms": 9.057, "learn_time_ms": 2.789, "learn_throughput": 11474.935, "synch_weights_time_ms": 4.217}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 252000, "last_target_update_ts": 63504, "num_target_updates": 125}, "done": false, "episodes_total": 1675, "training_iteration": 64, "trial_id": "default", "date": "2024-10-05_21-57-29", "timestamp": 1728158249, "time_this_iter_s": 3.393221378326416, "time_total_s": 231.65651655197144, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 231.65651655197144, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 87.32}}
{"evaluation": {"sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": 27.0, "episode_reward_mean": 37.9, "episode_len_mean": 37.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 64.0, 40.0, 27.0, 44.0, 37.0, 33.0, 38.0, 39.0, 30.0], "episode_lengths": [27, 64, 40, 27, 44, 37, 33, 38, 39, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3364568760855918, "mean_inference_ms": 1.0327396035972196, "mean_action_processing_ms": 0.11435687827779087, "mean_env_wait_ms": 0.054120792550548115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028967857360839844, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.05721092224121094}}, "episode_reward_max": 64.0, "episode_reward_min": 27.0, "episode_reward_mean": 37.9, "episode_len_mean": 37.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 64.0, 40.0, 27.0, 44.0, 37.0, 33.0, 38.0, 39.0, 30.0], "episode_lengths": [27, 64, 40, 27, 44, 37, 33, 38, 39, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3364568760855918, "mean_inference_ms": 1.0327396035972196, "mean_action_processing_ms": 0.11435687827779087, "mean_env_wait_ms": 0.054120792550548115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028967857360839844, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.05721092224121094}, "num_agent_steps_sampled_this_iter": 379, "num_env_steps_sampled_this_iter": 379, "timesteps_this_iter": 379, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.185943603515625, "min_q": 0.8946177959442139, "max_q": 44.114559173583984, "mean_td_error": 1.1279700994491577}, "td_error": [-2.2270164489746094, 3.5358071327209473, 0.002094268798828125, 0.4944953918457031, 0.44098663330078125, 6.622501373291016, 8.706355094909668, 3.2700958251953125, -2.3919124603271484, -3.322101593017578, -1.7873835563659668, 7.203361511230469, -1.2343101501464844, 12.840120315551758, 0.7207374572753906, 3.6109657287597656, 6.842157363891602, -8.300090789794922, 2.747760772705078, -5.671154975891113, -0.22840309143066406, -4.746326446533203, 2.5252342224121094, -1.975625991821289, 5.107110977172852, -1.496917724609375, -8.007637977600098, -2.549945831298828, 20.800527572631836, 4.087841510772705, 0.38680267333984375, -9.91108512878418], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8000, "diff_num_grad_updates_vs_sampler_policy": 7999}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "last_target_update_ts": 64512, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 69.0, "episode_reward_min": 13.0, "episode_reward_mean": 36.57, "episode_len_mean": 36.57, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0], "episode_lengths": [54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5242059069757028, "mean_inference_ms": 1.72954195168802, "mean_action_processing_ms": 0.17764528039640823, "mean_env_wait_ms": 0.09949010023442152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008189916610717773, "StateBufferConnector_ms": 0.005711078643798828, "ViewRequirementAgentConnector_ms": 0.12769842147827148}}, "episode_reward_max": 69.0, "episode_reward_min": 13.0, "episode_reward_mean": 36.57, "episode_len_mean": 36.57, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 40.0, 18.0, 22.0, 44.0, 40.0, 36.0, 39.0, 39.0, 44.0, 30.0, 36.0, 44.0, 29.0, 42.0, 35.0, 58.0, 37.0, 31.0, 69.0, 36.0, 63.0, 38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0], "episode_lengths": [54, 43, 40, 18, 22, 44, 40, 36, 39, 39, 44, 30, 36, 44, 29, 42, 35, 58, 37, 31, 69, 36, 63, 38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5242059069757028, "mean_inference_ms": 1.72954195168802, "mean_action_processing_ms": 0.17764528039640823, "mean_env_wait_ms": 0.09949010023442152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008189916610717773, "StateBufferConnector_ms": 0.005711078643798828, "ViewRequirementAgentConnector_ms": 0.12769842147827148}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.8895552758909, "num_env_steps_trained_throughput_per_sec": 1259.5582211035637, "timesteps_total": 65000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 25.02, "sample_time_ms": 8.854, "learn_time_ms": 2.796, "learn_throughput": 11446.946, "synch_weights_time_ms": 4.182}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 256000, "last_target_update_ts": 64512, "num_target_updates": 127}, "done": false, "episodes_total": 1704, "training_iteration": 65, "trial_id": "default", "date": "2024-10-05_21-57-33", "timestamp": 1728158253, "time_this_iter_s": 3.4735238552093506, "time_total_s": 235.1300404071808, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 235.1300404071808, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.879999999999995, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": 15.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 35.0, 35.0, 50.0, 43.0, 31.0, 34.0, 44.0, 47.0, 58.0], "episode_lengths": [15, 35, 35, 50, 43, 31, 34, 44, 47, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33643168906893806, "mean_inference_ms": 1.0321138812573416, "mean_action_processing_ms": 0.11434005708951409, "mean_env_wait_ms": 0.05412328793338741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028204917907714844, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.06082773208618164}}, "episode_reward_max": 58.0, "episode_reward_min": 15.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 35.0, 35.0, 50.0, 43.0, 31.0, 34.0, 44.0, 47.0, 58.0], "episode_lengths": [15, 35, 35, 50, 43, 31, 34, 44, 47, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33643168906893806, "mean_inference_ms": 1.0321138812573416, "mean_action_processing_ms": 0.11434005708951409, "mean_env_wait_ms": 0.05412328793338741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028204917907714844, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.06082773208618164}, "num_agent_steps_sampled_this_iter": 392, "num_env_steps_sampled_this_iter": 392, "timesteps_this_iter": 392, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.610641479492188, "min_q": -0.16996079683303833, "max_q": 44.307159423828125, "mean_td_error": 2.000521421432495}, "td_error": [0.5229530334472656, -0.5128898620605469, 7.697856426239014, -1.1103382110595703, 5.461215972900391, 11.734981536865234, 5.623041152954102, 0.37885284423828125, -3.6245498657226562, 5.6778106689453125, -1.1699607372283936, 2.853778839111328, 8.775636672973633, -0.3417015075683594, 9.92437744140625, 2.1032962799072266, 6.145073413848877, 0.3880789279937744, -2.769847869873047, 1.2563271522521973, 1.8686046600341797, 7.832979202270508, 5.377668380737305, 4.358949661254883, -0.8683319091796875, -3.187236785888672, -3.076519012451172, -0.06239891052246094, -1.4310522079467773, -0.575291633605957, -1.0124397277832031, -4.222236633300781], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8125, "diff_num_grad_updates_vs_sampler_policy": 8124}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "last_target_update_ts": 65520, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 66.0, "episode_reward_min": 13.0, "episode_reward_mean": 36.21, "episode_len_mean": 36.21, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0], "episode_lengths": [38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5215178141735537, "mean_inference_ms": 1.7262975752648122, "mean_action_processing_ms": 0.1772182900675989, "mean_env_wait_ms": 0.0992742033471339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008368968963623047, "StateBufferConnector_ms": 0.005722522735595703, "ViewRequirementAgentConnector_ms": 0.12742376327514648}}, "episode_reward_max": 66.0, "episode_reward_min": 13.0, "episode_reward_mean": 36.21, "episode_len_mean": 36.21, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.0, 33.0, 36.0, 42.0, 13.0, 38.0, 56.0, 43.0, 46.0, 35.0, 48.0, 37.0, 39.0, 27.0, 50.0, 37.0, 38.0, 48.0, 52.0, 42.0, 33.0, 24.0, 14.0, 36.0, 42.0, 26.0, 43.0, 42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0], "episode_lengths": [38, 33, 36, 42, 13, 38, 56, 43, 46, 35, 48, 37, 39, 27, 50, 37, 38, 48, 52, 42, 33, 24, 14, 36, 42, 26, 43, 42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5215178141735537, "mean_inference_ms": 1.7262975752648122, "mean_action_processing_ms": 0.1772182900675989, "mean_env_wait_ms": 0.0992742033471339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008368968963623047, "StateBufferConnector_ms": 0.005722522735595703, "ViewRequirementAgentConnector_ms": 0.12742376327514648}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.9913605198588, "num_env_steps_trained_throughput_per_sec": 1259.9654420794352, "timesteps_total": 66000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 25.517, "sample_time_ms": 9.582, "learn_time_ms": 2.753, "learn_throughput": 11625.716, "synch_weights_time_ms": 4.178}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 260000, "last_target_update_ts": 65520, "num_target_updates": 129}, "done": false, "episodes_total": 1727, "training_iteration": 66, "trial_id": "default", "date": "2024-10-05_21-57-36", "timestamp": 1728158256, "time_this_iter_s": 3.4768433570861816, "time_total_s": 238.60688376426697, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 238.60688376426697, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 35.620000000000005, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 48.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 31.0, 41.0, 46.0, 35.0, 41.0, 29.0, 48.0, 38.0, 44.0], "episode_lengths": [39, 31, 41, 46, 35, 41, 29, 48, 38, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359675062296686, "mean_inference_ms": 1.0304131123526656, "mean_action_processing_ms": 0.11421550469992092, "mean_env_wait_ms": 0.05406770658224217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.002505779266357422, "ViewRequirementAgentConnector_ms": 0.056319236755371094}}, "episode_reward_max": 48.0, "episode_reward_min": 29.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 31.0, 41.0, 46.0, 35.0, 41.0, 29.0, 48.0, 38.0, 44.0], "episode_lengths": [39, 31, 41, 46, 35, 41, 29, 48, 38, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359675062296686, "mean_inference_ms": 1.0304131123526656, "mean_action_processing_ms": 0.11421550469992092, "mean_env_wait_ms": 0.05406770658224217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.002505779266357422, "ViewRequirementAgentConnector_ms": 0.056319236755371094}, "num_agent_steps_sampled_this_iter": 392, "num_env_steps_sampled_this_iter": 392, "timesteps_this_iter": 392, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 31.355424880981445, "min_q": 13.175048828125, "max_q": 44.91077423095703, "mean_td_error": 0.8049540519714355}, "td_error": [5.13102912902832, -3.255758285522461, -4.385643005371094, -3.2468490600585938, -2.618938446044922, -3.453205108642578, 6.494650840759277, 13.827938079833984, -3.2532081604003906, 0.6400604248046875, 3.5139808654785156, 4.995532989501953, -2.422060012817383, -7.825290679931641, -2.267810821533203, 6.266338348388672, 1.8410491943359375, -0.15581893920898438, -2.5424728393554688, -4.733053207397461, 9.601987838745117, 0.8283672332763672, 7.806108474731445, -3.8703441619873047, 4.011991500854492, -1.0129661560058594, 1.7771625518798828, -0.1658935546875, 5.4345550537109375, 0.8197784423828125, -4.232486724853516, 2.209796905517578], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8250, "diff_num_grad_updates_vs_sampler_policy": 8249}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "last_target_update_ts": 66528, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 36.71, "episode_len_mean": 36.71, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0], "episode_lengths": [42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5205926704591075, "mean_inference_ms": 1.725102192132634, "mean_action_processing_ms": 0.17706347229241437, "mean_env_wait_ms": 0.0992534360360138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008245706558227539, "StateBufferConnector_ms": 0.0056722164154052734, "ViewRequirementAgentConnector_ms": 0.12715864181518555}}, "episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 36.71, "episode_len_mean": 36.71, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 29.0, 27.0, 25.0, 35.0, 30.0, 41.0, 44.0, 55.0, 22.0, 30.0, 15.0, 31.0, 47.0, 29.0, 26.0, 39.0, 14.0, 43.0, 31.0, 34.0, 14.0, 37.0, 48.0, 40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0], "episode_lengths": [42, 29, 27, 25, 35, 30, 41, 44, 55, 22, 30, 15, 31, 47, 29, 26, 39, 14, 43, 31, 34, 14, 37, 48, 40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5205926704591075, "mean_inference_ms": 1.725102192132634, "mean_action_processing_ms": 0.17706347229241437, "mean_env_wait_ms": 0.0992534360360138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008245706558227539, "StateBufferConnector_ms": 0.0056722164154052734, "ViewRequirementAgentConnector_ms": 0.12715864181518555}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.55950892992973, "num_env_steps_trained_throughput_per_sec": 1254.238035719719, "timesteps_total": 67000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 25.202, "sample_time_ms": 9.311, "learn_time_ms": 2.802, "learn_throughput": 11420.355, "synch_weights_time_ms": 4.146}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 264000, "last_target_update_ts": 66528, "num_target_updates": 131}, "done": false, "episodes_total": 1754, "training_iteration": 67, "trial_id": "default", "date": "2024-10-05_21-57-40", "timestamp": 1728158260, "time_this_iter_s": 3.4922032356262207, "time_total_s": 242.0990869998932, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 242.0990869998932, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 36.22, "ram_util_percent": 87.32000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": 29.0, "episode_reward_mean": 43.4, "episode_len_mean": 43.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 42.0, 44.0, 41.0, 59.0, 29.0, 52.0, 36.0, 34.0, 47.0], "episode_lengths": [50, 42, 44, 41, 59, 29, 52, 36, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33584428982174325, "mean_inference_ms": 1.0293865819315857, "mean_action_processing_ms": 0.11411035953655127, "mean_env_wait_ms": 0.054026945349727504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.05889177322387695}}, "episode_reward_max": 59.0, "episode_reward_min": 29.0, "episode_reward_mean": 43.4, "episode_len_mean": 43.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 42.0, 44.0, 41.0, 59.0, 29.0, 52.0, 36.0, 34.0, 47.0], "episode_lengths": [50, 42, 44, 41, 59, 29, 52, 36, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33584428982174325, "mean_inference_ms": 1.0293865819315857, "mean_action_processing_ms": 0.11411035953655127, "mean_env_wait_ms": 0.054026945349727504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.05889177322387695}, "num_agent_steps_sampled_this_iter": 434, "num_env_steps_sampled_this_iter": 434, "timesteps_this_iter": 434, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.813831329345703, "min_q": 13.162260055541992, "max_q": 45.22616958618164, "mean_td_error": 2.2174148559570312}, "td_error": [-10.986343383789062, 0.3809700012207031, -3.400766372680664, -2.219501495361328, 2.609457015991211, 2.4190673828125, -1.7194366455078125, 3.45111083984375, 1.154062271118164, 2.8191604614257812, -8.617883682250977, 10.797117233276367, 4.107366561889648, -0.19358253479003906, 2.7511720657348633, 3.2745361328125, 6.578239440917969, -0.1491374969482422, 0.9019317626953125, 3.7570362091064453, 6.468353271484375, 14.049291610717773, 1.4432430267333984, -1.866455078125, -0.3103485107421875, 6.411089897155762, 4.035282135009766, 10.900629997253418, 6.809169769287109, -0.7992362976074219, 6.458774566650391, -0.3570899963378906], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8375, "diff_num_grad_updates_vs_sampler_policy": 8374}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "last_target_update_ts": 67536, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 38.88, "episode_len_mean": 38.88, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0], "episode_lengths": [40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5235117559712767, "mean_inference_ms": 1.7277955377312262, "mean_action_processing_ms": 0.1775623556028806, "mean_env_wait_ms": 0.09956061014129086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008168220520019531, "StateBufferConnector_ms": 0.005796194076538086, "ViewRequirementAgentConnector_ms": 0.12720322608947754}}, "episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 38.88, "episode_len_mean": 38.88, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.0, 18.0, 14.0, 32.0, 38.0, 25.0, 46.0, 31.0, 30.0, 44.0, 34.0, 33.0, 48.0, 36.0, 48.0, 40.0, 32.0, 57.0, 57.0, 32.0, 66.0, 16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0], "episode_lengths": [40, 18, 14, 32, 38, 25, 46, 31, 30, 44, 34, 33, 48, 36, 48, 40, 32, 57, 57, 32, 66, 16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5235117559712767, "mean_inference_ms": 1.7277955377312262, "mean_action_processing_ms": 0.1775623556028806, "mean_env_wait_ms": 0.09956061014129086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008168220520019531, "StateBufferConnector_ms": 0.005796194076538086, "ViewRequirementAgentConnector_ms": 0.12720322608947754}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5259120496612, "num_env_steps_trained_throughput_per_sec": 1258.1036481986448, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 25.638, "sample_time_ms": 9.671, "learn_time_ms": 2.759, "learn_throughput": 11598.991, "synch_weights_time_ms": 4.198}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 268000, "last_target_update_ts": 67536, "num_target_updates": 133}, "done": false, "episodes_total": 1778, "training_iteration": 68, "trial_id": "default", "date": "2024-10-05_21-57-43", "timestamp": 1728158263, "time_this_iter_s": 3.479442596435547, "time_total_s": 245.57852959632874, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 245.57852959632874, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 36.08, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 60.0, "episode_reward_min": 25.0, "episode_reward_mean": 36.3, "episode_len_mean": 36.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 39.0, 60.0, 25.0, 44.0, 37.0, 26.0, 42.0, 25.0, 40.0], "episode_lengths": [25, 39, 60, 25, 44, 37, 26, 42, 25, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3358187796873338, "mean_inference_ms": 1.0291637578188422, "mean_action_processing_ms": 0.11411903877100202, "mean_env_wait_ms": 0.05404999652792534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028014183044433594, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.06052255630493164}}, "episode_reward_max": 60.0, "episode_reward_min": 25.0, "episode_reward_mean": 36.3, "episode_len_mean": 36.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 39.0, 60.0, 25.0, 44.0, 37.0, 26.0, 42.0, 25.0, 40.0], "episode_lengths": [25, 39, 60, 25, 44, 37, 26, 42, 25, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3358187796873338, "mean_inference_ms": 1.0291637578188422, "mean_action_processing_ms": 0.11411903877100202, "mean_env_wait_ms": 0.05404999652792534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028014183044433594, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.06052255630493164}, "num_agent_steps_sampled_this_iter": 363, "num_env_steps_sampled_this_iter": 363, "timesteps_this_iter": 363, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.887807846069336, "min_q": -0.3467700481414795, "max_q": 44.590579986572266, "mean_td_error": -0.02723020315170288}, "td_error": [-0.6806974411010742, -0.5863494873046875, -0.7661018371582031, -0.4359779357910156, 1.4639816284179688, -1.8323135375976562, 2.646879196166992, 9.675352096557617, -2.9789257049560547, -1.2898712158203125, 3.3599300384521484, 3.0416297912597656, -3.4780120849609375, -0.41965484619140625, -0.5058517456054688, -0.8736190795898438, 6.269094467163086, 2.8622970581054688, -4.9531402587890625, 10.483186721801758, -1.0595622062683105, -2.495891571044922, -5.21327018737793, -1.2806205749511719, -1.3467700481414795, 0.7001638412475586, -5.389913558959961, -2.9503769874572754, 1.4141387939453125, 2.9139251708984375, -6.541191101074219, -0.623835563659668], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8500, "diff_num_grad_updates_vs_sampler_policy": 8499}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "last_target_update_ts": 68544, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 39.57, "episode_len_mean": 39.57, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0], "episode_lengths": [16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521332772069195, "mean_inference_ms": 1.7253489777733821, "mean_action_processing_ms": 0.1771897343645921, "mean_env_wait_ms": 0.09941603097596012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008210420608520508, "StateBufferConnector_ms": 0.0058400630950927734, "ViewRequirementAgentConnector_ms": 0.1277151107788086}}, "episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 39.57, "episode_len_mean": 39.57, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 27.0, 34.0, 31.0, 15.0, 29.0, 65.0, 40.0, 46.0, 55.0, 34.0, 39.0, 28.0, 41.0, 30.0, 42.0, 46.0, 50.0, 41.0, 41.0, 30.0, 34.0, 36.0, 14.0, 39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0], "episode_lengths": [16, 27, 34, 31, 15, 29, 65, 40, 46, 55, 34, 39, 28, 41, 30, 42, 46, 50, 41, 41, 30, 34, 36, 14, 39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521332772069195, "mean_inference_ms": 1.7253489777733821, "mean_action_processing_ms": 0.1771897343645921, "mean_env_wait_ms": 0.09941603097596012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008210420608520508, "StateBufferConnector_ms": 0.0058400630950927734, "ViewRequirementAgentConnector_ms": 0.1277151107788086}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1764506986212, "num_env_steps_trained_throughput_per_sec": 1256.7058027944847, "timesteps_total": 69000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 25.033, "sample_time_ms": 9.025, "learn_time_ms": 2.818, "learn_throughput": 11353.889, "synch_weights_time_ms": 4.134}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 272000, "last_target_update_ts": 68544, "num_target_updates": 135}, "done": false, "episodes_total": 1799, "training_iteration": 69, "trial_id": "default", "date": "2024-10-05_21-57-47", "timestamp": 1728158267, "time_this_iter_s": 3.476351261138916, "time_total_s": 249.05488085746765, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 249.05488085746765, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.9, "ram_util_percent": 87.38}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 27.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 41.0, 36.0, 37.0, 50.0, 37.0, 62.0, 43.0, 42.0, 29.0], "episode_lengths": [27, 41, 36, 37, 50, 37, 62, 43, 42, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33556762628041736, "mean_inference_ms": 1.0280311172786682, "mean_action_processing_ms": 0.11406180758366109, "mean_env_wait_ms": 0.05402692177548819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033903121948242188, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.06194591522216797}}, "episode_reward_max": 62.0, "episode_reward_min": 27.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 41.0, 36.0, 37.0, 50.0, 37.0, 62.0, 43.0, 42.0, 29.0], "episode_lengths": [27, 41, 36, 37, 50, 37, 62, 43, 42, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33556762628041736, "mean_inference_ms": 1.0280311172786682, "mean_action_processing_ms": 0.11406180758366109, "mean_env_wait_ms": 0.05402692177548819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033903121948242188, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.06194591522216797}, "num_agent_steps_sampled_this_iter": 404, "num_env_steps_sampled_this_iter": 404, "timesteps_this_iter": 404, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.267593383789062, "min_q": 6.291568756103516, "max_q": 45.66079330444336, "mean_td_error": 0.5382827520370483}, "td_error": [-4.375688552856445, -2.9319915771484375, -0.8582553863525391, -3.9975833892822266, 3.297466278076172, -0.9000406265258789, 0.043972015380859375, -1.9951286315917969, 7.503063201904297, -0.9202003479003906, 6.014039993286133, 6.251214027404785, 3.985454559326172, 3.3389110565185547, 3.3389110565185547, 0.5922966003417969, -3.4751319885253906, 4.464468479156494, -0.14167022705078125, -3.9809608459472656, -6.648834228515625, 0.2271442413330078, -1.7459564208984375, 3.2178096771240234, 1.162381649017334, 2.692394256591797, 1.120370864868164, 2.932117462158203, -1.2107086181640625, -3.287212371826172, 1.636871337890625, 1.8755245208740234], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8625, "diff_num_grad_updates_vs_sampler_policy": 8624}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "last_target_update_ts": 69552, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.27, "episode_len_mean": 42.27, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0], "episode_lengths": [39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.522668410714557, "mean_inference_ms": 1.726407516400642, "mean_action_processing_ms": 0.1774892677319751, "mean_env_wait_ms": 0.09956229509061569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141279220581055, "StateBufferConnector_ms": 0.0058956146240234375, "ViewRequirementAgentConnector_ms": 0.12743735313415527}}, "episode_reward_max": 82.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.27, "episode_len_mean": 42.27, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 43.0, 36.0, 34.0, 33.0, 39.0, 32.0, 12.0, 43.0, 16.0, 29.0, 41.0, 56.0, 82.0, 35.0, 54.0, 51.0, 41.0, 44.0, 40.0, 31.0, 12.0, 30.0, 47.0, 36.0, 30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0], "episode_lengths": [39, 43, 36, 34, 33, 39, 32, 12, 43, 16, 29, 41, 56, 82, 35, 54, 51, 41, 44, 40, 31, 12, 30, 47, 36, 30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.522668410714557, "mean_inference_ms": 1.726407516400642, "mean_action_processing_ms": 0.1774892677319751, "mean_env_wait_ms": 0.09956229509061569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141279220581055, "StateBufferConnector_ms": 0.0058956146240234375, "ViewRequirementAgentConnector_ms": 0.12743735313415527}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3937266171913, "num_env_steps_trained_throughput_per_sec": 1253.5749064687652, "timesteps_total": 70000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 25.088, "sample_time_ms": 9.302, "learn_time_ms": 2.742, "learn_throughput": 11671.31, "synch_weights_time_ms": 4.112}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 276000, "last_target_update_ts": 69552, "num_target_updates": 137}, "done": false, "episodes_total": 1823, "training_iteration": 70, "trial_id": "default", "date": "2024-10-05_21-57-50", "timestamp": 1728158270, "time_this_iter_s": 3.505380868911743, "time_total_s": 252.5602617263794, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 252.5602617263794, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 36.06, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 50.0, "episode_reward_min": 26.0, "episode_reward_mean": 36.9, "episode_len_mean": 36.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 32.0, 42.0, 26.0, 33.0, 49.0, 30.0, 30.0, 43.0, 34.0], "episode_lengths": [50, 32, 42, 26, 33, 49, 30, 30, 43, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33555264882738, "mean_inference_ms": 1.0270861321873883, "mean_action_processing_ms": 0.11399230871918527, "mean_env_wait_ms": 0.05399472115965426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.05775928497314453}}, "episode_reward_max": 50.0, "episode_reward_min": 26.0, "episode_reward_mean": 36.9, "episode_len_mean": 36.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 32.0, 42.0, 26.0, 33.0, 49.0, 30.0, 30.0, 43.0, 34.0], "episode_lengths": [50, 32, 42, 26, 33, 49, 30, 30, 43, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33555264882738, "mean_inference_ms": 1.0270861321873883, "mean_action_processing_ms": 0.11399230871918527, "mean_env_wait_ms": 0.05399472115965426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.05775928497314453}, "num_agent_steps_sampled_this_iter": 369, "num_env_steps_sampled_this_iter": 369, "timesteps_this_iter": 369, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 32.072288513183594, "min_q": 5.829833030700684, "max_q": 45.545406341552734, "mean_td_error": -0.01039135456085205}, "td_error": [0.168701171875, -5.734889984130859, -5.927093505859375, 2.38934326171875, -3.416830062866211, -1.281097412109375, -3.0532445907592773, -2.0507431030273438, -2.195880889892578, -3.4556655883789062, -2.461956024169922, 2.3208065032958984, 5.436151504516602, 4.543022155761719, -1.38629150390625, -5.0230560302734375, -2.1524200439453125, -3.074859619140625, -0.024990081787109375, 18.725379943847656, 13.185110092163086, -2.0995216369628906, -2.3391456604003906, 6.426155090332031, -6.036067962646484, 2.1870574951171875, -2.4222030639648438, -2.8792877197265625, 9.700946807861328, -7.989543914794922, -6.083240509033203, 5.672832489013672], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8750, "diff_num_grad_updates_vs_sampler_policy": 8749}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "last_target_update_ts": 70560, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 84.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.45, "episode_len_mean": 42.45, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0], "episode_lengths": [30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189743663591764, "mean_inference_ms": 1.72171606654644, "mean_action_processing_ms": 0.17677684820627093, "mean_env_wait_ms": 0.09922948123676764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00836801528930664, "StateBufferConnector_ms": 0.0058972835540771484, "ViewRequirementAgentConnector_ms": 0.1268141269683838}}, "episode_reward_max": 84.0, "episode_reward_min": 22.0, "episode_reward_mean": 42.45, "episode_len_mean": 42.45, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.0, 61.0, 49.0, 47.0, 34.0, 41.0, 42.0, 30.0, 39.0, 42.0, 36.0, 56.0, 39.0, 42.0, 34.0, 41.0, 39.0, 43.0, 59.0, 57.0, 38.0, 41.0, 32.0, 35.0, 42.0, 42.0, 28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0], "episode_lengths": [30, 61, 49, 47, 34, 41, 42, 30, 39, 42, 36, 56, 39, 42, 34, 41, 39, 43, 59, 57, 38, 41, 32, 35, 42, 42, 28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189743663591764, "mean_inference_ms": 1.72171606654644, "mean_action_processing_ms": 0.17677684820627093, "mean_env_wait_ms": 0.09922948123676764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00836801528930664, "StateBufferConnector_ms": 0.0058972835540771484, "ViewRequirementAgentConnector_ms": 0.1268141269683838}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.70242477988756, "num_env_steps_trained_throughput_per_sec": 1254.8096991195503, "timesteps_total": 71000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 25.31, "sample_time_ms": 9.229, "learn_time_ms": 2.833, "learn_throughput": 11294.461, "synch_weights_time_ms": 4.156}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 280000, "last_target_update_ts": 70560, "num_target_updates": 139}, "done": false, "episodes_total": 1848, "training_iteration": 71, "trial_id": "default", "date": "2024-10-05_21-57-54", "timestamp": 1728158274, "time_this_iter_s": 3.445202112197876, "time_total_s": 256.00546383857727, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 256.00546383857727, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 36.14, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 43.0, "episode_reward_min": 11.0, "episode_reward_mean": 33.0, "episode_len_mean": 33.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 39.0, 39.0, 43.0, 32.0, 32.0, 12.0, 38.0, 42.0, 11.0], "episode_lengths": [42, 39, 39, 43, 32, 32, 12, 38, 42, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357235558967878, "mean_inference_ms": 1.0272759561127711, "mean_action_processing_ms": 0.11399215798072126, "mean_env_wait_ms": 0.054015592429397484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003306865692138672, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.061113834381103516}}, "episode_reward_max": 43.0, "episode_reward_min": 11.0, "episode_reward_mean": 33.0, "episode_len_mean": 33.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 39.0, 39.0, 43.0, 32.0, 32.0, 12.0, 38.0, 42.0, 11.0], "episode_lengths": [42, 39, 39, 43, 32, 32, 12, 38, 42, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357235558967878, "mean_inference_ms": 1.0272759561127711, "mean_action_processing_ms": 0.11399215798072126, "mean_env_wait_ms": 0.054015592429397484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003306865692138672, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.061113834381103516}, "num_agent_steps_sampled_this_iter": 330, "num_env_steps_sampled_this_iter": 330, "timesteps_this_iter": 330, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.20792579650879, "min_q": 1.9200913906097412, "max_q": 43.11405563354492, "mean_td_error": 1.0116546154022217}, "td_error": [2.772930145263672, 0.6583824157714844, 9.906473159790039, 5.161491394042969, 10.840576171875, 0.9200913906097412, -10.518766403198242, 1.2709598541259766, -0.5657272338867188, -1.4244728088378906, 4.272087097167969, -4.845207214355469, 2.1323928833007812, 2.6586990356445312, -3.1852283477783203, 9.254383087158203, -6.3089399337768555, -1.1679725646972656, 5.483127593994141, -2.029940128326416, 1.7832722663879395, 2.1008310317993164, 6.147163391113281, 7.150997161865234, 0.7810287475585938, -0.015543460845947266, -0.0717620849609375, -1.57049560546875, -0.5220718383789062, -9.506731033325195, 0.052524566650390625, 0.758392333984375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 8875, "diff_num_grad_updates_vs_sampler_policy": 8874}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "last_target_update_ts": 71568, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 84.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.36, "episode_len_mean": 41.36, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0], "episode_lengths": [28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5178012556217098, "mean_inference_ms": 1.7200206943574075, "mean_action_processing_ms": 0.17661284052104034, "mean_env_wait_ms": 0.09915359143495688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00837850570678711, "StateBufferConnector_ms": 0.0057866573333740234, "ViewRequirementAgentConnector_ms": 0.12748384475708008}}, "episode_reward_max": 84.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.36, "episode_len_mean": 41.36, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.0, 37.0, 57.0, 54.0, 42.0, 35.0, 29.0, 49.0, 28.0, 25.0, 46.0, 46.0, 39.0, 74.0, 30.0, 34.0, 42.0, 33.0, 39.0, 47.0, 37.0, 59.0, 64.0, 33.0, 39.0, 40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0], "episode_lengths": [28, 37, 57, 54, 42, 35, 29, 49, 28, 25, 46, 46, 39, 74, 30, 34, 42, 33, 39, 47, 37, 59, 64, 33, 39, 40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5178012556217098, "mean_inference_ms": 1.7200206943574075, "mean_action_processing_ms": 0.17661284052104034, "mean_env_wait_ms": 0.09915359143495688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00837850570678711, "StateBufferConnector_ms": 0.0057866573333740234, "ViewRequirementAgentConnector_ms": 0.12748384475708008}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.95107986825275, "num_env_steps_trained_throughput_per_sec": 1259.804319473011, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 24.966, "sample_time_ms": 8.923, "learn_time_ms": 2.78, "learn_throughput": 11509.474, "synch_weights_time_ms": 4.172}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 284000, "last_target_update_ts": 71568, "num_target_updates": 141}, "done": false, "episodes_total": 1874, "training_iteration": 72, "trial_id": "default", "date": "2024-10-05_21-57-57", "timestamp": 1728158277, "time_this_iter_s": 3.4488108158111572, "time_total_s": 259.4542746543884, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 259.4542746543884, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 35.78, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 57.0, "episode_reward_min": 30.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 38.0, 30.0, 34.0, 30.0, 39.0, 57.0, 34.0, 44.0], "episode_lengths": [44, 42, 38, 30, 34, 30, 39, 57, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355756127248429, "mean_inference_ms": 1.0262794517362503, "mean_action_processing_ms": 0.11392854285225126, "mean_env_wait_ms": 0.053975388720085206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002906322479248047, "StateBufferConnector_ms": 0.0024652481079101562, "ViewRequirementAgentConnector_ms": 0.061528682708740234}}, "episode_reward_max": 57.0, "episode_reward_min": 30.0, "episode_reward_mean": 39.2, "episode_len_mean": 39.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 42.0, 38.0, 30.0, 34.0, 30.0, 39.0, 57.0, 34.0, 44.0], "episode_lengths": [44, 42, 38, 30, 34, 30, 39, 57, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355756127248429, "mean_inference_ms": 1.0262794517362503, "mean_action_processing_ms": 0.11392854285225126, "mean_env_wait_ms": 0.053975388720085206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002906322479248047, "StateBufferConnector_ms": 0.0024652481079101562, "ViewRequirementAgentConnector_ms": 0.061528682708740234}, "num_agent_steps_sampled_this_iter": 392, "num_env_steps_sampled_this_iter": 392, "timesteps_this_iter": 392, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 24.59939956665039, "min_q": 6.318605422973633, "max_q": 46.13540267944336, "mean_td_error": 0.6462979316711426}, "td_error": [-0.015996932983398438, 2.1525659561157227, 1.8596420288085938, 2.210407257080078, 1.6939010620117188, 0.46167755126953125, 10.266403198242188, -3.6948204040527344, -5.656124114990234, -4.934087753295898, 2.5738728046417236, -5.867679595947266, 11.598560333251953, -2.7047386169433594, -2.633957862854004, -0.6689071655273438, -1.1606006622314453, 8.475532531738281, -0.8356113433837891, 2.610187530517578, -0.5165681838989258, -0.5249252319335938, -0.8202075958251953, -0.9443168640136719, -0.643707275390625, 5.653987884521484, 4.612892150878906, -3.945486068725586, 6.185665130615234, -6.962364196777344, 3.320962905883789, -0.4646267890930176], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9000, "diff_num_grad_updates_vs_sampler_policy": 8999}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "last_target_update_ts": 72576, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 84.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.09, "episode_len_mean": 41.09, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0], "episode_lengths": [40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5168307014854923, "mean_inference_ms": 1.7185302536796363, "mean_action_processing_ms": 0.1764718566659029, "mean_env_wait_ms": 0.09908762753735845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008564472198486328, "StateBufferConnector_ms": 0.0056667327880859375, "ViewRequirementAgentConnector_ms": 0.12668776512145996}}, "episode_reward_max": 84.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.09, "episode_len_mean": 41.09, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.0, 66.0, 48.0, 37.0, 38.0, 55.0, 51.0, 71.0, 38.0, 40.0, 57.0, 44.0, 54.0, 72.0, 50.0, 22.0, 28.0, 63.0, 45.0, 33.0, 43.0, 56.0, 42.0, 41.0, 36.0, 39.0, 30.0, 29.0, 41.0, 54.0, 31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0], "episode_lengths": [40, 66, 48, 37, 38, 55, 51, 71, 38, 40, 57, 44, 54, 72, 50, 22, 28, 63, 45, 33, 43, 56, 42, 41, 36, 39, 30, 29, 41, 54, 31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5168307014854923, "mean_inference_ms": 1.7185302536796363, "mean_action_processing_ms": 0.1764718566659029, "mean_env_wait_ms": 0.09908762753735845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008564472198486328, "StateBufferConnector_ms": 0.0056667327880859375, "ViewRequirementAgentConnector_ms": 0.12668776512145996}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.9391832590195, "num_env_steps_trained_throughput_per_sec": 1247.756733036078, "timesteps_total": 73000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 25.208, "sample_time_ms": 9.133, "learn_time_ms": 2.83, "learn_throughput": 11308.259, "synch_weights_time_ms": 4.138}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 288000, "last_target_update_ts": 72576, "num_target_updates": 143}, "done": false, "episodes_total": 1899, "training_iteration": 73, "trial_id": "default", "date": "2024-10-05_21-58-01", "timestamp": 1728158281, "time_this_iter_s": 3.506713628768921, "time_total_s": 262.96098828315735, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 262.96098828315735, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.78, "ram_util_percent": 87.30000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 48.0, "episode_reward_min": 25.0, "episode_reward_mean": 37.8, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 41.0, 45.0, 25.0, 48.0, 30.0, 32.0, 37.0, 40.0, 36.0], "episode_lengths": [44, 41, 45, 25, 48, 30, 32, 37, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33554243022052516, "mean_inference_ms": 1.0252596349889056, "mean_action_processing_ms": 0.11384854990366797, "mean_env_wait_ms": 0.05394523035231279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028634071350097656, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.06000518798828125}}, "episode_reward_max": 48.0, "episode_reward_min": 25.0, "episode_reward_mean": 37.8, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 41.0, 45.0, 25.0, 48.0, 30.0, 32.0, 37.0, 40.0, 36.0], "episode_lengths": [44, 41, 45, 25, 48, 30, 32, 37, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33554243022052516, "mean_inference_ms": 1.0252596349889056, "mean_action_processing_ms": 0.11384854990366797, "mean_env_wait_ms": 0.05394523035231279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028634071350097656, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.06000518798828125}, "num_agent_steps_sampled_this_iter": 378, "num_env_steps_sampled_this_iter": 378, "timesteps_this_iter": 378, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 28.284048080444336, "min_q": 6.844709396362305, "max_q": 44.57859802246094, "mean_td_error": 1.4033935070037842}, "td_error": [3.1395339965820312, -4.630218505859375, 4.399330139160156, -4.464271545410156, -3.442058563232422, 1.9381389617919922, 4.152521133422852, 8.988362312316895, 1.762939453125, -4.939502716064453, -4.477773666381836, 3.3819236755371094, -2.0830726623535156, 1.9111824035644531, -0.29343414306640625, 8.328651428222656, 12.362335205078125, -5.093337059020996, 8.133394241333008, 8.014274597167969, -1.5113563537597656, -4.116436004638672, -6.765819549560547, 1.9269123077392578, 0.73834228515625, 4.093204498291016, 2.934864044189453, 3.5144996643066406, -2.9843063354492188, 11.524238586425781, -1.3218269348144531, -0.21263885498046875], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9125, "diff_num_grad_updates_vs_sampler_policy": 9124}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "last_target_update_ts": 73584, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 84.0, "episode_reward_min": 11.0, "episode_reward_mean": 37.86, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0], "episode_lengths": [31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5118815682364315, "mean_inference_ms": 1.7130682563561859, "mean_action_processing_ms": 0.17588536550845732, "mean_env_wait_ms": 0.09863587684023808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008708000183105469, "StateBufferConnector_ms": 0.005676746368408203, "ViewRequirementAgentConnector_ms": 0.1270122528076172}}, "episode_reward_max": 84.0, "episode_reward_min": 11.0, "episode_reward_mean": 37.86, "episode_len_mean": 37.86, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.0, 41.0, 36.0, 39.0, 41.0, 84.0, 39.0, 36.0, 43.0, 41.0, 26.0, 38.0, 41.0, 29.0, 37.0, 49.0, 29.0, 34.0, 31.0, 34.0, 30.0, 45.0, 27.0, 46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0], "episode_lengths": [31, 41, 36, 39, 41, 84, 39, 36, 43, 41, 26, 38, 41, 29, 37, 49, 29, 34, 31, 34, 30, 45, 27, 46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5118815682364315, "mean_inference_ms": 1.7130682563561859, "mean_action_processing_ms": 0.17588536550845732, "mean_env_wait_ms": 0.09863587684023808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008708000183105469, "StateBufferConnector_ms": 0.005676746368408203, "ViewRequirementAgentConnector_ms": 0.1270122528076172}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4020392715508, "num_env_steps_trained_throughput_per_sec": 1261.6081570862032, "timesteps_total": 74000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 25.006, "sample_time_ms": 9.198, "learn_time_ms": 2.785, "learn_throughput": 11489.768, "synch_weights_time_ms": 4.058}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 292000, "last_target_update_ts": 73584, "num_target_updates": 145}, "done": false, "episodes_total": 1929, "training_iteration": 74, "trial_id": "default", "date": "2024-10-05_21-58-04", "timestamp": 1728158284, "time_this_iter_s": 3.4566922187805176, "time_total_s": 266.41768050193787, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 266.41768050193787, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.56, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 63.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.6, "episode_len_mean": 42.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 12.0, 38.0, 50.0, 32.0, 50.0, 63.0, 42.0, 43.0, 60.0], "episode_lengths": [36, 12, 38, 50, 32, 50, 63, 42, 43, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3358531728796704, "mean_inference_ms": 1.0251645170396757, "mean_action_processing_ms": 0.11385711542878112, "mean_env_wait_ms": 0.05394875665642675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031518936157226562, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06377935409545898}}, "episode_reward_max": 63.0, "episode_reward_min": 12.0, "episode_reward_mean": 42.6, "episode_len_mean": 42.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 12.0, 38.0, 50.0, 32.0, 50.0, 63.0, 42.0, 43.0, 60.0], "episode_lengths": [36, 12, 38, 50, 32, 50, 63, 42, 43, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3358531728796704, "mean_inference_ms": 1.0251645170396757, "mean_action_processing_ms": 0.11385711542878112, "mean_env_wait_ms": 0.05394875665642675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031518936157226562, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06377935409545898}, "num_agent_steps_sampled_this_iter": 426, "num_env_steps_sampled_this_iter": 426, "timesteps_this_iter": 426, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.296377182006836, "min_q": 8.211267471313477, "max_q": 45.851524353027344, "mean_td_error": 0.3764630854129791}, "td_error": [2.0459022521972656, 0.3896961212158203, -2.1305999755859375, 0.4168682098388672, 1.9191007614135742, -2.111713409423828, 0.16278839111328125, 0.236602783203125, -6.390220642089844, 6.1492919921875, -1.3146934509277344, 0.7972221374511719, -2.392223358154297, -0.7368850708007812, -0.4210195541381836, 1.6097240447998047, 3.6913108825683594, -3.220754623413086, 9.572067260742188, 0.6875953674316406, 1.2400779724121094, 0.5206375122070312, -2.2747802734375, -3.3263397216796875, 7.211267471313477, 0.07286834716796875, 0.1383380889892578, -0.09039306640625, 1.7144651412963867, 7.856863021850586, -5.157112121582031, -4.819133758544922], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9250, "diff_num_grad_updates_vs_sampler_policy": 9249}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "last_target_update_ts": 74592, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 38.73, "episode_len_mean": 38.73, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0], "episode_lengths": [46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5118919765997676, "mean_inference_ms": 1.7127556081410131, "mean_action_processing_ms": 0.17595543832908397, "mean_env_wait_ms": 0.09865619720299496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008453369140625, "StateBufferConnector_ms": 0.005709171295166016, "ViewRequirementAgentConnector_ms": 0.1270756721496582}}, "episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 38.73, "episode_len_mean": 38.73, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, 42.0, 40.0, 42.0, 48.0, 41.0, 28.0, 32.0, 43.0, 38.0, 45.0, 58.0, 12.0, 41.0, 65.0, 34.0, 30.0, 33.0, 42.0, 37.0, 12.0, 37.0, 44.0, 39.0, 40.0, 43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0], "episode_lengths": [46, 42, 40, 42, 48, 41, 28, 32, 43, 38, 45, 58, 12, 41, 65, 34, 30, 33, 42, 37, 12, 37, 44, 39, 40, 43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5118919765997676, "mean_inference_ms": 1.7127556081410131, "mean_action_processing_ms": 0.17595543832908397, "mean_env_wait_ms": 0.09865619720299496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008453369140625, "StateBufferConnector_ms": 0.005709171295166016, "ViewRequirementAgentConnector_ms": 0.1270756721496582}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.82670307220485, "num_env_steps_trained_throughput_per_sec": 1263.3068122888194, "timesteps_total": 75000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 25.354, "sample_time_ms": 9.207, "learn_time_ms": 2.962, "learn_throughput": 10803.275, "synch_weights_time_ms": 4.138}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 296000, "last_target_update_ts": 74592, "num_target_updates": 147}, "done": false, "episodes_total": 1952, "training_iteration": 75, "trial_id": "default", "date": "2024-10-05_21-58-08", "timestamp": 1728158288, "time_this_iter_s": 3.485572338104248, "time_total_s": 269.9032528400421, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 269.9032528400421, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 35.28, "ram_util_percent": 87.28}}
{"evaluation": {"sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": 28.0, "episode_reward_mean": 37.5, "episode_len_mean": 37.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 47.0, 47.0, 41.0, 36.0, 31.0, 28.0, 45.0, 29.0, 42.0], "episode_lengths": [29, 47, 47, 41, 36, 31, 28, 45, 29, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33565189876641205, "mean_inference_ms": 1.024287290898251, "mean_action_processing_ms": 0.11379632678672544, "mean_env_wait_ms": 0.05391742514561585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032281875610351562, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.05789518356323242}}, "episode_reward_max": 47.0, "episode_reward_min": 28.0, "episode_reward_mean": 37.5, "episode_len_mean": 37.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 47.0, 47.0, 41.0, 36.0, 31.0, 28.0, 45.0, 29.0, 42.0], "episode_lengths": [29, 47, 47, 41, 36, 31, 28, 45, 29, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33565189876641205, "mean_inference_ms": 1.024287290898251, "mean_action_processing_ms": 0.11379632678672544, "mean_env_wait_ms": 0.05391742514561585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032281875610351562, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.05789518356323242}, "num_agent_steps_sampled_this_iter": 375, "num_env_steps_sampled_this_iter": 375, "timesteps_this_iter": 375, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 27.410093307495117, "min_q": -0.26457858085632324, "max_q": 45.78759002685547, "mean_td_error": 0.34820348024368286}, "td_error": [-0.4277801513671875, 3.8302536010742188, -2.110139846801758, 2.8529367446899414, 0.950042724609375, 2.0497703552246094, 6.389469146728516, 2.0617828369140625, -4.925897598266602, 6.527593612670898, 2.042491912841797, 1.4021530151367188, 0.4186267852783203, -2.8428468704223633, 1.8490638732910156, -3.873411178588867, -6.375741958618164, 3.557384490966797, -1.3170013427734375, -0.24613571166992188, -1.8812599182128906, -7.056646347045898, 1.7807197570800781, -5.108991622924805, 1.7765941619873047, 14.192497253417969, -2.288381576538086, -4.859668731689453, 0.7107753753662109, 4.371185302734375, -3.0945587158203125, 0.7876310348510742], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9375, "diff_num_grad_updates_vs_sampler_policy": 9374}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "last_target_update_ts": 75600, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 38.98, "episode_len_mean": 38.98, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0], "episode_lengths": [43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514438455131649, "mean_inference_ms": 1.7154116544976268, "mean_action_processing_ms": 0.17649419657740592, "mean_env_wait_ms": 0.0989457432962009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008565187454223633, "StateBufferConnector_ms": 0.005633831024169922, "ViewRequirementAgentConnector_ms": 0.12640070915222168}}, "episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 38.98, "episode_len_mean": 38.98, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 48.0, 43.0, 38.0, 80.0, 78.0, 34.0, 39.0, 35.0, 44.0, 42.0, 35.0, 37.0, 59.0, 12.0, 36.0, 13.0, 42.0, 43.0, 12.0, 42.0, 41.0, 18.0, 44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0], "episode_lengths": [43, 48, 43, 38, 80, 78, 34, 39, 35, 44, 42, 35, 37, 59, 12, 36, 13, 42, 43, 12, 42, 41, 18, 44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514438455131649, "mean_inference_ms": 1.7154116544976268, "mean_action_processing_ms": 0.17649419657740592, "mean_env_wait_ms": 0.0989457432962009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008565187454223633, "StateBufferConnector_ms": 0.005633831024169922, "ViewRequirementAgentConnector_ms": 0.12640070915222168}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.81342764341923, "num_env_steps_trained_throughput_per_sec": 1259.253710573677, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 25.085, "sample_time_ms": 9.199, "learn_time_ms": 2.813, "learn_throughput": 11377.469, "synch_weights_time_ms": 4.111}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 300000, "last_target_update_ts": 75600, "num_target_updates": 149}, "done": false, "episodes_total": 1977, "training_iteration": 76, "trial_id": "default", "date": "2024-10-05_21-58-11", "timestamp": 1728158291, "time_this_iter_s": 3.4584877490997314, "time_total_s": 273.36174058914185, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 273.36174058914185, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 35.940000000000005, "ram_util_percent": 87.3}}
{"evaluation": {"sampler_results": {"episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 44.2, "episode_len_mean": 44.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 45.0, 31.0, 62.0, 39.0, 41.0, 54.0, 40.0, 50.0, 45.0], "episode_lengths": [35, 45, 31, 62, 39, 41, 54, 40, 50, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3351457461483488, "mean_inference_ms": 1.0230748529126814, "mean_action_processing_ms": 0.11365925037097131, "mean_env_wait_ms": 0.05385753630579806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025653839111328125, "StateBufferConnector_ms": 0.002791881561279297, "ViewRequirementAgentConnector_ms": 0.05817413330078125}}, "episode_reward_max": 62.0, "episode_reward_min": 31.0, "episode_reward_mean": 44.2, "episode_len_mean": 44.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 45.0, 31.0, 62.0, 39.0, 41.0, 54.0, 40.0, 50.0, 45.0], "episode_lengths": [35, 45, 31, 62, 39, 41, 54, 40, 50, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3351457461483488, "mean_inference_ms": 1.0230748529126814, "mean_action_processing_ms": 0.11365925037097131, "mean_env_wait_ms": 0.05385753630579806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025653839111328125, "StateBufferConnector_ms": 0.002791881561279297, "ViewRequirementAgentConnector_ms": 0.05817413330078125}, "num_agent_steps_sampled_this_iter": 442, "num_env_steps_sampled_this_iter": 442, "timesteps_this_iter": 442, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 26.578025817871094, "min_q": 4.681346416473389, "max_q": 44.81345748901367, "mean_td_error": 0.9059320092201233}, "td_error": [-1.6452140808105469, 6.6455230712890625, -8.630146026611328, 5.524009704589844, -0.3553581237792969, 4.812297821044922, -3.3699913024902344, 4.402454376220703, 2.7953758239746094, -2.7627124786376953, -1.3032665252685547, 3.021503448486328, -0.12676239013671875, -1.1422629356384277, 3.3586320877075195, 2.214397430419922, -1.7830257415771484, 2.6237668991088867, -0.7817306518554688, 1.1228466033935547, 6.081029891967773, 4.338020324707031, -0.6998939514160156, -1.5909996032714844, 2.0942459106445312, 7.247121810913086, -0.5685434341430664, 3.6138877868652344, -0.835693359375, -1.2391204833984375, -3.5002479553222656, -0.5703201293945312], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9500, "diff_num_grad_updates_vs_sampler_policy": 9499}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "last_target_update_ts": 76608, "num_target_updates": 151}, "sampler_results": {"episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 39.25, "episode_len_mean": 39.25, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0], "episode_lengths": [44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5149925754994649, "mean_inference_ms": 1.715727640523765, "mean_action_processing_ms": 0.17661204257245053, "mean_env_wait_ms": 0.09903455379921289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008568763732910156, "StateBufferConnector_ms": 0.0055730342864990234, "ViewRequirementAgentConnector_ms": 0.12714385986328125}}, "episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 39.25, "episode_len_mean": 39.25, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 39.0, 39.0, 42.0, 41.0, 38.0, 57.0, 47.0, 32.0, 31.0, 12.0, 39.0, 12.0, 30.0, 43.0, 45.0, 45.0, 33.0, 35.0, 11.0, 41.0, 13.0, 12.0, 35.0, 35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0], "episode_lengths": [44, 39, 39, 42, 41, 38, 57, 47, 32, 31, 12, 39, 12, 30, 43, 45, 45, 33, 35, 11, 41, 13, 12, 35, 35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5149925754994649, "mean_inference_ms": 1.715727640523765, "mean_action_processing_ms": 0.17661204257245053, "mean_env_wait_ms": 0.09903455379921289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008568763732910156, "StateBufferConnector_ms": 0.0055730342864990234, "ViewRequirementAgentConnector_ms": 0.12714385986328125}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.61540273890375, "num_env_steps_trained_throughput_per_sec": 1254.461610955615, "timesteps_total": 77000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 25.157, "sample_time_ms": 8.983, "learn_time_ms": 2.962, "learn_throughput": 10804.493, "synch_weights_time_ms": 4.19}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 304000, "last_target_update_ts": 76608, "num_target_updates": 151}, "done": false, "episodes_total": 2000, "training_iteration": 77, "trial_id": "default", "date": "2024-10-05_21-58-15", "timestamp": 1728158295, "time_this_iter_s": 3.531480550765991, "time_total_s": 276.89322113990784, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 276.89322113990784, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.82, "ram_util_percent": 87.35999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 57.0, "episode_reward_min": 27.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 46.0, 27.0, 57.0, 33.0, 29.0, 37.0, 41.0, 34.0, 44.0], "episode_lengths": [56, 46, 27, 57, 33, 29, 37, 41, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350897559794868, "mean_inference_ms": 1.0225161900298614, "mean_action_processing_ms": 0.11364478415418626, "mean_env_wait_ms": 0.05385964699016339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002582073211669922, "StateBufferConnector_ms": 0.0026655197143554688, "ViewRequirementAgentConnector_ms": 0.057778358459472656}}, "episode_reward_max": 57.0, "episode_reward_min": 27.0, "episode_reward_mean": 40.4, "episode_len_mean": 40.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 46.0, 27.0, 57.0, 33.0, 29.0, 37.0, 41.0, 34.0, 44.0], "episode_lengths": [56, 46, 27, 57, 33, 29, 37, 41, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350897559794868, "mean_inference_ms": 1.0225161900298614, "mean_action_processing_ms": 0.11364478415418626, "mean_env_wait_ms": 0.05385964699016339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002582073211669922, "StateBufferConnector_ms": 0.0026655197143554688, "ViewRequirementAgentConnector_ms": 0.057778358459472656}, "num_agent_steps_sampled_this_iter": 404, "num_env_steps_sampled_this_iter": 404, "timesteps_this_iter": 404, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 29.353824615478516, "min_q": 5.751062393188477, "max_q": 48.19795227050781, "mean_td_error": 0.34779906272888184}, "td_error": [4.243854522705078, -2.644084930419922, -0.3071327209472656, -3.7583885192871094, -2.390263557434082, -0.31179285049438477, 3.8167037963867188, 3.9140262603759766, -2.4583301544189453, -1.3992767333984375, 2.548898696899414, 5.506656646728516, -5.379180908203125, 1.6728897094726562, -3.0232715606689453, 2.0659914016723633, 3.2101287841796875, -1.3838920593261719, 2.1598072052001953, 1.1181831359863281, -8.405097961425781, 1.8499755859375, -0.3374900817871094, 1.4264860153198242, -1.5034255981445312, -2.4470977783203125, 3.4283833503723145, -0.03237152099609375, 4.560890197753906, 5.878170013427734, -0.47855377197265625, -0.0118255615234375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9625, "diff_num_grad_updates_vs_sampler_policy": 9624}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "last_target_update_ts": 77616, "num_target_updates": 153}, "sampler_results": {"episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0], "episode_lengths": [35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5109782680117823, "mean_inference_ms": 1.7101261993091765, "mean_action_processing_ms": 0.17567355375376714, "mean_env_wait_ms": 0.09861544328071158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008294343948364258, "StateBufferConnector_ms": 0.005467414855957031, "ViewRequirementAgentConnector_ms": 0.12535452842712402}}, "episode_reward_max": 81.0, "episode_reward_min": 11.0, "episode_reward_mean": 41.1, "episode_len_mean": 41.1, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 81.0, 37.0, 41.0, 12.0, 38.0, 48.0, 66.0, 52.0, 46.0, 32.0, 45.0, 41.0, 41.0, 54.0, 27.0, 55.0, 48.0, 43.0, 51.0, 14.0, 31.0, 34.0, 58.0, 38.0, 11.0, 38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0], "episode_lengths": [35, 81, 37, 41, 12, 38, 48, 66, 52, 46, 32, 45, 41, 41, 54, 27, 55, 48, 43, 51, 14, 31, 34, 58, 38, 11, 38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5109782680117823, "mean_inference_ms": 1.7101261993091765, "mean_action_processing_ms": 0.17567355375376714, "mean_env_wait_ms": 0.09861544328071158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008294343948364258, "StateBufferConnector_ms": 0.005467414855957031, "ViewRequirementAgentConnector_ms": 0.12535452842712402}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.6056998910661, "num_env_steps_trained_throughput_per_sec": 1258.4227995642643, "timesteps_total": 78000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 25.496, "sample_time_ms": 9.489, "learn_time_ms": 2.807, "learn_throughput": 11400.179, "synch_weights_time_ms": 4.192}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 308000, "last_target_update_ts": 77616, "num_target_updates": 153}, "done": false, "episodes_total": 2024, "training_iteration": 78, "trial_id": "default", "date": "2024-10-05_21-58-18", "timestamp": 1728158298, "time_this_iter_s": 3.4722657203674316, "time_total_s": 280.36548686027527, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 280.36548686027527, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.3, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 68.0, "episode_reward_min": 27.0, "episode_reward_mean": 44.4, "episode_len_mean": 44.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 68.0, 27.0, 44.0, 52.0, 49.0, 44.0, 41.0, 35.0, 41.0], "episode_lengths": [43, 68, 27, 44, 52, 49, 44, 41, 35, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3363665864919598, "mean_inference_ms": 1.0263448469807126, "mean_action_processing_ms": 0.1141068273581971, "mean_env_wait_ms": 0.05407983494629505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004000663757324219, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.07894039154052734}}, "episode_reward_max": 68.0, "episode_reward_min": 27.0, "episode_reward_mean": 44.4, "episode_len_mean": 44.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 68.0, 27.0, 44.0, 52.0, 49.0, 44.0, 41.0, 35.0, 41.0], "episode_lengths": [43, 68, 27, 44, 52, 49, 44, 41, 35, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3363665864919598, "mean_inference_ms": 1.0263448469807126, "mean_action_processing_ms": 0.1141068273581971, "mean_env_wait_ms": 0.05407983494629505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004000663757324219, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.07894039154052734}, "num_agent_steps_sampled_this_iter": 444, "num_env_steps_sampled_this_iter": 444, "timesteps_this_iter": 444, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 31.390804290771484, "min_q": 13.114483833312988, "max_q": 46.77301788330078, "mean_td_error": 1.9566203355789185}, "td_error": [1.1885147094726562, -4.496311187744141, 1.6510887145996094, 5.653736114501953, 2.272676467895508, 7.007347106933594, 3.3083229064941406, 2.9893035888671875, 6.9795989990234375, 1.8382701873779297, -0.08801651000976562, -1.8967876434326172, -0.09528732299804688, -3.0858840942382812, 15.104263305664062, 6.043251037597656, -1.0798521041870117, 5.493694305419922, 8.757135391235352, -1.0418376922607422, -1.7779388427734375, -0.483001708984375, -1.3657417297363281, -2.2623291015625, 3.983175277709961, 3.4095077514648438, -0.9222850799560547, 4.20356559753418, -0.9889717102050781, -1.2228355407714844, 0.9282217025756836, 2.607257843017578], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9750, "diff_num_grad_updates_vs_sampler_policy": 9749}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "last_target_update_ts": 78624, "num_target_updates": 155}, "sampler_results": {"episode_reward_max": 70.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.92, "episode_len_mean": 40.92, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0, 70.0, 38.0, 37.0, 45.0, 25.0, 51.0, 38.0, 48.0, 28.0, 41.0, 28.0, 38.0, 53.0, 41.0, 41.0, 26.0, 31.0, 44.0, 37.0, 39.0, 52.0, 55.0, 37.0, 39.0, 54.0, 25.0], "episode_lengths": [38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65, 70, 38, 37, 45, 25, 51, 38, 48, 28, 41, 28, 38, 53, 41, 41, 26, 31, 44, 37, 39, 52, 55, 37, 39, 54, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5126263584904376, "mean_inference_ms": 1.711910016634166, "mean_action_processing_ms": 0.17608678750520979, "mean_env_wait_ms": 0.0988193117714051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008347034454345703, "StateBufferConnector_ms": 0.005403757095336914, "ViewRequirementAgentConnector_ms": 0.1264173984527588}}, "episode_reward_max": 70.0, "episode_reward_min": 12.0, "episode_reward_mean": 40.92, "episode_len_mean": 40.92, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.0, 57.0, 34.0, 12.0, 38.0, 42.0, 48.0, 32.0, 42.0, 47.0, 37.0, 42.0, 50.0, 30.0, 30.0, 38.0, 39.0, 39.0, 40.0, 43.0, 37.0, 44.0, 48.0, 41.0, 59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0, 70.0, 38.0, 37.0, 45.0, 25.0, 51.0, 38.0, 48.0, 28.0, 41.0, 28.0, 38.0, 53.0, 41.0, 41.0, 26.0, 31.0, 44.0, 37.0, 39.0, 52.0, 55.0, 37.0, 39.0, 54.0, 25.0], "episode_lengths": [38, 57, 34, 12, 38, 42, 48, 32, 42, 47, 37, 42, 50, 30, 30, 38, 39, 39, 40, 43, 37, 44, 48, 41, 59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65, 70, 38, 37, 45, 25, 51, 38, 48, 28, 41, 28, 38, 53, 41, 41, 26, 31, 44, 37, 39, 52, 55, 37, 39, 54, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5126263584904376, "mean_inference_ms": 1.711910016634166, "mean_action_processing_ms": 0.17608678750520979, "mean_env_wait_ms": 0.0988193117714051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008347034454345703, "StateBufferConnector_ms": 0.005403757095336914, "ViewRequirementAgentConnector_ms": 0.1264173984527588}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.21013006305026, "num_env_steps_trained_throughput_per_sec": 1236.840520252201, "timesteps_total": 79000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 28.897, "sample_time_ms": 10.18, "learn_time_ms": 3.337, "learn_throughput": 9589.309, "synch_weights_time_ms": 4.841}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 312000, "last_target_update_ts": 78624, "num_target_updates": 155}, "done": false, "episodes_total": 2050, "training_iteration": 79, "trial_id": "default", "date": "2024-10-05_21-58-22", "timestamp": 1728158302, "time_this_iter_s": 3.6850345134735107, "time_total_s": 284.0505213737488, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 284.0505213737488, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 87.4}}
{"evaluation": {"sampler_results": {"episode_reward_max": 51.0, "episode_reward_min": 23.0, "episode_reward_mean": 34.4, "episode_len_mean": 34.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 24.0, 25.0, 39.0, 39.0, 36.0, 37.0, 25.0, 23.0, 51.0], "episode_lengths": [45, 24, 25, 39, 39, 36, 37, 25, 23, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33832376753067706, "mean_inference_ms": 1.031386329730225, "mean_action_processing_ms": 0.11475142648891981, "mean_env_wait_ms": 0.05438868882196237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004296302795410156, "StateBufferConnector_ms": 0.004100799560546875, "ViewRequirementAgentConnector_ms": 0.0957798957824707}}, "episode_reward_max": 51.0, "episode_reward_min": 23.0, "episode_reward_mean": 34.4, "episode_len_mean": 34.4, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 24.0, 25.0, 39.0, 39.0, 36.0, 37.0, 25.0, 23.0, 51.0], "episode_lengths": [45, 24, 25, 39, 39, 36, 37, 25, 23, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33832376753067706, "mean_inference_ms": 1.031386329730225, "mean_action_processing_ms": 0.11475142648891981, "mean_env_wait_ms": 0.05438868882196237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004296302795410156, "StateBufferConnector_ms": 0.004100799560546875, "ViewRequirementAgentConnector_ms": 0.0957798957824707}, "num_agent_steps_sampled_this_iter": 344, "num_env_steps_sampled_this_iter": 344, "timesteps_this_iter": 344, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 30.34095001220703, "min_q": -13.936055183410645, "max_q": 46.247650146484375, "mean_td_error": -0.3010338842868805}, "td_error": [-2.0086441040039062, -1.0788688659667969, -7.5150146484375, -1.1069412231445312, 7.756865501403809, -1.0500602722167969, -0.7650833129882812, 1.4735450744628906, -0.5162277221679688, 9.949911117553711, 3.9987335205078125, 5.2316131591796875, -3.9428977966308594, -6.312562942504883, 2.4483509063720703, -2.5302734375, 3.5344009399414062, -0.3411083221435547, -15.535285949707031, -7.217555999755859, 1.8808441162109375, 5.238616943359375, 0.11029434204101562, -2.7345542907714844, -1.1553764343261719, -0.21474838256835938, -0.6946029663085938, 3.1304473876953125, 1.1646728515625, -3.6904220581054688, -2.0349349975585938, 4.8937835693359375], "custom_metrics": {}, "num_agent_steps_trained": 32, "num_grad_updates_lifetime": 9875, "diff_num_grad_updates_vs_sampler_policy": 9874}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "last_target_update_ts": 79632, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": 75.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.8, "episode_len_mean": 41.8, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0, 70.0, 38.0, 37.0, 45.0, 25.0, 51.0, 38.0, 48.0, 28.0, 41.0, 28.0, 38.0, 53.0, 41.0, 41.0, 26.0, 31.0, 44.0, 37.0, 39.0, 52.0, 55.0, 37.0, 39.0, 54.0, 25.0, 26.0, 75.0, 35.0, 73.0, 37.0, 43.0, 29.0, 40.0, 45.0, 47.0, 34.0, 45.0, 35.0, 50.0, 51.0, 51.0, 36.0, 34.0, 34.0, 55.0, 37.0, 46.0, 34.0, 44.0], "episode_lengths": [59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65, 70, 38, 37, 45, 25, 51, 38, 48, 28, 41, 28, 38, 53, 41, 41, 26, 31, 44, 37, 39, 52, 55, 37, 39, 54, 25, 26, 75, 35, 73, 37, 43, 29, 40, 45, 47, 34, 45, 35, 50, 51, 51, 36, 34, 34, 55, 37, 46, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5119059837585167, "mean_inference_ms": 1.710382544955963, "mean_action_processing_ms": 0.17580174218968952, "mean_env_wait_ms": 0.09867876792402477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009101390838623047, "StateBufferConnector_ms": 0.006154060363769531, "ViewRequirementAgentConnector_ms": 0.139113187789917}}, "episode_reward_max": 75.0, "episode_reward_min": 12.0, "episode_reward_mean": 41.8, "episode_len_mean": 41.8, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 47.0, 35.0, 42.0, 38.0, 60.0, 41.0, 54.0, 37.0, 51.0, 41.0, 34.0, 40.0, 28.0, 60.0, 31.0, 45.0, 45.0, 36.0, 64.0, 39.0, 24.0, 12.0, 52.0, 34.0, 33.0, 41.0, 54.0, 40.0, 32.0, 61.0, 45.0, 46.0, 35.0, 44.0, 37.0, 29.0, 37.0, 31.0, 38.0, 48.0, 54.0, 42.0, 38.0, 34.0, 29.0, 41.0, 44.0, 36.0, 65.0, 70.0, 38.0, 37.0, 45.0, 25.0, 51.0, 38.0, 48.0, 28.0, 41.0, 28.0, 38.0, 53.0, 41.0, 41.0, 26.0, 31.0, 44.0, 37.0, 39.0, 52.0, 55.0, 37.0, 39.0, 54.0, 25.0, 26.0, 75.0, 35.0, 73.0, 37.0, 43.0, 29.0, 40.0, 45.0, 47.0, 34.0, 45.0, 35.0, 50.0, 51.0, 51.0, 36.0, 34.0, 34.0, 55.0, 37.0, 46.0, 34.0, 44.0], "episode_lengths": [59, 47, 35, 42, 38, 60, 41, 54, 37, 51, 41, 34, 40, 28, 60, 31, 45, 45, 36, 64, 39, 24, 12, 52, 34, 33, 41, 54, 40, 32, 61, 45, 46, 35, 44, 37, 29, 37, 31, 38, 48, 54, 42, 38, 34, 29, 41, 44, 36, 65, 70, 38, 37, 45, 25, 51, 38, 48, 28, 41, 28, 38, 53, 41, 41, 26, 31, 44, 37, 39, 52, 55, 37, 39, 54, 25, 26, 75, 35, 73, 37, 43, 29, 40, 45, 47, 34, 45, 35, 50, 51, 51, 36, 34, 34, 55, 37, 46, 34, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5119059837585167, "mean_inference_ms": 1.710382544955963, "mean_action_processing_ms": 0.17580174218968952, "mean_env_wait_ms": 0.09867876792402477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009101390838623047, "StateBufferConnector_ms": 0.006154060363769531, "ViewRequirementAgentConnector_ms": 0.139113187789917}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.1861709431384, "num_env_steps_trained_throughput_per_sec": 864.7446837725536, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 38.458, "sample_time_ms": 13.782, "learn_time_ms": 4.296, "learn_throughput": 7448.43, "synch_weights_time_ms": 6.22}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 316000, "last_target_update_ts": 79632, "num_target_updates": 157}, "done": false, "episodes_total": 2074, "training_iteration": 80, "trial_id": "default", "date": "2024-10-05_21-58-27", "timestamp": 1728158307, "time_this_iter_s": 5.0339391231536865, "time_total_s": 289.08446049690247, "pid": 333946, "hostname": "instaboy", "node_ip": "192.168.178.49", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "POCartPole", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 2, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d8e45cfbe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 289.08446049690247, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 36.55714285714286, "ram_util_percent": 87.39999999999999}}
